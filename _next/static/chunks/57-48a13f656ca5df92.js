try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="53cd824f-8617-44ca-9177-64d22073d770",e._sentryDebugIdIdentifier="sentry-dbid-53cd824f-8617-44ca-9177-64d22073d770")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(e,t,n){var s=n(11010),a=n(91309),i=n(97582),r=n(85893),l=n(27245),d=n(86501),o=n(42130),c=n(67294),u=n(41664),p=n.n(u),y=n(74598),m=n(91529),x=n(99958),f=n(73591),b=n(933),h=n(72260),v=n(77156),g=n(7224),T=n(85794),j=n(53696),k=n(42083),w=n(44576);t.Z=function(e){var t,n,u,N,C=e.token,I=e.enableWithdraw,B=void 0!==I&&I,A=e.onStakeStatusChange,M=(0,o.m)().address,E=(0,h.Bk)(),_=E.currentRound,F=E.isPending,P=E.error,S=(0,b.L)(null==C?void 0:C.address,M),Z=S.slAmount,D=S.stAmount,z=S.promisedWaitingPhases,L=S.requestedUnstakeRound,J=S.govVotes,V=S.isPending,G=S.error,H=function(){return!(!Z||Z<=BigInt(0))||(d.Am.error("流动性质押数量为0，不用取消质押"),!1)},W=(0,T.yG)(null==C?void 0:C.slTokenAddress,M,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",B),q=W.allowance,K=W.isPending,R=W.error,O=(0,T.yG)(null==C?void 0:C.stTokenAddress,M,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",B),Q=O.allowance,U=O.isPending,X=O.error,Y=(0,b.Ty)((null==C?void 0:C.address)||"",M||""),$=Y.validGovVotes,ee=Y.isPending;Y.error;var et=(0,a._)((0,c.useState)(!1),2),en=et[0],es=et[1],ea=(0,a._)((0,c.useState)(!1),2),ei=ea[0],er=ea[1],el=(0,v.yA)(null==C?void 0:C.stTokenAddress),ed=el.isPending,eo=el.isConfirming,ec=el.isConfirmed,eu=el.writeError,ep=el.approve,ey=(0,g.yA)(null==C?void 0:C.slTokenAddress),em=ey.isPending,ex=ey.isConfirming,ef=ey.isConfirmed,eb=ey.writeError,eh=ey.approve,ev=(t=(0,s._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!H())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(Z&&Z>BigInt(0)&&!en))return[3,3];return[4,eh("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",Z)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)}),eg=(n=(0,s._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!H())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(D&&D>BigInt(0)&&!ei))return[3,3];return[4,ep("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",D)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})}),function(){return n.apply(this,arguments)});(0,c.useEffect)(function(){ef?es(!0):Z&&Z>BigInt(0)&&q&&q>=Z?es(!0):es(!1)},[Z,q,K,ef]),(0,c.useEffect)(function(){ec?er(!0):!D||D<=BigInt(0)?er(!0):Q&&Q>=D?er(!0):er(!1)},[D,Q,U,ec]);var eT=(0,b.vc)(),ej=eT.isWriting,ek=eT.isConfirming,ew=eT.isConfirmed,eN=eT.writeError,eC=eT.unstake,eI=(u=(0,s._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eC(null==C?void 0:C.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,c.useEffect)(function(){ew&&(d.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==C?void 0:C.symbol)},2e3))},[ew]);var eB=(0,b.Qc)(),eA=eB.isWriting,eM=eB.isConfirming,eE=eB.isConfirmed,e_=eB.writeError,eF=eB.withdraw,eP=(N=(0,s._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eF(null==C?void 0:C.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})}),function(){return N.apply(this,arguments)});(0,c.useEffect)(function(){eE&&(d.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==C?void 0:C.symbol)},2e3))},[eE]),(0,c.useEffect)(function(){A&&!V&&A(!!(Z&&Z>BigInt(0)))},[Z,V,A]);var eS=(0,f.S)().handleContractError;if((0,c.useEffect)(function(){G&&eS(G,"stake"),eu&&eS(eu,"stToken"),eb&&eS(eb,"slToken"),eN&&eS(eN,"stake"),e_&&eS(e_,"stake"),P&&eS(P,"stake"),R&&eS(R,"slToken"),X&&eS(X,"stToken")},[G,eu,eb,eN,e_,P,R,X]),!M)return(0,r.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!C||B&&F||V)return(0,r.jsx)(k.Z,{});if(!V&&!Z)return(0,r.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eZ=em||ex,eD=ed||eo,ez=en&&ei,eL=L&&_>L+(z||BigInt(0));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,r.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,r.jsx)("div",{className:"stat-value text-xl text-secondary",children:V?(0,r.jsx)(k.Z,{}):(0,m.LH)(J||BigInt(0))}),(0,r.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:L&&L>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,r.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,r.jsxs)("div",{className:"stat-value text-lg",children:[(0,r.jsx)("span",{className:"text-secondary",children:V?(0,r.jsx)(k.Z,{}):"".concat(z||BigInt(0)," ")}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,r.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,x.Cn)(Number(z||BigInt(0)),!0))})]})]}),(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,r.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,r.jsx)(j.Z,{tokenAddress:C.slTokenAddress,tokenSymbol:"sl"+C.symbol,tokenDecimals:C.decimals})]}),(0,r.jsx)("div",{className:"stat-value text-xl text-gray-600",children:V?(0,r.jsx)(k.Z,{}):(0,r.jsxs)(p(),{href:"/my/liquid?symbol=".concat(C.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,r.jsx)("span",{className:"cursor-pointer",children:(0,m.LH)(Z||BigInt(0))}),(0,r.jsx)(y.Z,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,r.jsx)("div",{className:"stat-desc text-xs",children:(0,r.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,r.jsx)(p(),{href:"/stake/stakelp/?symbol=".concat(C.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,r.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,r.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,r.jsx)(j.Z,{tokenAddress:C.stTokenAddress,tokenSymbol:"st"+C.symbol,tokenDecimals:C.decimals})]}),(0,r.jsx)("div",{className:"stat-value text-xl text-gray-600",children:V?(0,r.jsx)(k.Z,{}):(0,m.LH)(D||BigInt(0))}),(0,r.jsx)("div",{className:"stat-desc text-xs",children:(0,r.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,r.jsx)(p(),{href:"/stake/staketoken?symbol=".concat(C.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),!ee&&!V&&void 0!==$&&void 0!==J&&$<=BigInt(0)&&J>BigInt(0)&&(0,r.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,r.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),B&&(0,r.jsxs)(r.Fragment,{children:[!L&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,r.jsx)(l.z,{className:"w-1/3",onClick:ev,disabled:eZ||en,children:eZ?"1.提交中...":ex?"1.确认中...":en?"1.sl".concat(null==C?void 0:C.symbol," 已授权"):"1.授权 sl".concat(null==C?void 0:C.symbol)}),(0,r.jsx)(l.z,{className:"w-1/3",onClick:eg,disabled:!en||eD||ei,children:eD?"2.提交中...":eo?"2.确认中...":ei?"2.st".concat(null==C?void 0:C.symbol," 已授权"):"2.授权 st".concat(null==C?void 0:C.symbol)}),(0,r.jsx)(l.z,{className:"w-1/3",onClick:eI,disabled:!ez||ej||ek||ew,children:ej?"3.提交中":ek?"3.确认中":ew?"3.已取消质押":"3.取消质押"})]}),(0,r.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,r.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,r.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(_,C)+(z||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),L&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,r.jsx)(l.z,{className:"w-1/2",onClick:eP,disabled:!eL||eA||eM||eE,children:eL?eA?"提交中":eM?"确认中":eE?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(L,C)+(z||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!B&&(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsx)(l.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(p(),{href:"/my/govrewards?symbol=".concat(C.symbol),children:"铸造 治理激励 >>"})}),L&&(0,r.jsx)(l.z,{variant:"outline",className:"w-1/2 ".concat(eL?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eL,asChild:!0,children:(0,r.jsx)(p(),{href:"/stake/unstake/?symbol=".concat(C.symbol),children:eL?"取回质押代币":"已取消, 第"+((0,m.cK)(L,C)+(z||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,r.jsx)(w.Z,{isLoading:eZ||eD||eA||ej||eM||ek,text:em||ed||eA||ej?"提交交易...":"确认交易..."})]})}},77156:function(e,t,n){n.d(t,{yA:function(){return p},hS:function(){return u}});var s=n(11010),a=n(97582),i=n(67294),r=n(71104),l=[{type:"constructor",inputs:[{name:"minter_",type:"address",internalType:"address"},{name:"tokenAddress_",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"allowance",inputs:[{name:"owner",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"balanceOf",inputs:[{name:"account",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"burn",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"decimals",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"decreaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"subtractedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"increaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"addedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"mint",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"minter",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"reserve",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"tokenAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"totalSupply",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transfer",inputs:[{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"transferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"event",name:"Approval",inputs:[{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"spender",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenBurn",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenMint",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Transfer",inputs:[{name:"from",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AmountIsGreaterThanReserve",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"NotMinter",inputs:[]}],d=n(37742),o=n(37474),c=n(84689),u=function(e,t){var n=(0,r.u)({address:e,abi:l,functionName:"balanceOf",args:[t],query:{enabled:!!e&&!!t}}),s=n.data,a=n.isPending,i=n.error;return{balance:s?(0,d.Z)(s):void 0,isPending:a,error:i}};function p(e){var t,n=(0,o.e9)(l,e,"approve"),r=n.execute,d=n.isPending,u=n.isConfirming,p=n.isConfirmed,y=n.error,m=n.hash,x=n.isTukeMode,f=(t=(0,s._)(function(t,n){return(0,a.Jh)(this,function(s){switch(s.label){case 0:return console.log("提交approve交易:",{address:e,spender:t,value:n,isTukeMode:x}),[4,r([t,n])];case 1:return[2,s.sent()]}})}),function(e,n){return t.apply(this,arguments)});return(0,i.useEffect)(function(){m&&console.log("approve tx hash:",m),y&&(console.log("提交approve交易错误:"),(0,c.Vh)(y),(0,c.H)(y))},[m,y]),{approve:f,isPending:d,isConfirming:u,writeError:y,isConfirmed:p,hash:m,isTukeMode:x}}}}]);