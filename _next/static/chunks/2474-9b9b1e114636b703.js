"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2474],{42038:(e,t,n)=>{n.d(t,{C:()=>a});var s=n(97685),a=e=>!!e||(s.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},42472:(e,t,n)=>{n.d(t,{zH:()=>c,lW:()=>o});var s=n(16927),a=n(4902),r=n(75569),i=n(59493),l=n(40162),d=[{type:"constructor",inputs:[{name:"minter_",type:"address",internalType:"address"},{name:"tokenAddress_",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"allowance",inputs:[{name:"owner",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"balanceOf",inputs:[{name:"account",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"burn",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"decimals",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"decreaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"subtractedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"increaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"addedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"mint",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"minter",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"reserve",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"tokenAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"totalSupply",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transfer",inputs:[{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"transferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"event",name:"Approval",inputs:[{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"spender",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenBurn",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenMint",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Transfer",inputs:[{name:"from",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AmountIsGreaterThanReserve",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"NotEligibleToMint",inputs:[]}],o=(e,t)=>{var n=(0,r.Q)({address:e,abi:d,functionName:"balanceOf",args:[t],query:{enabled:!!e&&!!t}}),s=n.data;return{balance:s,isPending:n.isPending,error:n.error}},c=e=>{var t=(0,i.x)(),n=t.writeContract,r=t.data,o=t.isPending,c=t.error,u=function(){var t=(0,s._)(function(t,s){var r;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,n({address:e,abi:d,functionName:"approve",args:[t,s]})];case 1:return a.sent(),[3,3];case 2:throw console.error("Approve failed:",r=a.sent()),r;case 3:return[2]}})});return function(e,n){return t.apply(this,arguments)}}(),p=(0,l.g)({hash:r});return{approve:u,writeData:r,isPending:o,error:c,isConfirming:p.isLoading,isConfirmed:p.isSuccess}}},92474:(e,t,n)=>{n.d(t,{A:()=>N});var s=n(16927),a=n(40854),r=n(4902),i=n(37876),l=n(6960),d=n(97685),o=n(8047),c=n(14232),u=n(48230),p=n.n(u),m=n(42038),y=n(20442),x=n(4066),b=n(20451),v=n(19591),f=n(42472),h=n(67121),j=n(9215),T=n(75695),g=n(87577),A=n(12293),w=n(99574);let N=e=>{var t=e.token,n=e.enableWithdraw,u=void 0!==n&&n,N=(0,o.F)(),k=N.address,C=N.chain,_=(0,v.vC)(u),M=_.currentRound,P=_.isPending,E=_.error,F=(0,v.n3)(null==t?void 0:t.address,k),B=F.slAmount,S=F.stAmount,$=F.promisedWaitingPhases,L=F.requestedUnstakeRound,R=F.govVotes,W=F.isPending,z=F.error,G=()=>!!(0,m.C)(C)&&(!!B&&!(B<=0n)||(d.oR.error("流动性质押数量为0，不用取消质押"),!1)),V=(0,j.Gp)(null==t?void 0:t.slTokenAddress,k,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",u),H=V.allowance,I=V.isPending,J=V.error,q=(0,j.Gp)(null==t?void 0:t.stTokenAddress,k,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",u),D=q.allowance,O=q.isPending,Q=q.error,U=(0,v.Fd)((null==t?void 0:t.address)||"",k||""),Z=U.validGovVotes;U.isPending,U.error;var K=(0,a._)((0,c.useState)(!1),2),X=K[0],Y=K[1],ee=(0,a._)((0,c.useState)(!1),2),et=ee[0],en=ee[1],es=(0,f.zH)(null==t?void 0:t.stTokenAddress),ea=es.isPending,er=es.isConfirming,ei=es.isConfirmed,el=es.error,ed=es.approve,eo=(0,h.zH)(null==t?void 0:t.slTokenAddress),ec=eo.isPending,eu=eo.isConfirming,ep=eo.isConfirmed,em=eo.error,ey=eo.approve,ex=function(){var e=(0,s._)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:if(!G())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(B&&B>0n&&!X))return[3,3];return[4,ey("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",B)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})});return function(){return e.apply(this,arguments)}}(),eb=function(){var e=(0,s._)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:if(!G())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(S&&S>0n&&!et))return[3,3];return[4,ed("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",S)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,c.useEffect)(()=>{ep||B&&B>0n&&H&&H>=B?Y(!0):Y(!1)},[B,H,I,ep]),(0,c.useEffect)(()=>{ei||!S||S<=0n||D&&D>=S?en(!0):en(!1)},[S,D,O,ei]);var ev=(0,v.Zh)(),ef=ev.isWriting,eh=ev.isConfirming,ej=ev.isConfirmed,eT=ev.writeError,eg=ev.unstake,eA=function(){var e=(0,s._)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eg(null==t?void 0:t.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,c.useEffect)(()=>{ej&&(d.oR.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==t?void 0:t.symbol)},2e3))},[ej]);var ew=(0,v.S1)(),eN=ew.isWriting,ek=ew.isConfirming,eC=ew.isConfirmed,e_=ew.writeError,eM=ew.withdraw,eP=function(){var e=(0,s._)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eM(null==t?void 0:t.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,c.useEffect)(()=>{eC&&(d.oR.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==t?void 0:t.symbol)},2e3))},[eC]);var eE=(0,b.g)().handleContractError;if((0,c.useEffect)(()=>{z&&eE(z,"stake"),el&&eE(el,"stToken"),em&&eE(em,"slToken"),eT&&eE(eT,"stake"),e_&&eE(e_,"stake"),E&&eE(E,"stake"),J&&eE(J,"slToken"),Q&&eE(Q,"stToken")},[z,el,em,eT,e_,E,J,Q]),!k)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!t||u&&P||W)return(0,i.jsx)(A.A,{});if(!W&&!B)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eF=ec||eu,eB=ea||er,eS=X&&et,e$=u&&L&&M>L+($||BigInt(0));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,i.jsx)("div",{className:"stat-value text-xl",children:W?(0,i.jsx)(A.A,{}):(0,y.NJ)(R||0n)}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:L&&L>0n&&"注意：解锁期内治理票数为0"})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,i.jsxs)("div",{className:"stat-value text-lg",children:[W?(0,i.jsx)(A.A,{}):"".concat($||0n," "),(0,i.jsx)("span",{className:"text-sm",children:" 阶段"})]}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,x.u$)(Number($||0n),!0))})]})]}),(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,i.jsx)(g.A,{address:t.slTokenAddress,showAddress:!1}),(0,i.jsx)(T.A,{tokenAddress:t.slTokenAddress,tokenSymbol:"sl"+t.symbol,tokenDecimals:t.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl",children:W?(0,i.jsx)(A.A,{}):(0,y.NJ)(B||0n)}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(l.$,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(p(),{href:"/gov/stakelp/?symbol=".concat(t.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,i.jsx)(g.A,{address:t.stTokenAddress,showAddress:!1}),(0,i.jsx)(T.A,{tokenAddress:t.stTokenAddress,tokenSymbol:"st"+t.symbol,tokenDecimals:t.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl",children:W?(0,i.jsx)(A.A,{}):(0,y.NJ)(S||0n)}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(l.$,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(p(),{href:"/gov/staketoken?symbol=".concat(t.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),Z<=0n&&R&&R>0n&&(0,i.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,i.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),u&&(0,i.jsxs)(i.Fragment,{children:[!L&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,i.jsx)(l.$,{className:"w-1/3",onClick:ex,disabled:eF||X,children:eF?"1.提交中...":eu?"1.确认中...":X?"1.sl".concat(null==t?void 0:t.symbol," 已授权"):"1.授权 sl".concat(null==t?void 0:t.symbol)}),(0,i.jsx)(l.$,{className:"w-1/3",onClick:eb,disabled:!X||eB||et,children:eB?"2.提交中...":er?"2.确认中...":et?"2.st".concat(null==t?void 0:t.symbol," 已授权"):"2.授权 st".concat(null==t?void 0:t.symbol)}),(0,i.jsx)(l.$,{className:"w-1/3",onClick:eA,disabled:!eS||ef||eh||ej,children:ef?"3.提交中":eh?"3.确认中":ej?"3.已取消质押":"3.取消质押"})]}),(0,i.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,i.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,i.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,y.LP)(M,t)+($||0n)+1n," ")}),"轮才能取回代币）"]})]}),L&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,i.jsx)(l.$,{className:"w-1/2",onClick:eP,disabled:!e$||eN||ek||eC,children:e$?eN?"提交中":ek?"确认中":eC?"已取回":"取回质押代币":"已取消,第"+((0,y.LP)(L,t)+($||0n)+1n)+"轮才可取回"})})})]}),!u&&(0,i.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,i.jsx)(l.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(p(),{href:"/my/govrewards?symbol=".concat(t.symbol),children:"铸造治理奖励"})}),L&&(0,i.jsx)(l.$,{variant:"outline",className:"w-1/2 ".concat(e$?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!e$,asChild:!0,children:(0,i.jsx)(p(),{href:"/gov/unstake/?symbol=".concat(t.symbol),children:e$?"取回质押代币":"已取消, 第"+((0,y.LP)(L,t)+($||0n)+1n)+"轮可取回"})})]}),(0,i.jsx)(w.A,{isLoading:eF||eB||eN||ef||ek||eh,text:ec||ea||eN||ef?"提交交易...":"确认交易..."})]})}},99574:(e,t,n)=>{n.d(t,{A:()=>r});var s=n(37876);n(14232);var a=n(7446);let r=e=>{var t=e.isLoading,n=e.text;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===n?"Loading":n})]})}):null}}}]);