"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2474],{92474:(e,s,t)=>{t.d(s,{A:()=>w});var n=t(16927),r=t(40854),a=t(4902),l=t(37876),c=t(6960),i=t(97685),d=t(8047),o=t(14232),m=t(48230),x=t.n(m),u=t(42038),h=t(20442),v=t(4066),b=t(20451),f=t(19591),j=t(42472),y=t(67121),A=t(9215),N=t(75695),g=t(87577),p=t(12293),k=t(99574);let w=e=>{var s=e.token,t=e.enableWithdraw,m=void 0!==t&&t,w=(0,d.F)(),C=w.address,_=w.chain,T=(0,f.vC)(m),P=T.currentRound,E=T.isPending,F=T.error,$=(0,f.n3)(null==s?void 0:s.address,C),B=$.slAmount,S=$.stAmount,L=$.promisedWaitingPhases,R=$.requestedUnstakeRound,W=$.govVotes,G=$.isPending,J=$.error,z=()=>!!(0,u.C)(_)&&(!!B&&!(B<=0n)||(i.oR.error("流动性质押数量为0，不用取消质押"),!1)),D=(0,A.Gp)(null==s?void 0:s.slTokenAddress,C,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",m),H=D.allowance,V=D.isPending,q=D.error,I=(0,A.Gp)(null==s?void 0:s.stTokenAddress,C,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",m),U=I.allowance,Z=I.isPending,K=I.error,M=(0,f.Fd)((null==s?void 0:s.address)||"",C||""),O=M.validGovVotes;M.isPending,M.error;var Q=(0,r._)((0,o.useState)(!1),2),X=Q[0],Y=Q[1],ee=(0,r._)((0,o.useState)(!1),2),es=ee[0],et=ee[1],en=(0,j.zH)(null==s?void 0:s.stTokenAddress),er=en.isPending,ea=en.isConfirming,el=en.isConfirmed,ec=en.error,ei=en.approve,ed=(0,y.zH)(null==s?void 0:s.slTokenAddress),eo=ed.isPending,em=ed.isConfirming,ex=ed.isConfirmed,eu=ed.error,eh=ed.approve,ev=function(){var e=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:if(!z())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(B&&B>0n&&!X))return[3,3];return[4,eh("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",B)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})});return function(){return e.apply(this,arguments)}}(),eb=function(){var e=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:if(!z())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(S&&S>0n&&!es))return[3,3];return[4,ei("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",S)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,o.useEffect)(()=>{ex||B&&B>0n&&H&&H>=B?Y(!0):Y(!1)},[B,H,V,ex]),(0,o.useEffect)(()=>{el||!S||S<=0n||U&&U>=S?et(!0):et(!1)},[S,U,Z,el]);var ef=(0,f.Zh)(),ej=ef.isWriting,ey=ef.isConfirming,eA=ef.isConfirmed,eN=ef.writeError,eg=ef.unstake,ep=function(){var e=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eg(null==s?void 0:s.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,o.useEffect)(()=>{eA&&(i.oR.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[eA]);var ek=(0,f.S1)(),ew=ek.isWriting,eC=ek.isConfirming,e_=ek.isConfirmed,eT=ek.writeError,eP=ek.withdraw,eE=function(){var e=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eP(null==s?void 0:s.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,o.useEffect)(()=>{e_&&(i.oR.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[e_]);var eF=(0,b.g)().handleContractError;if((0,o.useEffect)(()=>{J&&eF(J,"stake"),ec&&eF(ec,"stToken"),eu&&eF(eu,"slToken"),eN&&eF(eN,"stake"),eT&&eF(eT,"stake"),F&&eF(F,"stake"),q&&eF(q,"slToken"),K&&eF(K,"stToken")},[J,ec,eu,eN,eT,F,q,K]),!C)return(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!s||m&&E||G)return(0,l.jsx)(p.A,{});if(!G&&!B)return(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var e$=eo||em,eB=er||ea,eS=X&&es,eL=m&&R&&P>R+(L||BigInt(0));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pl-1",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,l.jsx)("div",{className:"stat-value text-xl",children:G?(0,l.jsx)(p.A,{}):(0,h.NJ)(W||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:R&&R>0n&&"注意：解锁期内治理票数为0"})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pl-1",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,l.jsxs)("div",{className:"stat-value text-lg",children:[G?(0,l.jsx)(p.A,{}):"".concat(L||0n," "),(0,l.jsx)("span",{className:"text-sm",children:" 阶段"})]}),(0,l.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,v.u$)(Number(L||0n),!0))})]})]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pb-3 pl-1",children:[(0,l.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,l.jsx)(g.A,{address:s.slTokenAddress,showAddress:!1}),(0,l.jsx)(N.A,{tokenAddress:s.slTokenAddress,tokenSymbol:"sl"+s.symbol,tokenDecimals:s.decimals})]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:G?(0,l.jsx)(p.A,{}):(0,h.NJ)(B||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(c.$,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,l.jsx)(x(),{href:"/gov/stakelp/?symbol=".concat(s.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pb-3  pl-3",children:[(0,l.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,l.jsx)(g.A,{address:s.stTokenAddress,showAddress:!1}),(0,l.jsx)(N.A,{tokenAddress:s.stTokenAddress,tokenSymbol:"st"+s.symbol,tokenDecimals:s.decimals})]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:G?(0,l.jsx)(p.A,{}):(0,h.NJ)(S||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(c.$,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,l.jsx)(x(),{href:"/gov/staketoken?symbol=".concat(s.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),(0,l.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:O<=0n&&W&&W>0n&&(0,l.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),m&&(0,l.jsxs)(l.Fragment,{children:[!R&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,l.jsx)(c.$,{className:"w-1/3",onClick:ev,disabled:e$||X,children:e$?"1.提交中...":em?"1.确认中...":X?"1.sl".concat(null==s?void 0:s.symbol," 已授权"):"1.授权 sl".concat(null==s?void 0:s.symbol)}),(0,l.jsx)(c.$,{className:"w-1/3",onClick:eb,disabled:!X||eB||es,children:eB?"2.提交中...":ea?"2.确认中...":es?"2.st".concat(null==s?void 0:s.symbol," 已授权"):"2.授权 st".concat(null==s?void 0:s.symbol)}),(0,l.jsx)(c.$,{className:"w-1/3",onClick:ep,disabled:!eS||ej||ey||eA,children:ej?"3.提交中":ey?"3.确认中":eA?"3.已取消质押":"3.取消质押"})]}),(0,l.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,l.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,l.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,h.LP)(P,s)+(L||0n)+1n," ")}),"轮才能取回代币）"]})]}),R&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,l.jsx)(c.$,{className:"w-1/2",onClick:eE,disabled:!eL||ew||eC||e_,children:eL?ew?"提交中":eC?"确认中":e_?"已取回":"取回质押代币":"已取消,第"+((0,h.LP)(R,s)+(L||0n)+1n)+"轮才可取回"})})})]}),!m&&(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,l.jsx)(c.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(x(),{href:"/my/govrewards?symbol=".concat(s.symbol),children:"查看奖励"})}),R&&(0,l.jsx)(c.$,{variant:"outline",className:"w-1/2 ".concat(eL?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eL,asChild:!0,children:(0,l.jsx)(x(),{href:"/gov/unstake/?symbol=".concat(s.symbol),children:eL?"取回质押代币":"已取消, 第"+((0,h.LP)(R,s)+(L||0n)+1n)+"轮可取回"})}),!R&&(0,l.jsx)(c.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(x(),{href:"/gov/?symbol=".concat(s.symbol),children:"社区治理"})})]}),(0,l.jsx)(k.A,{isLoading:e$||eB||ew||ej||eC||ey,text:eo||er||ew||ej?"提交交易...":"确认交易..."})]})}}}]);