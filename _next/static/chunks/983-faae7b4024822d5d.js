(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{78865:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},68655:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},40057:function(e,s,t){"use strict";var n=t(85893),l=t(27245),c=t(86501),i=t(92321),r=t(67294),a=t(41664),d=t.n(a),o=t(48105),x=t(91529),m=t(99958),h=t(67068),u=t(92180),y=t(77156),f=t(7224),v=t(19638),j=t(34426),b=t(27460),g=t(42083),k=t(44576);s.Z=e=>{let{token:s,enableWithdraw:t=!1}=e,{address:a,chain:N}=(0,i.m)(),{currentRound:C,isPending:p,error:w}=(0,u.Bk)(t),{slAmount:A,stAmount:Z,promisedWaitingPhases:B,requestedUnstakeRound:T,govVotes:$,isPending:z,error:E}=(0,u.L)(null==s?void 0:s.address,a),P=()=>!!(0,o.S)(N)&&(!!A&&!(A<=0n)||(c.Am.error("流动性质押数量为0，不用取消质押"),!1)),{allowance:S,isPending:D,error:I}=(0,v.yG)(null==s?void 0:s.slTokenAddress,a,"0x91618bc95d5069B2d7d5B42f6c1292D43ce5Ca3C",t),{allowance:L,isPending:F,error:M}=(0,v.yG)(null==s?void 0:s.stTokenAddress,a,"0x91618bc95d5069B2d7d5B42f6c1292D43ce5Ca3C",t),{validGovVotes:_,isPending:H,error:K}=(0,u.Ty)((null==s?void 0:s.address)||"",a||""),[W,G]=(0,r.useState)(!1),[q,Q]=(0,r.useState)(!1),{isPending:J,isConfirming:O,isConfirmed:R,error:U,approve:V}=(0,y.yA)(null==s?void 0:s.stTokenAddress),{isPending:X,isConfirming:Y,isConfirmed:ee,error:es,approve:et}=(0,f.yA)(null==s?void 0:s.slTokenAddress),en=async()=>{if(P())try{A&&A>0n&&!W&&await et("0x91618bc95d5069B2d7d5B42f6c1292D43ce5Ca3C",A)}catch(e){console.error(e)}},el=async()=>{if(P())try{Z&&Z>0n&&!q&&await V("0x91618bc95d5069B2d7d5B42f6c1292D43ce5Ca3C",Z)}catch(e){console.error(e)}};(0,r.useEffect)(()=>{ee?G(!0):A&&A>0n&&S&&S>=A?G(!0):G(!1)},[A,S,D,ee]),(0,r.useEffect)(()=>{R?Q(!0):!Z||Z<=0n?Q(!0):L&&L>=Z?Q(!0):Q(!1)},[Z,L,F,R]);let{isWriting:ec,isConfirming:ei,isConfirmed:er,writeError:ea,unstake:ed}=(0,u.vc)(),eo=async()=>{try{await ed(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,r.useEffect)(()=>{er&&(c.Am.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[er]);let{isWriting:ex,isConfirming:em,isConfirmed:eh,writeError:eu,withdraw:ey}=(0,u.Qc)(),ef=async()=>{try{await ey(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,r.useEffect)(()=>{eh&&(c.Am.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[eh]);let{handleContractError:ev}=(0,h.S)();if((0,r.useEffect)(()=>{E&&ev(E,"stake"),U&&ev(U,"stToken"),es&&ev(es,"slToken"),ea&&ev(ea,"stake"),eu&&ev(eu,"stake"),w&&ev(w,"stake"),I&&ev(I,"slToken"),M&&ev(M,"stToken")},[E,U,es,ea,eu,w,I,M]),!a)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!s||t&&p||z)return(0,n.jsx)(g.Z,{});if(!z&&!A)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});let ej=X||Y,eb=J||O,eg=W&&q,ek=t&&T&&C>T+(B||BigInt(0));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:z?(0,n.jsx)(g.Z,{}):(0,x.LH)($||0n,2)}),(0,n.jsx)("div",{className:"stat-desc text-xs my-2",children:"注意：解锁期内治理票数为0"})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:z?(0,n.jsx)(g.Z,{}):"".concat(B||0n," 阶段")}),(0,n.jsx)("div",{className:"stat-desc text-xs my-2",children:"".concat((0,m.Cn)(Number(B||0n),!0))})]})]}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押sl",s.symbol,(0,n.jsx)(b.Z,{address:s.slTokenAddress,showAddress:!1}),(0,n.jsx)(j.Z,{tokenAddress:s.slTokenAddress,tokenSymbol:"sl"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:z?(0,n.jsx)(g.Z,{}):(0,x.LH)(A||0n,2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/stakelp/?symbol=".concat(s.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["质押代币st",s.symbol,(0,n.jsx)(b.Z,{address:s.stTokenAddress,showAddress:!1}),(0,n.jsx)(j.Z,{tokenAddress:s.stTokenAddress,tokenSymbol:"st"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:z?(0,n.jsx)(g.Z,{}):(0,x.LH)(Z||0n,2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/staketoken?symbol=".concat(s.symbol),children:"质押 增加收益\xa0>>"})})})]})]}),(0,n.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:_<=0n&&$&&$>0n&&(0,n.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),t&&(0,n.jsxs)(n.Fragment,{children:[!T&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,n.jsx)(l.z,{className:"w-1/3",onClick:en,disabled:ej||W,children:ej?"1.提交中...":Y?"1.确认中...":W?"1.sl".concat(null==s?void 0:s.symbol," 已授权"):"1.授权 sl".concat(null==s?void 0:s.symbol)}),(0,n.jsx)(l.z,{className:"w-1/3",onClick:el,disabled:!W||eb||q,children:eb?"2.提交中...":O?"2.确认中...":q?"2.st".concat(null==s?void 0:s.symbol," 已授权"):"2.授权 st".concat(null==s?void 0:s.symbol)}),(0,n.jsx)(l.z,{className:"w-1/3",onClick:eo,disabled:!eg||ec||ei||er,children:ec?"3.提交中":ei?"3.确认中":er?"3.已取消质押":"3.取消质押"})]}),(0,n.jsxs)("div",{className:"text-center mt-2 text-sm text-greyscale-600",children:["取消质押后，投票轮第",(0,n.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,x.cK)(C,s)+(B||0n)+1n," ")}),"轮才能取回代币"]})]}),T&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,n.jsx)(l.z,{className:"w-1/2",onClick:ef,disabled:!ek||ex||em||eh,children:ek?ex?"提交中":em?"确认中":eh?"已取回":"取回质押代币":"已取消,第"+((0,x.cK)(T,s)+(B||0n)+1n)+"轮才可取回"})})})]}),!t&&(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,n.jsx)(l.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/my/govrewards?symbol=".concat(s.symbol),children:"查看奖励"})}),T&&(0,n.jsx)(l.z,{variant:"outline",className:"w-1/2 ".concat(ek?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!ek,asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/unstake/?symbol=".concat(s.symbol),children:ek?"取回质押代币":"已取消, 第"+((0,x.cK)(T,s)+(B||0n)+1n)+"轮可取回"})}),!T&&(0,n.jsx)(l.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/?symbol=".concat(s.symbol),children:"社区治理"})})]}),(0,n.jsx)(k.Z,{isLoading:ej||eb||ex||ec||em||ei,text:X||J||ex||ec?"提交交易...":"确认交易..."})]})}},9008:function(e,s,t){e.exports=t(23867)},21803:function(e,s,t){"use strict";function n(e,s){let[t,n="0"]=e.split("."),l=t.startsWith("-");if(l&&(t=t.slice(1)),n=n.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${n}`))&&(t=`${BigInt(t)+1n}`),n="";else if(n.length>s){let[e,l,c]=[n.slice(0,s-1),n.slice(s-1,s),n.slice(s)],i=Math.round(Number(`${l}.${c}`));(n=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>s&&(n=n.slice(1),t=`${BigInt(t)+1n}`),n=n.slice(0,s)}else n=n.padEnd(s,"0");return BigInt(`${l?"-":""}${t}${n}`)}t.d(s,{v:function(){return n}})}}]);