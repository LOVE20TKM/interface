"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1217],{22605:(e,s,t)=>{t.d(s,{A:()=>w});var n=t(16927),i=t(4902),r=t(37876),a=t(14232),l=t(8047),d=t(97685),c=t(6960),o=t(48230),x=t.n(o),m=t(89099),u=t(17660),h=t(52372),v=t(64115),j=t(20451),f=t(42038),b=t(83416),N=t(20442),y=t(12293),g=t(99574),p=t(43885);let w=e=>{var s=e.actionId,t=e.onRoundChange,o=e.actionInfo,w=e.onStakedAmountChange,A=e.showJoinButton,C=(0,l.F)(),k=C.address,E=C.chain,I=((0,a.useContext)(b.N)||{}).token,R=(0,m.useRouter)(),S=(0,u.vC)(),B=S.currentRound,F=S.error;(0,a.useEffect)(()=>{t&&"function"==typeof t&&t(B)},[B,t]);var P=(0,v.F6)((null==I?void 0:I.address)||"",B,s),_=P.isSubmitted,H=P.error,L=P.isPending,$=(0,u.vx)((null==I?void 0:I.address)||"",s,k||""),J=$.joinedAmountByActionIdByAccount,K=$.isPending,D=$.error,V=(0,u.p9)((null==I?void 0:I.address)||"",s),Y=V.joinedAmountByActionId,G=V.isPending,M=V.error,q=J&&J>0&&Y&&Y>0,z=q?Number(J)/Number(Y)*100:0,O=(0,N.Ee)(z),Q=q?(0,N.Ee)(Math.min(z*Number(null==o?void 0:o.body.maxRandomAccounts),100)):"0%",T=(0,h.IJ)((null==I?void 0:I.address)||"",s,k||""),U=T.verificationKeys,W=T.verificationInfos,X=T.isPending,Z=T.error,ee=(0,u.S1)(),es=ee.withdraw,et=ee.isPending,en=ee.isConfirming,ei=ee.isConfirmed,er=ee.writeError,ea=function(){var e=(0,n._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:if(!(0,f.C)(E))return[2];if(void 0!=J&&J<=2n)return d.oR.error("你还没有参与，无需取回"),[2];return[4,es((null==I?void 0:I.address)||"",s)];case 1:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}();(0,a.useEffect)(()=>{ei&&(d.oR.success("取回成功"),R.push("/my"))},[ei,R]),(0,a.useEffect)(()=>{K||null==w||w(J||BigInt(0))},[J,K]);var el=(0,j.g)().handleContractError;return((0,a.useEffect)(()=>{D&&el(D,"join"),M&&el(M,"join"),Z&&el(Z,"join"),F&&el(F,"join"),er&&el(er,"join"),H&&el(H,"submit")},[D,M,Z,F,er,H]),K||G||L)?"":(0,r.jsxs)("div",{className:"flex flex-col items-center px-4 pt-1",children:[q&&(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title",children:"我的参与"}),(0,r.jsx)("div",{className:"stat-value text-2xl text-secondary",children:G?(0,r.jsx)(y.A,{}):(0,N.NJ)(J||BigInt(0),0)}),(0,r.jsx)("div",{className:"stat-desc text-sm mt-2",children:"参与本行动的代币"})]}),(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title",children:"我的占比"}),(0,r.jsx)("div",{className:"stat-value text-2xl text-secondary",children:O}),(0,r.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["被抽中验证概率 ",Q]})]})]}),(void 0===A||A)&&(0,r.jsx)(r.Fragment,{children:q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-center space-x-4 mt-2 w-full",children:[void 0!=J&&J<=2n?(0,r.jsx)(c.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",disabled:!0,children:"取回"}):(0,r.jsx)(c.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",onClick:ea,disabled:et||en||ei,children:et?"提交中":en?"确认中":ei?"已取回":"取回代币"}),(0,r.jsx)(c.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(x(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==I?void 0:I.symbol),children:"增加参与代币"})})]}),(0,r.jsx)("div",{className:"flex flex-col items-center mt-2 mb-4",children:(0,r.jsxs)("div",{className:"text-sm text-greyscale-600",children:[X&&"加载中...",void 0!=J&&J>2n&&U&&U.length>0&&(0,r.jsx)("div",{children:U.map((e,s)=>(0,r.jsxs)("div",{children:[e,": ",(0,r.jsx)(p.H,{text:W[s]})]},s))})]})})]}):_&&(0,r.jsx)(c.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(x(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==I?void 0:I.symbol),children:"参与行动"})})}),(0,r.jsx)(g.A,{isLoading:et||en,text:et?"提交交易...":"确认交易..."})]})}},43885:(e,s,t)=>{t.d(s,{H:()=>a});var n=t(37876);t(14232);var i=t(54680),r=e=>{if(!e)return e;var s=/(https?:\/\/[^\s]+)/g;if(!s.test(e))return e;var t=e.split(s),r=e.match(s)||[];return(0,n.jsx)(n.Fragment,{children:t.map((e,s)=>{if(s%2==0)return e;var t=r[(s-1)/2];return(0,n.jsx)("a",{href:t,onClick:e=>{e.preventDefault(),i.a.handleExternalLink(t)},className:"text-blue-500 underline hover:text-blue-700",target:"_blank",children:t},s)})})},a=e=>{var s=e.text;return(0,n.jsx)(n.Fragment,{children:r(s)})}},92101:(e,s,t)=>{t.d(s,{A:()=>f});var n=t(37876),i=t(14232),r=t(6960),a=t(48230),l=t.n(a),d=t(64115),c=t(52372),o=t(20451),x=t(83416),m=t(20442),u=t(43885),h=t(87577),v=t(12293),j=t(1709);let f=e=>{var s,t=e.actionId,a=e.round,f=e.showSubmitter,b=e.showVerifyHistory,N=e.onActionInfo,y=((0,i.useContext)(x.N)||{}).token,g=(0,d.Y4)(null==y?void 0:y.address,t),p=g.actionInfo,w=g.isPending,A=g.error;(0,i.useEffect)(()=>{N&&p&&N(p)},[p]);var C=(0,c.VD)(null==y?void 0:y.address,f?a:0n),k=C.actionSubmits,E=C.isPending,I=C.error,R=(null==k||null==(s=k.find(e=>e.actionId==Number(t)))?void 0:s.submitter)||"N/A",S=(0,o.g)().handleContractError;return((0,i.useEffect)(()=>{A&&S(A,"submit"),I&&S(I,"submit")},[A,I]),w)?(0,n.jsx)(v.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mx-auto p-4 pb-2 border-t border-greyscale-100",children:(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)(j.A,{title:"行动详情"}),(void 0===b||b)&&(0,n.jsx)(r.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(l(),{href:"/my/actrewards/?id=".concat(t,"&symbol=").concat(null==y?void 0:y.symbol),children:"查看铸造激励 >>"})})]})}),(0,n.jsxs)("div",{className:"mx-auto p-4 pb-2 ",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==p?void 0:p.head.id.toString()]}),(0,n.jsx)("span",{className:"text-xl font-bold text-black",children:null==p?void 0:p.body.title})]}),(0,n.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,n.jsx)(h.A,{address:null==p?void 0:p.head.author})]}),f&&(0,n.jsxs)("div",{className:"flex items-center",children:["推举人"," ",E?(0,n.jsx)(v.A,{}):(0,n.jsx)(h.A,{address:R})]})]})]}),(0,n.jsx)("div",{className:"mx-auto p-4 pb-2",children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最小参与代币数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(0,m.NJ)((null==p?void 0:p.body.minStake)||BigInt(0))})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最大抽取验证地址数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==p?void 0:p.body.maxRandomAccounts.toString())||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,n.jsx)("p",{className:"text-greyscale-500 whitespace-pre-wrap",children:(0,n.jsx)(u.H,{text:null==p?void 0:p.body.verificationRule})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"报名参加行动时，行动者要提供的信息"}),(null==p?void 0:p.body.verificationKeys)&&(null==p?void 0:p.body.verificationKeys.length)>0?(0,n.jsx)("ul",{className:"list-disc pl-5",children:p.body.verificationKeys.map((e,s)=>(0,n.jsxs)("li",{className:"text-greyscale-500",children:[e," : ",p.body.verificationInfoGuides[s]]},s))}):(0,n.jsx)("span",{className:"text-greyscale-500",children:"无"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,n.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==p?void 0:p.body.whiteListAddress)&&"0x0000000000000000000000000000000000000000"!==p.body.whiteListAddress?(0,n.jsx)("span",{className:"flex items-center mr-2",children:(0,n.jsx)(h.A,{address:p.body.whiteListAddress})}):"无限制"})]})]})})]})}}}]);