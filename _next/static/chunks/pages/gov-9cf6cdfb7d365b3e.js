(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6700],{54889:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov",function(){return t(15976)}])},4270:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(31134).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},27460:function(e,s,t){"use strict";var l=t(85893),n=t(67294),a=t(74855),r=t(78865),i=t(18289),c=t(86501),d=t(91529);s.Z=e=>{let{address:s,word:t,showCopyButton:o=!0,showAddress:x=!0,colorClassName:m=""}=e,[u,j]=(0,n.useState)(!1);return(0,l.jsxs)("span",{className:"flex items-center space-x-2",children:[t&&(0,l.jsx)("span",{className:"text-xs",children:t}),x&&(0,l.jsx)("span",{className:"text-xs ".concat(null!=m?m:"text-greyscale-500"),children:(0,d.Vu)(s)}),o&&(0,l.jsx)(a.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?j(!0):c.ZP.error("复制失败")},children:(0,l.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:u?(0,l.jsx)(r.Z,{className:"h-4 w-4 ".concat(null!=m?m:"text-greyscale-500")}):(0,l.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=m?m:"text-greyscale-500")})})})]})}},96693:function(e,s,t){"use strict";t.d(s,{Z:function(){return d}});var l=t(85893),n=t(67294),a=t(42757),r=t(93778),i=e=>{let{initialTimeLeft:s,onTick:t}=e,[a,r]=(0,n.useState)(Date.now()+1e3*s),[i,c]=(0,n.useState)(s);(0,n.useEffect)(()=>{r(Date.now()+1e3*s)},[s]),(0,n.useEffect)(()=>{let e=setInterval(()=>{let s=Math.max(0,Math.floor((a-Date.now())/1e3));c(s),t&&t(s),s<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[a,t]);let d=Math.floor(i/86400),o=Math.floor(i%86400/3600);return(0,l.jsxs)("div",{className:"inline-flex gap-1 text-secondary",children:[d>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":d}})}),"天"]}),(o>0||d>0)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":o}})}),"时"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":Math.floor(i%3600/60)}})}),"分"]}),d<=0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":i%60}})}),"秒"]})]})},c=t(42083),d=e=>{let{currentRound:s,roundType:t}=e,{data:d}=(0,a.O)(),o=(0,n.useContext)(r.M),x=o?o.token:void 0,m=!d||!x||void 0===x.voteOriginBlocks||!x.initialStakeRound,[u,j]=(0,n.useState)(0n),h=Number("33784")||0,v=Number("255")||0,N=x?Number(x.voteOriginBlocks):0,f=h-(Number(d)-N)%h,p=f>0?Math.ceil(f*v/100):0,[y,b]=(0,n.useState)(p);(0,n.useEffect)(()=>{if(!d)return;let e=h-(Number(d)-N)%h;b(e>0?Math.ceil(e*v/100):0)},[d,h,v,N]),(0,n.useEffect)(()=>{x&&s>0n&&j(s-BigInt(x.initialStakeRound)+1n)},[s,x]);let g=null!=u?u.toString():"0";return m||null==u||u<0n?((null==u||u<0n)&&(console.log("currentTokenRound",u),console.log("currentRound",s),console.log("token.initialStakeRound",null==x?void 0:x.initialStakeRound),console.log("token",x)),(0,l.jsx)(c.Z,{})):(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsxs)("h1",{className:"text-lg font-bold",children:["第 ",(0,l.jsx)("span",{className:"text-secondary",children:g})," 轮","vote"===t?"投票":"verify"===t?"验证":"行动","阶段"]}),(0,l.jsxs)("span",{className:"text-sm mt-1 pt-0",children:[(0,l.jsx)("span",{className:"text-greyscale-400 mr-1",children:"剩余:"}),(0,l.jsx)("span",{className:"text-secondary mr-1",children:Math.ceil(100*y/v)}),(0,l.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),(0,l.jsx)(i,{initialTimeLeft:p,onTick:b})]})]})}},99958:function(e,s,t){"use strict";t.d(s,{Cn:function(){return a},IS:function(){return l},Tn:function(){return n}});let l=(e,s,t)=>{if(!e||!s)return"0%";let l=31536e5/Number("255"),n=BigInt("33784");if(0===l||0n===n)return console.error("配置错误: NEXT_PUBLIC_BLOCK_TIME 或 NEXT_PUBLIC_PHASE_BLOCKS 未设置"),"0%";let a=e?99n*e*99n/2000000n:BigInt(0),r=(2n*s||BigInt(0))+(t||BigInt(0));if(r===BigInt(0))return"0%";let i=Number(a)/Number(r)/(Number(n)/l)*100;return"".concat(i.toFixed(2).replace(/\.?0+$/,""),"%")},n=(e,s)=>{if(!e||!s||0n===s)return"0%";let t=31536e5/Number("255"),l=BigInt("33784");if(0===t||0n===l)return console.error("配置错误: BLOCK_TIME 或 PHASE_BLOCKS 未设置或为0"),"0%";let n=Number(e)/Number(s)/(Number(l)/t)*100;return"".concat(n.toFixed(2).replace(/\.?0+$/,""),"%")},a=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Number("33784")||0,l=Number("255")||0,n=e*t,a="".concat(n.toLocaleString(),"区块，约").concat(Math.ceil(Math.ceil(n*l/100)/86400),"天");return s||(a="".concat(e,"个阶段（").concat(a,")")),a}},15976:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return B}});var l=t(85893),n=t(67294),a=t(92321),r=t(27245),i=t(41664),c=t.n(i),d=t(93778),o=t(92180),x=t(37436),m=t(4062),u=t(74598),j=t(45551),h=t(42083),v=t(96693),N=t(99958),f=t(91529),p=t(67068),y=e=>{let{currentRound:s}=e,{token:t}=(0,n.useContext)(d.M)||{},{govData:a,isPending:i,error:o}=(0,j._H)(null==t?void 0:t.address),{handleContractError:x}=(0,p.S)();if((0,n.useEffect)(()=>{o&&x(o,"govData")},[o]),!t)return(0,l.jsx)(h.Z,{});let m=99n*((null==a?void 0:a.rewardAvailable)||BigInt(0))*99n/2000000n;return(0,l.jsxs)("div",{className:"px-4 mb-2",children:[(0,l.jsx)(v.Z,{currentRound:s,roundType:"vote"}),(0,l.jsxs)("div",{className:"border rounded-lg mt-3 p-0",children:[(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm pb-1",children:"总治理票数"}),(0,l.jsx)("div",{className:"stat-value text-secondary text-xl",children:i?(0,l.jsx)(h.Z,{}):(0,f.LH)((null==a?void 0:a.govVotes)||BigInt(0),2)})]}),(0,l.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm pb-1",children:"预计新增铸币"}),(0,l.jsx)("div",{className:"stat-value text-secondary text-xl",children:i?(0,l.jsx)(h.Z,{}):(0,f.LH)(m,2)})]})]}),(0,l.jsxs)("div",{className:"text-center text-xs mx-8 text-greyscale-500 border-b border-greyscale-200 pb-2",children:["预估年化收益率（APY）：",(0,N.IS)(null==a?void 0:a.rewardAvailable,null==a?void 0:a.tokenAmountForSl,null==a?void 0:a.stAmount)]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,l.jsxs)("div",{className:"stat place-items-center pb-0 pt-0",children:[(0,l.jsxs)("div",{className:"stat-title text-sm",children:["流动性质押sl",t.symbol]}),(0,l.jsx)("div",{className:"stat-value text-lg text-gray-600",children:i?(0,l.jsx)(h.Z,{}):(0,l.jsxs)(c(),{href:"/gov/liquid?symbol=".concat(null==t?void 0:t.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,l.jsx)("span",{className:"cursor-pointer",children:(0,f.LH)((null==a?void 0:a.slAmount)||BigInt(0),2)}),(0,l.jsx)(u.Z,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(r.z,{variant:"link",className:"text-secondary font-normal border-secondary pt-0",asChild:!0,children:(0,l.jsx)(c(),{href:"/gov/stakelp/?symbol=".concat(t.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,l.jsxs)("div",{className:"stat place-items-center pb-0 pt-0",children:[(0,l.jsxs)("div",{className:"stat-title text-sm",children:["质押代币st",t.symbol]}),(0,l.jsx)("div",{className:"stat-value text-lg text-gray-600",children:i?(0,l.jsx)(h.Z,{}):(0,f.LH)((null==a?void 0:a.stAmount)||BigInt(0),2)}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(r.z,{variant:"link",className:"text-secondary font-normal border-secondary pt-0",asChild:!0,children:(0,l.jsx)(c(),{href:"/gov/staketoken?symbol=".concat(t.symbol),children:"质押 增加收益\xa0>>"})})})]})]})]})]})},b=t(7080),g=t(64777),w=e=>{let{currentRound:s,validGovVotes:t,isPendingValidGovVotes:i}=e,{token:o}=(0,n.useContext)(d.M)||{},{address:x}=(0,a.m)(),{votesNumByAccount:m,isPending:u,error:j}=(0,b.VI)((null==o?void 0:o.address)||"",s,x||""),{handleContractError:v}=(0,p.S)();if((0,n.useEffect)(()=>{j&&v(j,"vote")},[j]),!o)return"";if(!x)return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,l.jsx)(g.Z,{title:"我的投票"}),(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})});let N=i||!1,y=t||0n;return(0,l.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)(g.Z,{title:"我的投票"}),(0,l.jsx)(r.z,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(c(),{href:"/vote/actions/?symbol=".concat(null==o?void 0:o.symbol),children:"投票中的行动"})})]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 mt-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我的已投票数"}),(0,l.jsx)("div",{className:"stat-value text-xl",children:u?(0,l.jsx)(h.Z,{}):(0,f.LH)(m||BigInt(0),2)})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我的剩余票数"}),(0,l.jsx)("div",{className:"stat-value text-xl",children:N||u?(0,l.jsx)(h.Z,{}):y?(0,f.LH)(y-m||BigInt(0),2):"0"})]})]}),(0,l.jsx)("div",{className:"flex justify-center",children:N||u?(0,l.jsx)(h.Z,{}):y>m+2n?(0,l.jsx)(r.z,{className:"w-1/2",asChild:!0,children:(0,l.jsx)(c(),{href:"/vote?symbol=".concat(o.symbol),children:"去投票"})}):(0,l.jsx)(r.z,{disabled:!0,className:"w-1/2",children:y>0?"已投票":"无治理票，不能投票"})})]})},Z=t(87250),k=e=>{let{currentRound:s,showBtn:t=!0}=e,{token:i}=(0,n.useContext)(d.M)||{},{address:o}=(0,a.m)(),{votesNumByAccount:x,isPending:m,error:u}=(0,b.VI)(null==i?void 0:i.address,s,o||""),{scoreByVerifier:j,isPending:v,error:N}=(0,Z.w3)(null==i?void 0:i.address,s,o||""),y=m||v?BigInt(0):x-j,{handleContractError:w}=(0,p.S)();return((0,n.useEffect)(()=>{u&&w(u,"vote"),N&&w(N,"verify")},[u,N]),i)?o?(0,l.jsxs)("div",{className:"flex-col items-center px-4 pt-3 pb-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)(g.Z,{title:"我的验证票"}),t&&(0,l.jsx)(r.z,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(c(),{href:"/verify/actions/?symbol=".concat(null==i?void 0:i.symbol),children:"验证中的行动"})})]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"已验证票数"}),(0,l.jsx)("div",{className:"stat-value text-xl ".concat(t?"":"text-secondary"),children:v?(0,l.jsx)(h.Z,{}):(0,f.LH)(j||BigInt(0),2)})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"未验证票数"}),(0,l.jsx)("div",{className:"stat-value text-xl ".concat(t?"":"text-secondary"),children:m||v?(0,l.jsx)(h.Z,{}):(0,f.LH)(y,2)})]})]}),t&&(0,l.jsx)("div",{className:"flex justify-center",children:m||v?(0,l.jsx)(h.Z,{}):y>5n&&x>j?(0,l.jsx)(r.z,{className:"w-1/2",asChild:!0,children:(0,l.jsx)(c(),{href:"/verify?symbol=".concat(i.symbol),children:"去验证"})}):(0,l.jsx)(r.z,{disabled:!0,className:"w-1/2",children:j>0?"已验证":"未投票，无需验证"})})]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex-col items-center px-4 pt-6 pb-2",children:[(0,l.jsx)(g.Z,{title:"行动验证"}),(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):(0,l.jsx)(h.Z,{})},C=t(4270),I=e=>{let{token:s}=e;return(0,l.jsxs)("div",{className:"mt-2 p-4",children:[(0,l.jsx)(g.Z,{title:"部署子币"}),(0,l.jsx)("div",{className:"w-full text-center",children:(0,l.jsx)(r.z,{variant:"outline",size:"sm",className:"mt-2 w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsxs)(c(),{href:"/launch/deploy?symbol=".concat(null==s?void 0:s.symbol),children:[(0,l.jsx)(C.Z,{className:"w-4 h-4"}),"去部署"]})})}),(0,l.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,l.jsx)("p",{className:"mb-1",children:"说明："}),(0,l.jsxs)("p",{children:["1. 部署者：须持有 ",null==s?void 0:s.symbol,"不少于 0.5%的治理票"]}),(0,l.jsxs)("p",{children:["2. 子币发射目标：须筹集 20,000,000个 ",null==s?void 0:s.symbol]})]})]})},B=()=>{let{token:e}=(0,n.useContext)(d.M)||{},{address:s}=(0,a.m)(),{currentRound:t,error:i,isPending:u}=(0,o.Bk)(),{validGovVotes:j,isPending:v,error:N}=(0,o.Ty)((null==e?void 0:e.address)||"",s||""),{handleContractError:f}=(0,p.S)();n.useEffect(()=>{N&&f(N,"stake"),i&&f(i,"vote")},[N,i]);let b=j>0n;return u||v?(0,l.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,l.jsx)(h.Z,{})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.Z,{title:"治理首页"}),(0,l.jsx)("main",{className:"flex-grow",children:e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.Z,{}),(0,l.jsx)(y,{currentRound:t||0n}),v?(0,l.jsx)("div",{className:"flex justify-center p-4",children:(0,l.jsx)(h.Z,{})}):b?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{currentRound:t||0n,validGovVotes:j,isPendingValidGovVotes:v}),(0,l.jsx)(k,{currentRound:t>2?t-2n:0n}),(0,l.jsx)(I,{token:e})]}):(0,l.jsxs)("div",{className:"flex flex-col items-center p-4 mt-4",children:[(0,l.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"您当前没有治理票，获取治理票后才能治理"}),(0,l.jsx)(r.z,{className:"w-1/2",asChild:!0,children:(0,l.jsx)(c(),{href:"/gov/stakelp/?symbol=".concat(null==e?void 0:e.symbol),children:"质押获取治理票"})})]})]}):(0,l.jsx)(h.Z,{})})]})}}},function(e){e.O(0,[1664,2209,1335,6242,7863,7380,4323,3317,4062,2888,9774,179],function(){return e(e.s=54889)}),_N_E=e.O()}]);