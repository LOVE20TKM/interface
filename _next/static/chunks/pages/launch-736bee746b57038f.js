(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6185],{8917:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return s(67574)}])},20442:(e,t,s)=>{"use strict";s.d(t,{$w:()=>l,Ee:()=>f,Js:()=>o,LP:()=>u,NJ:()=>c,W_:()=>a,XS:()=>i,Xo:()=>m,lM:()=>x,mW:()=>d});var n=s(18449),r=s(32602),a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=e=>{var t=Number(o(e));return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,s=Number(o(e));if(e<10n)return"0";if(4!==t)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(s);if(s>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(s);if(s>=10)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(s);if(s>=1||s>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(s);if(0===s)return"0";var n=s.toFixed(14),r=n.split(".");if(r.length<2)return n;var a=r[1],l=0,c=!0,i=!1,d=void 0;try{for(var m,u=a[Symbol.iterator]();!(c=(m=u.next()).done);c=!0){var x=m.value;if("0"===x)l++;else break}}catch(e){i=!0,d=e}finally{try{c||null==u.return||u.return()}finally{if(i)throw d}}var h=a.slice(l,l+4);return"0.0{".concat(l,"}").concat(h)},i=e=>{var t=parseInt("18",10);try{var s=e.replace(/,/g,"");return(0,n.X)(s,t)}catch(e){return console.error("parseUnits error:",e),0n}},o=e=>{var t=parseInt("18",10);return(0,r.J)(e,t)},d=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,m=e=>e>86400?"".concat(Math.floor(e/86400),"天").concat(Math.floor(e%86400/3600),"小时").concat(Math.floor(e%3600/60),"分"):e>3600?"".concat(Math.floor(e/3600),"小时").concat(Math.floor(e%3600/60),"分"):"".concat(Math.floor(e/60),"分").concat(e%60,"秒"),u=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=Number(e);if(n>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(n);if(n>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:s+1}).format(n);if(0===n)return"0";var r=n.toFixed(s+10),a=r.split(".");if(a.length<2)return r;var l=a[1],c=0,i=!0,o=!1,d=void 0;try{for(var m,u=l[Symbol.iterator]();!(i=(m=u.next()).done);i=!0){var x=m.value;if("0"===x)c++;else break}}catch(e){o=!0,d=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw d}}var h=l.slice(c);return"0.0{".concat(c,"}").concat(h)},h=(e,t)=>e.toFixed(t).replace(/\.?0+$/,""),f=e=>{var t="string"==typeof e?parseFloat(e):e,s=Math.abs(t);return 0===s?"0%":s>=100?t.toLocaleString(void 0,{maximumFractionDigits:0})+"%":s>=10?h(t,1)+"%":s>=1?h(t,2)+"%":s>=.1?h(t,3)+"%":s>=.01?h(t,4)+"%":t.toExponential(4)+"%"}},67574:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var n=s(3576),r=s(62701),a=s(37876),l=s(14232),c=s(83416),i=s(40752),o=s(20451),d=s(66663),m=s(12293),u=s(63934),x=s(57607),h=s(20442),f=s(1709);let v=e=>{var t=e.token,s=e.launchInfo,n=Number(s.totalContributed)/Number(s.parentTokenFundraisingGoal),r=(100*n).toFixed(1),l=(0,u.y)().data;if(!s)return(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!t)return(0,a.jsx)(m.A,{});var c="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex-col items-center mb-2 mt-4 px-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.A,{title:"公平发射"}),s.hasEnded&&(0,a.jsx)("span",{className:"stat-title text-base text-red-500",children:"（已结束）"})]}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"申购累计筹集到"}),(0,a.jsxs)("div",{className:"stat-value",children:[(0,a.jsx)("span",{className:"text-3xl text-secondary",children:(0,h.NJ)(s.totalContributed)}),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:c})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsx)("span",{children:c}),"筹集目标"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:(0,h.NJ)(s.parentTokenFundraisingGoal)})]}),(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsxs)("span",{children:[t.symbol," "]}),"发射总量"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,h.NJ)(BigInt(x.F.fairLaunch)))})]})]}),(0,a.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",c," ="," ",(0,h.lM)((0,h.mW)((Number(x.F.fairLaunch)/Number(s.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",t.symbol]}),(0,a.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,a.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!s.hasEnded&&"（当前 ".concat(r,"%）")]}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!s.hasEnded&&n>=.5&&(()=>{var e=Number(s.secondHalfStartBlock)+Number(s.secondHalfMinBlocks),t=Number(l||0),r=e-t;return r<=0?n>=1?"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（当前区块：第").concat(t,"区块，还需等待").concat(r,"个区块）")})(),!s.hasEnded&&n<.5&&"，至少".concat(s.secondHalfMinBlocks.toString(),"个区块"),s.hasEnded&&"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,a.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,a.jsxs)("p",{children:["1. 代币总量：",(0,h.NJ)(BigInt(x.F.totalSupply))]}),(0,a.jsxs)("p",{children:["2. 发射数量：",(0,h.NJ)(BigInt(x.F.fairLaunch))," (10%)"]}),(0,a.jsxs)("p",{children:["3. 治理激励：",(0,h.NJ)(BigInt(x.F.govRewards))," (45%)"]}),(0,a.jsxs)("p",{children:["4. 行动激励：",(0,h.NJ)(BigInt(x.F.actionRewards))," (45%)"]}),(0,a.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,a.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,a.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})})};var N=s(16927),g=s(4902),j=s(6960),p=s(8047),b=s(89099),y=s(48230),w=s.n(y),k=s(97685),S=s(99574);let F=e=>{var t=e.token;e.launchInfo;var s=(0,p.F)(),n=s.address,r=s.isConnected,c=(0,u.y)().data,d=(0,b.useRouter)(),x=(0,i.$r)(null==t?void 0:t.address,r?n:"0x0000000000000000000000000000000000000000"),v=x.contributed,y=x.isPending,F=x.error,C=x.refetch,A=(0,i.MU)(null==t?void 0:t.address,r?n:"0x0000000000000000000000000000000000000000"),E=A.lastContributedBlock,T=A.isPending,_=A.error,I=BigInt("40")-((c?BigInt(c):0n)-(E||0n)),M=(0,i.S1)(),B=M.withdraw,J=M.isPending,D=M.writeError,H=M.isConfirming,L=M.isConfirmed,P=function(){var e=(0,N._)(function(){return(0,g.__generator)(this,function(e){switch(e.label){case 0:if(I>0n)return k.Ay.error("还需要等待 ".concat(I," 个区块才能撤回")),[2];return[4,B(null==t?void 0:t.address)];case 1:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}();(0,l.useEffect)(()=>{L&&(k.Ay.success("撤回成功"),C(),setTimeout(()=>{d.push("/dex/swap/?symbol=".concat(null==t?void 0:t.symbol,"&from=").concat(null==t?void 0:t.parentTokenSymbol))},1e3))},[L]);var U=(0,o.g)().handleContractError;if((0,l.useEffect)(()=>{F&&U(F,"launch"),_&&U(_,"launch"),D&&U(D,"launch")},[F,_,D]),!t||y||T)return(0,a.jsx)(m.A,{});var $="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-6",children:[(0,a.jsx)(f.A,{title:"参与申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,a.jsxs)("div",{className:"stat-value text-secondary",children:[(0,h.NJ)(v||0n),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:$})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[v&&v>0n&&(0,a.jsx)(j.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",onClick:P,disabled:J||H||L,children:J?"提交中...":H?"确认中...":L?"已撤回":"撤回申购"}),(0,a.jsx)(j.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/contribute?symbol=".concat(null==t?void 0:t.symbol),children:v&&v>0n?"增加申购":"去申购"})})]}),v&&v>0n&&(0,a.jsxs)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:["申购后需等 ","40"," 个区块才能撤回（当前还需等"," ",I>0?I.toString():"0"," 个区块）"]}),(0,a.jsx)("div",{className:"border-t border-gray-200 mt-4 mb-6"}),(0,a.jsx)(S.A,{isLoading:J||H,text:J?"提交交易...":"确认交易..."})]})},C=e=>{var t=e.token,s=e.launchInfo,n=(0,p.F)().address,r=((0,l.useContext)(c.N)||{}).clearToken,d=(0,i.$r)(null==t?void 0:t.address,n),u=d.contributed,v=(d.isPending,d.error),b=(0,i.nD)(null==t?void 0:t.address,n),y=b.claimed,F=b.isPending,C=b.error,A=(0,i.f5)(null==t?void 0:t.address,n),E=A.extraRefunded,T=(A.isPending,A.error),_=s.totalContributed?BigInt(x.F.fairLaunch)*(u||0n)/BigInt(s.totalContributed):0n,I=(0,i.G0)(),M=I.claim,B=I.isWriting,J=I.writeError,D=I.isConfirming,H=I.isConfirmed,L=function(){var e=(0,N._)(function(){return(0,g.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,M(null==t?void 0:t.address)];case 1:return e.sent(),[3,3];case 2:return console.error("领取失败:",e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,l.useEffect)(()=>{H?(k.Ay.success("领取成功"),null==r||r(),setTimeout(()=>{window.location.reload()},1e3)):J&&k.Ay.error("领取失败")},[H,J]);var P=(0,o.g)().handleContractError;if((0,l.useEffect)(()=>{J&&P(J,"launch"),C&&P(C,"launch"),T&&P(T,"launch"),v&&P(v,"launch")},[J,C,T,v]),!n)return"";if(F||!t)return(0,a.jsx)(m.A,{});var U="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-4 mt-2",children:[(0,a.jsx)(f.A,{title:"我的申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,a.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,h.NJ)(_),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:t.symbol})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(u)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.$,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,a.jsx)(j.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]}),Number(u)>0&&!y&&(0,a.jsx)(j.$,{className:"w-1/2",onClick:L,disabled:B||D||H,children:B?"领取中...":D?"确认中...":H?"已领取":"领取"}),Number(u)>0&&y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.$,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,a.jsx)(j.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]})]}),Number(u)>0&&y&&(0,a.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,a.jsxs)("span",{className:"text-secondary",children:[(0,h.NJ)(null!=u?u:0n)," "]}),U,"，申购返还了"," ",(0,a.jsx)("span",{className:"text-secondary",children:(0,h.NJ)(null!=E?E:0n)})," ",U]}),(0,a.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-4 mb-6"}),(0,a.jsx)(S.A,{isLoading:B||D,text:B?"提交交易...":"确认交易..."})]})};var A=s(19593);function E(){var e=(0,l.useContext)(c.N)||{token:null,setToken:null},t=e.token,s=e.setToken,u=(0,i.TU)(t?t.address:"0x0000000000000000000000000000000000000000"),x=u.launchInfo,h=u.isPending,f=u.error,N=(0,o.g)().handleContractError;return((0,l.useEffect)(()=>{f&&N(f,"launch")},[f]),(0,l.useEffect)(()=>{x&&t&&x.hasEnded&&!t.hasEnded&&s((0,r._)((0,n._)({},t),{hasEnded:!0}))},[x,t]),h||x)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{title:"公平发射"}),(0,a.jsxs)("main",{className:"flex-grow",children:[(0,a.jsx)(A.A,{}),h||!x?(0,a.jsx)(m.A,{}):(0,a.jsxs)(a.Fragment,{children:[t&&(x.hasEnded?(0,a.jsx)(C,{token:t,launchInfo:x}):(0,a.jsx)(F,{token:t,launchInfo:x})),(0,a.jsx)(v,{token:t,launchInfo:x})]})]})]}):(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}},75695:(e,t,s)=>{"use strict";s.d(t,{A:()=>x});var n=s(16927),r=s(40854),a=s(4902),l=s(37876),c=s(14232),i=s(7446),o=s(95167),d=s(8047),m=s(44571),u=s(97685);function x(e){var t,s=e.tokenAddress,x=e.tokenSymbol,h=e.tokenDecimals,f=e.tokenImage,v=(0,r._)((0,c.useState)(!1),2),N=v[0],g=v[1],j=(0,d.F)().isConnected,p=(0,m.G)().data,b=(t=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:if(!j)return alert("请先连接你的钱包"),[2];g(!0),e.label=1;case 1:if(e.trys.push([1,3,4,5]),!p)return alert("无法获取钱包客户端"),[2];return[4,p.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:x,decimals:h,image:f}}})];case 2:return e.sent()?u.Ay.success("代币已成功添加到 MetaMask 钱包"):u.Ay.error("用户拒绝添加代币"),[3,5];case 3:return console.error("添加代币失败:",e.sent()),u.Ay.error("添加代币失败，请检查控制台以获取更多信息"),[3,5];case 4:return g(!1),[7];case 5:return[2]}})}),function(){return t.apply(this,arguments)});return(0,l.jsx)("button",{onClick:b,disabled:N,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:N?(0,l.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-greyscale-500"})})}},87577:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var n=s(40854),r=s(37876),a=s(14232),l=s(48447),c=s(33276),i=s(70801),o=s(97685),d=s(20442);let m=e=>{var t=e.address,s=e.word,m=e.showCopyButton,u=e.showAddress,x=void 0===u||u,h=e.colorClassName,f=void 0===h?"":h,v=e.colorClassName2,N=void 0===v?"":v,g=(0,n._)((0,a.useState)(!1),2),j=g[0],p=g[1];return(0,r.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[s&&(0,r.jsx)("span",{className:"text-xs",children:s}),x&&!N&&(0,r.jsx)("span",{className:"text-xs ".concat(null!=f?f:"text-greyscale-500"),children:(0,d.W_)(t)}),x&&N&&(0,r.jsxs)("span",{className:"text-[0px]",children:[(0,r.jsx)("span",{className:"text-xs ".concat(null!=f?f:"text-greyscale-500"),children:"".concat(t.substring(0,6),"...")}),(0,r.jsx)("span",{className:"text-xs ".concat(N),children:"".concat(t.substring(t.length-4))})]}),(void 0===m||m)&&(0,r.jsx)(l.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?p(!0):o.Ay.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:j?(0,r.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=f?f:"text-greyscale-500")}):(0,r.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=f?f:"text-greyscale-500")})})})]})}},99574:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(37876);s(14232);var r=s(7446);let a=e=>{var t=e.isLoading,s=e.text;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(r.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===s?"Loading":s})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[8230,4571,4112,4267,2569,5139,3356,9593,636,6593,8792],()=>t(8917)),_N_E=e.O()}]);