try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="258d6229-4902-4e1b-a7bd-e0953de8e725",e._sentryDebugIdIdentifier="sentry-dbid-258d6229-4902-4e1b-a7bd-e0953de8e725")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{72124:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/submit/actions",function(){return t(30628)}])},34680:function(e,n,t){"use strict";t.d(n,{Ol:function(){return u},SZ:function(){return l},Zb:function(){return c},aY:function(){return f},eW:function(){return m},ll:function(){return d}});var s=t(72253),r=t(47702),a=t(85893),i=t(67294),o=t(40108),c=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t)},i))});c.displayName="Card";var u=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t)},i))});u.displayName="CardHeader";var d=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t)},i))});d.displayName="CardTitle";var l=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("text-sm text-muted-foreground",t)},i))});l.displayName="CardDescription";var f=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("p-6 pt-0",t)},i))});f.displayName="CardContent";var m=i.forwardRef(function(e,n){var t=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,s._)({ref:n,className:(0,o.cn)("flex items-center p-6 pt-0",t)},i))});m.displayName="CardFooter"},24920:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var s=(0,t(31134).Z)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])},27460:function(e,n,t){"use strict";var s=t(91309),r=t(85893),a=t(67294),i=t(74855),o=t(78865),c=t(18289),u=t(86501),d=t(91529);n.Z=function(e){var n=e.address,t=e.word,l=e.showCopyButton,f=e.showCopyLast4Button,m=e.showAddress,x=void 0===m||m,h=e.colorClassName,b=void 0===h?"":h,g=e.colorClassName2,p=void 0===g?"":g,N=(0,s._)((0,a.useState)(!1),2),y=N[0],v=N[1],j=(0,s._)((0,a.useState)(!1),2),w=j[0],C=j[1];(0,a.useEffect)(function(){v(!1),C(!1)},[n]);var _=function(e){e.preventDefault(),e.stopPropagation()};return(0,r.jsxs)("span",{className:"inline-flex items-center space-x-1",children:[t&&(0,r.jsx)("span",{className:"text-xs",children:t}),x&&!p&&(0,r.jsx)("span",{className:"font-mono text-xs ".concat(null!=b?b:"text-greyscale-500"),children:(0,d.Vu)(n)}),x&&p&&(0,r.jsxs)("span",{className:"text-[0px]",children:[(0,r.jsx)("span",{className:"font-mono text-xs ".concat(null!=b?b:"text-greyscale-500"),children:"".concat(n.substring(0,4),"...")}),(0,r.jsx)("span",{className:"font-mono text-xs ".concat(p),children:"".concat(n.substring(n.length-6))})]}),(void 0===l||l)&&(0,r.jsx)(i.CopyToClipboard,{text:n,onCopy:function(e,n){n?(v(!0),setTimeout(function(){return v(!1)},2e3)):u.ZP.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:_,"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:y?(0,r.jsx)(o.Z,{className:"h-4 w-4 ".concat(null!=b?b:"text-greyscale-500")}):(0,r.jsx)(c.Z,{className:"h-4 w-4 ".concat(null!=b?b:"text-greyscale-500")})})}),void 0!==f&&f&&(0,r.jsx)(i.CopyToClipboard,{text:n.substring(n.length-4),onCopy:function(e,n){n?(C(!0),u.ZP.success("已复制后4位"),setTimeout(function(){return C(!1)},2e3)):u.ZP.error("复制失败")},children:(0,r.jsx)("button",{className:"text-xs px-2 py-1 rounded border border-gray-300 focus:outline-none active:bg-gray-200 md:hover:bg-gray-100 transition-colors",onClick:_,"aria-label":"复制地址后4位",style:{WebkitTapHighlightColor:"transparent"},children:w?(0,r.jsx)("span",{className:"".concat(null!=b?b:"text-greyscale-500"),children:"已复制"}):(0,r.jsx)("span",{className:"".concat(null!=b?b:"text-greyscale-500"),children:"后4位"})})})]})}},93566:function(e,n,t){"use strict";t.d(n,{$A:function(){return h},Bk:function(){return x},Xo:function(){return p},dI:function(){return f},qd:function(){return g},r7:function(){return m},sK:function(){return b}});var s=t(11010),r=t(97582),a=t(67294),i=t(71104),o=t(7724),c=t(37742),u=t(84689),d=t(37474),l="0xeBB295af1D4ee9ed92e55EFF4ca5Eb8D4AB81aCE",f=function(e,n){var t=(0,i.u)({address:l,abi:o.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},m=function(e){var n=(0,i.u)({address:l,abi:o.d,functionName:"actionsCount",args:[e]}),t=n.data,s=n.isPending,r=n.error;return{actionNum:t?(0,c.Z)(t):void 0,isPending:s,error:r}},x=function(){var e=(0,i.u)({address:l,abi:o.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,s=e.error;return{currentRound:(0,c.Z)(n),isPending:t,error:s}},h=function(e,n,t){var s=(0,i.u)({address:l,abi:o.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:s.data,isPending:s.isPending,error:s.error}},b=function(e,n,t){var s=(0,i.u)({address:l,abi:o.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:s.data,isPending:s.isPending,error:s.error}};function g(){var e,n=(0,d.e9)(o.d,l,"submit"),t=n.execute,i=n.isPending,c=n.isConfirming,f=n.isConfirmed,m=n.error,x=n.hash,h=n.isTukeMode,b=(e=(0,s._)(function(e,n){return(0,r.Jh)(this,function(s){switch(s.label){case 0:return console.log("提交submit交易:",{tokenAddress:e,actionId:n,isTukeMode:h}),[4,t([e,n])];case 1:return[2,s.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,a.useEffect)(function(){x&&console.log("submit tx hash:",x),m&&(console.log("提交submit交易错误:"),(0,u.Vh)(m),(0,u.H)(m)),f&&console.log("submit tx confirmed")},[x,m,f]),{submit:b,isPending:i,isConfirming:c,writeError:m,isConfirmed:f,hash:x,isTukeMode:h}}function p(){var e,n=(0,d.e9)(o.d,l,"submitNewAction"),t=n.execute,i=n.isPending,c=n.isConfirming,f=n.isConfirmed,m=n.error,x=n.hash,h=n.isTukeMode,b=(e=(0,s._)(function(e,n){return(0,r.Jh)(this,function(s){switch(s.label){case 0:return console.log("提交submitNewAction交易:",{tokenAddress:e,actionBody:n,isTukeMode:h}),[4,t([e,n])];case 1:return[2,s.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,a.useEffect)(function(){x&&console.log("submitNewAction tx hash:",x),m&&(console.log("提交submitNewAction交易错误:"),(0,u.Vh)(m),(0,u.H)(m)),f&&console.log("submitNewAction tx confirmed")},[x,m,f]),{submitNewAction:b,isPending:i,isConfirming:c,writeError:m,isConfirmed:f,hash:x,isTukeMode:h}}},30628:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return j}});var s=t(85893),r=t(67294),a=t(11163),i=t(93778),o=t(93566),c=t(73591),u=t(83494),d=t(91309),l=t(4586),f=t(27245),m=t(34680),x=t(41664),h=t.n(x),b=t(90278),g=t(42083),p=t(64777),N=t(27460),y=t(24920),v=function(e){var n,t=e.currentRound,a=((0,r.useContext)(i.M)||{}).token,u=(0,o.r7)((null==a?void 0:a.address)||""),x=u.actionNum,v=u.isPending,j=u.error,w=(0,d._)((0,r.useState)([]),2),C=w[0],_=w[1],k=(0,d._)((0,r.useState)(0),2),P=k[0],E=k[1],I=(0,d._)((0,r.useState)(!0),2),Z=I[0],B=I[1],T=(0,d._)((0,r.useState)(!1),2),S=T[0],R=T[1],A=(0,r.useRef)(null),M=(0,r.useCallback)(function(e){if(!x)return{start:BigInt(0),end:BigInt(0)};var n=Number(x)-40*e;return{start:BigInt(Math.max(0,n-40)),end:BigInt(n)}},[x])(P),D=(0,b.s4)((null==a?void 0:a.address)||"",M.start,M.end),H=D.actionInfos,O=D.isPending,W=D.error,z=(0,b.WZ)((null==a?void 0:a.address)||"",t),F=z.actionSubmits,q=z.isPending,V=z.error;(0,r.useEffect)(function(){H&&H.length>0&&(_(function(e){var n=new Set(e.map(function(e){return e.head.id})),t=H.filter(function(e){return!n.has(e.head.id)});return(0,l._)(e).concat((0,l._)(t))}),0===P&&R(!0),M.start===BigInt(0)&&B(!1))},[H,P,M.start]),(0,r.useEffect)(function(){if(S){var e=new IntersectionObserver(function(e){e[0].isIntersecting&&Z&&!O&&E(function(e){return e+1})},{threshold:.1}),n=A.current;return n&&e.observe(n),function(){n&&e.unobserve(n)}}},[Z,O,S,P]);var X=(0,c.S)().handleContractError;if((0,r.useEffect)(function(){j&&X(j,"submit"),W&&X(W,"submit"),V&&X(V,"submit")},[j,W,V]),!a||v||0===P&&O||q)return(0,s.jsx)(g.Z,{});var J=(null==C?void 0:null===(n=C.filter(function(e){return!(null==F?void 0:F.some(function(n){return n.actionId===e.head.id}))}))||void 0===n?void 0:n.sort(function(e,n){return Number(n.head.id-e.head.id)}))||[];return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(p.Z,{title:"未推举的行动"}),(0,s.jsx)(h(),{href:"/extension/factories/",children:(0,s.jsx)(f.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",children:"发起新行动"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[0===C.length&&!O&&(0,s.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"暂无行动"}),J.map(function(e){return(0,s.jsx)(m.Zb,{className:"shadow-none",children:(0,s.jsxs)(h(),{href:"/submit/submit?id=".concat(e.head.id,"&symbol=").concat(a.symbol,"&submitted=false"),children:[(0,s.jsxs)(m.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,s.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,s.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.head.id)}),(0,s.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.title)})]}),(0,s.jsx)(m.aY,{className:"px-3 pt-1 pb-2",children:(0,s.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(y.Z,{className:"text-greyscale-400 mr-1 h-3 w-3 -translate-y-0.5"}),(0,s.jsx)("span",{className:"text-greyscale-400",children:(0,s.jsx)(N.Z,{address:e.head.author,showCopyButton:!1,colorClassName2:"text-secondary"})})]}),(0,s.jsx)("span",{className:"text-sm text-greyscale-600",children:"未推举"})]})})]})},e.head.id)}),Z&&(0,s.jsx)("div",{ref:A,className:"flex justify-center py-4",children:O&&(0,s.jsx)(g.Z,{})}),!Z&&C.length>0&&(0,s.jsx)("div",{className:"text-sm text-greyscale-400 text-center py-4",children:"已加载全部行动"})]})]})},j=function(){var e=(0,o.Bk)(),n=e.currentRound,t=e.isPending,d=e.error,l=(0,c.S)().handleContractError;(0,r.useEffect)(function(){d&&l(d,"submit")},[d]);var f=(0,a.useRouter)(),m=((0,r.useContext)(i.M)||{}).token;return(0,r.useEffect)(function(){m&&!m.hasEnded?f.push("/launch?symbol=".concat(m.symbol)):m&&!m.initialStakeRound&&f.push("/stake/stakelp/?symbol=".concat(m.symbol,"&first=true"))},[m]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{title:"推举",showBackButton:!0}),(0,s.jsx)("main",{className:"flex-grow",children:t?(0,s.jsx)(g.Z,{}):(0,s.jsx)(v,{currentRound:n})})]})}}},function(e){e.O(0,[8501,4463,3494,3591,9419,2888,9774,179],function(){return e(e.s=72124)}),_N_E=e.O()}]);