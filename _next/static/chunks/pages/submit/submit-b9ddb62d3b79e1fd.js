try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="3346a7f4-7f52-4b78-9e7d-01f00c45608f",e._sentryDebugIdIdentifier="sentry-dbid-3346a7f4-7f52-4b78-9e7d-01f00c45608f")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3015],{32223:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/submit/submit",function(){return n(20665)}])},20725:function(e,s,n){"use strict";var t=n(85893),i=n(67294),d=n(93566),o=n(73591),r=n(93778),a=n(91529),l=n(72107),c=n(31084),u=n(44746),x=n(27460),m=n(42083),f=n(5971);s.Z=function(e){var s=e.actionId,n=e.round,b=e.showSubmitter,v=(e.showVerifyHistory,e.onActionInfo),h=e.isExtensionAction,g=e.extensionAddress,j=e.factory,N=((0,i.useContext)(r.M)||{}).token,y=(0,d.dI)(null==N?void 0:N.address,s),p=y.actionInfo,E=y.isPending,w=y.error;(0,i.useEffect)(function(){v&&p&&v(p)},[p]);var I=(0,d.sK)(null==N?void 0:N.address,b?n:BigInt(0),s),C=I.submitInfo,_=I.isPending,A=I.error,k=(null==C?void 0:C.submitter)||"N/A",Z=(0,o.S)().handleContractError;return((0,i.useEffect)(function(){w&&Z(w,"submit"),A&&Z(A,"submit")},[w,A]),E)?(0,t.jsx)(m.Z,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mx-auto p-4 pb-2 ",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==p?void 0:p.head.id.toString()]}),(0,t.jsx)("span",{className:"text-xl font-bold text-black",children:null==p?void 0:p.body.title})]}),(0,t.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,t.jsx)(x.Z,{address:null==p?void 0:p.head.author})]}),b&&(0,t.jsxs)("div",{className:"flex items-center",children:["推举人"," ",_?(0,t.jsx)(m.Z,{}):(0,t.jsx)(x.Z,{address:k})]})]})]}),(0,t.jsx)("div",{className:"mx-auto p-4 pb-2",children:(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold",children:"最小参与代币数"}),(0,t.jsx)("p",{className:"text-greyscale-500",children:(0,a.LH)((null==p?void 0:p.body.minStake)||BigInt(0))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,t.jsx)("h3",{className:"text-sm font-bold",children:"最大激励地址数"}),(0,t.jsx)(u.Z,{title:"最大激励地址数说明",content:(0,t.jsxs)("p",{className:"leading-relaxed text-base",children:["每轮从所有参与行动的代币中，随机抽取",(0,t.jsx)("span",{className:"font-mono font-bold text-blue-600 mx-1 text-base",children:null==p?void 0:p.body.maxRandomAccounts.toString()}),"份代币，返回对应地址。若多份代币对应相同地址，则会合并为一个地址。"]})})]}),(0,t.jsx)("p",{className:"text-greyscale-500",children:(null==p?void 0:p.body.maxRandomAccounts.toString())||"-"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold mb-2",children:"验证规则"}),(0,t.jsx)("div",{className:"text-greyscale-500",children:(0,t.jsx)(l.L,{text:null==p?void 0:p.body.verificationRule,preserveLineBreaks:!0})})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold mb-2",children:"报名参加行动时，行动者要提供的信息"}),(null==p?void 0:p.body.verificationKeys)&&(null==p?void 0:p.body.verificationKeys.length)>0?(0,t.jsx)("ul",{className:"list-disc pl-5",children:p.body.verificationKeys.map(function(e,s){return(0,t.jsxs)("li",{className:"text-greyscale-500",children:[(0,t.jsxs)("div",{className:"text-sm font-bold text-greyscale-900 mb-1",children:[(0,t.jsx)(c.Z,{text:e,showWarning:!0})," :"]}),(0,t.jsx)("div",{children:(0,t.jsx)(c.Z,{text:p.body.verificationInfoGuides[s],showWarning:!0,preserveLineBreaks:!0})})]},s)})}):(0,t.jsx)("span",{className:"text-greyscale-500",children:"无"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,t.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==p?void 0:p.body.whiteListAddress)&&"0x0000000000000000000000000000000000000000"!==p.body.whiteListAddress?(0,t.jsx)("span",{className:"flex items-center mr-2",children:(0,t.jsx)(x.Z,{address:p.body.whiteListAddress})}):"无限制"})]}),h&&g&&j&&(0,t.jsx)(f.Z,{extensionAddress:g,factoryAddress:j.address,actionId:s,actionInfo:p})]})})]})}},42083:function(e,s,n){"use strict";var t=n(85893),i=n(23432);s.Z=function(){return(0,t.jsx)(i.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},60624:function(e,s,n){"use strict";n.d(s,{C:function(){return x}});var t=n(91309),i=n(67294),d=n(67516),o=n(42130),r=n(93778),a=n(66889),l=n(32848),c=n(37742),u=Number("3")/1e3,x=function(){var e=((0,i.useContext)(r.M)||{}).token,s=(0,o.m)().address,n=(0,i.useMemo)(function(){return(null==e?void 0:e.address)&&s?[{address:"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",abi:a.B,functionName:"validGovVotes",args:[e.address,s]},{address:"0xa42CAcd51b0F27c863b0De3e7961590e00E3fc4a",abi:l.C,functionName:"govData",args:[e.address]}]:[]},[null==e?void 0:e.address,s]),x=(0,d.N)({contracts:n,query:{enabled:!!(null==e?void 0:e.address)&&!!s&&n.length>0}}),m=x.data,f=x.isPending,b=x.error;return(0,i.useMemo)(function(){if(!m||!(null==e?void 0:e.address)||!s)return{hasEnoughVotes:!1,percentage:0,validGovVotes:void 0,govData:void 0,SUBMIT_MIN_PERCENTAGE:u,isPending:f,error:b};var n=(0,t._)(m,2),i=n[0],d=n[1],o=(null==i?void 0:i.result)?(0,c.Z)(i.result):void 0,r=null==d?void 0:d.result,a=o&&(null==r?void 0:r.govVotes)&&r.govVotes!==BigInt(0)?Number(o)/Number(r.govVotes):0;return{hasEnoughVotes:a>=u,percentage:a,validGovVotes:o,govData:r,SUBMIT_MIN_PERCENTAGE:u,isPending:f,error:b}},[m,null==e?void 0:e.address,s,f,b])}},20665:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return p}});var t=n(91309),i=n(85893),d=n(67294),o=n(11163),r=n(42130),a=n(93778),l=n(45231),c=n(83494),u=n(20725),x=n(27245),m=n(86501),f=n(93566),b=n(73591),v=n(60624),h=n(17301),g=n(42083),j=n(44576),N=n(91529),y=function(e){var s=e.actionId,n=e.submitted,t=e.onRoundChange,r=((0,d.useContext)(a.M)||{}).token,l=(0,o.useRouter)(),c=(0,f.Bk)(),u=c.currentRound,y=c.isPending,p=c.error;(0,d.useEffect)(function(){t&&"function"==typeof t&&t(u)},[u,t]);var E=(0,v.C)(),w=E.hasEnoughVotes,I=E.percentage,C=E.validGovVotes,_=E.govData,A=E.SUBMIT_MIN_PERCENTAGE,k=E.isPending,Z=E.error,B=(0,f.qd)(),P=B.submit,M=B.isPending,S=B.isConfirming,V=B.isConfirmed,R=B.writeError;(0,d.useEffect)(function(){V&&!R&&(m.Am.success("推举成功",{duration:2e3}),setTimeout(function(){l.push("/vote/batch?symbol=".concat(null==r?void 0:r.symbol))},2e3))},[V,R]);var T=(0,b.S)().handleContractError;return((0,d.useEffect)(function(){p&&T(p,"submit"),Z&&T(Z,"submit"),R&&T(R,"submit")},[p,Z,R]),k||y)?(0,i.jsx)(g.Z,{}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex flex-col m-4",children:[!w&&void 0!==C&&(null==_?void 0:_.govVotes)&&(0,i.jsx)(h.Z,{type:"error",message:"有效治理票，须达到总治理票的".concat((100*A).toFixed(1),"%，才能新建、推举行动（您当前有效治理票占比").concat((0,N.rl)(100*I,3),"%）"),className:"mb-4"}),(0,i.jsx)("div",{className:"flex justify-center",children:n||V?(0,i.jsxs)("div",{className:"flex space-x-4 justify-center w-full",children:[(0,i.jsx)(x.z,{disabled:!0,className:"w-1/2",children:"已推举"}),n&&!V&&(0,i.jsx)(x.z,{onClick:function(){return l.push("/vote/batch?symbol=".concat(null==r?void 0:r.symbol))},className:"w-1/2",children:"去投票"})]}):(0,i.jsxs)(x.z,{onClick:function(){M||S||!w||P(null==r?void 0:r.address,s)},className:"submit-action-button w-1/2",disabled:M||S||!w,children:[M&&"提交中...",S&&"确认中...",!M&&!S&&"推举本行动"]})}),(0,i.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4 w-full",children:[(0,i.jsx)("p",{className:"mb-1",children:"说明："}),(0,i.jsxs)("p",{children:["1. 有效治理票数 ≥ 总治理票的",Number("3")/10,"%，才能推举；"]}),(0,i.jsx)("p",{children:"2. 每轮次，1个地址最多可 创建/推举 1 个行动；"})]})]}),(0,i.jsx)(j.Z,{isLoading:M||S,text:M?"提交交易...":"确认交易..."})]})},p=function(){var e=(0,o.useRouter)().query,s=e.id,n=e.submitted,x=s?BigInt(s):void 0,m=(0,r.m)().address,f=((0,d.useContext)(a.M)||{}).token,b=(0,t._)((0,d.useState)(null),2),v=b[0],h=b[1],g=(0,l.Q)({tokenAddress:null==f?void 0:f.address,actionId:x,account:m}),j=g.isExtensionAction,N=g.extensionAddress,p=g.factory;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Z,{title:"行动详情",showBackButton:!0}),(0,i.jsxs)("main",{className:"flex-grow",children:[(0,i.jsx)(y,{actionId:BigInt(s||0),submitted:"true"===n,onRoundChange:function(e){h(e)}}),(0,i.jsx)(u.Z,{actionId:BigInt(s||0),round:BigInt(v||0),showSubmitter:!1,isExtensionAction:j,extensionAddress:N,factory:p})]})]})}}},function(e){e.O(0,[8501,4463,3798,8139,3494,3591,8300,2112,6268,6097,9330,7568,4018,2888,9774,179],function(){return e(e.s=32223)}),_N_E=e.O()}]);