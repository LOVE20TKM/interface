(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7260],{1709:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});var t=a(37876);let r=e=>{var s=e.title;return(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-lg font-bold",children:s})})}},12293:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});var t=a(37876),r=a(7446);let n=()=>(0,t.jsx)(r.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},18449:(e,s,a)=>{"use strict";a.d(s,{X:()=>n});var t=a(76200);class r extends t.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function n(e,s){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[a,t="0"]=e.split("."),n=a.startsWith("-");if(n&&(a=a.slice(1)),t=t.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${t}`))&&(a=`${BigInt(a)+1n}`),t="";else if(t.length>s){let[e,r,n]=[t.slice(0,s-1),t.slice(s-1,s),t.slice(s)],l=Math.round(Number(`${r}.${n}`));(t=l>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${l}`).length>s&&(t=t.slice(1),a=`${BigInt(a)+1n}`),t=t.slice(0,s)}else t=t.padEnd(s,"0");return BigInt(`${n?"-":""}${a}${t}`)}},21099:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote",function(){return a(82763)}])},28638:(e,s,a)=>{"use strict";a.d(s,{BT:()=>x,Wu:()=>m,ZB:()=>o,Zp:()=>i,aR:()=>d,wL:()=>u});var t=a(3576),r=a(65699),n=a(37876),l=a(14232),c=a(30684),i=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a)},l))});i.displayName="Card";var d=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",a)},l))});d.displayName="CardHeader";var o=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",a)},l))});o.displayName="CardTitle";var x=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},l))});x.displayName="CardDescription";var m=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("p-6 pt-0",a)},l))});m.displayName="CardContent";var u=l.forwardRef((e,s)=>{var a=e.className,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex items-center p-6 pt-0",a)},l))});u.displayName="CardFooter"},82763:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var t=a(37876),r=a(14232),n=a(98684),l=a(20451),c=a(60154),i=a(40854),d=a(89099),o=a(97685),x=a(91754),m=a(6960),u=a(28638),h=a(48230),N=a.n(h),v=a(52372),f=a(20442),p=a(83416),j=a(87577),y=a(1709),g=a(12293);let b=e=>{var s=e.currentRound,a=((0,r.useContext)(p.N)||{}).token,n=(0,d.useRouter)(),c=(0,v.ch)((null==a?void 0:a.address)||"",s),h=c.votes,b=c.actionIds,w=c.isPending,_=c.error,C=(0,v.VD)((null==a?void 0:a.address)||"",s),A=C.actionSubmits,I=C.isPending;C.error;var $=Array.from(new Set((null==A?void 0:A.map(e=>BigInt(e.actionId)))||[])).sort((e,s)=>Number(e)-Number(s)),B=(0,v.ui)((null==a?void 0:a.address)||"",$),k=B.actionInfos,R=B.isPending,E=B.error,P=e=>{if(!b||!h)return 0n;var s=b.findIndex(s=>s===e);return -1!==s?h[s]:0n},S=(0,i._)((0,r.useState)(new Set),2),T=S[0],z=S[1],D=e=>{z(s=>{var a=new Set(s);return a.has(e)?a.delete(e):a.add(e),a})},M=(null==h?void 0:h.reduce((e,s)=>e+s,0n))||0n,W=(0,l.g)().handleContractError;return((0,r.useEffect)(()=>{_&&W(_,"vote"),E&&W(E,"submit")},[_,E]),w||I||$&&$.length>0&&R)?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(g.A,{})}):a?(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(y.A,{title:"投票中的行动"}),a&&(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(m.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(N(),{href:"/action/new/?symbol=".concat(null==a?void 0:a.symbol),children:"推举新行动"})}),(0,t.jsx)(m.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(N(),{href:"/vote/actions4submit?symbol=".concat(null==a?void 0:a.symbol),children:"推举历史行动"})})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:$.length>0?(0,t.jsxs)(t.Fragment,{children:[null==k?void 0:k.map((e,s)=>{var r;return null==A||null==(r=A.find(s=>BigInt(s.actionId)===BigInt(e.head.id)))||r.submitter,(0,t.jsxs)(u.Zp,{className:"shadow-none flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",className:"checkbox accent-secondary ml-2",checked:T.has(BigInt(e.head.id)),onChange:()=>D(BigInt(e.head.id))}),(0,t.jsxs)(N(),{href:"/action/detail?id=".concat(e.head.id,"&type=vote&symbol=").concat(null==a?void 0:a.symbol),className:"w-full",children:[(0,t.jsxs)(u.aR,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,t.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No."}),(0,t.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.head.id)}),(0,t.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.title)})]}),(0,t.jsx)(u.Wu,{className:"px-3 pt-1 pb-2",children:(0,t.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(x.A,{className:"text-greyscale-400 mr-1 h-3 w-3"}),(0,t.jsx)("span",{className:"text-greyscale-400",children:(0,t.jsx)(j.A,{address:e.head.author,showCopyButton:!1})})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票数"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,f.NJ)(P(BigInt(e.head.id)))})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"占比"}),(0,t.jsx)("span",{className:"text-secondary",children:0n===M?"-":(0,f.Ee)(100*Number(P(BigInt(e.head.id)))/Number(M))})]})]})})]},e.head.id)]},e.head.id)}),(0,t.jsx)("div",{className:"flex justify-center mt-4",children:(0,t.jsx)(m.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",onClick:()=>{var e=Array.from(T).join(",");if(0===e.length)return void o.oR.error("请选择行动");n.push("/vote/vote?ids=".concat(e,"&symbol=").concat(null==a?void 0:a.symbol))},children:"给选中的行动投票"})}),(0,t.jsx)("div",{className:"mt-2 text-sm text-greyscale-500 text-center",children:"提示: 每轮最大可投票数，等于您的治理票数"})]}):(0,t.jsx)("div",{className:"text-sm text-greyscale-500 text-center mt-8",children:"还没推举行动，请先推举"})})]}):(0,t.jsx)(g.A,{})},w=()=>{var e=(0,n.vC)(),s=e.currentRound,a=e.isPending,i=e.error,d=(0,l.g)().handleContractError;return(0,r.useEffect)(()=>{i&&d(i,"vote")},[i]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.A,{title:"投票首页"}),(0,t.jsx)("main",{className:"flex-grow",children:a?(0,t.jsx)(g.A,{}):(0,t.jsx)(b,{currentRound:s})})]})}},87577:(e,s,a)=>{"use strict";a.d(s,{A:()=>x});var t=a(40854),r=a(37876),n=a(14232),l=a(48447),c=a(33276),i=a(70801),d=a(97685),o=a(20442);let x=e=>{var s=e.address,a=e.word,x=e.showCopyButton,m=e.showAddress,u=void 0===m||m,h=e.colorClassName,N=void 0===h?"":h,v=e.colorClassName2,f=void 0===v?"":v,p=(0,t._)((0,n.useState)(!1),2),j=p[0],y=p[1];return(0,r.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[a&&(0,r.jsx)("span",{className:"text-xs",children:a}),u&&!f&&(0,r.jsx)("span",{className:"text-xs ".concat(null!=N?N:"text-greyscale-500"),children:(0,o.W_)(s)}),u&&f&&(0,r.jsxs)("span",{className:"text-[0px]",children:[(0,r.jsx)("span",{className:"text-xs ".concat(null!=N?N:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,r.jsx)("span",{className:"text-xs ".concat(f),children:"".concat(s.substring(s.length-4))})]}),(void 0===x||x)&&(0,r.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?y(!0):d.Ay.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:j?(0,r.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=N?N:"text-greyscale-500")}):(0,r.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=N?N:"text-greyscale-500")})})})]})}},91754:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});var t=(0,a(11713).A)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[3308,9374,8230,154,3096,636,6593,8792],()=>s(21099)),_N_E=e.O()}]);