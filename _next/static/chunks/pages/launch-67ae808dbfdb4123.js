(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{68786:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return n(10423)}])},27460:function(e,t,n){"use strict";var s=n(85893),r=n(67294),a=n(74855),l=n(78865),i=n(18289),c=n(86501),o=n(91529);t.Z=e=>{let{address:t,word:n,showCopyButton:d=!0,showAddress:u=!0,colorClassName:m=""}=e,[x,h]=(0,r.useState)(!1);return(0,s.jsxs)("span",{className:"flex items-center space-x-2",children:[n&&(0,s.jsx)("span",{className:"text-xs",children:n}),u&&(0,s.jsx)("span",{className:"text-xs ".concat(null!=m?m:"text-greyscale-500"),children:(0,o.Vu)(t)}),d&&(0,s.jsx)(a.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?h(!0):c.ZP.error("复制失败")},children:(0,s.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:x?(0,s.jsx)(l.Z,{className:"h-4 w-4 ".concat(null!=m?m:"text-greyscale-500")}):(0,s.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=m?m:"text-greyscale-500")})})})]})}},44576:function(e,t,n){"use strict";var s=n(85893);n(67294);var r=n(23432);t.Z=e=>{let{isLoading:t,text:n="Loading"}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:n})]})}):null}},91529:function(e,t,n){"use strict";n.d(t,{LH:function(){return l},Vu:function(){return a},bM:function(){return c},cK:function(){return d},eb:function(){return u},kP:function(){return o},vz:function(){return i}});var s=n(21803),r=n(15229);let a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=Number(c(e));if(e<10n)return"0";if(t>=1e5)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t);if(t>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(t);if(t>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(t);{if(t>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(t);if(0===t)return"0";let e=t.toFixed(14),n=e.split(".");if(n.length<2)return e;let s=n[1],r=0;for(let e of s)if("0"===e)r++;else break;let a=s.slice(r,r+4);return"0.0{".concat(r,"}").concat(a)}},i=e=>{let t=parseInt("18",10);try{let n=e.replace(/,/g,"");return(0,s.v)(n,t)}catch(e){return console.error("parseUnits error:",e),0n}},c=e=>{let t=parseInt("18",10);return(0,r.b)(e,t)},o=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,d=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=Number(e);if(s>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(s);if(s>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:n+1}).format(s);{if(0===s)return"0";let e=s.toFixed(n+10),t=e.split(".");if(t.length<2)return e;let r=t[1],a=0;for(let e of r)if("0"===e)a++;else break;let l=r.slice(a);return"0.0{".concat(a,"}").concat(l)}}},10423:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var s=n(85893),r=n(67294),a=n(93778),l=n(70019),i=n(10403),c=n(37436),o=n(42083),d=n(42757),u=n(37413),m=n(91529),x=e=>{let{token:t,launchInfo:n}=e,r=Number(n.totalContributed)/Number(n.parentTokenFundraisingGoal),a=(100*r).toFixed(1),{data:l}=(0,d.O)();if(!n)return(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!t)return(0,s.jsx)(o.Z,{});let i="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-6 mb-4"}),(0,s.jsxs)("div",{className:"flex-col items-center px-4",children:[(0,s.jsx)("div",{className:"grid place-items-center mb-2",children:(0,s.jsx)("div",{className:"stat-title text-base mr-6 ".concat(n.hasEnded?"text-red-500":"text-secondary"),children:n.hasEnded?"公平发射已结束":"公平发射进行中"})}),(0,s.jsx)("div",{className:"stats w-full border",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"累计已申购"}),(0,s.jsxs)("div",{className:"stat-value",children:[(0,s.jsx)("span",{className:"text-3xl text-secondary",children:(0,m.LH)(n.totalContributed)}),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:i})]}),(0,s.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,s.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,s.jsxs)("div",{className:"stat-title text-sm",children:[(0,s.jsx)("span",{children:i}),"筹集目标"]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:(0,m.LH)(n.parentTokenFundraisingGoal)})]}),(0,s.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,s.jsxs)("div",{className:"stat-title text-sm",children:[(0,s.jsxs)("span",{children:[t.symbol," "]}),"发射总量"]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,m.LH)(BigInt(u.v.fairLaunch)))})]})]}),(0,s.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",i," ="," ",(0,m.eb)((0,m.kP)((Number(u.v.fairLaunch)/Number(n.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",t.symbol]}),(0,s.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,s.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,s.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!n.hasEnded&&"（当前 ".concat(a,"%）")]}),(0,s.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!n.hasEnded&&r>=.5&&(()=>{let e=Number(n.secondHalfStartBlock)+Number(n.secondHalfMinBlocks),t=Number(l||0),s=e-t;return s<=0?r>=1?"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（当前区块：第").concat(t,"区块，还需等待").concat(s,"个区块）")})(),!n.hasEnded&&r<.5&&"，至少".concat(n.secondHalfMinBlocks.toString(),"个区块"),n.hasEnded&&"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,s.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,s.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,s.jsxs)("p",{children:["1. 代币总量：",(0,m.LH)(BigInt(u.v.totalSupply))]}),(0,s.jsxs)("p",{children:["2. 发射数量：",(0,m.LH)(BigInt(u.v.fairLaunch))," (10%)"]}),(0,s.jsxs)("p",{children:["3. 治理激励：",(0,m.LH)(BigInt(u.v.govRewards))," (45%)"]}),(0,s.jsxs)("p",{children:["4. 行动激励：",(0,m.LH)(BigInt(u.v.actionRewards))," (45%)"]}),(0,s.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,s.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,s.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})]})},h=n(27245),f=n(92321),g=n(11163),j=n(41664),N=n.n(j),b=n(86501),p=n(64777),v=n(44576),y=e=>{let{token:t,launchInfo:n}=e,{address:a,isConnected:c}=(0,f.m)(),{data:u}=(0,d.O)(),x=(0,g.useRouter)(),{contributed:j,isPending:y,error:k,refetch:w}=(0,l.ap)(null==t?void 0:t.address,c?a:"0x0000000000000000000000000000000000000000"),{lastContributedBlock:S,isPending:F,error:I}=(0,l.oz)(null==t?void 0:t.address,c?a:"0x0000000000000000000000000000000000000000"),C=BigInt("40")-((u?BigInt(u):0n)-(S||0n)),{withdraw:T,isPending:B,writeError:E,isConfirming:H,isConfirmed:Z}=(0,l.Qc)(),L=async()=>{if(C>0n){b.ZP.error("还需要等待 ".concat(C," 个区块才能撤回"));return}await T(null==t?void 0:t.address)};(0,r.useEffect)(()=>{Z&&(b.ZP.success("撤回成功"),w(),setTimeout(()=>{x.push("/dex/swap/?symbol=".concat(null==t?void 0:t.symbol,"&from=").concat(null==t?void 0:t.parentTokenSymbol))},1e3))},[Z]);let{handleContractError:P}=(0,i.S)();if((0,r.useEffect)(()=>{k&&P(k,"launch"),I&&P(I,"launch"),E&&P(E,"launch")},[k,I,E]),!t||y||F)return(0,s.jsx)(o.Z,{});let M="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,s.jsxs)("div",{className:"px-6",children:[(0,s.jsx)(p.Z,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,m.LH)(j||0n),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:M})]})]})}),(0,s.jsxs)("div",{className:"flex justify-center gap-4",children:[j&&j>0n&&(0,s.jsx)(h.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",onClick:L,disabled:B||H||Z,children:B?"提交中...":H?"确认中...":Z?"已撤回":"撤回申购"}),(0,s.jsx)(h.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(N(),{href:"/launch/contribute?symbol=".concat(null==t?void 0:t.symbol),children:j&&j>0n?"增加申购":"去申购"})})]}),j&&j>0n&&(0,s.jsxs)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:["申购后需等 ","40"," 个区块才能撤回（当前还需等"," ",C>0?C.toString():"0"," 个区块）"]}),(0,s.jsx)(v.Z,{isLoading:B||H,text:B?"提交交易...":"确认交易..."})]})},k=e=>{let{token:t,launchInfo:n}=e,{address:c}=(0,f.m)(),{clearToken:d}=(0,r.useContext)(a.M)||{},{contributed:x,isPending:g,error:j}=(0,l.ap)(null==t?void 0:t.address,c),{claimed:y,isPending:k,error:w}=(0,l.ur)(null==t?void 0:t.address,c),{extraRefunded:S,isPending:F,error:I}=(0,l.Vh)(null==t?void 0:t.address,c),C=n.totalContributed?BigInt(u.v.fairLaunch)*(x||0n)/BigInt(n.totalContributed):0n,{claim:T,isWriting:B,writeError:E,isConfirming:H,isConfirmed:Z}=(0,l.z7)(),L=async()=>{try{await T(null==t?void 0:t.address)}catch(e){console.error("领取失败:",e)}};(0,r.useEffect)(()=>{Z?(b.ZP.success("领取成功"),null==d||d(),setTimeout(()=>{window.location.reload()},1e3)):E&&b.ZP.error("领取失败")},[Z,E]);let{handleContractError:P}=(0,i.S)();if((0,r.useEffect)(()=>{E&&P(E,"launch"),w&&P(w,"launch"),I&&P(I,"launch"),j&&P(j,"launch")},[E,w,I,j]),!c)return"";if(k||!t)return(0,s.jsx)(o.Z,{});let M="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,s.jsxs)("div",{className:"px-6",children:[(0,s.jsx)(p.Z,{title:"我的申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,s.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,m.LH)(C),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:t.symbol})]})]})}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(x)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.z,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,s.jsx)(h.z,{className:"w-1/2",asChild:!0,children:(0,s.jsx)(N(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]}),Number(x)>0&&!y&&(0,s.jsx)(h.z,{className:"w-1/2",onClick:L,disabled:B||H||Z,children:B?"领取中...":H?"确认中...":Z?"已领取":"领取"}),Number(x)>0&&y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.z,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,s.jsx)(h.z,{className:"w-1/2",asChild:!0,children:(0,s.jsx)(N(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]})]}),Number(x)>0&&y&&(0,s.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,s.jsxs)("span",{className:"text-secondary",children:[(0,m.LH)(null!=x?x:0n)," "]}),M,"，申购返还了"," ",(0,s.jsx)("span",{className:"text-secondary",children:(0,m.LH)(null!=S?S:0n)})," ",M]}),(0,s.jsx)(v.Z,{isLoading:B||H,text:B?"提交交易...":"确认交易..."})]})},w=n(4062);function S(){let{token:e,setToken:t}=(0,r.useContext)(a.M)||{token:null,setToken:null},{launchInfo:n,isPending:d,error:u}=(0,l.kF)(e?e.address:"0x0"),{handleContractError:m}=(0,i.S)();return((0,r.useEffect)(()=>{u&&m(u,"launch")},[u]),(0,r.useEffect)(()=>{n&&e&&n.hasEnded&&!e.hasEnded&&t({...e,hasEnded:!0})},[n,e]),d||n)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{title:"公平发射"}),(0,s.jsxs)("main",{className:"flex-grow",children:[(0,s.jsx)(w.Z,{}),d||!n?(0,s.jsx)(o.Z,{}):(0,s.jsxs)(s.Fragment,{children:[e&&(n.hasEnded?(0,s.jsx)(k,{token:e,launchInfo:n}):(0,s.jsx)(y,{token:e,launchInfo:n})),(0,s.jsx)(x,{token:e,launchInfo:n})]})]})]}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}},42757:function(e,t,n){"use strict";n.d(t,{O:function(){return u}});var s=n(30202),r=n(97712),a=n(81946),l=n(36100),i=n(45631),c=n(82002),o=n(80666),d=n(97861);function u(e={}){let{query:t={},watch:n}=e,u=(0,o.Z)(e),m=(0,s.NL)(),x=(0,c.x)({config:u}),h=e.chainId??x,f=function(e,t={}){return{gcTime:0,async queryFn({queryKey:t}){let{scopeKey:n,...s}=t[1];return await function(e,t={}){let{chainId:n,...s}=t,l=e.getClient({chainId:n});return(0,a.s)(l,r.z,"getBlockNumber")(s)}(e,s)??null},queryKey:function(e={}){return["blockNumber",(0,l.OP)(e)]}(t)}}(u,{...e,chainId:h});return(0,d.x)({...{config:e.config,chainId:e.chainId,..."object"==typeof n?n:{}},enabled:!!((t.enabled??!0)&&("object"==typeof n?n.enabled:n)),onBlockNumber(e){m.setQueryData(f.queryKey,e)}}),(0,i.aM)({...t,...f})}},97861:function(e,t,n){"use strict";n.d(t,{x:function(){return c}});var s=n(65185),r=n(81946),a=n(67294),l=n(82002),i=n(80666);function c(e={}){let{enabled:t=!0,onBlockNumber:n,config:c,...o}=e,d=(0,i.Z)(e),u=(0,l.x)({config:d}),m=e.chainId??u;(0,a.useEffect)(()=>{if(t&&n)return function(e,t){let n,a;let{syncConnectedChain:l=e._internal.syncConnectedChain,...i}=t,c=t=>{n&&n();let a=e.getClient({chainId:t});return n=(0,r.s)(a,s.q,"watchBlockNumber")(i)},o=c(t.chainId);return l&&!t.chainId&&(a=e.subscribe(({chainId:e})=>e,async e=>c(e))),()=>{o?.(),a?.()}}(d,{...o,chainId:m,onBlockNumber:n})},[m,d,t,n,o.onError,o.emitMissed,o.emitOnBegin,o.poll,o.pollingInterval,o.syncConnectedChain])}}},function(e){e.O(0,[2209,1335,2690,2083,7380,6202,4062,2888,9774,179],function(){return e(e.s=68786)}),_N_E=e.O()}]);