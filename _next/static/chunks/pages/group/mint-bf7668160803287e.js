try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="13670f0f-d955-4326-b18b-b4c0592b6430",e._sentryDebugIdIdentifier="sentry-dbid-13670f0f-d955-4326-b18b-b4c0592b6430")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5625],{40498:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/group/mint",function(){return n(15e3)}])},74193:function(e,r,n){"use strict";n.d(r,{NI:function(){return y},Wi:function(){return h},l0:function(){return x},lX:function(){return b},pf:function(){return j},xJ:function(){return N},zG:function(){return w}});var i=n(34788),t=n(12796),s=n(72253),a=n(14932),o=n(47702),u=n(85893),c=n(67294),d=n(88426),l=n(87536),f=n(40108),m=n(94193),x=l.RV,g=c.createContext({}),h=function(e){var r=(0,i._)({},(0,t._)(e));return(0,u.jsx)(g.Provider,{value:{name:r.name},children:(0,u.jsx)(l.Qr,(0,s._)({},r))})},v=function(){var e=c.useContext(g),r=c.useContext(p),n=(0,l.Gc)(),i=n.getFieldState,t=n.formState,a=i(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");var o=r.id;return(0,s._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},a)},p=c.createContext({}),N=c.forwardRef(function(e,r){var n=e.className,i=(0,o._)(e,["className"]),t=c.useId();return(0,u.jsx)(p.Provider,{value:{id:t},children:(0,u.jsx)("div",(0,s._)({ref:r,className:(0,f.cn)("space-y-2",n)},i))})});N.displayName="FormItem";var b=c.forwardRef(function(e,r){var n=e.className,i=(0,o._)(e,["className"]),t=v(),a=t.error,c=t.formItemId;return(0,u.jsx)(m._,(0,s._)({ref:r,className:(0,f.cn)(a&&"text-destructive",n),htmlFor:c},i))});b.displayName="FormLabel";var y=c.forwardRef(function(e,r){var n=(0,i._)({},(0,t._)(e)),a=v(),o=a.error,c=a.formItemId,l=a.formDescriptionId,f=a.formMessageId;return(0,u.jsx)(d.g7,(0,s._)({ref:r,id:c,"aria-describedby":o?"".concat(l," ").concat(f):"".concat(l),"aria-invalid":!!o},n))});y.displayName="FormControl";var j=c.forwardRef(function(e,r){var n=e.className,i=(0,o._)(e,["className"]),t=v().formDescriptionId;return(0,u.jsx)("p",(0,s._)({ref:r,id:t,className:(0,f.cn)("text-sm text-muted-foreground",n)},i))});j.displayName="FormDescription";var w=c.forwardRef(function(e,r){var n=e.className,i=e.children,t=(0,o._)(e,["className","children"]),c=v(),d=c.error,l=c.formMessageId,m=d?String(null==d?void 0:d.message):i;return m?(0,u.jsx)("p",(0,a._)((0,s._)({ref:r,id:l,className:(0,f.cn)("text-sm font-medium text-destructive",n)},t),{children:m})):null});w.displayName="FormMessage"},94193:function(e,r,n){"use strict";n.d(r,{_:function(){return l}});var i=n(72253),t=n(47702),s=n(85893),a=n(67294),o=n(49102),u=n(12003),c=n(40108),d=(0,u.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=a.forwardRef(function(e,r){var n=e.className,a=(0,t._)(e,["className"]);return(0,s.jsx)(o.f,(0,i._)({ref:r,className:(0,c.cn)(d(),n)},a))});l.displayName=o.f.displayName},64777:function(e,r,n){"use strict";var i=n(85893);r.Z=function(e){var r=e.title;return(0,i.jsx)("div",{className:"flex justify-between items-center",children:(0,i.jsx)("h1",{className:"text-lg font-bold",children:r})})}},42083:function(e,r,n){"use strict";var i=n(85893),t=n(23432);r.Z=function(){return(0,i.jsx)(t.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},85794:function(e,r,n){"use strict";n.d(r,{A5:function(){return x},DA:function(){return v},hS:function(){return f},l3:function(){return h},yA:function(){return g},yG:function(){return l},z4:function(){return m}});var i=n(11010),t=n(97582),s=n(67294),a=n(71104),o=n(37541),u=n(37742),c=n(37474),d=n(84689),l=function(e,r,n){var i=!(arguments.length>3)||void 0===arguments[3]||arguments[3],t=(0,a.u)({address:e,abi:o.O,functionName:"allowance",args:[r,n],query:{enabled:!!e&&!!r&&!!n&&i}}),s=t.data,c=t.isPending,d=t.error,l=t.refetch;return{allowance:void 0!==s?(0,u.Zu)(s):void 0,isPending:c,error:d,refetch:l}},f=function(e,r){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=(0,a.u)({address:e,abi:o.O,functionName:"balanceOf",args:[r],query:{enabled:!!e&&!!r&&n}}),t=i.data,s=i.isPending,c=i.error,d=i.refetch;return{balance:void 0!==t?(0,u.Zu)(t):void 0,isPending:s,error:c,refetch:d}},m=function(e){var r=(0,a.u)({address:e,abi:o.O,functionName:"symbol",args:[],query:{enabled:!!e}});return{symbol:r.data,isPending:r.isPending,error:r.error}},x=function(e){var r=(0,a.u)({address:e,abi:o.O,functionName:"totalSupply",args:[],query:{enabled:!!e}}),n=r.data,i=r.isPending,t=r.error;return{totalSupply:void 0!==n?(0,u.Zu)(n):void 0,isPending:i,error:t}};function g(e){var r,n=(0,c.e9)(o.O,e,"approve"),a=n.execute,u=n.isPending,l=n.isConfirming,f=n.isConfirmed,m=n.error,x=n.hash,g=n.isTukeMode,h=(r=(0,i._)(function(r,n){return(0,t.Jh)(this,function(i){switch(i.label){case 0:return console.log("提交approve交易:",{token:e,spender:r,value:n,isTukeMode:g}),[4,a([r,n])];case 1:return[2,i.sent()]}})}),function(e,n){return r.apply(this,arguments)});return(0,s.useEffect)(function(){x&&console.log("approve tx hash:",x),m&&(console.log("提交approve交易错误:"),(0,d.Vh)(m),(0,d.H)(m))},[x,m]),{approve:h,isPending:u,isConfirming:l,writeError:m,isConfirmed:f,hash:x,isTukeMode:g}}function h(e){var r,n=(0,c.e9)(o.O,e,"burnForParentToken"),a=n.execute,u=n.isPending,l=n.isConfirming,f=n.isConfirmed,m=n.error,x=n.hash,g=n.isTukeMode,h=(r=(0,i._)(function(r){return(0,t.Jh)(this,function(n){switch(n.label){case 0:return console.log("提交burnForParentToken交易:",{token:e,amount:r,isTukeMode:g}),[4,a([r])];case 1:return[2,n.sent()]}})}),function(e){return r.apply(this,arguments)});return(0,s.useEffect)(function(){x&&console.log("burnForParentToken tx hash:",x),m&&(console.log("提交burnForParentToken交易错误:"),(0,d.Vh)(m),(0,d.H)(m))},[x,m]),{burnForParentToken:h,isPending:u,isConfirming:l,writeError:m,isConfirmed:f,hash:x,isTukeMode:g}}function v(e){var r,n=(0,c.e9)(o.O,e,"transfer"),a=n.execute,u=n.isPending,l=n.isConfirming,f=n.isConfirmed,m=n.error,x=n.hash,g=n.isTukeMode,h=(r=(0,i._)(function(r,n){return(0,t.Jh)(this,function(i){switch(i.label){case 0:return console.log("提交transfer交易:",{token:e,to:r,amount:n,isTukeMode:g}),[4,a([r,n])];case 1:return[2,i.sent()]}})}),function(e,n){return r.apply(this,arguments)});return(0,s.useEffect)(function(){x&&console.log("transfer tx hash:",x),m&&(console.log("提交transfer交易错误:"),(0,d.Vh)(m),(0,d.H)(m))},[x,m]),{transfer:h,isPending:u,isConfirming:l,writeError:m,isConfirmed:f,hash:x,isTukeMode:g}}},22403:function(e,r,n){"use strict";n.d(r,{_:function(){return o}});var i=n(67516),t=n(50095),s=n(37742),a="0xA0a5BB442214988D0c6e707d825640C026fB1d04";function o(e){var r,n,o=e.groupName,u=e.maxGroupNameLength,c=e.enabled,d=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(!e)return{isValid:!1,error:"群名称不能为空"};var n=new TextEncoder().encode(e),i=n.length;if(0===i||i>r)return{isValid:!1,error:"群名称长度必须在 1-".concat(r," 字节之间")};for(var t=0;t<i;){var s=n[t];if(s<=32)return{isValid:!1,error:"群名称不能包含控制字符或空格"};if(127===s)return{isValid:!1,error:"群名称不能包含 DEL 字符"};if(s<128){t++;continue}var a=0;if(s>=194&&s<=223)a=2;else if(s>=224&&s<=239)a=3;else{if(!(s>=240)||!(s<=244))return{isValid:!1,error:"群名称包含无效的 UTF-8 字符"};a=4}if(t+a>i)return{isValid:!1,error:"群名称包含不完整的 UTF-8 字符"};for(var o=1;o<a;o++){var u=n[t+o];if(u<128||u>191)return{isValid:!1,error:"群名称包含无效的 UTF-8 延续字节"}}if(2===a){var c=n[t],d=n[t+1];if(194===c&&160===d)return{isValid:!1,error:"群名称不能包含不间断空格"};if(194===c&&173===d)return{isValid:!1,error:"群名称不能包含软连字符"};if(194===c&&d>=128&&d<=159)return{isValid:!1,error:"群名称不能包含 C1 控制字符"};if(205===c&&143===d)return{isValid:!1,error:"群名称不能包含组合字形连接符"};if(216===c&&156===d)return{isValid:!1,error:"群名称不能包含阿拉伯字母标记"}}if(3===a){var l=n[t],f=n[t+1],m=n[t+2];if(225===l&&154===f&&128===m)return{isValid:!1,error:"群名称不能包含特殊空格字符"};if(226===l&&128===f&&m>=128&&m<=143)return{isValid:!1,error:"群名称不能包含特殊空格或零宽字符"};if(226===l&&128===f&&168===m)return{isValid:!1,error:"群名称不能包含行分隔符"};if(226===l&&128===f&&169===m)return{isValid:!1,error:"群名称不能包含段落分隔符"};if(226===l&&128===f&&m>=170&&m<=174)return{isValid:!1,error:"群名称不能包含方向格式化字符"};if(226===l&&128===f&&175===m)return{isValid:!1,error:"群名称不能包含窄不间断空格"};if(226===l&&129===f&&159===m)return{isValid:!1,error:"群名称不能包含特殊数学空格"};if(226===l&&129===f&&160===m)return{isValid:!1,error:"群名称不能包含单词连接符"};if(227===l&&128===f&&128===m)return{isValid:!1,error:"群名称不能包含全角空格"};if(239===l&&187===f&&191===m)return{isValid:!1,error:"群名称不能包含 BOM 字符"};if(224===l&&f<160)return{isValid:!1,error:"群名称包含过长的 UTF-8 编码"};if(237===l&&f>=160)return{isValid:!1,error:"群名称包含无效的 UTF-16 代理对"}}if(4===a){var x=n[t],g=n[t+1];if(240===x&&g<144)return{isValid:!1,error:"群名称包含过长的 UTF-8 编码"};if(244===x&&g>=144)return{isValid:!1,error:"群名称包含超出范围的 Unicode 字符"}}t+=a}return{isValid:!0}}(o,void 0===u?100:u),l=(void 0===c||c)&&!!o&&d.isValid,f=(0,i.N)({contracts:[{address:a,abi:t.s,functionName:"isGroupNameUsed",args:[o]},{address:a,abi:t.s,functionName:"calculateMintCost",args:[o]}],query:{enabled:l}}),m=f.data,x=f.isPending,g=f.error,h=null==m?void 0:null===(r=m[0])||void 0===r?void 0:r.result,v=(null==m?void 0:null===(n=m[1])||void 0===n?void 0:n.result)?(0,s.Zu)(m[1].result):void 0,p=d.isValid&&!h,N=d.error;return d.isValid&&h&&(N="该群名称已被使用"),{isValid:p,validationError:N,isGroupNameUsed:h,mintCost:v,isPending:!!l&&x,error:g}}},15e3:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return M}});var i=n(85893),t=n(83494),s=n(11010),a=n(72253),o=n(14932),u=n(91309),c=n(97582),d=n(67294),l=n(11163),f=n(45901),m=n(56312),x=n(87536),g=n(42130),h=n(86501),v=n(23432),p=n(27245),N=n(21774),b=n(74193),y=n(91529),j=n(27966),w=n(95049),_=n(85794),V=n(8300),C=n(22403),E=n(64777),I=n(42083),F=n(44576),P="0x6458E25680765Add4e2ca8d5a31fA08f5e1b6e4a",T="0xA0a5BB442214988D0c6e707d825640C026fB1d04",k="LOVE20";function B(){var e,r,n=(0,g.m)(),t=n.address,B=n.isConnected,M=(0,l.useRouter)(),A=(0,w.V)().setError,D=(0,V.Q7)().maxGroupNameLength,Z=(0,_.hS)(P,t),O=Z.balance,G=Z.isPending,R=Z.error,S=(0,x.cI)({resolver:(0,m.F)((O||BigInt(0),f.Ry({groupName:f.Z_().nonempty({message:"请输入群名称"}).refine(function(e){return e.trim().length>0},{message:"群名称不能只包含空白字符"})}))),defaultValues:{groupName:""},mode:"onChange",reValidateMode:"onChange"}),L=S.watch("groupName"),U=(0,C._)({groupName:L,maxGroupNameLength:D?Number(D):100,enabled:!!L}),J=U.isValid,H=U.validationError,q=(U.isGroupNameUsed,U.mintCost),z=U.isPending;(0,d.useEffect)(function(){L&&!z&&H?S.setError("groupName",{message:H}):L&&!z&&J&&S.clearErrors("groupName")},[L,J,H,z,S]);var X=(0,_.yA)(P),Q=X.approve,W=X.isPending,K=X.isConfirming,Y=X.isConfirmed,$=X.writeError,ee=(0,u._)((0,d.useState)(!1),2),er=ee[0],en=ee[1],ei=(0,_.yG)(P,t,T),et=ei.allowance,es=ei.isPending,ea=ei.error,eo=ei.refetch,eu=(0,d.useRef)(!1);(0,d.useEffect)(function(){W&&(eu.current=!1)},[W]),(0,d.useEffect)(function(){Y&&!eu.current&&(eu.current=!0,en(!0),h.Am.success("授权成功"),eo())},[Y,eo]),(0,d.useEffect)(function(){q&&q>BigInt(0)&&et&&et>=q?en(!0):en(!1)},[q,et]);var ec=(e=(0,s._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:if(!q||q<=BigInt(0))return h.Am.error("请先输入有效的群名称"),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Q(T,q*BigInt(1001)/BigInt(1e3))];case 2:return e.sent(),[3,4];case 3:return console.error(e.sent()),[3,4];case 4:return[2]}})}),function(){return e.apply(this,arguments)}),ed=(0,V.DB)(),el=ed.mint,ef=ed.isPending,em=ed.isConfirming,ex=ed.isConfirmed,eg=ed.writeError,eh=(r=(0,s._)(function(e){return(0,c.Jh)(this,function(r){switch(r.label){case 0:if(!J)return h.Am.error(H||"群名称不合法"),[2];if(!er)return h.Am.error("请先授权"),[2];if(!q||q<=BigInt(0))return h.Am.error("无法获取铸造成本"),[2];if(O&&O<q)return h.Am.error("".concat(k," 代币余额不足")),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,el(e.groupName.trim())];case 2:return r.sent(),[3,4];case 3:return console.error(r.sent()),[3,4];case 4:return[2]}})}),function(e){return r.apply(this,arguments)}),ev=(0,d.useRef)(!1);(0,d.useEffect)(function(){ef&&(ev.current=!1)},[ef]),(0,d.useEffect)(function(){ex&&!ev.current&&(ev.current=!0,h.Am.success("铸造成功！"),setTimeout(function(){M.push("/group/groupids")},2e3))},[ex,M]),(0,d.useEffect)(function(){void 0===O&&!G&&J&&void 0!==q?A({name:"余额不足",message:"".concat(k," 不足")}):void 0!==O&&void 0!==q&&O>=q&&A(null)},[O,G,J,q,A,k]);var ep=(0,j.b)().handleError;(0,d.useEffect)(function(){R&&ep(R),$&&ep($),ea&&ep(ea),eg&&ep(eg)},[R,$,ea,eg,ep]);var eN=W||K;return B?G?(0,i.jsx)(I.Z,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"px-2 mt-4",children:[(0,i.jsx)(E.Z,{title:"铸造链群NFT"}),(0,i.jsx)(b.l0,(0,o._)((0,a._)({},S),{children:(0,i.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,i.jsx)(b.Wi,{control:S.control,name:"groupName",render:function(e){var r=e.field;return(0,i.jsxs)(b.xJ,{children:[(0,i.jsx)(b.lX,{}),(0,i.jsx)(b.NI,{children:(0,i.jsx)(N.I,(0,a._)({type:"text",placeholder:"请输入NFT名称",disabled:eN||ef||em,className:"!ring-secondary-foreground"},r))}),(0,i.jsx)(b.zG,{}),D&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-xs text-greyscale-400 mt-1",children:["最大长度：",D.toString()," 字节"]}),(0,i.jsx)("div",{className:"text-xs text-greyscale-400 mt-1",children:"(其中英文或数字一个占1个字节，中文一个占3个字节)"})]})]})}}),L&&(0,i.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-500",children:"链群名称:"}),z?(0,i.jsx)("span",{className:"text-gray-400",children:"检查中..."}):J?(0,i.jsx)("span",{className:"text-green-600 font-medium",children:"✓ 可用"}):(0,i.jsxs)("span",{className:"text-red-600 font-medium",children:["✗ ",H]})]}),J&&void 0!==q&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-500",children:"铸造成本:"}),(0,i.jsxs)("span",{className:"font-mono text-secondary font-medium",children:[(0,y.LH)(q)," ",k]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-500",children:"滑点:"}),(0,i.jsx)("span",{className:"font-mono text-secondary font-medium",children:"0.1%"})]})]}),void 0!==O&&(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-500",children:"我的余额:"}),(0,i.jsxs)("span",{className:"font-mono text-greyscale-600",children:[(0,y.LH)(O)," ",k]})]}),J&&void 0!==q&&void 0!==O&&O<q&&(0,i.jsxs)("div",{className:"text-xs text-red-600 mt-1",children:["余额不足，还需要 ",(0,y.LH)(q-O)," ",k]})]}),(0,i.jsxs)("div",{className:"flex space-x-4 w-full pt-2",children:[(0,i.jsx)(p.z,{className:"w-1/2",onClick:ec,disabled:es||W||K||er||!J||!q||q<=BigInt(0)||void 0===O&&!G||void 0!==O&&O<q,children:es?(0,i.jsx)(v.Z,{className:"animate-spin"}):W?"1.授权中...":K?"1.确认中...":er?"1.已授权":"1.授权"}),(0,i.jsx)(p.z,{className:"w-1/2 text-white py-2 rounded-lg",onClick:S.handleSubmit(eh),disabled:!er||ef||em||ex||void 0===O&&!G||void 0!==O&&O<(q||BigInt(0)),children:ef?"2.铸造中...":em?"2.确认中...":ex?"2.铸造成功":"2.铸造"})]})]})}))]}),(0,i.jsx)(F.Z,{isLoading:ef||em||W||K,text:ef||W?"提交交易...":"确认交易..."})]}):(0,i.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,i.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})}function M(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.Z,{title:"铸造链群NFT",showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow px-3 sm:px-0",children:(0,i.jsx)("div",{className:"w-full max-w-2xl mx-auto",children:(0,i.jsx)(B,{})})})]})}}},function(e){e.O(0,[8501,4463,721,3494,8300,7966,2888,9774,179],function(){return e(e.s=40498)}),_N_E=e.O()}]);