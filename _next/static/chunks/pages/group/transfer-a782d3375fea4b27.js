try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d67abafe-3f99-4c7c-9e19-2fed376af878",e._sentryDebugIdIdentifier="sentry-dbid-d67abafe-3f99-4c7c-9e19-2fed376af878")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2921],{78191:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/group/transfer",function(){return r(53332)}])},74193:function(e,t,r){"use strict";r.d(t,{NI:function(){return j},Wi:function(){return p},l0:function(){return x},lX:function(){return y},pf:function(){return b},xJ:function(){return N},zG:function(){return _}});var n=r(34788),s=r(12796),a=r(72253),i=r(14932),o=r(47702),c=r(85893),l=r(67294),u=r(88426),d=r(87536),f=r(40108),m=r(94193),x=d.RV,h=l.createContext({}),p=function(e){var t=(0,n._)({},(0,s._)(e));return(0,c.jsx)(h.Provider,{value:{name:t.name},children:(0,c.jsx)(d.Qr,(0,a._)({},t))})},v=function(){var e=l.useContext(h),t=l.useContext(g),r=(0,d.Gc)(),n=r.getFieldState,s=r.formState,i=n(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");var o=t.id;return(0,a._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},i)},g=l.createContext({}),N=l.forwardRef(function(e,t){var r=e.className,n=(0,o._)(e,["className"]),s=l.useId();return(0,c.jsx)(g.Provider,{value:{id:s},children:(0,c.jsx)("div",(0,a._)({ref:t,className:(0,f.cn)("space-y-2",r)},n))})});N.displayName="FormItem";var y=l.forwardRef(function(e,t){var r=e.className,n=(0,o._)(e,["className"]),s=v(),i=s.error,l=s.formItemId;return(0,c.jsx)(m._,(0,a._)({ref:t,className:(0,f.cn)(i&&"text-destructive",r),htmlFor:l},n))});y.displayName="FormLabel";var j=l.forwardRef(function(e,t){var r=(0,n._)({},(0,s._)(e)),i=v(),o=i.error,l=i.formItemId,d=i.formDescriptionId,f=i.formMessageId;return(0,c.jsx)(u.g7,(0,a._)({ref:t,id:l,"aria-describedby":o?"".concat(d," ").concat(f):"".concat(d),"aria-invalid":!!o},r))});j.displayName="FormControl";var b=l.forwardRef(function(e,t){var r=e.className,n=(0,o._)(e,["className"]),s=v().formDescriptionId;return(0,c.jsx)("p",(0,a._)({ref:t,id:s,className:(0,f.cn)("text-sm text-muted-foreground",r)},n))});b.displayName="FormDescription";var _=l.forwardRef(function(e,t){var r=e.className,n=e.children,s=(0,o._)(e,["className","children"]),l=v(),u=l.error,d=l.formMessageId,m=u?String(null==u?void 0:u.message):n;return m?(0,c.jsx)("p",(0,i._)((0,a._)({ref:t,id:d,className:(0,f.cn)("text-sm font-medium text-destructive",r)},s),{children:m})):null});_.displayName="FormMessage"},94193:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var n=r(72253),s=r(47702),a=r(85893),i=r(67294),o=r(49102),c=r(12003),l=r(40108),u=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(function(e,t){var r=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)(o.f,(0,n._)({ref:t,className:(0,l.cn)(u(),r)},i))});d.displayName=o.f.displayName},27460:function(e,t,r){"use strict";var n=r(91309),s=r(85893),a=r(67294),i=r(74855),o=r(78865),c=r(18289),l=r(86501),u=r(91529);t.Z=function(e){var t=e.address,r=e.word,d=e.showCopyButton,f=e.showCopyLast4Button,m=e.showAddress,x=void 0===m||m,h=e.colorClassName,p=void 0===h?"":h,v=e.colorClassName2,g=void 0===v?"":v,N=(0,n._)((0,a.useState)(!1),2),y=N[0],j=N[1],b=(0,n._)((0,a.useState)(!1),2),_=b[0],w=b[1];(0,a.useEffect)(function(){j(!1),w(!1)},[t]);var I=function(e){e.preventDefault(),e.stopPropagation()};return(0,s.jsxs)("span",{className:"inline-flex items-center space-x-1",children:[r&&(0,s.jsx)("span",{className:"text-xs",children:r}),x&&!g&&(0,s.jsx)("span",{className:"font-mono text-xs ".concat(null!=p?p:"text-greyscale-500"),children:(0,u.Vu)(t)}),x&&g&&(0,s.jsxs)("span",{className:"text-[0px]",children:[(0,s.jsx)("span",{className:"font-mono text-xs ".concat(null!=p?p:"text-greyscale-500"),children:"".concat(t.substring(0,6),"...")}),(0,s.jsx)("span",{className:"font-mono text-xs ".concat(g),children:"".concat(t.substring(t.length-4))})]}),(void 0===d||d)&&(0,s.jsx)(i.CopyToClipboard,{text:t,onCopy:function(e,t){t?(j(!0),setTimeout(function(){return j(!1)},2e3)):l.ZP.error("复制失败")},children:(0,s.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:I,"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:y?(0,s.jsx)(o.Z,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")}):(0,s.jsx)(c.Z,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")})})}),void 0!==f&&f&&(0,s.jsx)(i.CopyToClipboard,{text:t.substring(t.length-4),onCopy:function(e,t){t?(w(!0),l.ZP.success("已复制后4位"),setTimeout(function(){return w(!1)},2e3)):l.ZP.error("复制失败")},children:(0,s.jsx)("button",{className:"text-xs px-2 py-1 rounded border border-gray-300 focus:outline-none active:bg-gray-200 md:hover:bg-gray-100 transition-colors",onClick:I,"aria-label":"复制地址后4位",style:{WebkitTapHighlightColor:"transparent"},children:_?(0,s.jsx)("span",{className:"".concat(null!=p?p:"text-greyscale-500"),children:"已复制"}):(0,s.jsx)("span",{className:"".concat(null!=p?p:"text-greyscale-500"),children:"后4位"})})})]})}},64777:function(e,t,r){"use strict";var n=r(85893);t.Z=function(e){var t=e.title;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},42083:function(e,t,r){"use strict";var n=r(85893),s=r(23432);t.Z=function(){return(0,n.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},92429:function(e,t,r){"use strict";r.d(t,{Fw:function(){return x},hq:function(){return p},Hw:function(){return v}});var n=r(48564),s=r(2267),a=r(75766),i=r(45775),o=r(60480),c=r(13550),l=r.n(c),u=function(e,t){for(var r=e;r.length<2*t;)r="0"+r;return r},d=function(e){return(e=(e=e.toUpperCase()).substr(4)+e.substr(0,4)).split("").map(function(e){var t=e.charCodeAt(0);return t>=65&&t<=90?(t-65+10).toString():e}).join("")},f=function(e){for(var t,r=e;r.length>2;)r=(parseInt(t=r.slice(0,9),10)%97).toString()+r.slice(t.length);return parseInt(r,10)%97},m=function(){function e(t){(0,n._)(this,e),(0,a._)(this,"_iban",void 0),this._iban=t}return(0,s._)(e,[{key:"isValid",value:function(){return/^TH[0-9]{2}(ETH[0-9A-Z]{13}|[0-9A-Z]{30,31})$/.test(this._iban)&&1===f(d(this._iban))}},{key:"isDirect",value:function(){return 34===this._iban.length||35===this._iban.length}},{key:"isIndirect",value:function(){return 20===this._iban.length}},{key:"checksum",value:function(){return this._iban.substr(2,2)}},{key:"toAddress",value:function(){if(this.isDirect()){var e=this._iban.substr(4),t=new(l())(e,36);return(0,i.K)("0x".concat(t.toString(16).padStart(40,"0")))}return""}},{key:"toString",value:function(){return this._iban}}],[{key:"fromAddress",value:function(t){if(!(0,o.U)(t))throw Error("Provided address is not a valid address: "+t);var r=t.replace("0x","").replace("0X",""),n=u(new(l())(r,16).toString(36),15);return e.fromBban(n.toUpperCase())}},{key:"fromBban",value:function(t){return new e("TH"+("0"+(98-f(d("TH00"+t)))).slice(-2)+t)}},{key:"toIban",value:function(t){return e.fromAddress(t).toString()}},{key:"toAddress",value:function(t){var r=new e(t);if(!r.isDirect())throw Error("IBAN is indirect and can't be converted");return r.toAddress()}},{key:"isValid",value:function(t){return new e(t).isValid()}}]),e}();function x(e){return/^0[Xx][A-Fa-f0-9]{40}$/.test(e)}function h(e){try{return m.isValid(e)}catch(e){return!1}}function p(e){if(!e||""===e)return"";var t=e.trim();return x(t)?t.toLowerCase():h(t)?function(e){if(!e||""===e)return"";if("TH48000000000000000000000000001EKI"===e)return"0x0000000000000000000000000000000000010002";try{return m.toAddress(e).toLowerCase()}catch(e){return console.error("转换TH地址为0x失败:",e),""}}(t):""}function v(e){if(!e||""===e.trim())return"请输入收款地址";var t=e.trim();return x(t)||h(t)&&p(t)?null:"请输入有效的地址格式（支持 0x、XE 或 TH 格式）"}},53332:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var n=r(91309),s=r(85893),a=r(11163),i=r(67294),o=r(37742),c=r(83494),l=r(11010),u=r(72253),d=r(14932),f=r(97582),m=r(86501),x=r(45901),h=r(56312),p=r(42130),v=r(87536),g=r(92429),N=r(27245),y=r(21774),j=r(74193),b=r(8300),_=r(73591),w=r(64777),I=r(42083),C=r(44576),k=r(27460),T=function(e){var t,r=e.tokenId,o=(0,a.useRouter)(),c=(0,p.m)().address,T=(0,n._)((0,i.useState)(""),2),F=T[0],Z=T[1],E=(0,n._)((0,i.useState)(null),2),S=E[0],A=E[1],D=(0,n._)((0,i.useState)(null),2),H=D[0],P=D[1],B=(0,b.nS)(r),R=B.groupName,X=B.isPending,V=B.error,L=(0,v.cI)({resolver:(0,h.F)(x.Ry({to:x.Z_().nonempty("请输入目标地址").refine(function(e){return null===(0,g.Hw)(e)},{message:"请输入有效的地址格式（支持 0x、TH 格式）"})})),defaultValues:{to:""},mode:"onChange"}),W=L.watch("to");(0,i.useEffect)(function(){if(!W||""===W.trim()){Z(""),A(null);return}var e=W.trim(),t=(0,g.hq)(e);if(!t){Z(""),A(null);return}e.startsWith("0x")?e.toLowerCase()!==t?(Z("地址已标准化"),A(t)):(Z(""),A(null)):(Z("将转换为:"),A(t))},[W]);var q=(0,b.vE)(),z=q.transferFrom,M=q.isPending,G=q.isConfirming,J=q.isConfirmed,U=q.writeError,K=q.hash,O=M||G;(0,i.useEffect)(function(){J&&K&&K!==H&&(m.Am.success("转移链群NFT成功"),L.reset(),P(K),setTimeout(function(){o.push("/group/groupids")},2e3))},[J,K,H,L,o]);var $=L.handleSubmit((t=(0,l._)(function(e){var t,n;return(0,f.Jh)(this,function(s){switch(s.label){case 0:if(!c)return m.Am.error("请先连接钱包"),[2];if(!(t=(0,g.hq)(e.to)))return m.Am.error("地址格式无效，请检查输入"),[2];s.label=1;case 1:return s.trys.push([1,3,,4]),console.log("执行NFT转移:",{from:c,to:n=t,tokenId:r}),[4,z(c,n,r)];case 2:return s.sent(),[3,4];case 3:return console.error("Transfer error:",s.sent()),[3,4];case 4:return[2]}})}),function(e){return t.apply(this,arguments)})),Q=(0,_.S)().handleContractError;if((0,i.useEffect)(function(){U&&Q(U,"group")},[U,Q]),X)return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)(w.Z,{title:"转移链群NFT"}),(0,s.jsx)("div",{className:"flex justify-center py-8",children:(0,s.jsx)(I.Z,{})})]});if(V)return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)(w.Z,{title:"转移链群NFT"}),(0,s.jsxs)("div",{className:"text-center text-red-500 mt-4",children:["加载NFT信息失败: ",V.message]})]});if(!R)return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)(w.Z,{title:"转移链群NFT"}),(0,s.jsx)("div",{className:"text-center text-gray-500 mt-4",children:"未找到NFT信息"})]});var Y=!c;return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)(w.Z,{title:"转移链群NFT"}),(0,s.jsx)("div",{className:"w-full max-w-md mx-auto mt-4",children:(0,s.jsx)(j.l0,(0,d._)((0,u._)({},L),{children:(0,s.jsxs)("form",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)(j.lX,{className:"text-sm font-medium text-gray-700",children:"链群 NFT"}),(0,s.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsxs)("span",{className:"mr-2 text-sm text-gray-500 font-mono",children:["(ID: ",r.toString(),")"]}),(0,s.jsx)("span",{className:"font-medium text-gray-800",children:R})]})]}),(0,s.jsx)(j.Wi,{control:L.control,name:"to",render:function(e){var t=e.field;return(0,s.jsxs)(j.xJ,{children:[(0,s.jsx)(j.lX,{className:"text-sm font-medium text-gray-700",children:"目标地址"}),(0,s.jsx)(j.NI,{children:(0,s.jsx)(y.I,(0,d._)((0,u._)({placeholder:"请输入目标钱包地址（支持 0x、TH 格式）"},t),{disabled:Y,className:"font-mono text-sm"}))}),F&&(0,s.jsxs)("div",{className:"text-xs text-blue-600 mt-1 flex items-center gap-1",children:[(0,s.jsx)("span",{children:F}),S&&(0,s.jsx)(k.Z,{address:S,showCopyButton:!0,showAddress:!0,colorClassName:"text-blue-600"})]}),(0,s.jsx)(j.zG,{})]})}}),(0,s.jsx)("div",{className:"flex space-x-2 pt-4",children:(0,s.jsx)(N.z,{className:"w-full",onClick:$,disabled:O||Y,size:"lg",children:O?"转移中...":"确认转移"})})]})}))}),(0,s.jsx)(C.Z,{isLoading:O,text:"转移中..."})]})};function F(){var e=(0,a.useRouter)(),t=(0,n._)((0,i.useState)(null),2),r=t[0],l=t[1];return((0,i.useEffect)(function(){var t=e.query.tokenId;if(t)try{var r=(0,o.Zu)(t);void 0!==r?l(r):console.error("无效的 tokenId 参数:",t)}catch(e){console.error("解析 tokenId 失败:",e)}},[e.query]),r)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{title:"转移链群NFT",showBackButton:!0}),(0,s.jsx)("main",{className:"flex-grow px-3 sm:px-0",children:(0,s.jsx)("div",{className:"w-full max-w-2xl mx-auto",children:(0,s.jsx)(T,{tokenId:r})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{title:"转移链群NFT",showBackButton:!0}),(0,s.jsx)("main",{className:"flex-grow px-3 sm:px-0",children:(0,s.jsx)("div",{className:"w-full max-w-2xl mx-auto",children:(0,s.jsx)("div",{className:"flex justify-center py-8",children:(0,s.jsx)(I.Z,{})})})})]})}}},function(e){e.O(0,[8501,4463,721,3494,3591,8300,2888,9774,179],function(){return e(e.s=78191)}),_N_E=e.O()}]);