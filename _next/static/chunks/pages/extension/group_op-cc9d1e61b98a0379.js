try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7941a9a9-64f6-469d-be0b-965fb38b30a6",e._sentryDebugIdIdentifier="sentry-dbid-7941a9a9-64f6-469d-be0b-965fb38b30a6")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1203],{48014:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/extension/group_op",function(){return r(280)}])},74193:function(e,n,r){"use strict";r.d(n,{NI:function(){return b},Wi:function(){return p},l0:function(){return f},lX:function(){return y},pf:function(){return N},xJ:function(){return j},zG:function(){return A}});var t=r(34788),s=r(12796),i=r(72253),a=r(14932),o=r(47702),c=r(85893),l=r(67294),d=r(88426),u=r(87536),m=r(40108),x=r(94193),f=u.RV,h=l.createContext({}),p=function(e){var n=(0,t._)({},(0,s._)(e));return(0,c.jsx)(h.Provider,{value:{name:n.name},children:(0,c.jsx)(u.Qr,(0,i._)({},n))})},v=function(){var e=l.useContext(h),n=l.useContext(g),r=(0,u.Gc)(),t=r.getFieldState,s=r.formState,a=t(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,i._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},a)},g=l.createContext({}),j=l.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=l.useId();return(0,c.jsx)(g.Provider,{value:{id:s},children:(0,c.jsx)("div",(0,i._)({ref:n,className:(0,m.cn)("space-y-2",r)},t))})});j.displayName="FormItem";var y=l.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=v(),a=s.error,l=s.formItemId;return(0,c.jsx)(x._,(0,i._)({ref:n,className:(0,m.cn)(a&&"text-destructive",r),htmlFor:l},t))});y.displayName="FormLabel";var b=l.forwardRef(function(e,n){var r=(0,t._)({},(0,s._)(e)),a=v(),o=a.error,l=a.formItemId,u=a.formDescriptionId,m=a.formMessageId;return(0,c.jsx)(d.g7,(0,i._)({ref:n,id:l,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},r))});b.displayName="FormControl";var N=l.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=v().formDescriptionId;return(0,c.jsx)("p",(0,i._)({ref:n,id:s,className:(0,m.cn)("text-sm text-muted-foreground",r)},t))});N.displayName="FormDescription";var A=l.forwardRef(function(e,n){var r=e.className,t=e.children,s=(0,o._)(e,["className","children"]),l=v(),d=l.error,u=l.formMessageId,x=d?String(null==d?void 0:d.message):t;return x?(0,c.jsx)("p",(0,a._)((0,i._)({ref:n,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",r)},s),{children:x})):null});A.displayName="FormMessage"},94193:function(e,n,r){"use strict";r.d(n,{_:function(){return u}});var t=r(72253),s=r(47702),i=r(85893),a=r(67294),o=r(49102),c=r(12003),l=r(40108),d=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=a.forwardRef(function(e,n){var r=e.className,a=(0,s._)(e,["className"]);return(0,i.jsx)(o.f,(0,t._)({ref:n,className:(0,l.cn)(d(),r)},a))});u.displayName=o.f.displayName},88659:function(e,n,r){"use strict";r.d(n,{Bw:function(){return g},Ph:function(){return x},Ql:function(){return j},i4:function(){return h},ki:function(){return f}});var t=r(72253),s=r(14932),i=r(47702),a=r(85893),o=r(67294),c=r(76405),l=r(42171),d=r(15432),u=r(78865),m=r(40108),x=c.fC;c.ZA;var f=c.B4,h=o.forwardRef(function(e,n){var r=e.className,o=e.children,d=(0,i._)(e,["className","children"]);return(0,a.jsxs)(c.xz,(0,s._)((0,t._)({ref:n,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r)},d),{children:[o,(0,a.jsx)(c.JO,{asChild:!0,children:(0,a.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]}))});h.displayName=c.xz.displayName;var p=o.forwardRef(function(e,n){var r=e.className,o=(0,i._)(e,["className"]);return(0,a.jsx)(c.u_,(0,s._)((0,t._)({ref:n,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})}))});p.displayName=c.u_.displayName;var v=o.forwardRef(function(e,n){var r=e.className,o=(0,i._)(e,["className"]);return(0,a.jsx)(c.$G,(0,s._)((0,t._)({ref:n,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})}))});v.displayName=c.$G.displayName;var g=o.forwardRef(function(e,n){var r=e.className,o=e.children,l=e.position,d=void 0===l?"popper":l,u=(0,i._)(e,["className","children","position"]);return(0,a.jsx)(c.h_,{children:(0,a.jsxs)(c.VY,(0,s._)((0,t._)({ref:n,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:d},u),{children:[(0,a.jsx)(p,{}),(0,a.jsx)(c.l_,{className:(0,m.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),(0,a.jsx)(v,{})]}))})});g.displayName=c.VY.displayName,o.forwardRef(function(e,n){var r=e.className,s=(0,i._)(e,["className"]);return(0,a.jsx)(c.__,(0,t._)({ref:n,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r)},s))}).displayName=c.__.displayName;var j=o.forwardRef(function(e,n){var r=e.className,o=e.children,l=(0,i._)(e,["className","children"]);return(0,a.jsxs)(c.ck,(0,s._)((0,t._)({ref:n,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r)},l),{children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(c.wU,{children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(c.eT,{children:o})]}))});j.displayName=c.ck.displayName,o.forwardRef(function(e,n){var r=e.className,s=(0,i._)(e,["className"]);return(0,a.jsx)(c.Z0,(0,t._)({ref:n,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",r)},s))}).displayName=c.Z0.displayName},76453:function(e,n,r){"use strict";r.d(n,{g:function(){return c}});var t=r(72253),s=r(47702),i=r(85893),a=r(67294),o=r(40108),c=a.forwardRef(function(e,n){var r=e.className,a=(0,s._)(e,["className"]);return(0,i.jsx)("textarea",(0,t._)({className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:n},a))});c.displayName="Textarea"},42083:function(e,n,r){"use strict";var t=r(85893),s=r(23432);n.Z=function(){return(0,t.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},21973:function(e,n,r){"use strict";var t=r(85893),s=r(67294),i=r(86501);n.Z=function(e){var n=e.isOpen,r=e.onClose,a=e.onConfirm,o=e.title,c=e.description,l=e.placeholder,d=(0,s.useRef)(null);return((0,s.useEffect)(function(){var e=function(e){"Escape"===e.key&&r()};return n&&(document.addEventListener("keydown",e),setTimeout(function(){var e;null===(e=d.current)||void 0===e||e.focus()},100)),function(){document.removeEventListener("keydown",e)}},[n,r]),n)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000] p-5",onClick:function(e){e.target===e.currentTarget&&r()},children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md text-center shadow-xl",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:void 0===o?"粘贴分数数据":o}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4 leading-relaxed",children:void 0===c?"请将复制的分数数据粘贴到下方文本框中（每行一个数字）":c}),(0,t.jsx)("textarea",{ref:d,placeholder:void 0===l?"请粘贴分数数据...":l,className:"w-full h-32 p-3 border border-gray-300 rounded-md font-mono text-sm resize-none mb-4 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"}),(0,t.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,t.jsx)("button",{onClick:function(){var e,n=(null===(e=d.current)||void 0===e?void 0:e.value.trim())||"";n?(a(n),r()):i.Am.error("请输入分数数据")},className:"px-4 py-2 bg-[#1e3a8a] text-white rounded-md hover:bg-gray-500/90 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-medium",children:"确认粘贴"}),(0,t.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors font-medium",children:"取消"})]})]})}):null}},84668:function(e,n,r){"use strict";r.d(n,{Q:function(){return a}});var t=r(67294),s=r(67516),i=r(67959),a=function(e){var n=e.tokenAddress,r=e.actionId,a=e.accounts,o=e.verificationKeys,c=e.round,l=e.enabled,d=void 0===l||l,u=(0,t.useMemo)(function(){if(!d||0===a.length||0===o.length||!n)return[];var e=[];return a.forEach(function(t){o.forEach(function(s){e.push({address:"0x37Ddf561323b823144BaE33264f9C5461714846e",abi:i.z,functionName:"verificationInfoByRound",args:[n,r,t,s,c]})})}),e},[n,r,a,o,c,d]),m=(0,s.N)({contracts:u,query:{enabled:d&&u.length>0}}),x=m.data,f=m.isLoading,h=m.error,p=m.isSuccess,v=(0,t.useMemo)(function(){if(!d||0===a.length||0===o.length)return{infos:[],isLoading:!1,hasError:!1,allLoaded:!0};var e=a.map(function(e,n){var r=[],t=!1,s=null;return o.forEach(function(e,i){var a=n*o.length+i,c=null==x?void 0:x[a];(null==c?void 0:c.status)==="success"?r.push(c.result||""):(r.push(""),(null==c?void 0:c.status)==="failure"&&(t=!0,s=c.error))}),{account:e,infos:r,isPending:f,error:t?s:null}}),n=!!h||e.some(function(e){return null!==e.error});return{infos:e,isLoading:f,hasError:n,allLoaded:p}},[x,a,o,d,f,h,p]);return{verificationInfos:v.infos,isLoading:v.isLoading,isPending:v.isLoading,hasError:v.hasError,allLoaded:v.allLoaded,error:h||null,getInfosByAccount:function(e){var n=v.infos.find(function(n){return n.account.toLowerCase()===e.toLowerCase()});return(null==n?void 0:n.infos)||[]},getInfosMap:function(){var e={};return v.infos.forEach(function(n){e[n.account]=n.infos}),e},hasValidData:d&&a.length>0&&o.length>0&&!!n}}},85794:function(e,n,r){"use strict";r.d(n,{A5:function(){return f},DA:function(){return v},hS:function(){return m},l3:function(){return p},yA:function(){return h},yG:function(){return u},z4:function(){return x}});var t=r(11010),s=r(97582),i=r(67294),a=r(71104),o=r(37541),c=r(37742),l=r(37474),d=r(84689),u=function(e,n,r){var t=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=(0,a.u)({address:e,abi:o.O,functionName:"allowance",args:[n,r],query:{enabled:!!e&&!!n&&!!r&&t}}),i=s.data,l=s.isPending,d=s.error,u=s.refetch;return{allowance:void 0!==i?(0,c.Z)(i):void 0,isPending:l,error:d,refetch:u}},m=function(e,n){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],t=(0,a.u)({address:e,abi:o.O,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n&&r}}),s=t.data,i=t.isPending,l=t.error,d=t.refetch;return{balance:void 0!==s?(0,c.Z)(s):void 0,isPending:i,error:l,refetch:d}},x=function(e){var n=(0,a.u)({address:e,abi:o.O,functionName:"symbol",args:[],query:{enabled:!!e}});return{symbol:n.data,isPending:n.isPending,error:n.error}},f=function(e){var n=(0,a.u)({address:e,abi:o.O,functionName:"totalSupply",args:[],query:{enabled:!!e}}),r=n.data,t=n.isPending,s=n.error;return{totalSupply:void 0!==r?(0,c.Z)(r):void 0,isPending:t,error:s}};function h(e){var n,r=(0,l.e9)(o.O,e,"approve"),a=r.execute,c=r.isPending,u=r.isConfirming,m=r.isConfirmed,x=r.error,f=r.hash,h=r.isTukeMode,p=(n=(0,t._)(function(n,r){return(0,s.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交approve交易:",{token:e,spender:n,value:r,isTukeMode:h}),[4,a([n,r])];case 1:return[2,t.sent()]}})}),function(e,r){return n.apply(this,arguments)});return(0,i.useEffect)(function(){f&&console.log("approve tx hash:",f),x&&(console.log("提交approve交易错误:"),(0,d.Vh)(x),(0,d.H)(x))},[f,x]),{approve:p,isPending:c,isConfirming:u,writeError:x,isConfirmed:m,hash:f,isTukeMode:h}}function p(e){var n,r=(0,l.e9)(o.O,e,"burnForParentToken"),a=r.execute,c=r.isPending,u=r.isConfirming,m=r.isConfirmed,x=r.error,f=r.hash,h=r.isTukeMode,p=(n=(0,t._)(function(n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交burnForParentToken交易:",{token:e,amount:n,isTukeMode:h}),[4,a([n])];case 1:return[2,r.sent()]}})}),function(e){return n.apply(this,arguments)});return(0,i.useEffect)(function(){f&&console.log("burnForParentToken tx hash:",f),x&&(console.log("提交burnForParentToken交易错误:"),(0,d.Vh)(x),(0,d.H)(x))},[f,x]),{burnForParentToken:p,isPending:c,isConfirming:u,writeError:x,isConfirmed:m,hash:f,isTukeMode:h}}function v(e){var n,r=(0,l.e9)(o.O,e,"transfer"),a=r.execute,c=r.isPending,u=r.isConfirming,m=r.isConfirmed,x=r.error,f=r.hash,h=r.isTukeMode,p=(n=(0,t._)(function(n,r){return(0,s.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交transfer交易:",{token:e,to:n,amount:r,isTukeMode:h}),[4,a([n,r])];case 1:return[2,t.sent()]}})}),function(e,r){return n.apply(this,arguments)});return(0,i.useEffect)(function(){f&&console.log("transfer tx hash:",f),x&&(console.log("提交transfer交易错误:"),(0,d.Vh)(x),(0,d.H)(x))},[f,x]),{transfer:p,isPending:c,isConfirming:u,writeError:x,isConfirmed:m,hash:f,isTukeMode:h}}},15206:function(e,n,r){"use strict";r.d(n,{k:function(){return c}});var t=r(67516),s=r(50095),i=r(8300),a=r(37742),o="0xA0a5BB442214988D0c6e707d825640C026fB1d04";function c(e){for(var n=!!e,r=(0,i.hS)(e||"0x0000000000000000000000000000000000000000",n),c=r.balance,l=r.isPending,d=r.error,u=n&&void 0!==c?Number(c):0,m=[],x=0;x<u;x++)m.push({address:o,abi:s.s,functionName:"tokenOfOwnerByIndex",args:[e,BigInt(x)]});var f=(0,t.N)({contracts:m,query:{enabled:n&&u>0}}),h=f.data,p=f.isPending,v=f.error,g=null==h?void 0:h.map(function(e){return e.result?(0,a.Z)(e.result):void 0}).filter(Boolean),j=(null==g?void 0:g.map(function(e){return{address:o,abi:s.s,functionName:"groupNameOf",args:[e]}}))||[],y=(0,t.N)({contracts:j,query:{enabled:n&&g&&g.length>0}}),b=y.data,N=y.isPending,A=y.error,I=n&&g?g.map(function(e,n){var r;return{tokenId:e,groupName:(null==b?void 0:null===(r=b[n])||void 0===r?void 0:r.result)||""}}):[],w=!!n&&(l||u>0&&(p||N)),_=n?d||v||A:void 0;return{myGroups:I,balance:n&&void 0!==c?c:BigInt(0),isPending:w,error:_}}},55976:function(e,n,r){"use strict";r.d(n,{k:function(){return a}});var t=r(48564),s=r(2267),i=r(88421),a=function(){function e(){(0,t._)(this,e)}return(0,s._)(e,null,[{key:"isClient",value:function(){return!0}},{key:"serialize",value:function(e){return JSON.stringify(e,function(e,n){return(void 0===n?"undefined":(0,i._)(n))==="bigint"?n.toString():n})}},{key:"deserialize",value:function(e){return JSON.parse(e,function(e,n){return n})}},{key:"get",value:function(e){if(!this.isClient())return null;try{var n=localStorage.getItem(e);if(!n)return null;var r=this.deserialize(n);if(r.expiresAt&&Date.now()>r.expiresAt)return localStorage.removeItem(e),null;return r.data}catch(n){return console.error("读取缓存失败 [".concat(e,"]:"),n),null}}},{key:"set",value:function(e,n,r){if(this.isClient())try{var t={data:n,timestamp:Date.now()};(null==r?void 0:r.expiresIn)&&(t.expiresAt=Date.now()+r.expiresIn),localStorage.setItem(e,this.serialize(t))}catch(n){console.error("保存缓存失败 [".concat(e,"]:"),n)}}},{key:"remove",value:function(e){if(this.isClient())try{localStorage.removeItem(e)}catch(n){console.error("删除缓存失败 [".concat(e,"]:"),n)}}},{key:"has",value:function(e){if(!this.isClient())return!1;try{var n=localStorage.getItem(e);if(!n)return!1;var r=this.deserialize(n);if(r.expiresAt&&Date.now()>r.expiresAt)return localStorage.removeItem(e),!1;return!0}catch(n){return console.error("检查缓存失败 [".concat(e,"]:"),n),!1}}},{key:"clear",value:function(){if(this.isClient())try{localStorage.clear()}catch(e){console.error("清除所有缓存失败:",e)}}}]),e}()},49189:function(e,n,r){"use strict";r.d(n,{P:function(){return l}});var t,s,i=r(11010),a=r(97582),o=r(86501),c=(t=(0,i._)(function(e){var n,r;return(0,a.Jh)(this,function(t){switch(t.label){case 0:if(!(navigator.clipboard&&navigator.clipboard.writeText))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(e)];case 2:return t.sent(),[2,{success:!0,method:"clipboard"}];case 3:return console.warn("Clipboard API 失败，尝试降级方案:",t.sent()),[3,4];case 4:try{if((n=document.createElement("textarea")).value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",n.style.opacity="0",n.style.pointerEvents="none",n.setAttribute("readonly",""),document.body.appendChild(n),n.focus(),n.select(),n.setSelectionRange(0,n.value.length),r=document.execCommand("copy"),document.body.removeChild(n),r)return[2,{success:!0,method:"execCommand"}]}catch(e){console.warn("execCommand 复制失败:",e)}return[2,{success:!1,method:"manual",error:"浏览器不支持自动复制，需要手动复制"}]}})}),function(e){return t.apply(this,arguments)}),l=(s=(0,i._)(function(e,n,r){var t;return(0,a.Jh)(this,function(s){switch(s.label){case 0:return[4,c(e)];case 1:return(t=s.sent()).success?o.Am.success(n):r?r(e):o.Am.error(t.error||"复制失败，请手动复制"),[2]}})}),function(e,n,r){return s.apply(this,arguments)})},280:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return ed}});var t=r(72253),s=r(14932),i=r(85893),a=r(67294),o=r(11163),c=r(93778),l=r(93566),d=r(92112),u=r(8300),m=r(27966),x=r(42083),f=r(83494),h=r(11010),p=r(91309),v=r(97582),g=r(41664),j=r.n(g),y=r(56312),b=r(86501),N=r(87536),A=r(42130),I=r(45901),w=r(79711),_=r(27245),C=r(74193),k=r(21774),B=r(88659),J=r(76453),P=r(85794),E=r(15206),S=r(38442),M=r(21879),L=r(87974),Z=r(933),z=r(91529),F=r(64777),R=r(44576),T=function(e){var n=e.activationMinGovRatio,r=(e.maxJoinAmountRatio,e.joinMaxAmount,e.groupActivationStakeAmount),t=n?(0,z.rl)(100*Number(n)/1e18):"0%";return(0,i.jsxs)("div",{className:"text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:[(0,i.jsx)("div",{className:"flex items-center gap-2 text-sm font-bold text-blue-800",children:"\uD83D\uDCA1小贴士"}),(0,i.jsxs)("div",{className:"flex flex-col space-y-2 text-gray-700 ",children:[(0,i.jsx)("div",{className:"text-sm text-blue-700 pt-3",children:"激活要求："}),(0,i.jsxs)("div",{children:["激活链群需质押代币数量：",(0,i.jsx)("b",{children:(0,z.LH)(r||BigInt(0),4,"ceil")})]}),(0,i.jsxs)("div",{children:["激活链群最小治理票比例：",(0,i.jsx)("b",{children:t})]}),(0,i.jsx)("div",{className:"text-sm text-blue-700 pt-3",children:"参与代币："}),(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"行动最大参与代币量"})," = 已铸造代币总量 \xd7 最大参与代币占比 \xd7 该行动投票率"]})]})]})},D=function(e){var n=e.tokenSymbol,r=void 0===n?"":n,t=e.isTokenApproved,s=e.isPendingApprove,a=e.isConfirmingApprove,o=e.onApprove,c=e.isPendingAction,l=e.isConfirmingAction,d=e.isConfirmedAction,u=e.onAction,m=e.actionLabel,x=e.actionLabelPending,f=e.actionLabelConfirming,h=e.actionLabelConfirmed,p=e.disableApprove,v=e.disableAction;return(0,i.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,i.jsx)(_.z,{className:"w-1/2",disabled:s||a||t||void 0!==p&&p,type:"button",onClick:o,children:t?"1.".concat(r,"已授权"):"1.授权".concat(r)}),(0,i.jsx)(_.z,{className:"w-1/2",disabled:!t||c||l||d||void 0!==v&&v,type:"button",onClick:u,children:c?x||"2.提交中...":l?f||"2.确认中...":d?h||"2.已完成":"2.".concat(m)})]})},G="0x0000000000000000000000000000000000000000",V=function(e){var n=e.actionId,r=(e.actionInfo,e.extensionAddress),l=e.groupId,d=(0,o.useRouter)(),u=((0,a.useContext)(c.M)||{}).token,f=(0,A.m)().address,g=(0,E.k)(f),V=g.myGroups,O=g.isPending,H=g.error,X=(0,p._)((0,a.useState)(l),2),q=X[0],W=X[1],Q=(0,p._)((0,a.useState)(!1),2),K=Q[0],U=Q[1],$=l||q,Y=(0,L.gO)(r,f||G),ee=Y.activeGroupIds,en=Y.isPending,er=Y.error,et=(0,a.useMemo)(function(){return V&&ee?V.filter(function(e){return!ee.some(function(n){return n===e.tokenId})}):V},[V,ee]);(0,a.useEffect)(function(){l||!et||1!==et.length||q||W(et[0].tokenId)},[l,et,q]);var es=(0,M.DM)({actionId:n,extensionAddress:r}),ei=es.params,ea=es.isPending,eo=es.error,ec=(0,S.r)({tokenAddress:null==ei?void 0:ei.joinTokenAddress,tokenSymbol:null==ei?void 0:ei.joinTokenSymbol,enabled:!!(null==ei?void 0:ei.joinTokenAddress)}),el=ec.formattedSymbol,ed=ec.isPending,eu=(null==ei?void 0:ei.groupActivationStakeAmount)||BigInt(0),em=(0,Z.Ty)((null==ei?void 0:ei.tokenAddress)||G,f||G,!!(null==ei?void 0:ei.tokenAddress)&&!!f).validGovVotes,ex=(0,Z.kc)((null==ei?void 0:ei.tokenAddress)||G).govVotesNum,ef=(0,a.useMemo)(function(){return em&&ex&&ex!==BigInt(0)?em*BigInt(1e18)/ex:BigInt(0)},[em,ex]),eh=(null==ei?void 0:ei.activationMinGovRatio)||BigInt(0),ep=ef<eh,ev=(0,P.hS)((null==ei?void 0:ei.tokenAddress)||G,f||G,!!(null==ei?void 0:ei.tokenAddress)&&!!f),eg=ev.balance,ej=ev.isPending,ey=ev.error,eb=(0,a.useMemo)(function(){return I.Ry({maxCapacity:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseFloat(e);return!isNaN(n)&&n>=0},{message:"请输入有效的容量上限"}),description:I.Z_().max(2e3,{message:"描述不能超过2000字"}),minJoinAmount:I.Z_().refine(function(e){if(!e||""===e.trim()||"0"===e)return!1;var n=parseFloat(e);return!isNaN(n)&&n>0},{message:"最小参与代币数不能为空且必须大于0"}).superRefine(function(e,n){if(!e||"0"===e){n.addIssue({code:w.NL.custom,message:"最小参与代币数不能为0"});return}var r=(0,z.vz)(e);r>BigInt(0)&&(null==ei?void 0:ei.joinMaxAmount)&&r>ei.joinMaxAmount&&n.addIssue({code:w.NL.custom,message:"不能大于全局最大参与量 ".concat((0,z.LH)(ei.joinMaxAmount,2)," ").concat((null==u?void 0:u.symbol)||"")})}),maxJoinAmount:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseFloat(e);return!isNaN(n)&&n>=0},{message:"请输入有效的代币数"}).superRefine(function(e,n){if(e&&"0"!==e){var r=(0,z.vz)(e);r>BigInt(0)&&(null==ei?void 0:ei.joinMaxAmount)&&r>ei.joinMaxAmount&&n.addIssue({code:w.NL.custom,message:"不能大于全局最大参与量 ".concat((0,z.LH)(ei.joinMaxAmount,2)," ").concat((null==u?void 0:u.symbol)||"")})}}),maxAccounts:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseInt(e,10);return!isNaN(n)&&n>=0&&Number.isInteger(n)},{message:"请输入有效的非负整数"})}).refine(function(e){var n=(0,z.vz)(e.minJoinAmount||"0"),r=(0,z.vz)(e.maxJoinAmount||"0");return!(n>BigInt(0)&&r>BigInt(0)&&r<n)},{message:"最大参与量不能小于最小参与量",path:["maxJoinAmount"]})},[ei,u]),eN=(0,N.cI)({resolver:(0,y.F)(eb),defaultValues:{maxCapacity:"",description:"",minJoinAmount:"",maxJoinAmount:"",maxAccounts:""},mode:"onChange"}),eA=(0,P.yG)((null==ei?void 0:ei.tokenAddress)||G,f||G,"0xf2084E73bF047aF26d72CEFde25e22536a1f37C8",!!(null==ei?void 0:ei.tokenAddress)&&!!f),eI=eA.allowance,ew=(eA.isPending,eA.error),e_=eA.refetch,eC=void 0!==eI&&eI>=eu,ek=(0,P.yA)((null==ei?void 0:ei.tokenAddress)||G),eB=ek.approve,eJ=ek.isPending,eP=ek.isConfirming,eE=ek.isConfirmed,eS=ek.writeError;function eM(){return(eM=(0,h._)(function(e){return(0,v.Jh)(this,function(e){switch(e.label){case 0:if(!eu||eu===BigInt(0))return b.Am.error("激活需质押代币数量未设置"),[2];if(void 0!==eg&&eg<eu)return b.Am.error("余额不足，需要 ".concat((0,z.LH)(eu)," ").concat(null==u?void 0:u.symbol)),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,eB("0xf2084E73bF047aF26d72CEFde25e22536a1f37C8",eu)];case 2:return e.sent(),[3,4];case 3:return console.error("Approve failed",e.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){eE&&(b.Am.success("授权成功"),e_())},[eE,e_]);var eL=(0,L.EU)(),eZ=eL.activateGroup,ez=eL.isPending,eF=eL.isConfirming,eR=eL.isConfirmed,eT=eL.writeError;function eD(){return(eD=(0,h._)(function(e){var n,t,s,i;return(0,v.Jh)(this,function(a){switch(a.label){case 0:if(!ei)return b.Am.error("扩展协议参数未加载完成"),[2];if(!$)return b.Am.error("请选择要激活的链群"),[2];if(!eC)return b.Am.error("请先授权质押代币"),[2];if(ep)return b.Am.error("治理票占比不足，无法激活链群"),[2];if(n=e.maxCapacity?(0,z.vz)(e.maxCapacity):BigInt(0),!e.minJoinAmount||"0"===e.minJoinAmount)return b.Am.error("最小参与代币数不能为0"),[2];if((t=(0,z.vz)(e.minJoinAmount))<=BigInt(0))return b.Am.error("最小参与代币数必须大于0"),[2];s=e.maxJoinAmount?(0,z.vz)(e.maxJoinAmount):BigInt(0),i=e.maxAccounts&&"0"!==e.maxAccounts?BigInt(parseInt(e.maxAccounts,10)):BigInt(0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,eZ(r,$,e.description,n,t,s,i)];case 2:return a.sent(),[3,4];case 3:return console.error("Activate group failed",a.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){eR&&(b.Am.success("链群激活成功"),U(!0),setTimeout(function(){d.push("/action/info/?id=".concat(n.toString(),"&symbol=").concat(null==u?void 0:u.symbol,"&tab=public"))},1500))},[eR,d,n,null==u?void 0:u.symbol]);var eG=(0,m.b)().handleError;return((0,a.useEffect)(function(){eo&&eG(eo),ey&&eG(ey),ew&&eG(ew),eS&&eG(eS),eT&&eG(eT),H&&eG(H),er&&eG(er)},[eo,ey,ew,eS,eT,H,er,eG]),ea||ej||ed||!l&&(O||en))?(0,i.jsxs)("div",{className:"flex flex-col items-center py-8",children:[(0,i.jsx)(x.Z,{}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"加载参数中..."})]}):ez||K||l||et&&0!==et.length?ei?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{children:(0,i.jsx)(F.Z,{title:"激活链群"})}),ep&&(0,i.jsxs)("div",{className:"text-sm text-red-700 bg-red-50 border border-red-200 rounded px-3 py-2",children:[(0,i.jsx)("div",{className:"font-medium",children:"⚠️ 治理票占比不足"}),(0,i.jsxs)("div",{className:"mt-1",children:["你的治理票占比"," ",(0,i.jsx)("span",{className:"font-semibold",children:(0,z.rl)(100*Number(ef)/1e18)})," ","低于最小限制 ",(0,i.jsx)("span",{className:"font-semibold",children:(0,z.rl)(100*Number(eh)/1e18)}),"，无法激活链群。"]}),(0,i.jsx)("div",{className:"text-xs text-red-600 mt-1",children:"您可以增加治理票数，再尝试激活链群。"})]}),!l&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"选择链群NFT"}),(0,i.jsxs)(B.Ph,{value:(null==q?void 0:q.toString())||"",onValueChange:function(e){return W(BigInt(e))},children:[(0,i.jsx)(B.i4,{className:"!ring-secondary-foreground",children:(0,i.jsx)(B.ki,{placeholder:"请选择要激活的链群"})}),(0,i.jsx)(B.Bw,{children:null==et?void 0:et.map(function(e){return(0,i.jsx)(B.Ql,{value:e.tokenId.toString(),children:e.groupName||"链群 #".concat(e.tokenId.toString())},e.tokenId.toString())})})]}),!q&&(0,i.jsx)("p",{className:"text-xs text-red-500",children:"请选择一个链群"})]}),(0,i.jsx)(C.l0,(0,s._)((0,t._)({},eN),{children:(0,i.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,i.jsx)(C.Wi,{control:eN.control,name:"maxCapacity",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["链群容量上限 ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:el})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"0 为不限制",className:"!ring-secondary-foreground flex-1"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:eN.control,name:"description",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsx)(C.lX,{children:"链群描述"}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(J.g,(0,t._)({placeholder:"例如：一些注意事项，以及如何联系到链群服务者，如何加入所在链群的行动者群（例如：QQ 群、微信验证群）等",className:"!ring-secondary-foreground min-h-[100px]"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:eN.control,name:"minJoinAmount",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["单地址最小参与代币数"," ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:el})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"请填写数量，必须大于0",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.pf,{className:"text-xs",children:"最小参与代币数必须大于0"}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:eN.control,name:"maxJoinAmount",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["单地址最大参与代币数"," ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:el})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"0 为不做限制",className:"!ring-secondary-foreground"},n))}),(null==ei?void 0:ei.joinMaxAmount)&&ei.joinMaxAmount>BigInt(0)&&(0,i.jsxs)(C.pf,{className:"text-xs",children:["扩展行动当前最大参与量：",(0,z.LH)(ei.joinMaxAmount)]}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:eN.control,name:"maxAccounts",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsx)(C.lX,{children:"行动者最大地址数"}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"0 为不做限制",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsxs)("div",{className:"p-4 border rounded-lg ".concat(void 0!==eg&&eg<eu?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"),children:[(0,i.jsx)("div",{className:"text-sm mb-1 ".concat(void 0!==eg&&eg<eu?"text-red-800":"text-gray-800"),children:"激活链群需质押代币："}),(0,i.jsx)("div",{className:"text-lg font-semibold ".concat(void 0!==eg&&eg<eu?"text-red-900":"text-blue-900"),children:(0,i.jsxs)("span",{className:"flex items-center gap-1",children:[(0,z.LH)(eu,4,"ceil")," ",(0,i.jsx)("span",{className:"text-sm text-gray-600",children:null==ei?void 0:ei.stakeTokenSymbol})]})}),(0,i.jsxs)("div",{className:"text-xs mt-1 ".concat(void 0!==eg&&eg<eu?"text-red-600":"text-gray-600"),children:["当前余额：",(0,z.LH)(eg||BigInt(0))]}),void 0!==eg&&eg<eu&&(0,i.jsx)("div",{className:"text-xs text-red-700 font-medium mt-2",children:"⚠️ 余额不足，无法激活链群"})]}),(0,i.jsx)(D,{tokenSymbol:null==u?void 0:u.symbol,isTokenApproved:eC,isPendingApprove:eJ,isConfirmingApprove:eP,onApprove:function(){return eN.handleSubmit(function(e){return function(e){return eM.apply(this,arguments)}(e)})()},isPendingAction:ez,isConfirmingAction:eF,isConfirmedAction:eR,onAction:function(){return eN.handleSubmit(function(e){return function(e){return eD.apply(this,arguments)}(e)})()},actionLabel:"激活链群",actionLabelPending:"2.提交中...",actionLabelConfirming:"2.确认中...",actionLabelConfirmed:"2.已激活",disableApprove:ep,disableAction:!$||void 0!==eg&&eg<eu||ep})]})})),(0,i.jsx)(T,{activationMinGovRatio:null==ei?void 0:ei.activationMinGovRatio,maxJoinAmountRatio:null==ei?void 0:ei.maxJoinAmountRatio,joinMaxAmount:null==ei?void 0:ei.joinMaxAmount,groupActivationStakeAmount:null==ei?void 0:ei.groupActivationStakeAmount})]}),(0,i.jsx)(R.Z,{isLoading:eJ||eP||ez||eF,text:eJ?"授权中...":eP?"确认授权...":ez?"激活中...":"确认激活..."})]}):(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-red-500",children:"未找到扩展参数"})}):(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"mb-4 text-gray-500",children:V&&V.length>0?"您的所有链群已激活，没有未激活链群":"没有未激活的 链群NFT"}),(0,i.jsx)("p",{className:"mb-4",children:(0,i.jsx)(j(),{href:"/group/groupids/",children:(0,i.jsx)(_.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",children:"去铸造链群NFT >>"})})})]})},O=r(72260),H=r(48886),X=function(e){e.actionId,e.actionInfo;var n=e.extensionAddress,r=e.groupId,t=(0,o.useRouter)(),s=((0,a.useContext)(c.M)||{}).token,l=(0,L.iF)(n,r),d=l.activatedRound,u=l.isPending,f=l.error,p=(0,O.Bk)(),g=p.currentRound,j=p.isPending,y=p.error,N=(0,a.useMemo)(function(){return g?g+BigInt(1):void 0},[g]),A=(0,M.Av)({extensionAddress:n,groupId:r,round:N}),I=A.groupDetail,w=A.isPending,C=A.error,k=g>BigInt(0)?g-BigInt(1):BigInt(0),B=(0,H.oi)(n,k,r),J=B.count,P=B.isPending,E=B.error,S=(0,L.M3)(),Z=S.deactivateGroup,T=S.isPending,D=S.isConfirming,G=S.isConfirmed,V=S.writeError;function X(){return(X=(0,h._)(function(){return(0,v.Jh)(this,function(e){switch(e.label){case 0:if(!I)return b.Am.error("未找到链群信息"),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Z(n,r)];case 2:return e.sent(),[3,4];case 3:return console.error("Deactivate group failed",e.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){G&&(b.Am.success("链群关闭成功"),setTimeout(function(){t.back()},1500))},[G,t]);var q=(0,m.b)().handleError;if((0,a.useEffect)(function(){C&&q(C),f&&q(f),E&&q(E),y&&q(y),V&&q(V)},[C,f,E,y,V,q]),w||u||P||j)return(0,i.jsxs)("div",{className:"flex flex-col items-center py-8",children:[(0,i.jsx)(x.Z,{}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"加载链群信息..."})]});if(!I||void 0===d)return(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-red-500",children:"未找到链群信息"})});var W=d===g,Q=I.isActive&&!W;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(F.Z,{title:"关闭链群"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["关闭链群 ",(0,i.jsx)("span",{className:"text-gray-500 text-xs",children:"#"}),(0,i.jsx)("span",{className:"text-secondary text-base font-semibold",children:r.toString()}),(0,i.jsx)("span",{className:"font-semibold text-gray-800 text-sm ml-1",children:I.groupName})," 并取回质押代币"]})]}),(0,i.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600",children:"链群状态:"}),(0,i.jsx)("span",{className:"ftext-sm ".concat(I.isActive?"text-green-600":"text-gray-500"),children:I.isActive?"活跃中":"已关闭"})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600",children:"当前容量:"}),(0,i.jsxs)("span",{className:"text-sm",children:[(0,z.LH)(I.totalJoinedAmount,2)," /"," ",I.maxCapacity>BigInt(0)?(0,z.LH)(I.maxCapacity,2):"不限"," ",null==s?void 0:s.symbol]})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600",children:"参与地址数:"}),(0,i.jsx)("span",{className:"text-sm",children:(null==J?void 0:J.toString())||"0"})]})]})}),(0,i.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,i.jsx)(_.z,{variant:"outline",onClick:function(){return t.back()},disabled:T||D,children:"取消"}),(0,i.jsx)(_.z,{variant:"destructive",disabled:!Q||T||D||G,onClick:function(){return X.apply(this,arguments)},children:T?"提交中...":D?"确认中...":G?"已关闭":W?"请等待下一轮次再关闭":"确认关闭"})]}),W&&I.isActive&&(0,i.jsx)("div",{className:"text-center text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded px-3 py-2",children:"⚠️ 在激活链群的同一轮次内无法关闭，请等待下一轮次再操作。"}),!I.isActive&&(0,i.jsx)("div",{className:"text-center text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:"链群已关闭"}),(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,i.jsx)("div",{className:"flex items-start gap-3",children:(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"font-medium text-red-800 mb-1",children:"⚠️ 重要提示"}),(0,i.jsxs)("div",{className:"text-sm text-red-700 space-y-1",children:[(0,i.jsx)("div",{children:"• 链群关闭后将无法再验证，也不再有激励"}),(0,i.jsx)("div",{children:"• 链群关闭后，新的参与者无法再加入"}),(0,i.jsx)("div",{children:"• 链群关闭后可以取回全部质押代币"}),(0,i.jsx)("div",{children:"• 在激活后的下一个轮次，才能关闭链群"})]})]})})})]}),(0,i.jsx)(R.Z,{isLoading:T||D,text:T?"关闭中...":"确认关闭..."})]})},q=r(20442),W=r(8595),Q=r(47714),K=function(e){var n=e.actionId,r=(e.actionInfo,e.extensionAddress),l=e.groupId,d=(0,o.useRouter)(),u=((0,a.useContext)(c.M)||{}).token,f=(0,q.Bk)().currentRound,p=(0,Q.A)({extensionAddress:r,groupId:l,round:f}),g=p.groupDetail,j=p.isPending,A=p.error,B=(0,W.D)({actionId:n,extensionAddress:r}),P=B.params,E=B.isPending,M=B.error,Z=(0,S.r)({tokenAddress:null==P?void 0:P.joinTokenAddress,tokenSymbol:null==P?void 0:P.joinTokenSymbol,enabled:!!(null==P?void 0:P.joinTokenAddress)}),D=Z.formattedSymbol,G=Z.isPending,V=(0,a.useMemo)(function(){return I.Ry({maxCapacity:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseFloat(e);return!isNaN(n)&&n>=0},{message:"请输入有效的容量上限"}),description:I.Z_().max(500,{message:"描述不能超过500字"}),minJoinAmount:I.Z_().refine(function(e){if(!e||""===e.trim()||"0"===e)return!1;var n=parseFloat(e);return!isNaN(n)&&n>0},{message:"最小参与代币数不能为空且必须大于0"}).superRefine(function(e,n){if(!e||"0"===e){n.addIssue({code:w.NL.custom,message:"最小参与代币数不能为0"});return}var r=(0,z.vz)(e);r>BigInt(0)&&(null==P?void 0:P.joinMaxAmount)&&r>P.joinMaxAmount&&n.addIssue({code:w.NL.custom,message:"不能大于全局最大参与量 ".concat((0,z.LH)(P.joinMaxAmount,2)," ").concat((null==u?void 0:u.symbol)||"")})}),maxJoinAmount:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseFloat(e);return!isNaN(n)&&n>=0},{message:"请输入有效的代币数"}).superRefine(function(e,n){if(e&&"0"!==e){var r=(0,z.vz)(e);r>BigInt(0)&&(null==P?void 0:P.joinMaxAmount)&&r>P.joinMaxAmount&&n.addIssue({code:w.NL.custom,message:"不能大于全局最大参与量 ".concat((0,z.LH)(P.joinMaxAmount,2)," ").concat((null==u?void 0:u.symbol)||"")})}}),maxAccounts:I.Z_().refine(function(e){if(!e||"0"===e)return!0;var n=parseInt(e,10);return!isNaN(n)&&n>=0&&Number.isInteger(n)},{message:"请输入有效的非负整数"})}).refine(function(e){var n=(0,z.vz)(e.minJoinAmount||"0"),r=(0,z.vz)(e.maxJoinAmount||"0");return!(n>BigInt(0)&&r>BigInt(0)&&r<n)},{message:"最大参与量不能小于最小参与量",path:["maxJoinAmount"]})},[P,u]),O=(0,N.cI)({resolver:(0,y.F)(V),defaultValues:{maxCapacity:"",description:"",minJoinAmount:"",maxJoinAmount:"",maxAccounts:""},mode:"onChange"});(0,a.useEffect)(function(){if(g){var e=g.minJoinAmount>BigInt(0)?(0,z.LH)(g.minJoinAmount,(null==u?void 0:u.decimals)||18):"";O.reset({maxCapacity:g.maxCapacity>BigInt(0)?(0,z.LH)(g.maxCapacity,(null==u?void 0:u.decimals)||18):"",description:g.description||"",minJoinAmount:e,maxJoinAmount:g.maxJoinAmount>BigInt(0)?(0,z.LH)(g.maxJoinAmount,(null==u?void 0:u.decimals)||18):"",maxAccounts:g.maxAccounts>BigInt(0)?g.maxAccounts.toString():""})}},[g,O,null==u?void 0:u.decimals]);var H=(0,L.Jh)(),X=H.updateGroupInfo,K=H.isPending,U=H.isConfirming,$=H.isConfirmed,Y=H.writeError;function ee(){return(ee=(0,h._)(function(e){var n,t,s,i;return(0,v.Jh)(this,function(a){switch(a.label){case 0:if(!P)return b.Am.error("扩展协议参数未加载完成"),[2];if(n=e.maxCapacity?(0,z.vz)(e.maxCapacity):BigInt(0),!e.minJoinAmount||"0"===e.minJoinAmount)return b.Am.error("最小参与代币数不能为0"),[2];if((t=(0,z.vz)(e.minJoinAmount))<=BigInt(0))return b.Am.error("最小参与代币数必须大于0"),[2];s=e.maxJoinAmount?(0,z.vz)(e.maxJoinAmount):BigInt(0),i=e.maxAccounts&&"0"!==e.maxAccounts?BigInt(parseInt(e.maxAccounts,10)):BigInt(0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,X(r,l,e.description,n,t,s,i)];case 2:return a.sent(),[3,4];case 3:return console.error("Update group failed",a.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){$&&(b.Am.success("链群信息更新成功"),setTimeout(function(){d.back()},1500))},[$,d]);var en=(0,m.b)().handleError;return((0,a.useEffect)(function(){A&&en(A),M&&en(M),Y&&en(Y)},[A,M,Y,en]),j||E||G)?(0,i.jsxs)("div",{className:"flex flex-col items-center py-8",children:[(0,i.jsx)(x.Z,{}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"加载参数中..."})]}):g&&P?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)(F.Z,{title:"更新链群信息"})}),(0,i.jsx)(C.l0,(0,s._)((0,t._)({},O),{children:(0,i.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,i.jsx)(C.Wi,{control:O.control,name:"maxCapacity",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["链群容量上限 ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:D})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"0 为不限制",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:O.control,name:"description",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsx)(C.lX,{children:"链群描述"}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(J.g,(0,t._)({placeholder:"介绍您的链群...",className:"!ring-secondary-foreground min-h-[100px]"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:O.control,name:"minJoinAmount",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["单地址最小参与代币数"," ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:D})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"请填写数量，必须大于0",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.pf,{className:"text-xs",children:"最小参与代币数必须大于0"}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:O.control,name:"maxJoinAmount",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsxs)(C.lX,{children:["单地址最大参与代币数"," ",(0,i.jsx)("span",{className:"text-gray-500 text-xs font-normal",children:D})]}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"可填0, 表示与扩展行动默认值保持一致",className:"!ring-secondary-foreground"},n))}),(null==P?void 0:P.joinMaxAmount)&&P.joinMaxAmount>BigInt(0)&&(0,i.jsxs)(C.pf,{className:"text-xs",children:["扩展行动当前最大参与量：",(0,z.LH)(P.joinMaxAmount)]}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)(C.Wi,{control:O.control,name:"maxAccounts",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsx)(C.lX,{children:"行动者最大地址数"}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"0 为不做限制",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)("div",{className:"flex justify-center space-x-4 pt-4",children:(0,i.jsx)(_.z,{disabled:K||U||$,className:"w-full max-w-xs",type:"button",onClick:function(){O.handleSubmit(function(e){return function(e){return ee.apply(this,arguments)}(e)})()},children:K?"提交中...":U?"确认中...":$?"已更新":"确认更新"})})]})})),(0,i.jsx)(T,{activationMinGovRatio:null==P?void 0:P.activationMinGovRatio,maxJoinAmountRatio:null==P?void 0:P.maxJoinAmountRatio,joinMaxAmount:null==P?void 0:P.joinMaxAmount,groupActivationStakeAmount:null==P?void 0:P.groupActivationStakeAmount})]}),(0,i.jsx)(R.Z,{isLoading:K||U,text:K?"更新中...":"确认更新..."})]}):(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-red-500",children:"未找到扩展参数"})})},U=r(60480),$=r(10221),Y=r(27460),ee=function(e){var n=e.actionId,r=(e.actionInfo,e.extensionAddress),l=e.groupId,d=(0,o.useRouter)(),u=((0,a.useContext)(c.M)||{}).token,f=(0,L.iF)(r,l),p=f.isPending,g=f.error,j=(0,$.Nq)(r,l),A=j.delegatedVerifier,w=j.isPending,B=j.error,J=I.Ry({delegatedVerifier:I.Z_().refine(function(e){return!e||""===e.trim()||(0,U.U)(e)},{message:"请输入有效的以太坊地址"})}),P=(0,N.cI)({resolver:(0,y.F)(J),defaultValues:{delegatedVerifier:""},mode:"onChange"});(0,a.useEffect)(function(){A&&"0x0000000000000000000000000000000000000000"!==A&&P.reset({delegatedVerifier:A})},[A,P]);var E=(0,$.$b)(),S=E.setGroupDelegate,M=E.isPending,Z=E.isConfirming,z=E.isConfirmed,T=E.writeError;function D(){return(D=(0,h._)(function(e){var n,t;return(0,v.Jh)(this,function(s){switch(s.label){case 0:t=(null===(n=e.delegatedVerifier)||void 0===n?void 0:n.trim())||"0x0000000000000000000000000000000000000000",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,S(r,l,t)];case 2:return s.sent(),[3,4];case 3:return console.error("Set delegate failed",s.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}function G(){return(G=(0,h._)(function(){return(0,v.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,S(r,l,"0x0000000000000000000000000000000000000000")];case 1:return e.sent(),[3,3];case 2:return console.error("Cancel delegate failed",e.sent()),[3,3];case 3:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){if(z){var e,r=(null===(e=P.getValues("delegatedVerifier"))||void 0===e?void 0:e.trim())?"打分代理设置成功":"打分代理已取消";b.Am.success(r),setTimeout(function(){d.push("/extension/group/?groupId=".concat(l,"&actionId=").concat(n,"&symbol=").concat(null==u?void 0:u.symbol))},1500)}},[z,d,P]);var V=(0,m.b)().handleError;if((0,a.useEffect)(function(){g&&V(g),B&&V(B),T&&V(T)},[g,B,T,V]),p||w)return(0,i.jsxs)("div",{className:"flex flex-col items-center py-8",children:[(0,i.jsx)(x.Z,{}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"加载参数中..."})]});if(void 0===A)return(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-red-500",children:"未找到扩展参数"})});var O="0x0000000000000000000000000000000000000000"!==A;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)(F.Z,{title:"设置打分代理"})}),O&&(0,i.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,i.jsx)("div",{className:"text-sm text-blue-800 mb-2",children:"当前打分代理:"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(Y.Z,{address:A,showCopyButton:!0}),(0,i.jsx)("button",{type:"button",onClick:function(){return G.apply(this,arguments)},disabled:M||Z||z,className:"text-sm text-blue-600 hover:text-blue-800 underline disabled:text-gray-400 disabled:no-underline disabled:cursor-not-allowed",children:"取消代理"})]})]}),(0,i.jsx)(C.l0,(0,s._)((0,t._)({},P),{children:(0,i.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,i.jsx)(C.Wi,{control:P.control,name:"delegatedVerifier",render:function(e){var n=e.field;return(0,i.jsxs)(C.xJ,{children:[(0,i.jsx)(C.lX,{children:"代理地址"}),(0,i.jsx)(C.NI,{children:(0,i.jsx)(k.I,(0,t._)({placeholder:"输入代理打分地址",className:"!ring-secondary-foreground"},n))}),(0,i.jsx)(C.pf,{className:"text-xs"}),(0,i.jsx)(C.zG,{})]})}}),(0,i.jsx)("div",{className:"flex justify-center gap-3 pt-4",children:(0,i.jsx)(_.z,{disabled:M||Z||z,className:"w-full max-w-xs",type:"button",onClick:function(){P.handleSubmit(function(e){return function(e){return D.apply(this,arguments)}(e)})()},children:M?"提交中...":Z?"确认中...":z?"已设置":"确认设置"})})]})})),(0,i.jsxs)("div",{className:"text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:[(0,i.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"\uD83D\uDCA1 打分代理说明"}),(0,i.jsxs)("div",{className:"space-y-1 text-gray-600",children:[(0,i.jsx)("div",{children:"• 打分代理可以代替您对链群进行验证打分"}),(0,i.jsx)("div",{children:"• 代理人不需要是链群所有者"}),(0,i.jsx)("div",{children:"• 可以随时更换或取消代理"})]})]})]}),(0,i.jsx)(R.Z,{isLoading:M||Z,text:M?"设置中...":"确认设置..."})]})},en=r(4586),er=r(59271),et=r(79128),es=r(49189),ei=r(55976),ea=r(72107),eo=r(84668),ec=r(21973),el=function(e){var n,r,t=e.actionId,s=e.actionInfo,l=e.extensionAddress,d=e.groupId,u=e.groupName,f=(0,o.useRouter)(),g=((0,a.useContext)(c.M)||{}).token,j=(0,A.m)().address,y=(0,er.Bk)(),N=y.currentRound,I=y.isPending,w=y.error,C=(0,a.useMemo)(function(){return N?"group_verify_scores_".concat(l,"_").concat(d,"_").concat(N):""},[l,d,N]),k=(0,$.Y8)(l,j||"0x",d),B=k.canVerify,J=k.isPending,P=k.error,E=(0,et.o)({extensionAddress:l,groupId:d,round:N||BigInt(0)}),S=E.accounts,M=E.isPending,L=E.error,Z=(0,$.Jf)(l,N||BigInt(0),d),z=Z.verifiedAccountCount,T=Z.isPending,D=Z.error,G=(0,eo.Q)({tokenAddress:null==g?void 0:g.address,actionId:t,accounts:S||[],verificationKeys:(null==s?void 0:s.body.verificationKeys)||[],round:N||BigInt(0),enabled:!!(null==g?void 0:g.address)&&!!s&&((null==S?void 0:S.length)||0)>0}),V=G.verificationInfos,O=G.isPending,H=G.error,X=(0,p._)((0,a.useState)([]),2),q=X[0],W=X[1],Q=(0,p._)((0,a.useState)(!1),2),K=Q[0],U=Q[1];(0,a.useEffect)(function(){if(S&&S.length>0){var e=C?ei.k.get(C):null;W(S.map(function(n){var r;return{account:n,score:null!==(r=null==e?void 0:e[n.toLowerCase()])&&void 0!==r?r:"0"}}))}},[S,C]),(0,a.useEffect)(function(){if(C&&q.length>0){var e={};q.forEach(function(n){e[n.account.toLowerCase()]=n.score}),ei.k.set(C,e)}},[q,C]);var ee=(0,$.jQ)(),el=ee.submitOriginScores,ed=ee.isPending,eu=ee.isConfirming,em=ee.isConfirmed,ex=ee.writeError,ef=(n=(0,h._)(function(){var e,n,r,t,i;return(0,v.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,2,,3]),!q||0===q.length)return b.Am.error("没有可复制的地址"),[2];return e=[],n=(null==s?void 0:s.body.verificationKeys)||[],r=["地址","后4位"].concat((0,en._)(n)),e.push(r.join("	")),q.forEach(function(n){var r=n.account,t=r.slice(-4),s=V.find(function(e){return e.account.toLowerCase()===r.toLowerCase()}),i=(null==s?void 0:s.infos)||[];e.push([r,t].concat((0,en._)(i)).join("	"))}),t=e.join("\n"),[4,(0,es.P)(t,"已复制 ".concat(q.length," 个地址信息到剪贴板"))];case 1:return a.sent(),[3,3];case 2:return i=a.sent(),b.Am.error("复制失败，请手动复制"),console.error("Copy error:",i),[3,3];case 3:return[2]}})}),function(){return n.apply(this,arguments)}),eh=function(e){var n=e.trim().split("\n").filter(function(e){return e.trim().length>0}),r=(0,en._)(q),t=0,s=n.every(function(e){return 1===e.trim().split(/[\t,\s]+/).length});if(s&&n.length===r.length)for(var i=0;i<n.length&&i<r.length;i++){var a=n[i].trim();!isNaN(parseFloat(a))&&(r[i].score=a,t++)}else{var o=!0,c=!1,l=void 0;try{for(var d,u=n[Symbol.iterator]();!(o=(d=u.next()).done);o=!0)!function(){var e=d.value.trim().split(/[\t,\s]+/);if(e.length>=2){var n=e[0].toLowerCase(),s=e[1],i=r.findIndex(function(e){return e.account.toLowerCase()===n});-1!==i&&!isNaN(parseFloat(s))&&(r[i].score=s,t++)}}()}catch(e){c=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(c)throw l}}}t>0?(W(r),b.Am.success("成功导入 ".concat(t," 个地址的分数"))):s?b.Am.error("分数行数（".concat(n.length,"）与地址数量（").concat(r.length,"）不匹配")):b.Am.error("未找到匹配的地址，请确保格式为：分数（每行一个）")},ep=(r=(0,h._)(function(){var e,n,r;return(0,v.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,10,,11]),e="",n=!1,r=/Trust/i.test(navigator.userAgent),!(navigator.clipboard&&navigator.clipboard.readText&&!r))return[3,8];t.label=1;case 1:return t.trys.push([1,6,,7]),[4,navigator.permissions.query({name:"clipboard-read"})];case 2:if("denied"!==t.sent().state)return[3,3];return n=!0,[3,5];case 3:return[4,navigator.clipboard.readText()];case 4:e=t.sent(),t.label=5;case 5:return[3,7];case 6:return console.warn("Clipboard API 读取失败:",t.sent()),n=!0,[3,7];case 7:return[3,9];case 8:n=!0,t.label=9;case 9:if(n||!e)return U(!0),[2];return eh(e),[3,11];case 10:return console.error("粘贴功能出错:",t.sent()),U(!0),[3,11];case 11:return[2]}})}),function(){return r.apply(this,arguments)});function ev(){return(ev=(0,h._)(function(){var e;return(0,v.Jh)(this,function(n){switch(n.label){case 0:if(!B)return b.Am.error("您没有打分权限"),[2];if(void 0!==z&&S&&z>=BigInt(S.length))return b.Am.error("本轮打分已经完成，无需重复提交"),[2];if(q.some(function(e){var n=parseFloat(e.score||"0");return isNaN(n)||n<0||n>100}))return b.Am.error("请确保所有分数都在 0~100 之间"),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),e=q.map(function(e){var n=parseInt(e.score);return BigInt(isNaN(n)||n<0?0:n)}),[4,el(l,d,BigInt(0),e)];case 2:return n.sent(),[3,4];case 3:return console.error("Verify group failed",n.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){em&&(C&&ei.k.remove(C),b.Am.success("打分提交成功"),setTimeout(function(){f.push("/extension/my_verifying_groups?symbol=".concat(null==g?void 0:g.symbol))},1500))},[em,f,C]);var eg=(0,m.b)().handleError;if((0,a.useEffect)(function(){w&&eg(w),P&&eg(P),L&&eg(L),D&&eg(D),ex&&eg(ex),H&&eg(H)},[w,P,L,D,ex,H,eg]),I||J||M||T||O)return(0,i.jsxs)("div",{className:"flex flex-col items-center py-8",children:[(0,i.jsx)(x.Z,{}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"加载验证信息..."})]});if(!B)return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(F.Z,{title:"链群验证"}),(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-red-500 mb-4",children:"您没有打分权限"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"只有链群服务者和打分代理才能打分"})]})]});if(!S||0===S.length)return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(F.Z,{title:"链群验证"}),(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-gray-500 mb-4",children:"暂无待打分的行动者"})})]});var ej=function(e,n){var r=(0,en._)(q);if(""===n){r[e].score=n,W(r);return}if(!/^\d+$/.test(n)){b.Am.error("请输入整数");return}var t=parseInt(n,10);t>=0&&t<=100?(r[e].score=n,W(r)):t>100?(r[e].score="100",W(r),b.Am.error("分数不能超过 100")):t<0&&(r[e].score="0",W(r),b.Am.error("分数不能小于 0"))};return void 0!==z&&S&&z>=BigInt(S.length)?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(F.Z,{title:"链群验证"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["为链群 #",d.toString()," 中的行动者打分"]})]}),(0,i.jsx)("div",{className:"text-center py-6",children:(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"打分已完成"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["本轮已为 ",null==S?void 0:S.length," 个行动者提交打分"]})]})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(F.Z,{title:"链群验证"}),(0,i.jsxs)("div",{className:"text-gray-500 mb-2 text-sm",children:[(0,i.jsx)("span",{children:"行动："}),(0,i.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,i.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:t.toString()}),(0,i.jsx)("span",{className:"font-bold text-greyscale-800 text-base",children:(null==s?void 0:s.body.title)||""})]}),(0,i.jsxs)("div",{className:"text-gray-500 mb-2 text-sm",children:[(0,i.jsx)("span",{children:"链群："}),(0,i.jsx)("span",{className:"text-gray-500 text-xs",children:"#"}),(0,i.jsx)("span",{className:"text-secondary text-base font-semibold ",children:d.toString()})," ",(0,i.jsx)("span",{className:"font-semibold",children:u})]})]}),(0,i.jsx)("div",{className:"w-full max-w-2xl",children:(0,i.jsxs)("table",{className:"w-full border-collapse",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,i.jsx)("th",{className:"pb-3 text-left text-sm text-greyscale-500",children:"行动者地址"}),(0,i.jsx)("th",{className:"pb-3 text-left whitespace-nowrap w-16 text-sm text-greyscale-500",children:"打分"})]})}),(0,i.jsx)("tbody",{children:q.map(function(e,n){var r=V.find(function(n){return n.account.toLowerCase()===e.account.toLowerCase()});return(0,i.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,i.jsx)("td",{className:"py-1",children:(0,i.jsxs)("div",{className:"text-left",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-xs font-bold text-gray-500 min-w-[4px]",children:n+1}),(0,i.jsx)("div",{className:"font-mono",children:(0,i.jsx)(Y.Z,{address:e.account,showCopyButton:!0,showCopyLast4Button:!0})})]}),s&&r&&(0,i.jsx)("div",{className:"text-sm text-greyscale-800 ml-3",children:s.body.verificationKeys.map(function(e,n){return(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsxs)("div",{className:"text-xs font-semibold text-gray-600 mb-1",children:[e,":"]}),(0,i.jsx)("div",{children:(0,i.jsx)(ea.L,{text:r.infos[n]||""})})]},n)})})]})}),(0,i.jsx)("td",{className:"py-1 w-18 px-1",children:(0,i.jsx)("div",{className:"flex items-center text-left",children:(0,i.jsx)("input",{type:"number",min:"0",max:"100",step:"1",pattern:"\\d*",inputMode:"numeric",value:e.score,placeholder:"0",onChange:function(e){return ej(n,e.target.value)},className:"w-16 px-1 py-1 border rounded text-xs focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})})]},e.account)})})]})}),(0,i.jsxs)("div",{className:"flex justify-center space-x-4 pt-4",children:[(0,i.jsx)(_.z,{className:"w-1/4",variant:"outline",disabled:!q||0===q.length,onClick:ef,title:"复制地址及验证信息（包含地址、后4位、验证信息）",children:"复制地址"}),(0,i.jsx)(_.z,{className:"w-1/4",variant:"outline",onClick:ep,children:"粘贴分数"}),(0,i.jsx)(_.z,{className:"w-1/2",disabled:ed||eu||em,onClick:function(){return ev.apply(this,arguments)},children:ed?"提交中...":eu?"确认中...":em?"已提交":"提交验证"})]}),(0,i.jsxs)("div",{className:"text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:[(0,i.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"\uD83D\uDCA1 小贴士"}),(0,i.jsxs)("div",{className:"space-y-1 text-gray-600",children:[(0,i.jsx)("div",{children:"• 验证打分范围为：0~100 之间"}),(0,i.jsx)("div",{children:"• 可以从剪贴板粘贴分数（格式：每行一个分数）"})]})]})]}),(0,i.jsx)(R.Z,{isLoading:ed||eu,text:ed?"提交打分...":"确认打分..."}),(0,i.jsx)(ec.Z,{isOpen:K,onClose:function(){return U(!1)},onConfirm:eh,title:"粘贴分数数据",description:"请将复制的分数数据粘贴到下方文本框中（每行一个分数，或每行：地址 分数）",placeholder:"请粘贴分数数据... 例如： 80 90 100"})]})},ed=function(){var e=(0,o.useRouter)(),n=e.query,r=n.op,h=n.groupId,p=((0,a.useContext)(c.M)||{}).token,v=e.query.actionId?BigInt(e.query.actionId):void 0,g=h?BigInt(h):void 0,j="activate"===r,y=(0,l.dI)(null==p?void 0:p.address,v||BigInt(0)),b=y.actionInfo,N=y.isPending,A=y.error,I=(0,d.kz)({tokenAddress:null==p?void 0:p.address,actionInfo:b}),w=I.contractInfo,_=I.isPending,C=I.error,k=null==w?void 0:w.extension,B=(0,u.nS)("verify"===r&&g?g:BigInt(0)),J=B.groupName,P=B.isPending,E=B.error,S=(0,m.b)().handleError;(0,a.useEffect)(function(){A&&S(A),C&&S(C),"verify"===r&&E&&S(E)},[A,C,E,S,r]);var M=function(){switch(r){case"activate":return"激活链群";case"deactivate":return"停用链群";case"update":return"更新链群";case"set_delegated":return"设置委托";case"verify":return"验证链群";default:return"链群操作"}};return N||_||"verify"===r&&P?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{title:M(),showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow",children:(0,i.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,i.jsx)("div",{className:"flex flex-col items-center py-12",children:(0,i.jsx)(x.Z,{})})})})]}):k&&r?j||g?b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{title:M(),showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow p-4",children:(0,i.jsx)("div",{className:"pt-0 pb-3 max-w-3xl mx-auto",children:function(){var e={actionId:v,actionInfo:b,extensionAddress:k};switch(r){case"activate":return(0,i.jsx)(V,(0,t._)({},e));case"deactivate":return(0,i.jsx)(X,(0,s._)((0,t._)({},e),{groupId:g}));case"update":return(0,i.jsx)(K,(0,s._)((0,t._)({},e),{groupId:g}));case"set_delegated":return(0,i.jsx)(ee,(0,s._)((0,t._)({},e),{groupId:g}));case"verify":return(0,i.jsx)(el,(0,s._)((0,t._)({},e),{groupId:g,groupName:J||""}));default:return(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsxs)("p",{className:"text-red-500",children:["未知的操作类型: ",r]})})}}()})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{title:M(),showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow",children:(0,i.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,i.jsx)("div",{className:"text-center py-12",children:(0,i.jsx)("p",{className:"text-red-500",children:"未找到行动信息"})})})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{title:M(),showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow",children:(0,i.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-red-500",children:"缺少必要参数"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"需要: groupId"})]})})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{title:"链群操作",showBackButton:!0}),(0,i.jsx)("main",{className:"flex-grow",children:(0,i.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-red-500",children:"缺少必要参数"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"需要: actionId (行动ID), op (操作类型)"})]})})})]})}}},function(e){e.O(0,[8501,4463,721,5771,3494,8300,2112,5801,7966,8945,6097,8886,5293,7974,7568,1879,2888,9774,179],function(){return e(e.s=48014)}),_N_E=e.O()}]);