try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b87d0c52-137b-464b-a99d-6c57d0873759",e._sentryDebugIdIdentifier="sentry-dbid-b87d0c52-137b-464b-a99d-6c57d0873759")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3920],{39804:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/extension/group_trial_add",function(){return t(4183)}])},74193:function(e,n,t){"use strict";t.d(n,{NI:function(){return T},Wi:function(){return x},l0:function(){return f},lX:function(){return b},pf:function(){return N},xJ:function(){return v},zG:function(){return w}});var r=t(34788),i=t(12796),a=t(72253),s=t(14932),o=t(47702),u=t(85893),d=t(67294),c=t(88426),l=t(87536),m=t(40108),p=t(94193),f=l.RV,y=d.createContext({}),x=function(e){var n=(0,r._)({},(0,i._)(e));return(0,u.jsx)(y.Provider,{value:{name:n.name},children:(0,u.jsx)(l.Qr,(0,a._)({},n))})},g=function(){var e=d.useContext(y),n=d.useContext(h),t=(0,l.Gc)(),r=t.getFieldState,i=t.formState,s=r(e.name,i);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,a._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},s)},h=d.createContext({}),v=d.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),i=d.useId();return(0,u.jsx)(h.Provider,{value:{id:i},children:(0,u.jsx)("div",(0,a._)({ref:n,className:(0,m.cn)("space-y-2",t)},r))})});v.displayName="FormItem";var b=d.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),i=g(),s=i.error,d=i.formItemId;return(0,u.jsx)(p._,(0,a._)({ref:n,className:(0,m.cn)(s&&"text-destructive",t),htmlFor:d},r))});b.displayName="FormLabel";var T=d.forwardRef(function(e,n){var t=(0,r._)({},(0,i._)(e)),s=g(),o=s.error,d=s.formItemId,l=s.formDescriptionId,m=s.formMessageId;return(0,u.jsx)(c.g7,(0,a._)({ref:n,id:d,"aria-describedby":o?"".concat(l," ").concat(m):"".concat(l),"aria-invalid":!!o},t))});T.displayName="FormControl";var N=d.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),i=g().formDescriptionId;return(0,u.jsx)("p",(0,a._)({ref:n,id:i,className:(0,m.cn)("text-sm text-muted-foreground",t)},r))});N.displayName="FormDescription";var w=d.forwardRef(function(e,n){var t=e.className,r=e.children,i=(0,o._)(e,["className","children"]),d=g(),c=d.error,l=d.formMessageId,p=c?String(null==c?void 0:c.message):r;return p?(0,u.jsx)("p",(0,s._)((0,a._)({ref:n,id:l,className:(0,m.cn)("text-sm font-medium text-destructive",t)},i),{children:p})):null});w.displayName="FormMessage"},94193:function(e,n,t){"use strict";t.d(n,{_:function(){return l}});var r=t(72253),i=t(47702),a=t(85893),s=t(67294),o=t(49102),u=t(12003),d=t(40108),c=(0,u.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef(function(e,n){var t=e.className,s=(0,i._)(e,["className"]);return(0,a.jsx)(o.f,(0,r._)({ref:n,className:(0,d.cn)(c(),t)},s))});l.displayName=o.f.displayName},4270:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});var r=(0,t(31134).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},37864:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});var r=(0,t(31134).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},50095:function(e,n,t){"use strict";t.d(n,{s:function(){return r}});var r=[{type:"constructor",inputs:[{name:"love20Token_",type:"address",internalType:"address"},{name:"baseDivisor_",type:"uint256",internalType:"uint256"},{name:"bytesThreshold_",type:"uint256",internalType:"uint256"},{name:"multiplier_",type:"uint256",internalType:"uint256"},{name:"maxGroupNameLength_",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"BASE_DIVISOR",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"BYTES_THRESHOLD",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"LOVE20_TOKEN_ADDRESS",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"MAX_GROUP_NAME_LENGTH",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"MULTIPLIER",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"to",type:"address",internalType:"address"},{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"balanceOf",inputs:[{name:"owner",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"calculateMintCost",inputs:[{name:"groupName",type:"string",internalType:"string"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"getApproved",inputs:[{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"groupNameOf",inputs:[{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"holdersAtIndex",inputs:[{name:"index",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"holdersCount",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"isApprovedForAll",inputs:[{name:"owner",type:"address",internalType:"address"},{name:"operator",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isGroupNameUsed",inputs:[{name:"groupName",type:"string",internalType:"string"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"mint",inputs:[{name:"groupName",type:"string",internalType:"string"}],outputs:[{name:"tokenId",type:"uint256",internalType:"uint256"},{name:"mintCost",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"normalizedNameOf",inputs:[{name:"groupName",type:"string",internalType:"string"}],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"pure"},{type:"function",name:"ownerOf",inputs:[{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"safeTransferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"safeTransferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"tokenId",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setApprovalForAll",inputs:[{name:"operator",type:"address",internalType:"address"},{name:"approved",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"supportsInterface",inputs:[{name:"interfaceId",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"tokenByIndex",inputs:[{name:"index",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"tokenIdOf",inputs:[{name:"groupName",type:"string",internalType:"string"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"tokenOfOwnerByIndex",inputs:[{name:"owner",type:"address",internalType:"address"},{name:"index",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"tokenURI",inputs:[{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"totalBurnedForMint",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"totalSupply",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"tokenId",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"AddHolder",inputs:[{name:"holder",type:"address",indexed:!0,internalType:"address"},{name:"totalHolders",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Approval",inputs:[{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"approved",type:"address",indexed:!0,internalType:"address"},{name:"tokenId",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"ApprovalForAll",inputs:[{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"operator",type:"address",indexed:!0,internalType:"address"},{name:"approved",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"Mint",inputs:[{name:"tokenId",type:"uint256",indexed:!0,internalType:"uint256"},{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"groupName",type:"string",indexed:!1,internalType:"string"},{name:"normalizedName",type:"string",indexed:!1,internalType:"string"},{name:"cost",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"RemoveHolder",inputs:[{name:"holder",type:"address",indexed:!0,internalType:"address"},{name:"totalHolders",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Transfer",inputs:[{name:"from",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenId",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"error",name:"GroupNameAlreadyExists",inputs:[{name:"existingTokenId",type:"uint256",internalType:"uint256"}]},{type:"error",name:"GroupNameEmpty",inputs:[]},{type:"error",name:"GroupNameInvalidCharacters",inputs:[]},{type:"error",name:"GroupNameTooLong",inputs:[{name:"length",type:"uint256",internalType:"uint256"},{name:"maxLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"HolderIndexOutOfBounds",inputs:[{name:"length",type:"uint256",internalType:"uint256"}]}]},42083:function(e,n,t){"use strict";var r=t(85893),i=t(23432);n.Z=function(){return(0,r.jsx)(i.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},93566:function(e,n,t){"use strict";t.d(n,{$A:function(){return y},Bk:function(){return f},Xo:function(){return h},dI:function(){return m},qd:function(){return g},r7:function(){return p},sK:function(){return x}});var r=t(11010),i=t(97582),a=t(67294),s=t(71104),o=t(7724),u=t(37742),d=t(84689),c=t(37474),l="0xeBB295af1D4ee9ed92e55EFF4ca5Eb8D4AB81aCE",m=function(e,n){var t=(0,s.u)({address:l,abi:o.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},p=function(e){var n=(0,s.u)({address:l,abi:o.d,functionName:"actionsCount",args:[e]}),t=n.data,r=n.isPending,i=n.error;return{actionNum:t?(0,u.Z)(t):void 0,isPending:r,error:i}},f=function(){var e=(0,s.u)({address:l,abi:o.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,r=e.error;return{currentRound:(0,u.Z)(n),isPending:t,error:r}},y=function(e,n,t){var r=(0,s.u)({address:l,abi:o.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:r.data,isPending:r.isPending,error:r.error}},x=function(e,n,t){var r=(0,s.u)({address:l,abi:o.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:r.data,isPending:r.isPending,error:r.error}};function g(){var e,n=(0,c.e9)(o.d,l,"submit"),t=n.execute,s=n.isPending,u=n.isConfirming,m=n.isConfirmed,p=n.error,f=n.hash,y=n.isTukeMode,x=(e=(0,r._)(function(e,n){return(0,i.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交submit交易:",{tokenAddress:e,actionId:n,isTukeMode:y}),[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("submit tx hash:",f),p&&(console.log("提交submit交易错误:"),(0,d.Vh)(p),(0,d.H)(p)),m&&console.log("submit tx confirmed")},[f,p,m]),{submit:x,isPending:s,isConfirming:u,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}function h(){var e,n=(0,c.e9)(o.d,l,"submitNewAction"),t=n.execute,s=n.isPending,u=n.isConfirming,m=n.isConfirmed,p=n.error,f=n.hash,y=n.isTukeMode,x=(e=(0,r._)(function(e,n){return(0,i.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交submitNewAction交易:",{tokenAddress:e,actionBody:n,isTukeMode:y}),[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("submitNewAction tx hash:",f),p&&(console.log("提交submitNewAction交易错误:"),(0,d.Vh)(p),(0,d.H)(p)),m&&console.log("submitNewAction tx confirmed")},[f,p,m]),{submitNewAction:x,isPending:s,isConfirming:u,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}},85794:function(e,n,t){"use strict";t.d(n,{A5:function(){return f},DA:function(){return g},hS:function(){return m},l3:function(){return x},yA:function(){return y},yG:function(){return l},z4:function(){return p}});var r=t(11010),i=t(97582),a=t(67294),s=t(71104),o=t(37541),u=t(37742),d=t(37474),c=t(84689),l=function(e,n,t){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=(0,s.u)({address:e,abi:o.O,functionName:"allowance",args:[n,t],query:{enabled:!!e&&!!n&&!!t&&r}}),a=i.data,d=i.isPending,c=i.error,l=i.refetch;return{allowance:void 0!==a?(0,u.Z)(a):void 0,isPending:d,error:c,refetch:l}},m=function(e,n){var t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=(0,s.u)({address:e,abi:o.O,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n&&t}}),i=r.data,a=r.isPending,d=r.error,c=r.refetch;return{balance:void 0!==i?(0,u.Z)(i):void 0,isPending:a,error:d,refetch:c}},p=function(e){var n=(0,s.u)({address:e,abi:o.O,functionName:"symbol",args:[],query:{enabled:!!e}});return{symbol:n.data,isPending:n.isPending,error:n.error}},f=function(e){var n=(0,s.u)({address:e,abi:o.O,functionName:"totalSupply",args:[],query:{enabled:!!e}}),t=n.data,r=n.isPending,i=n.error;return{totalSupply:void 0!==t?(0,u.Z)(t):void 0,isPending:r,error:i}};function y(e){var n,t=(0,d.e9)(o.O,e,"approve"),s=t.execute,u=t.isPending,l=t.isConfirming,m=t.isConfirmed,p=t.error,f=t.hash,y=t.isTukeMode,x=(n=(0,r._)(function(n,t){return(0,i.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交approve交易:",{token:e,spender:n,value:t,isTukeMode:y}),[4,s([n,t])];case 1:return[2,r.sent()]}})}),function(e,t){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("approve tx hash:",f),p&&(console.log("提交approve交易错误:"),(0,c.Vh)(p),(0,c.H)(p))},[f,p]),{approve:x,isPending:u,isConfirming:l,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}function x(e){var n,t=(0,d.e9)(o.O,e,"burnForParentToken"),s=t.execute,u=t.isPending,l=t.isConfirming,m=t.isConfirmed,p=t.error,f=t.hash,y=t.isTukeMode,x=(n=(0,r._)(function(n){return(0,i.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交burnForParentToken交易:",{token:e,amount:n,isTukeMode:y}),[4,s([n])];case 1:return[2,t.sent()]}})}),function(e){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("burnForParentToken tx hash:",f),p&&(console.log("提交burnForParentToken交易错误:"),(0,c.Vh)(p),(0,c.H)(p))},[f,p]),{burnForParentToken:x,isPending:u,isConfirming:l,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}function g(e){var n,t=(0,d.e9)(o.O,e,"transfer"),s=t.execute,u=t.isPending,l=t.isConfirming,m=t.isConfirmed,p=t.error,f=t.hash,y=t.isTukeMode,x=(n=(0,r._)(function(n,t){return(0,i.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交transfer交易:",{token:e,to:n,amount:t,isTukeMode:y}),[4,s([n,t])];case 1:return[2,r.sent()]}})}),function(e,t){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("transfer tx hash:",f),p&&(console.log("提交transfer交易错误:"),(0,c.Vh)(p),(0,c.H)(p))},[f,p]),{transfer:x,isPending:u,isConfirming:l,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}},47714:function(e,n,t){"use strict";t.d(n,{A:function(){return m}});var r=t(67294),i=t(67516),a=t(35611),s=t(65293),o=t(50095),u=t(37742),d="0xA0a5BB442214988D0c6e707d825640C026fB1d04",c="0xf2084E73bF047aF26d72CEFde25e22536a1f37C8",l="0xd94e4Fc2108B78Aa57438BFe5E85192687f74322",m=function(e){var n=e.extensionAddress,t=e.groupId,m=e.round,p=(0,r.useMemo)(function(){return n&&t&&m?[{address:d,abi:o.s,functionName:"groupNameOf",args:[t]},{address:d,abi:o.s,functionName:"ownerOf",args:[t]},{address:c,abi:s.i,functionName:"maxJoinAmount",args:[n]},{address:l,abi:a.w,functionName:"totalJoinedAmountByGroupId",args:[n,m,t]},{address:l,abi:a.w,functionName:"accountsByGroupIdCount",args:[n,m,t]},{address:c,abi:s.i,functionName:"groupInfo",args:[n,t]}]:[]},[n,t,m]),f=(0,i.N)({contracts:p,query:{enabled:!!n&&void 0!==t&&!!m&&p.length>0}}),y=f.data,x=f.isPending,g=f.error;return{groupDetail:(0,r.useMemo)(function(){if(y&&!(y.length<6)){var e,n,t,r,i,a,s=null===(e=y[0])||void 0===e?void 0:e.result,o=null===(n=y[1])||void 0===n?void 0:n.result,d=(0,u.Z)(null===(t=y[2])||void 0===t?void 0:t.result),c=(0,u.Z)(null===(r=y[3])||void 0===r?void 0:r.result),l=(0,u.Z)(null===(i=y[4])||void 0===i?void 0:i.result),m=null===(a=y[5])||void 0===a?void 0:a.result;if(m&&s&&o){var p=(0,u.Z)(m.groupId),f=m.description,x=(0,u.Z)(m.maxCapacity),g=(0,u.Z)(m.minJoinAmount),h=(0,u.Z)(m.maxJoinAmount),v=(0,u.Z)(m.maxAccounts),b=m.isActive,T=(0,u.Z)(m.activatedRound),N=(0,u.Z)(m.deactivatedRound),w=h>BigInt(0)&&h<d?h:d;return{groupId:p,groupName:s,description:f,owner:o,maxCapacity:x,accountCount:l,totalJoinedAmount:c,remainingCapacity:x-c,isActive:b,activatedRound:T,deactivatedRound:N,minJoinAmount:g,maxJoinAmount:h,maxAccounts:v,actionMaxJoinAmount:d,actualMinJoinAmount:g,actualMaxJoinAmount:w}}}},[y]),isPending:x,error:g}}},92429:function(e,n,t){"use strict";t.d(n,{Fw:function(){return f},hq:function(){return x},Hw:function(){return g}});var r=t(48564),i=t(2267),a=t(75766),s=t(45775),o=t(60480),u=t(13550),d=t.n(u),c=function(e,n){for(var t=e;t.length<2*n;)t="0"+t;return t},l=function(e){return(e=(e=e.toUpperCase()).substr(4)+e.substr(0,4)).split("").map(function(e){var n=e.charCodeAt(0);return n>=65&&n<=90?(n-65+10).toString():e}).join("")},m=function(e){for(var n,t=e;t.length>2;)t=(parseInt(n=t.slice(0,9),10)%97).toString()+t.slice(n.length);return parseInt(t,10)%97},p=function(){function e(n){(0,r._)(this,e),(0,a._)(this,"_iban",void 0),this._iban=n}return(0,i._)(e,[{key:"isValid",value:function(){return/^TH[0-9]{2}(ETH[0-9A-Z]{13}|[0-9A-Z]{30,31})$/.test(this._iban)&&1===m(l(this._iban))}},{key:"isDirect",value:function(){return 34===this._iban.length||35===this._iban.length}},{key:"isIndirect",value:function(){return 20===this._iban.length}},{key:"checksum",value:function(){return this._iban.substr(2,2)}},{key:"toAddress",value:function(){if(this.isDirect()){var e=this._iban.substr(4),n=new(d())(e,36);return(0,s.K)("0x".concat(n.toString(16).padStart(40,"0")))}return""}},{key:"toString",value:function(){return this._iban}}],[{key:"fromAddress",value:function(n){if(!(0,o.U)(n))throw Error("Provided address is not a valid address: "+n);var t=n.replace("0x","").replace("0X",""),r=c(new(d())(t,16).toString(36),15);return e.fromBban(r.toUpperCase())}},{key:"fromBban",value:function(n){return new e("TH"+("0"+(98-m(l("TH00"+n)))).slice(-2)+n)}},{key:"toIban",value:function(n){return e.fromAddress(n).toString()}},{key:"toAddress",value:function(n){var t=new e(n);if(!t.isDirect())throw Error("IBAN is indirect and can't be converted");return t.toAddress()}},{key:"isValid",value:function(n){return new e(n).isValid()}}]),e}();function f(e){return/^0[Xx][A-Fa-f0-9]{40}$/.test(e)}function y(e){try{return p.isValid(e)}catch(e){return!1}}function x(e){if(!e||""===e)return"";var n=e.trim();return f(n)?n.toLowerCase():y(n)?function(e){if(!e||""===e)return"";if("TH48000000000000000000000000001EKI"===e)return"0x0000000000000000000000000000000000010002";try{return p.toAddress(e).toLowerCase()}catch(e){return console.error("转换TH地址为0x失败:",e),""}}(n):""}function g(e){if(!e||""===e.trim())return"请输入收款地址";var n=e.trim();return f(n)||y(n)&&x(n)?null:"请输入有效的地址格式（支持 0x、XE 或 TH 格式）"}},39241:function(e,n,t){"use strict";t.d(n,{A:function(){return i},g:function(){return a}});var r=t(91529),i=function(e){var n=[];if(e.maxJoinAmount>BigInt(0)&&n.push({amount:e.maxJoinAmount,reason:"链群最大参与代币 ".concat((0,r.LH)(e.maxJoinAmount))}),e.actionMaxJoinAmount>BigInt(0)&&n.push({amount:e.actionMaxJoinAmount,reason:"行动参与代币上限 ".concat((0,r.LH)(e.actionMaxJoinAmount))}),e.maxCapacity>BigInt(0)&&n.push({amount:e.remainingCapacity,reason:"链群剩余容量 ".concat((0,r.LH)(e.remainingCapacity))}),0===n.length)return{amount:BigInt(0),reason:"无限制"};var t=n[0],i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var d=o.value;d.amount<t.amount&&(t=d)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return{amount:t.amount>BigInt(0)?t.amount:BigInt(0),reason:t.reason}},a=function(e,n){var t=[];if(e.maxJoinAmount>BigInt(0)){var i=e.maxJoinAmount-n;t.push({amount:i,reason:"链群最大参与代币 ".concat((0,r.LH)(e.maxJoinAmount))})}var a=e.actionMaxJoinAmount-n;if(t.push({amount:a,reason:"行动参与代币上限 ".concat((0,r.LH)(e.actionMaxJoinAmount))}),e.maxCapacity>BigInt(0)&&t.push({amount:e.remainingCapacity,reason:"链群剩余容量 ".concat((0,r.LH)(e.remainingCapacity))}),0===t.length)return{amount:BigInt(0),reason:"无限制"};var s=t[0],o=!0,u=!1,d=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var m=c.value;m.amount<s.amount&&(s=m)}}catch(e){u=!0,d=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw d}}return{amount:s.amount>BigInt(0)?s.amount:BigInt(0),reason:s.reason}}},4183:function(e,n,t){"use strict";t.r(n);var r=t(11010),i=t(72253),a=t(14932),s=t(97582),o=t(85893),u=t(67294),d=t(11163),c=t(42130),l=t(37864),m=t(4270),p=t(87536),f=t(56312),y=t(45901),x=t(86501),g=t(27245),h=t(21774),v=t(74193),b=t(17301),T=t(83494),N=t(64777),w=t(42083),I=t(44576),A=t(27966),j=t(91529),k=t(92429),M=t(39241),_=t(20442),C=t(48886),B=t(47714),P=t(93566),E=t(92112),F=t(93778),Z=t(85794),J="0xd94e4Fc2108B78Aa57438BFe5E85192687f74322";n.default=function(){var e,n,t=(0,d.useRouter)(),S=t.query,H=S.groupId,O=S.actionId,R=((0,u.useContext)(F.M)||{}).token,L=(0,c.m)().address,D=(0,u.useRef)(!1),z=O?BigInt(O):void 0,G=H?BigInt(H):void 0,V=(0,P.dI)(null==R?void 0:R.address,z||BigInt(0)),q=V.actionInfo,X=V.isPending,U=V.error,K=(0,E.kz)({tokenAddress:null==R?void 0:R.address,actionInfo:q}),W=K.contractInfo,$=K.isPending,Q=K.error,Y=null==W?void 0:W.extension,ee=(0,_.Bk)().currentRound,en=(0,B.A)({extensionAddress:Y||"0x0",groupId:G,round:ee}),et=en.groupDetail,er=en.isPending,ei=en.error,ea=(0,u.useMemo)(function(){return et?(0,M.A)(et):{amount:BigInt(0),reason:""}},[et]),es=(0,u.useMemo)(function(){return y.Ry({address:y.Z_().trim().min(1,"请输入地址"),amount:y.Z_().trim().refine(function(e){return!!e&&!isNaN(Number(e))&&Number(e)>0},{message:"请输入大于0的代币数量"}).refine(function(e){if(!et)return!0;var n=(0,j.vz)(e);return null!==n&&n>=et.actualMinJoinAmount},{message:"不能小于 ".concat(et?(0,j.LH)(et.actualMinJoinAmount,2):"0")}).refine(function(e){if(!et||ea.amount<=BigInt(0))return!0;var n=(0,j.vz)(e);return null!==n&&n<=ea.amount},{message:"不能大于 ".concat(ea.amount>BigInt(0)?(0,j.LH)(ea.amount,2):"不限")})})},[et,ea]),eo=(0,C.Pz)(),eu=eo.trialAccountsWaitingAdd,ed=eo.isPending,ec=eo.isConfirming,el=eo.isConfirmed,em=eo.writeError,ep=(0,Z.yA)(null==W?void 0:W.joinedAmountTokenAddress),ef=ep.approve,ey=ep.isPending,ex=ep.isConfirming,eg=ep.isConfirmed,eh=ep.writeError,ev=(0,Z.yG)(null==W?void 0:W.joinedAmountTokenAddress,L,J,!!(null==W?void 0:W.joinedAmountTokenAddress)&&!!L&&!!J),eb=ev.allowance,eT=(ev.isPending,ev.error),eN=ev.refetch,ew=(0,u.useMemo)(function(){return y.Ry({items:y.IX(es)}).refine(function(e){var n=e.items.map(function(e){return e.address.toLowerCase().trim()}).filter(Boolean),t=new Set(n);return n.length===t.size},{message:"存在重复的地址，请检查后再提交",path:["root"]})},[es]),eI=(0,p.cI)({resolver:(0,f.F)(ew),defaultValues:{items:[{address:"",amount:""}]},mode:"onChange"}),eA=(0,p.Dq)({control:eI.control,name:"items"}),ej=eA.fields,ek=eA.append,eM=eA.remove,e_=(0,p.qo)({control:eI.control,name:"items"}),eC=(0,u.useMemo)(function(){return e_&&0!==e_.length?e_.map(function(e){return(0,j.vz)((null==e?void 0:e.amount)||"0")||BigInt(0)}).reduce(function(e,n){return e+n},BigInt(0)):BigInt(0)},[e_]),eB=(0,u.useMemo)(function(){return!!e_&&0!==e_.length&&e_.some(function(e){var n=null==e?void 0:e.amount;return null!=n&&""!==String(n).trim()})},[e_])||eC>BigInt(0),eP=(0,u.useMemo)(function(){return!!eb&&eC!==BigInt(0)&&eb>=eC},[eb,eC]),eE=(0,A.b)().handleError;(0,u.useEffect)(function(){U&&eE(U),Q&&eE(Q),ei&&eE(ei),em&&eE(em),eh&&eE(eh),eT&&eE(eT)},[U,Q,ei,em,eh,eT,eE]),(0,u.useEffect)(function(){eg&&(x.Am.success("授权成功"),eN())},[eg,eN]),(0,u.useEffect)(function(){el&&!D.current&&(D.current=!0,x.Am.success("添加成功"),t.push("/extension/group_trial?groupId=".concat(null==G?void 0:G.toString(),"&actionId=").concat(null==z?void 0:z.toString(),"&symbol=").concat(null==R?void 0:R.symbol)))},[el,t,G,z,null==R?void 0:R.symbol]);var eF=(e=(0,r._)(function(){return(0,s.Jh)(this,function(e){switch(e.label){case 0:if(!J||eC===BigInt(0))return x.Am.error("请先添加体验地址和金额"),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,ef(J,eC)];case 2:return e.sent(),[3,4];case 3:return console.error("授权失败:",e.sent()),[3,4];case 4:return[2]}})}),function(){return e.apply(this,arguments)}),eZ=(n=(0,r._)(function(e){var n,t,r,i;return(0,s.Jh)(this,function(a){switch(a.label){case 0:if(!Y||!G)return x.Am.error("参数不完整"),[2];if(!eP)return x.Am.error("请先完成代币授权"),[2];if(n=[],t=[],e.items.forEach(function(e,r){var i=(0,k.hq)(e.address);i&&(0,k.Fw)(i)?n.push(i):t.push(r)}),t.length>0)return eI.setError("root",{message:"存在无效的地址格式，请检查并修正后再提交"}),[2];if(r=n.map(function(e){return e}),-1!==(i=e.items.map(function(e){return(0,j.vz)(e.amount||"0")})).findIndex(function(e){return e<=BigInt(0)}))return eI.setError("root",{message:"体验代币数量必须大于0"}),[2];return[4,eu(Y,G,r,i)];case 1:return a.sent(),[2]}})}),function(e){return n.apply(this,arguments)});return L?X||$||er?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.Z,{title:"增加体验地址",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,o.jsxs)("div",{className:"flex flex-col items-center py-12",children:[(0,o.jsx)(w.Z,{}),(0,o.jsx)("p",{className:"mt-4 text-gray-600",children:"加载中..."})]})})})]}):q&&Y&&G?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.Z,{title:"增加体验地址",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,o.jsx)(v.l0,(0,a._)((0,i._)({},eI),{children:(0,o.jsxs)("form",{onSubmit:eI.handleSubmit(eZ),children:[eI.formState.errors.root&&(0,o.jsx)("div",{className:"text-red-500 text-sm p-2 bg-red-50 rounded-md border border-red-200",children:eI.formState.errors.root.message}),(0,o.jsxs)("div",{children:[(0,o.jsx)(N.Z,{title:"增加新的体验地址"}),(0,o.jsxs)("table",{className:"table w-full mt-6",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,o.jsx)("th",{className:"px-1 text-left w-12",children:"No"}),(0,o.jsx)("th",{className:"px-1 text-left min-w-[200px]",children:"地址"}),(0,o.jsx)("th",{className:"px-1 text-right w-28",children:"体验代币数量"}),(0,o.jsx)("th",{className:"px-1 text-right",children:" "})]})}),(0,o.jsx)("tbody",{children:0===ej.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:4,className:"text-center text-sm text-greyscale-400 p-4",children:"暂无体验地址，点击下方按钮添加"})}):ej.map(function(e,n){return(0,o.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,o.jsx)("td",{className:"px-1",children:n+1}),(0,o.jsx)("td",{className:"px-1 min-w-[200px]",children:(0,o.jsx)(v.Wi,{control:eI.control,name:"items.".concat(n,".address"),render:function(e){var n=e.field;return(0,o.jsxs)(v.xJ,{children:[(0,o.jsx)(v.NI,{children:(0,o.jsx)(h.I,(0,a._)((0,i._)({placeholder:"0x..."},n),{className:"font-mono text-sm h-8 px-1 sm:px-2 w-full"}))}),(0,o.jsx)(v.zG,{className:"text-xs"})]})}})}),(0,o.jsx)("td",{className:"px-1 text-right w-20",children:(0,o.jsx)(v.Wi,{control:eI.control,name:"items.".concat(n,".amount"),render:function(e){var n=e.field;return(0,o.jsxs)(v.xJ,{children:[(0,o.jsx)(v.NI,{children:(0,o.jsx)(h.I,(0,a._)((0,i._)({type:"number",min:0,step:"any",placeholder:"0"},n),{className:"h-8 px-1 sm:px-2 text-right w-full"}))}),(0,o.jsx)(v.zG,{className:"text-xs"})]})}})}),(0,o.jsx)("td",{className:"px-0 text-right",children:(0,o.jsx)(g.z,{type:"button",variant:"ghost",size:"icon",onClick:function(){return eM(n)},className:"h-8 w-8 px-0 mx-0",children:(0,o.jsx)(l.Z,{className:"w-3 h-3 sm:w-4 sm:h-4 text-red-500"})})})]},e.id)})})]}),(0,o.jsx)("div",{className:"flex justify-center mt-2",children:(0,o.jsxs)(g.z,{type:"button",variant:"outline",className:"w-1/2 text-secondary border-secondary",onClick:function(){return ek({address:"",amount:""})},children:[(0,o.jsx)(m.Z,{className:"w-4 h-4 mr-2"})," 增加体验地址"]})}),et&&(0,o.jsxs)("div",{className:"mt-2 text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{children:"体验代币数量范围："}),(0,o.jsxs)("span",{className:"font-mono text-secondary",children:[(0,j.LH)(et.actualMinJoinAmount,2)," ~"," ",ea.amount>BigInt(0)?(0,j.LH)(ea.amount):"不限"]})]}),ea.reason&&ea.amount&&(0,o.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["限制: ",ea.reason]})]})]}),(0,o.jsxs)("div",{className:"flex space-x-4 w-full mt-8",children:[(0,o.jsx)(g.z,{type:"button",onClick:eF,className:"w-1/2",disabled:ey||ex||eP||eC===BigInt(0),children:ey?"1.提交中...":ex?"1.确认中...":eP?"1.代币已授权":"1.代币授权"}),(0,o.jsx)(g.z,{type:"submit",className:"w-1/2",disabled:ed||ec||!eP,children:ed?"2.提交中...":ec?"2.确认中...":"2.提交"})]}),eB&&(0,o.jsx)("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded px-3 py-2 mt-2",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{children:"需质押代币："}),(0,o.jsxs)("span",{children:[(0,o.jsx)("span",{className:"font-mono text-secondary mr-2",children:(0,j.LH)(eC)}),(0,o.jsx)("span",{className:"text-greyscale-500",children:(null==W?void 0:W.joinedAmountTokenSymbol)||""})]})]})})]})})),(0,o.jsx)(I.Z,{isLoading:ed||ec||ey||ex,text:ey?"正在提交授权...":ex?"正在确认授权...":ed?"正在提交...":"正在确认..."})]})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.Z,{title:"增加体验地址",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,o.jsx)(b.Z,{type:"error",message:"未找到行动或扩展信息"})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.Z,{title:"增加体验地址",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"请先连接钱包"})})})]})}}},function(e){e.O(0,[8501,4463,721,3494,2112,5801,7966,8886,5293,2888,9774,179],function(){return e(e.s=39804)}),_N_E=e.O()}]);