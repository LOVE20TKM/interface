(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return s(75959)}])},34680:function(e,t,s){"use strict";s.d(t,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var n=s(85893),a=s(67294),r=s(40108);let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});l.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...a})});c.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},4307:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(31134).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},96693:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var n=s(85893),a=s(67294),r=s(42757),l=s(93778),c=e=>{let{initialTimeLeft:t,onTick:s}=e,[r,l]=(0,a.useState)(Date.now()+1e3*t),[c,i]=(0,a.useState)(t);(0,a.useEffect)(()=>{l(Date.now()+1e3*t)},[t]),(0,a.useEffect)(()=>{let e=setInterval(()=>{let t=Math.max(0,Math.floor((r-Date.now())/1e3));i(t),s&&s(t),t<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[r,s]);let d=Math.floor(c/86400),o=Math.floor(c%86400/3600);return(0,n.jsxs)("div",{className:"inline-flex gap-1 text-secondary",children:[d>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":d}})}),"天"]}),(o>0||d>0)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":o}})}),"时"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":Math.floor(c%3600/60)}})}),"分"]}),d<=0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":c%60}})}),"秒"]})]})},i=s(42083),d=e=>{let{currentRound:t,roundType:s}=e,{data:d}=(0,r.O)(),o=(0,a.useContext)(l.M),u=o?o.token:void 0,x=!d||!u||void 0===u.voteOriginBlocks||!u.initialStakeRound,[m,f]=(0,a.useState)(0n),h=Number("100")||0,N=Number("3")||0,j=u?Number(u.voteOriginBlocks):0,p=h-(Number(d)-j)%h,v=p>0?p*N:0,[b,g]=(0,a.useState)(v);(0,a.useEffect)(()=>{if(!d)return;let e=h-(Number(d)-j)%h;g(e>0?e*N:0)},[d,h,N,j]),(0,a.useEffect)(()=>{u&&t>0n&&f(t-BigInt(u.initialStakeRound)+1n)},[t,u]);let y=null!=m?m.toString():"0";return x?(0,n.jsx)(i.Z,{}):(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("h1",{className:"text-lg font-bold",children:["第 ",(0,n.jsx)("span",{className:"text-secondary",children:y})," 轮","vote"===s?"投票":"行动","阶段"]}),(0,n.jsxs)("span",{className:"text-sm mt-1 pt-0",children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"剩余:"}),(0,n.jsx)("span",{className:"text-secondary mr-1",children:Math.ceil(b/N)}),(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),(0,n.jsx)(c,{initialTimeLeft:v,onTick:g})]})]})}},99958:function(e,t,s){"use strict";s.d(t,{I:function(){return n},T:function(){return a}});let n=(e,t,s)=>{if(!e||!t)return"0%";let n=31536e3/Number("3"),a=BigInt("100");if(0===n||0n===a)return console.error("配置错误: NEXT_PUBLIC_BLOCK_TIME 或 NEXT_PUBLIC_PHASE_BLOCKS 未设置"),"0%";let r=e?99n*e*99n/2000000n:BigInt(0),l=(2n*t||BigInt(0))+(s||BigInt(0));if(l===BigInt(0))return"0%";let c=Number(r)/Number(l)/(Number(a)/n)*100;return"".concat(c.toFixed(2).replace(/\.?0+$/,""),"%")},a=(e,t)=>{if(!e||!t||0n===t)return"0%";let s=31536e3/Number("3"),n=BigInt("100");if(0===s||0n===n)return console.error("配置错误: BLOCK_TIME 或 PHASE_BLOCKS 未设置或为0"),"0%";let a=Number(e)/Number(t)/(Number(n)/s)*100;return"".concat(a.toFixed(2).replace(/\.?0+$/,""),"%")}},75959:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var n=s(85893),a=s(67294),r=s(11163),l=s(93778),c=s(67068),i=s(19638),d=s(7399),o=s(91529),u=s(42083),x=s(96693),m=s(99958),f=e=>{let{currentRound:t}=e,{token:s}=(0,a.useContext)(l.M)||{},{rewardAvailable:r,isPending:f,error:h}=(0,d.CY)((null==s?void 0:s.address)||""),{balance:N,isPending:j,error:p}=(0,i.hS)((null==s?void 0:s.address)||"","0xD9255e4e2b14c82Ab402f7CAd1D6799660527281"),{handleContractError:v}=(0,c.S)();(0,a.useEffect)(()=>{p&&v(p,"join"),h&&v(h,"mint")},[p,h]);let b=99n*(r||BigInt(0))/20000n;return(0,n.jsxs)("div",{className:"px-4",children:[(0,n.jsx)(x.Z,{currentRound:t||0n,roundType:"act"}),(0,n.jsxs)("div",{className:"w-full border rounded-lg mt-4 p-0",children:[(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm pb-1",children:"参与行动代币"}),(0,n.jsx)("div",{className:"stat-value text-xl text-secondary",children:j?(0,n.jsx)(u.Z,{}):(0,o.LH)(N||BigInt(0),0)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm pb-1",children:"预计新增铸币"}),(0,n.jsx)("div",{className:"stat-value text-xl text-secondary",children:f||void 0===r?(0,n.jsx)(u.Z,{}):(0,o.LH)(b,2)})]})]}),(0,n.jsxs)("div",{className:"text-center text-xs mb-2 text-greyscale-500",children:["预估年化收益率（APY）：",(0,m.T)(b,N)]})]})]})},h=s(37436),N=s(41664),j=s.n(N),p=s(92321),v=s(4307),b=s(34680),g=s(45551),y=s(64777),w=e=>{let{currentRound:t}=e,{token:s}=(0,a.useContext)(l.M)||{},{address:r}=(0,p.m)(),{joinableActionDetails:i,joinedActions:d,isPending:x,error:m}=(0,g.eN)((null==s?void 0:s.address)||"",t||0n,r);null==i||i.sort((e,t)=>Number(e.action.head.id)-Number(t.action.head.id));let f=(null==i?void 0:i.reduce((e,t)=>e+t.votesNum,0n))||0n,{handleContractError:h}=(0,c.S)();return(0,a.useEffect)(()=>{m&&h(m,"dataViewer")},[m]),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)(y.Z,{title:"进行中的行动"}),!r&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"}),r&&x&&(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(u.Z,{})}),r&&!x&&!(null==i?void 0:i.length)&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"本轮暂无行动"}),!x&&i&&i.length>0&&(0,n.jsx)("div",{className:"mt-4 space-y-4",children:i.map((e,t)=>{let a=(null==d?void 0:d.some(t=>t.actionId===BigInt(e.action.head.id)))?"/action/".concat(e.action.head.id,"?type=join&symbol=").concat(null==s?void 0:s.symbol):"/acting/join?id=".concat(e.action.head.id,"&symbol=").concat(null==s?void 0:s.symbol);return(0,n.jsx)(b.Zb,{className:"shadow-none",children:(0,n.jsxs)(j(),{href:a,className:"relative block",children:[(0,n.jsxs)(b.Ol,{className:"px-3 pt-2 pb-1 flex-row items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.action.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.action.body.action)})]}),(0,n.jsxs)(b.aY,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.action.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,n.jsxs)("span",{className:"text-secondary",children:[(100*Number(i[t].votesNum||0n)/Number(f)).toFixed(1),"%"]})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"参与代币数"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,o.LH)(i[t].joinedAmount||0n)})]})]})]}),(0,n.jsx)(v.Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]})},e.action.head.id)})})]})},C=s(4062),E=s(5028),_=()=>{let e=(0,r.useRouter)(),{currentRound:t,error:s}=(0,E.Bk)(),{token:i}=(0,a.useContext)(l.M)||{},{handleContractError:d}=(0,c.S)();return(0,a.useEffect)(()=>{s&&d(s,"join")},[s]),(0,a.useEffect)(()=>{i&&!i.hasEnded?e.push("/launch?symbol=".concat(i.symbol)):i&&!i.initialStakeRound&&e.push("/gov/stakelp/?symbol=".concat(i.symbol,"&first=true"))},[i]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{title:"社区首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(C.Z,{}),(0,n.jsx)(f,{currentRound:t}),(0,n.jsx)(w,{currentRound:t})]})]})}}},function(e){e.O(0,[1664,2209,1335,6242,7863,7380,6697,2042,4062,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);