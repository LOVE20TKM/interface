try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7395c18f-1d08-4625-8059-0d4070e4efc0",e._sentryDebugIdIdentifier="sentry-dbid-7395c18f-1d08-4625-8059-0d4070e4efc0")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{68786:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return s(10423)}])},53696:function(e,n,s){"use strict";s.d(n,{Z:function(){return f}});var t=s(11010),r=s(91309),a=s(97582),i=s(85893),c=s(67294),l=s(23432),o=(0,s(31134).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),d=s(42130),u=s(30246),m=s(86501),h=s(55612);function f(e){var n,s=e.tokenAddress,f=e.tokenSymbol,x=e.tokenDecimals,g=e.tokenImage,p=(0,r._)((0,c.useState)(!1),2),b=p[0],v=p[1],j=(0,d.m)().isConnected,y=(0,u.p)().data,N=(n=(0,t._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:if(!j)return alert("请先连接你的钱包"),[2];v(!0),e.label=1;case 1:if(e.trys.push([1,3,4,5]),!y)return alert("无法获取钱包客户端"),[2];return[4,y.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:f,decimals:x,image:g}}})];case 2:return e.sent()?m.ZP.success("代币已成功添加到 MetaMask 钱包"):m.ZP.error("用户拒绝添加代币"),[3,5];case 3:return console.error("添加代币失败:",e.sent()),m.ZP.error("添加代币失败，请检查控制台以获取更多信息"),[3,5];case 4:return v(!1),[7];case 5:return[2]}})}),function(){return n.apply(this,arguments)});return f.length>11||(0,h.ON)()?null:(0,i.jsx)("button",{onClick:N,disabled:b,className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:b?(0,i.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(o,{className:"h-4 w-4 text-greyscale-500"})})}},64777:function(e,n,s){"use strict";var t=s(85893);n.Z=function(e){var n=e.title;return(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-lg font-bold",children:n})})}},42083:function(e,n,s){"use strict";var t=s(85893),r=s(23432);n.Z=function(){return(0,t.jsx)(r.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},85794:function(e,n,s){"use strict";s.d(n,{A5:function(){return f},DA:function(){return p},hS:function(){return m},l3:function(){return g},yA:function(){return x},yG:function(){return u},z4:function(){return h}});var t=s(11010),r=s(97582),a=s(67294),i=s(71104),c=s(37541),l=s(37742),o=s(37474),d=s(84689),u=function(e,n,s){var t=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=(0,i.u)({address:e,abi:c.O,functionName:"allowance",args:[n,s],query:{enabled:!!e&&!!n&&!!s&&t}}),a=r.data,o=r.isPending,d=r.error,u=r.refetch;return{allowance:void 0!==a?(0,l.Z)(a):void 0,isPending:o,error:d,refetch:u}},m=function(e,n){var s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],t=(0,i.u)({address:e,abi:c.O,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n&&s}}),r=t.data,a=t.isPending,o=t.error,d=t.refetch;return{balance:void 0!==r?(0,l.Z)(r):void 0,isPending:a,error:o,refetch:d}},h=function(e){var n=(0,i.u)({address:e,abi:c.O,functionName:"symbol",args:[],query:{enabled:!!e}});return{symbol:n.data,isPending:n.isPending,error:n.error}},f=function(e){var n=(0,i.u)({address:e,abi:c.O,functionName:"totalSupply",args:[],query:{enabled:!!e}}),s=n.data,t=n.isPending,r=n.error;return{totalSupply:void 0!==s?(0,l.Z)(s):void 0,isPending:t,error:r}};function x(e){var n,s=(0,o.e9)(c.O,e,"approve"),i=s.execute,l=s.isPending,u=s.isConfirming,m=s.isConfirmed,h=s.error,f=s.hash,x=s.isTukeMode,g=(n=(0,t._)(function(n,s){return(0,r.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交approve交易:",{token:e,spender:n,value:s,isTukeMode:x}),[4,i([n,s])];case 1:return[2,t.sent()]}})}),function(e,s){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("approve tx hash:",f),h&&(console.log("提交approve交易错误:"),(0,d.Vh)(h),(0,d.H)(h))},[f,h]),{approve:g,isPending:l,isConfirming:u,writeError:h,isConfirmed:m,hash:f,isTukeMode:x}}function g(e){var n,s=(0,o.e9)(c.O,e,"burnForParentToken"),i=s.execute,l=s.isPending,u=s.isConfirming,m=s.isConfirmed,h=s.error,f=s.hash,x=s.isTukeMode,g=(n=(0,t._)(function(n){return(0,r.Jh)(this,function(s){switch(s.label){case 0:return console.log("提交burnForParentToken交易:",{token:e,amount:n,isTukeMode:x}),[4,i([n])];case 1:return[2,s.sent()]}})}),function(e){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("burnForParentToken tx hash:",f),h&&(console.log("提交burnForParentToken交易错误:"),(0,d.Vh)(h),(0,d.H)(h))},[f,h]),{burnForParentToken:g,isPending:l,isConfirming:u,writeError:h,isConfirmed:m,hash:f,isTukeMode:x}}function p(e){var n,s=(0,o.e9)(c.O,e,"transfer"),i=s.execute,l=s.isPending,u=s.isConfirming,m=s.isConfirmed,h=s.error,f=s.hash,x=s.isTukeMode,g=(n=(0,t._)(function(n,s){return(0,r.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交transfer交易:",{token:e,to:n,amount:s,isTukeMode:x}),[4,i([n,s])];case 1:return[2,t.sent()]}})}),function(e,s){return n.apply(this,arguments)});return(0,a.useEffect)(function(){f&&console.log("transfer tx hash:",f),h&&(console.log("提交transfer交易错误:"),(0,d.Vh)(h),(0,d.H)(h))},[f,h]),{transfer:g,isPending:l,isConfirming:u,writeError:h,isConfirmed:m,hash:f,isTukeMode:x}}},10423:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return Z}});var t=s(72253),r=s(14932),a=s(85893),i=s(67294),c=s(93778),l=s(70019),o=s(73591),d=s(83494),u=s(42083),m=s(91309),h=s(88504),f=s(37413),x=s(91529),g=s(64777),p=s(74089),b=function(e){var n=e.token,s=e.launchInfo,t=Number(s.totalContributed)/Number(s.parentTokenFundraisingGoal),r=(100*t).toFixed(1),c=(0,h.O)().data,l=(0,m._)((0,i.useState)(0),2),o=l[0],d=l[1],b=(0,m._)((0,i.useState)(0),2),v=b[0],j=b[1],y=Number("2868")||0;if((0,i.useEffect)(function(){if(c&&s&&t>=.5){var e=Number(s.secondHalfStartBlock)+Number(s.secondHalfMinBlocks)-Number(c);j(e>0?e:0)}},[c,s,t]),!s)return(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!n)return(0,a.jsx)(u.Z,{});var N="TKM20"==n.parentTokenSymbol?"TKM":n.parentTokenSymbol;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex-col items-center mb-2 mt-4 px-4",children:[(0,a.jsxs)("div",{className:"flex items-center flex-wrap gap-2",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(g.Z,{title:"公平发射"})}),s.hasEnded&&(0,a.jsx)("span",{className:"stat-title text-base text-red-500",children:"（已结束）"}),!s.hasEnded&&t>=.5&&v>0&&(0,a.jsxs)("span",{className:"text-greyscale-500 text-sm",children:["(","距离结束还有"," ",(0,a.jsx)(p.Z,{initialTimeLeft:v>0?Math.ceil(v*y/1e3):0,onTick:d,forceShowSeconds:!0,fontClass:"text-greyscale-600"})," )"]})]}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center p-2",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"申购累计筹集到"}),(0,a.jsxs)("div",{className:"stat-value",children:[(0,a.jsx)("span",{className:"text-3xl text-secondary",children:(0,x.LH)(s.totalContributed)}),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:N})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsx)("span",{children:N}),"筹集目标"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:(0,x.LH)(s.parentTokenFundraisingGoal)})]}),(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsxs)("span",{children:[n.symbol," "]}),"发射总量"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,x.LH)(BigInt(f.v.fairLaunch)))})]})]}),(0,a.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",N," ="," ",(0,x.eb)((0,x.kP)((Number(f.v.fairLaunch)/Number(s.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",n.symbol]}),(0,a.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,a.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!s.hasEnded&&"（当前 ".concat(r,"%）")]}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!s.hasEnded&&t>=.5&&(v<=0?t>=1?"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):(0,a.jsxs)(a.Fragment,{children:["（第 ",s.secondHalfStartBlock.toString(),"区块），至少",s.secondHalfMinBlocks.toString(),"个区块（还需等待 ",Math.ceil(1e3*o/y),"个区块","）"]})),!s.hasEnded&&t<.5&&"，至少".concat(s.secondHalfMinBlocks.toString(),"个区块"),s.hasEnded&&"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,a.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,a.jsxs)("p",{children:["1. 代币总量：",(0,x.LH)(BigInt(f.v.totalSupply),4,"round")]}),(0,a.jsxs)("p",{children:["2. 发射数量：",(0,x.LH)(BigInt(f.v.fairLaunch),4,"round")," (10%)"]}),(0,a.jsxs)("p",{children:["3. 治理激励：",(0,x.LH)(BigInt(f.v.govRewards),4,"round")," (45%)"]}),(0,a.jsxs)("p",{children:["4. 行动激励：",(0,x.LH)(BigInt(f.v.actionRewards),4,"round")," (45%)"]}),(0,a.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,a.jsx)("p",{children:"1. 代币发放：按申购数量占比发放"}),(0,a.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})})},v=s(11010),j=s(97582),y=s(27245),N=s(42130),k=s(11163),w=s(41664),T=s.n(w),C=s(86501),S=s(37742),E=s(44576),P=function(e){var n,s=e.token;e.launchInfo;var t=(0,N.m)(),r=t.address,c=t.isConnected,d=(0,h.O)().data,m=(0,k.useRouter)(),f=(0,l.ap)(null==s?void 0:s.address,c?r:"0x0000000000000000000000000000000000000000"),p=f.contributed,b=f.isPending,w=f.error,P=f.refetch,M=(0,l.oz)(null==s?void 0:s.address,c?r:"0x0000000000000000000000000000000000000000"),B=M.lastContributedBlock,Z=M.isPending,I=M.error,_=(0,S.Z)("30126"),H=B||BigInt(0),F=_-((d?BigInt(d):BigInt(0))-H),L=(0,l.Qc)(),O=L.withdraw,z=L.isPending,K=L.writeError,D=L.isConfirming,A=L.isConfirmed,J=(n=(0,v._)(function(){return(0,j.Jh)(this,function(e){switch(e.label){case 0:return[4,O(null==s?void 0:s.address)];case 1:return e.sent(),[2]}})}),function(){return n.apply(this,arguments)});(0,i.useEffect)(function(){A&&(C.ZP.success("撤回成功"),P(),setTimeout(function(){m.push("/launch/?symbol=".concat(null==s?void 0:s.symbol))},1e3))},[A]);var q=(0,o.S)().handleContractError;if((0,i.useEffect)(function(){w&&q(w,"launch"),I&&q(I,"launch"),K&&q(K,"launch")},[w,I,K]),!s||b||Z)return(0,a.jsx)(u.Z,{});var R="TKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-6",children:[(0,a.jsx)(g.Z,{title:"参与申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,a.jsxs)("div",{className:"stat-value text-secondary",children:[(0,x.LH)(p||BigInt(0)),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:R})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center -mx-2",children:[p&&p>BigInt(0)&&(0,a.jsx)(y.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary mx-2",onClick:J,disabled:z||D||A,children:z?"提交中...":D?"确认中...":A?"已撤回":"撤回申购"}),(0,a.jsx)(y.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary mx-2",asChild:!0,children:(0,a.jsx)(T(),{href:"/launch/contribute?symbol=".concat(null==s?void 0:s.symbol),children:p&&p>BigInt(0)?"增加申购":"去申购"})})]}),p&&p>BigInt(0)&&F>0&&(0,a.jsx)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:(0,a.jsxs)("div",{children:["申购后需等 ","30126"," 个区块才能撤回（还需"," ",F>0?F.toString():"0"," 区块,大约"," ",(0,x.ZC)(Number(F)*Number("2868")/1e3),"）"]})}),(0,a.jsx)("div",{className:"border-t border-gray-200 mt-6 mb-6"}),(0,a.jsx)(E.Z,{isLoading:z||D,text:z?"提交交易...":"确认交易..."})]})},M=function(e){var n,s=e.token;e.launchInfo;var t=(0,N.m)().address,r=((0,i.useContext)(c.M)||{}).clearToken,d=(0,l.ap)(null==s?void 0:s.address,t),m=d.contributed,h=d.isPending,f=d.error,p=(0,l.r0)(null==s?void 0:s.address,t),b=p.receivedTokenAmount,k=p.extraRefund,w=p.isClaimed,S=p.isPending,P=p.error,M=(0,l.z7)(),B=M.claim,Z=M.isPending,I=M.writeError,_=M.isConfirming,H=M.isConfirmed,F=(n=(0,v._)(function(){return(0,j.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,B(null==s?void 0:s.address)];case 1:return e.sent(),[3,3];case 2:return console.error("领取失败:",e.sent()),[3,3];case 3:return[2]}})}),function(){return n.apply(this,arguments)});(0,i.useEffect)(function(){H?(C.ZP.success("领取成功"),null==r||r(),setTimeout(function(){window.location.reload()},1e3)):I&&C.ZP.error("领取失败")},[H,I]);var L=(0,o.S)().handleContractError;if((0,i.useEffect)(function(){I&&L(I,"launch"),P&&L(P,"launch"),f&&L(f,"launch")},[I,P,f]),console.log("contributed",m),!t)return"";if(S||h||!s)return(0,a.jsx)(u.Z,{});var O="TKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-4 mt-2",children:[(0,a.jsx)(g.Z,{title:"我的申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,a.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,x.LH)(null!=b?b:BigInt(0)),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:s.symbol})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(m)||!m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.z,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,a.jsx)(y.z,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(T(),{href:"/launch/burn?symbol=".concat(null==s?void 0:s.symbol),children:"换回父币"})})]}),Number(m)>0&&!w&&(0,a.jsx)(y.z,{className:"w-1/2",onClick:F,disabled:Z||_||H,children:Z?"领取中...":_?"确认中...":H?"已领取":"领取"}),Number(m)>0&&w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.z,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,a.jsx)(y.z,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(T(),{href:"/launch/burn?symbol=".concat(null==s?void 0:s.symbol),children:"换回父币"})})]})]}),Number(m)>0&&w&&(0,a.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,a.jsxs)("span",{className:"text-secondary",children:[(0,x.LH)(null!=m?m:BigInt(0))," "]}),O,"，申购返还了 ",(0,a.jsx)("span",{className:"text-secondary",children:(0,x.LH)(null!=k?k:BigInt(0))})," ",s.parentTokenSymbol,"TKM20"==s.parentTokenSymbol&&(0,a.jsxs)(T(),{href:"/dex/swap?from=".concat(s.parentTokenSymbol,"&to=").concat("TKM"),className:"text-secondary ml-1",children:["（转回 ","TKM","）"]})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-4 mb-6"}),(0,a.jsx)(E.Z,{isLoading:Z||_,text:Z?"提交交易...":"确认交易..."})]})},B=s(66247);function Z(){var e=(0,i.useContext)(c.M)||{token:null,setToken:null},n=e.token,s=e.setToken,m=(0,l.kF)(n?n.address:"0x0000000000000000000000000000000000000000"),h=m.launchInfo,f=m.isPending,x=m.error,g=(0,o.S)().handleContractError;return((0,i.useEffect)(function(){x&&g(x,"launch")},[x]),(0,i.useEffect)(function(){h&&n&&h.hasEnded&&!n.hasEnded&&s((0,r._)((0,t._)({},n),{hasEnded:!0}))},[h,n]),f||h)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{title:"公平发射",showBackButton:(null==h?void 0:h.hasEnded)||!1}),(0,a.jsxs)("main",{className:"flex-grow",children:[(0,a.jsx)(B.Z,{}),f||!h?(0,a.jsx)(u.Z,{}):(0,a.jsxs)(a.Fragment,{children:[n&&(h.hasEnded?(0,a.jsx)(M,{token:n,launchInfo:h}):(0,a.jsx)(P,{token:n,launchInfo:h})),(0,a.jsx)(b,{token:n,launchInfo:h})]})]})]}):(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}}},function(e){e.O(0,[8501,4463,3798,8139,246,3494,3591,19,4762,2888,9774,179],function(){return e(e.s=68786)}),_N_E=e.O()}]);