(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5875],{18449:(e,s,r)=>{"use strict";r.d(s,{X:()=>a});var t=r(76200);class n extends t.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,s){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new n({value:e});let[r,t="0"]=e.split("."),a=r.startsWith("-");if(a&&(r=r.slice(1)),t=t.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${t}`))&&(r=`${BigInt(r)+1n}`),t="";else if(t.length>s){let[e,n,a]=[t.slice(0,s-1),t.slice(s-1,s),t.slice(s)],l=Math.round(Number(`${n}.${a}`));(t=l>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${l}`).length>s&&(t=t.slice(1),r=`${BigInt(r)+1n}`),t=t.slice(0,s)}else t=t.padEnd(s,"0");return BigInt(`${a?"-":""}${r}${t}`)}},29680:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/burn",function(){return r(96693)}])},42038:(e,s,r)=>{"use strict";r.d(s,{C:()=>n});var t=r(97685),n=e=>!!e||(t.oR.error("请先将钱包链接 ".concat("thinkium70001")),!1)},69167:(e,s,r)=>{"use strict";r.d(s,{v:()=>o});var t=r(57616),n=r(94833),a=r(14237),l=r(66655),c=r(8481),i=r(57771);async function o(e,s){let{abi:r,address:o,args:d,dataSuffix:m,functionName:u,...x}=s,f=x.account?(0,t.J)(x.account):e.account,h=(0,a.p)({abi:r,args:d,functionName:u});try{let{data:t}=await (0,c.T)(e,i.T,"call")({batch:!1,data:`${h}${m?m.replace("0x",""):""}`,to:o,...x,account:f}),a=(0,n.e)({abi:r,args:d,functionName:u,data:t||"0x"}),l=r.filter(e=>"name"in e&&e.name===s.functionName);return{result:a,request:{abi:l,address:o,args:d,dataSuffix:m,functionName:u,...x,account:f}}}catch(e){throw(0,l.j)(e,{abi:r,address:o,args:d,docsPath:"/docs/contract/simulateContract",functionName:u,sender:f?.address})}}},81675:(e,s,r)=>{"use strict";r.d(s,{v:()=>l});var t=r(69167),n=r(629),a=r(90203);async function l(e,s){let r,{abi:l,chainId:c,connector:i,...o}=s;r=s.account?s.account:(await (0,a.r)(e,{chainId:c,connector:i})).account;let d=e.getClient({chainId:c}),m=(0,n.T)(d,t.v,"simulateContract"),{result:u,request:x}=await m({...o,abi:l,account:r});return{chainId:d.chain.id,result:u,request:{...x,chainId:c}}}},92659:(e,s,r)=>{"use strict";r.d(s,{lV:()=>v,MJ:()=>_,Rr:()=>w,zB:()=>N,eI:()=>y,lR:()=>g,C5:()=>k});var t=r(81110),n=r(40120),a=r(3576),l=r(62701),c=r(65699),i=r(37876),o=r(14232),d=r(39358),m=r(88992),u=r(30684),x=r(49794),f=(0,r(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=o.forwardRef((e,s)=>{var r=e.className,t=(0,c._)(e,["className"]);return(0,i.jsx)(x.b,(0,a._)({ref:s,className:(0,u.cn)(f(),r)},t))});h.displayName=x.b.displayName;var v=m.Op,p=o.createContext({}),N=e=>{var s=(0,t._)({},(0,n._)(e));return(0,i.jsx)(p.Provider,{value:{name:s.name},children:(0,i.jsx)(m.xI,(0,a._)({},s))})},b=()=>{var e=o.useContext(p),s=o.useContext(j),r=(0,m.xW)(),t=r.getFieldState,n=r.formState,l=t(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");var c=s.id;return(0,a._)({id:c,name:e.name,formItemId:"".concat(c,"-form-item"),formDescriptionId:"".concat(c,"-form-item-description"),formMessageId:"".concat(c,"-form-item-message")},l)},j=o.createContext({}),y=o.forwardRef((e,s)=>{var r=e.className,t=(0,c._)(e,["className"]),n=o.useId();return(0,i.jsx)(j.Provider,{value:{id:n},children:(0,i.jsx)("div",(0,a._)({ref:s,className:(0,u.cn)("space-y-2",r)},t))})});y.displayName="FormItem";var g=o.forwardRef((e,s)=>{var r=e.className,t=(0,c._)(e,["className"]),n=b(),l=n.error,o=n.formItemId;return(0,i.jsx)(h,(0,a._)({ref:s,className:(0,u.cn)(l&&"text-destructive",r),htmlFor:o},t))});g.displayName="FormLabel";var _=o.forwardRef((e,s)=>{var r=(0,t._)({},(0,n._)(e)),l=b(),c=l.error,o=l.formItemId,m=l.formDescriptionId,u=l.formMessageId;return(0,i.jsx)(d.DX,(0,a._)({ref:s,id:o,"aria-describedby":c?"".concat(m," ").concat(u):"".concat(m),"aria-invalid":!!c},r))});_.displayName="FormControl";var w=o.forwardRef((e,s)=>{var r=e.className,t=(0,c._)(e,["className"]),n=b().formDescriptionId;return(0,i.jsx)("p",(0,a._)({ref:s,id:n,className:(0,u.cn)("text-sm text-muted-foreground",r)},t))});w.displayName="FormDescription";var k=o.forwardRef((e,s)=>{var r=e.className,t=e.children,n=(0,c._)(e,["className","children"]),o=b(),d=o.error,m=o.formMessageId,x=d?String(null==d?void 0:d.message):t;return x?(0,i.jsx)("p",(0,l._)((0,a._)({ref:s,id:m,className:(0,u.cn)("text-sm font-medium text-destructive",r)},n),{children:x})):null});k.displayName="FormMessage"},96693:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>A});var t=r(37876),n=r(14232),a=r(83416),l=r(40752),c=r(20451),i=r(16927),o=r(3576),d=r(62701),m=r(40854),u=r(4902),x=r(60513),f=r(13810),h=r(88992),v=r(8047),p=r(97685),N=r(89099),b=r(6960),j=r(77932),y=r(92659),g=r(20442),_=r(42038),w=r(9215),k=r(1709),I=r(12293),T=r(99574);let C=e=>{var s=e.token;e.launchInfo;var r=(0,v.F)(),a=r.address,l=r.chain,C=(0,N.useRouter)(),S=(0,w.lW)(null==s?void 0:s.address,a),A=S.balance,$=S.isPending,F=S.error,E=(0,w.lW)(null==s?void 0:s.parentTokenAddress,a),M=E.balance,P=(E.isPending,E.error),R=(0,w.lW)(null==s?void 0:s.parentTokenAddress,null==s?void 0:s.address),X=R.balance,J=(R.isPending,R.error),z=(0,w.PT)(null==s?void 0:s.address),B=z.totalSupply,D=(z.isPending,z.error),V=(0,n.useMemo)(()=>x.z.object({burnAmount:x.z.string().nonempty({message:"请输入销毁数量"}).refine(e=>Number(e)>0,{message:"销毁数量不能为0"})}).refine(e=>{if(!A)return!0;try{return!!(0,g.XS)(e.burnAmount)&&(0,g.XS)(e.burnAmount)<=A}catch(e){return!1}},{message:"销毁数量不能超过您的余额",path:["burnAmount"]}),[A]),W=(0,h.mN)({resolver:(0,f.u)(V),defaultValues:{burnAmount:""},mode:"onChange"}),L=W.watch("burnAmount");(0,n.useMemo)(()=>{try{return L?(0,g.XS)(L):0n}catch(e){return 0n}},[L]);var K=(0,m._)((0,n.useState)(0n),2),O=K[0],q=K[1];(0,n.useEffect)(()=>{var e=W.getValues("burnAmount");B&&X&&e&&q((0,g.XS)(e)*X/B)},[W.watch("burnAmount"),B,X]);var H=(0,w.HF)(null==s?void 0:s.address),U=H.burnForParentToken,Y=H.isPending,G=H.isConfirming,Q=H.isConfirmed,Z=H.writeError,ee=function(){var e=(0,i._)(function(e){return(0,u.YH)(this,function(s){switch(s.label){case 0:if(!(0,_.C)(l))return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,U((0,g.XS)(e.burnAmount))];case 2:return s.sent(),[3,4];case 3:return console.error(s.sent()),[3,4];case 4:return[2]}})});return function(s){return e.apply(this,arguments)}}();(0,n.useEffect)(()=>{Q&&(p.oR.success("销毁成功"),setTimeout(()=>{C.push("/dex/swap/?symbol=".concat(null==s?void 0:s.symbol,"&from=").concat(null==s?void 0:s.parentTokenSymbol))},1e3))},[Q,C,null==s?void 0:s.symbol]);var es=(0,c.g)().handleContractError;return((0,n.useEffect)(()=>{F&&es(F,"token"),J&&es(J,"token"),D&&es(D,"token"),P&&es(P,"token"),Z&&es(Z,"token")},[F,J,D,P,Z,es]),!s||$)?(0,t.jsx)(I.A,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(k.A,{title:"换回父币"}),(0,t.jsx)("div",{className:"stats w-full",children:(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title text-sm mr-6",children:"父币托底池总量"}),(0,t.jsxs)("div",{className:"stat-value text-secondary mt-2",children:[(0,g.NJ)(X||0n),(0,t.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:s.parentTokenSymbol})]}),(0,t.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["销毁 ",s.symbol,"，可从父币托底池取回 ",s.parentTokenSymbol]})]})}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(y.lV,(0,d._)((0,o._)({},W),{children:(0,t.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,t.jsx)(y.zB,{control:W.control,name:"burnAmount",render:e=>{var r=e.field;return(0,t.jsxs)(y.eI,{children:[(0,t.jsxs)(y.lR,{children:["要销毁的 ",s.symbol," 数量："]}),(0,t.jsx)(y.MJ,{children:(0,t.jsx)(j.p,(0,o._)({type:"number",placeholder:"请输入数量",disabled:0n>=(A||0n)||Y||G,className:"!ring-secondary-foreground"},r))}),(0,t.jsx)(y.C5,{})]})}}),(0,t.jsxs)("div",{className:"flex items-center text-sm",children:[(0,t.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",s.symbol,": ",(0,t.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(A||0n)})]}),(0,t.jsx)(b.$,{variant:"link",size:"sm",onClick:()=>{W.setValue("burnAmount",(0,g.Js)(A||0n))},disabled:0n>=(A||0n)||Y||G,className:"text-secondary",children:"全选"})]}),(0,t.jsx)("div",{className:"flex items-center justify-end text-sm my-2",children:(0,t.jsxs)("span",{className:"text-greyscale-400",children:["预计可取回 ",(0,t.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(O)})," ",s.parentTokenSymbol]})}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(b.$,{className:"text-white py-2 rounded-lg",onClick:W.handleSubmit(ee),disabled:Y||G||Q,children:Y?"提交中...":G?"确认中...":Q?"交易成功":"销毁 ".concat(s.symbol,"，换回父币")})}),(0,t.jsxs)("div",{className:"flex items-center justify-center text-sm my-2",children:[(0,t.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",s.parentTokenSymbol,":"," ",(0,t.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(M||0n)})," ",s.parentTokenSymbol]}),(0,t.jsx)(b.$,{variant:"link",size:"sm",onClick:()=>C.push("/dex/swap?from=".concat(s.parentTokenSymbol,"&to=").concat("TestTKM20"==s.parentTokenSymbol?"TKM":"TestTKM20")),className:"text-secondary ml-2",children:"去兑换"})]})]})})),(0,t.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,t.jsx)("p",{className:"mb-1",children:"计算公式："}),(0,t.jsxs)("p",{children:["所得 ",s.parentTokenSymbol," 数量 = 底池 ",s.parentTokenSymbol," 总量 * (销毁 ",s.symbol," 数量 /"," ",s.symbol," 总发行量)"]})]})]})]}),(0,t.jsx)(T.A,{isLoading:Y||G,text:Y?"提交交易...":"确认交易..."})]})};var S=r(60154);function A(){var e=((0,n.useContext)(a.N)||{}).token,s=(0,l.TU)(e?e.address:"0x0000000000000000000000000000000000000000"),r=s.launchInfo,i=s.isPending,o=s.error,d=(0,c.g)().handleContractError;return(0,n.useEffect)(()=>{o&&d(o,"launch")},[o]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.A,{title:"换回父币"}),(0,t.jsx)("main",{className:"flex-grow",children:i?(0,t.jsx)(I.A,{}):r?(0,t.jsx)(C,{token:e,launchInfo:r}):(0,t.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},99574:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(37876);r(14232);var n=r(7446);let a=e=>{var s=e.isLoading,r=e.text;return s?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(n.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,t.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===r?"Loading":r})]})}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[3308,9374,6869,154,3096,5139,3356,636,6593,8792],()=>s(29680)),_N_E=e.O()}]);