try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="37ec189b-c211-4ad6-a99e-b533932b7e66",e._sentryDebugIdIdentifier="sentry-dbid-37ec189b-c211-4ad6-a99e-b533932b7e66")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5781],{65160:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/burn",function(){return r(72587)}])},74193:function(e,n,r){"use strict";r.d(n,{NI:function(){return N},Wi:function(){return b},l0:function(){return x},lX:function(){return g},pf:function(){return j},xJ:function(){return p},zG:function(){return _}});var s=r(34788),t=r(12796),a=r(72253),i=r(14932),o=r(47702),c=r(85893),l=r(67294),d=r(88426),u=r(87536),m=r(40108),f=r(94193),x=u.RV,h=l.createContext({}),b=function(e){var n=(0,s._)({},(0,t._)(e));return(0,c.jsx)(h.Provider,{value:{name:n.name},children:(0,c.jsx)(u.Qr,(0,a._)({},n))})},v=function(){var e=l.useContext(h),n=l.useContext(y),r=(0,u.Gc)(),s=r.getFieldState,t=r.formState,i=s(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,a._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},i)},y=l.createContext({}),p=l.forwardRef(function(e,n){var r=e.className,s=(0,o._)(e,["className"]),t=l.useId();return(0,c.jsx)(y.Provider,{value:{id:t},children:(0,c.jsx)("div",(0,a._)({ref:n,className:(0,m.cn)("space-y-2",r)},s))})});p.displayName="FormItem";var g=l.forwardRef(function(e,n){var r=e.className,s=(0,o._)(e,["className"]),t=v(),i=t.error,l=t.formItemId;return(0,c.jsx)(f._,(0,a._)({ref:n,className:(0,m.cn)(i&&"text-destructive",r),htmlFor:l},s))});g.displayName="FormLabel";var N=l.forwardRef(function(e,n){var r=(0,s._)({},(0,t._)(e)),i=v(),o=i.error,l=i.formItemId,u=i.formDescriptionId,m=i.formMessageId;return(0,c.jsx)(d.g7,(0,a._)({ref:n,id:l,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},r))});N.displayName="FormControl";var j=l.forwardRef(function(e,n){var r=e.className,s=(0,o._)(e,["className"]),t=v().formDescriptionId;return(0,c.jsx)("p",(0,a._)({ref:n,id:t,className:(0,m.cn)("text-sm text-muted-foreground",r)},s))});j.displayName="FormDescription";var _=l.forwardRef(function(e,n){var r=e.className,s=e.children,t=(0,o._)(e,["className","children"]),l=v(),d=l.error,u=l.formMessageId,f=d?String(null==d?void 0:d.message):s;return f?(0,c.jsx)("p",(0,i._)((0,a._)({ref:n,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",r)},t),{children:f})):null});_.displayName="FormMessage"},94193:function(e,n,r){"use strict";r.d(n,{_:function(){return u}});var s=r(72253),t=r(47702),a=r(85893),i=r(67294),o=r(49102),c=r(12003),l=r(40108),d=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(function(e,n){var r=e.className,i=(0,t._)(e,["className"]);return(0,a.jsx)(o.f,(0,s._)({ref:n,className:(0,l.cn)(d(),r)},i))});u.displayName=o.f.displayName},72587:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return F}});var s=r(85893),t=r(67294),a=r(93778),i=r(70019),o=r(73591),c=r(11010),l=r(72253),d=r(14932),u=r(91309),m=r(97582),f=r(63448),x=r(56312),h=r(87536),b=r(42130),v=r(39360),y=r(86501),p=r(11163),g=r(27245),N=r(21774),j=r(74193),_=r(91529),I=r(85794),k=r(64777),w=r(42083),S=r(44576),T=function(e){var n,r=e.token;e.launchInfo;var a=(0,b.m)().address;(0,v.x)();var i=(0,p.useRouter)(),T=(0,I.hS)(null==r?void 0:r.address,a),C=T.balance,F=T.isPending,A=T.error,E=(0,I.hS)(null==r?void 0:r.parentTokenAddress,a),z=E.balance,B=(E.isPending,E.error),M=(0,I.hS)(null==r?void 0:r.parentTokenAddress,null==r?void 0:r.address),P=M.balance,D=(M.isPending,M.error),R=(0,I.A5)(null==r?void 0:r.address),L=R.totalSupply,Z=(R.isPending,R.error),H=(0,t.useMemo)(function(){return f.Ry({burnAmount:f.Z_().nonempty({message:"请输入销毁数量"}).refine(function(e){return Number(e)>0},{message:"销毁数量不能为0"})}).refine(function(e){if(!C)return!0;try{return!!(0,_.vz)(e.burnAmount)&&(0,_.vz)(e.burnAmount)<=C}catch(e){return!1}},{message:"销毁数量不能超过您的余额",path:["burnAmount"]})},[C]),V=(0,h.cI)({resolver:(0,x.F)(H),defaultValues:{burnAmount:""},mode:"onChange"}),G=V.watch("burnAmount");(0,t.useMemo)(function(){try{return G?(0,_.vz)(G):BigInt(0)}catch(e){return BigInt(0)}},[G]);var J=(0,u._)((0,t.useState)(BigInt(0)),2),K=J[0],X=J[1];(0,t.useEffect)(function(){var e=V.getValues("burnAmount");L&&P&&e&&X((0,_.vz)(e)*P/L)},[V.watch("burnAmount"),L,P]);var O=(0,I.l3)(null==r?void 0:r.address),W=O.burnForParentToken,Q=O.isPending,q=O.isConfirming,U=O.isConfirmed,Y=O.writeError,$=(n=(0,c._)(function(e){return(0,m.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,W((0,_.vz)(e.burnAmount))];case 1:case 2:return n.sent(),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)});(0,t.useEffect)(function(){U&&(y.Am.success("销毁成功"),setTimeout(function(){i.push("/my?symbol=".concat(null==r?void 0:r.symbol))},1e3))},[U,i,null==r?void 0:r.symbol]);var ee=(0,o.S)().handleContractError;return((0,t.useEffect)(function(){A&&ee(A,"token"),D&&ee(D,"token"),Z&&ee(Z,"token"),B&&ee(B,"token"),Y&&ee(Y,"token")},[A,D,Z,B,Y,ee]),!r||F)?(0,s.jsx)(w.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)(k.Z,{title:"换回父币"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"父币托底池总量"}),(0,s.jsxs)("div",{className:"stat-value text-secondary mt-2",children:[(0,_.LH)(P||BigInt(0)),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:r.parentTokenSymbol})]}),(0,s.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["销毁 ",r.symbol,"，可从父币托底池取回 ",r.parentTokenSymbol]})]})}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)(j.l0,(0,d._)((0,l._)({},V),{children:(0,s.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[(0,s.jsxs)("div",{className:"flex items-center text-sm my-0",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.symbol,": ",(0,s.jsx)("span",{className:"text-secondary",children:(0,_.LH)(C||BigInt(0))})]}),(0,s.jsx)(g.z,{variant:"link",size:"sm",onClick:function(){V.setValue("burnAmount",(0,_.bM)(C||BigInt(0)))},disabled:(C||BigInt(0))<=BigInt(0)||Q||q,className:"text-secondary",children:"最高"})]}),(0,s.jsx)(j.Wi,{control:V.control,name:"burnAmount",render:function(e){var n=e.field;return(0,s.jsxs)(j.xJ,{children:[(0,s.jsx)(j.NI,{children:(0,s.jsx)(N.I,(0,l._)({type:"number",placeholder:"请输入要销毁的 ".concat(r.symbol," 数量"),disabled:(C||BigInt(0))<=BigInt(0)||Q||q,className:"!ring-secondary-foreground"},n))}),(0,s.jsx)(j.zG,{})]})}}),(0,s.jsx)("div",{className:"flex items-center text-sm mt-1 mb-2",children:(0,s.jsxs)("span",{className:"text-greyscale-400",children:["预计可取回 ",(0,s.jsx)("span",{className:"text-secondary",children:(0,_.LH)(K)})," ",r.parentTokenSymbol]})}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(g.z,{className:"text-white py-2 rounded-lg",onClick:V.handleSubmit($),disabled:Q||q||U,children:Q?"提交中...":q?"确认中...":U?"交易成功":"销毁 ".concat(r.symbol,"，换回父币")})}),(0,s.jsxs)("div",{className:"flex items-center justify-center text-sm my-2",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.parentTokenSymbol,":"," ",(0,s.jsx)("span",{className:"text-secondary",children:(0,_.LH)(z||BigInt(0))})," ",r.parentTokenSymbol]}),(0,s.jsx)(g.z,{variant:"link",size:"sm",onClick:function(){return i.push("/dex/swap?from=".concat(r.parentTokenSymbol,"&to=").concat("TKM20"==r.parentTokenSymbol?"TKM":"TKM20"))},className:"text-secondary ml-2",children:"去兑换"})]})]})})),(0,s.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,s.jsx)("p",{className:"mb-1",children:"计算公式："}),(0,s.jsxs)("p",{children:["所得 ",r.parentTokenSymbol," 数量 = 底池 ",r.parentTokenSymbol," 总量 * (销毁 ",r.symbol," 数量 /"," ",r.symbol," 总发行量)"]})]})]})]}),(0,s.jsx)(S.Z,{isLoading:Q||q,text:Q?"提交交易...":"确认交易..."})]})},C=r(83494);function F(){var e=((0,t.useContext)(a.M)||{}).token,n=(0,i.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),r=n.launchInfo,c=n.isPending,l=n.error,d=(0,o.S)().handleContractError;return(0,t.useEffect)(function(){l&&d(l,"launch")},[l]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.Z,{title:"换回父币"}),(0,s.jsx)("main",{className:"flex-grow",children:c?(0,s.jsx)(w.Z,{}):r?(0,s.jsx)(T,{token:e,launchInfo:r}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}}},function(e){e.O(0,[8239,5115,1617,3494,3591,6127,6202,2888,9774,179],function(){return e(e.s=65160)}),_N_E=e.O()}]);