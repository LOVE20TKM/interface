try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="801ff7f3-42b1-4964-8371-1488869245a5",e._sentryDebugIdIdentifier="sentry-dbid-801ff7f3-42b1-4964-8371-1488869245a5")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5781],{65160:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/burn",function(){return t(72587)}])},74193:function(e,n,t){"use strict";t.d(n,{NI:function(){return N},Wi:function(){return p},l0:function(){return x},lX:function(){return y},pf:function(){return j},xJ:function(){return g},zG:function(){return I}});var r=t(34788),s=t(12796),a=t(72253),i=t(14932),o=t(47702),c=t(85893),l=t(67294),d=t(88426),u=t(87536),m=t(40108),f=t(94193),x=u.RV,h=l.createContext({}),p=function(e){var n=(0,r._)({},(0,s._)(e));return(0,c.jsx)(h.Provider,{value:{name:n.name},children:(0,c.jsx)(u.Qr,(0,a._)({},n))})},b=function(){var e=l.useContext(h),n=l.useContext(v),t=(0,u.Gc)(),r=t.getFieldState,s=t.formState,i=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,a._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},i)},v=l.createContext({}),g=l.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),s=l.useId();return(0,c.jsx)(v.Provider,{value:{id:s},children:(0,c.jsx)("div",(0,a._)({ref:n,className:(0,m.cn)("space-y-2",t)},r))})});g.displayName="FormItem";var y=l.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),s=b(),i=s.error,l=s.formItemId;return(0,c.jsx)(f._,(0,a._)({ref:n,className:(0,m.cn)(i&&"text-destructive",t),htmlFor:l},r))});y.displayName="FormLabel";var N=l.forwardRef(function(e,n){var t=(0,r._)({},(0,s._)(e)),i=b(),o=i.error,l=i.formItemId,u=i.formDescriptionId,m=i.formMessageId;return(0,c.jsx)(d.g7,(0,a._)({ref:n,id:l,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},t))});N.displayName="FormControl";var j=l.forwardRef(function(e,n){var t=e.className,r=(0,o._)(e,["className"]),s=b().formDescriptionId;return(0,c.jsx)("p",(0,a._)({ref:n,id:s,className:(0,m.cn)("text-sm text-muted-foreground",t)},r))});j.displayName="FormDescription";var I=l.forwardRef(function(e,n){var t=e.className,r=e.children,s=(0,o._)(e,["className","children"]),l=b(),d=l.error,u=l.formMessageId,f=d?String(null==d?void 0:d.message):r;return f?(0,c.jsx)("p",(0,i._)((0,a._)({ref:n,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",t)},s),{children:f})):null});I.displayName="FormMessage"},94193:function(e,n,t){"use strict";t.d(n,{_:function(){return u}});var r=t(72253),s=t(47702),a=t(85893),i=t(67294),o=t(49102),c=t(12003),l=t(40108),d=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)(o.f,(0,r._)({ref:n,className:(0,l.cn)(d(),t)},i))});u.displayName=o.f.displayName},72587:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(85893),s=t(67294),a=t(93778),i=t(70019),o=t(73591),c=t(11010),l=t(72253),d=t(14932),u=t(91309),m=t(97582),f=t(63448),x=t(56312),h=t(87536),p=t(42130),b=t(39360),v=t(86501),g=t(11163),y=t(27245),N=t(21774),j=t(74193),I=t(91529),_=t(85794),k=t(64777),w=t(42083),S=t(44576),T=function(e){var n,t=e.token;e.launchInfo;var a=(0,p.m)().address;(0,b.x)();var i=(0,g.useRouter)(),T=(0,_.hS)(null==t?void 0:t.address,a),B=T.balance,C=T.isPending,F=T.error,A=(0,_.hS)(null==t?void 0:t.parentTokenAddress,a),E=A.balance,M=(A.isPending,A.error),z=(0,_.hS)(null==t?void 0:t.parentTokenAddress,null==t?void 0:t.address),$=z.balance,P=(z.isPending,z.error),D=(0,_.A5)(null==t?void 0:t.address),R=D.totalSupply,L=(D.isPending,D.error),Z=(0,s.useMemo)(function(){return f.Ry({burnAmount:f.Z_().nonempty({message:"请输入销毁数量"}).refine(function(e){return Number(e)>0},{message:"销毁数量不能为0"})}).refine(function(e){if(!B)return!0;try{return!!(0,I.vz)(e.burnAmount)&&(0,I.vz)(e.burnAmount)<=B}catch(e){return!1}},{message:"销毁数量不能超过您的余额",path:["burnAmount"]})},[B]),H=(0,h.cI)({resolver:(0,x.F)(Z),defaultValues:{burnAmount:""},mode:"onChange"}),V=H.watch("burnAmount");(0,s.useMemo)(function(){try{return V?(0,I.vz)(V):BigInt(0)}catch(e){return BigInt(0)}},[V]);var G=(0,u._)((0,s.useState)(BigInt(0)),2),J=G[0],K=G[1];(0,s.useEffect)(function(){var e=H.getValues("burnAmount");R&&$&&e&&K((0,I.vz)(e)*$/R)},[H.watch("burnAmount"),R,$]);var W=(0,_.l3)(null==t?void 0:t.address),X=W.burnForParentToken,O=W.isPending,Q=W.isConfirming,q=W.isConfirmed,U=W.writeError,Y=(n=(0,c._)(function(e){return(0,m.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,X((0,I.vz)(e.burnAmount))];case 1:case 2:return n.sent(),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)});(0,s.useEffect)(function(){q&&(v.Am.success("销毁成功"),setTimeout(function(){i.push("/my?symbol=".concat(null==t?void 0:t.symbol))},1e3))},[q,i,null==t?void 0:t.symbol]);var ee=(0,o.S)().handleContractError;return((0,s.useEffect)(function(){F&&ee(F,"token"),P&&ee(P,"token"),L&&ee(L,"token"),M&&ee(M,"token"),U&&ee(U,"token")},[F,P,L,M,U,ee]),!t||C)?(0,r.jsx)(w.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)(k.Z,{title:"换回父币"}),(0,r.jsx)("div",{className:"stats w-full",children:(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm mr-6",children:"父币托底池总量"}),(0,r.jsxs)("div",{className:"stat-value text-secondary mt-2",children:[(0,I.LH)($||BigInt(0)),(0,r.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:t.parentTokenSymbol})]}),(0,r.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["销毁 ",t.symbol,"，可从父币托底池取回 ",t.parentTokenSymbol]})]})}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)(j.l0,(0,d._)((0,l._)({},H),{children:(0,r.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[(0,r.jsxs)("div",{className:"flex items-center text-sm my-0",children:[(0,r.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",t.symbol,": ",(0,r.jsx)("span",{className:"text-secondary",children:(0,I.LH)(B||BigInt(0))})]}),(0,r.jsx)(y.z,{variant:"link",size:"sm",onClick:function(){H.setValue("burnAmount",(0,I.bM)(B||BigInt(0)))},disabled:(B||BigInt(0))<=BigInt(0)||O||Q,className:"text-secondary",children:"最高"})]}),(0,r.jsx)(j.Wi,{control:H.control,name:"burnAmount",render:function(e){var n=e.field;return(0,r.jsxs)(j.xJ,{children:[(0,r.jsx)(j.NI,{children:(0,r.jsx)(N.I,(0,l._)({type:"number",placeholder:"请输入要销毁的 ".concat(t.symbol," 数量"),disabled:(B||BigInt(0))<=BigInt(0)||O||Q,className:"!ring-secondary-foreground"},n))}),(0,r.jsx)(j.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center text-sm mt-1 mb-2",children:(0,r.jsxs)("span",{className:"text-greyscale-400",children:["预计可取回 ",(0,r.jsx)("span",{className:"text-secondary",children:(0,I.LH)(J)})," ",t.parentTokenSymbol]})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(y.z,{className:"text-white py-2 rounded-lg",onClick:H.handleSubmit(Y),disabled:O||Q||q,children:O?"提交中...":Q?"确认中...":q?"交易成功":"销毁 ".concat(t.symbol,"，换回父币")})}),(0,r.jsxs)("div",{className:"flex items-center justify-center text-sm my-2",children:[(0,r.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",t.parentTokenSymbol,":"," ",(0,r.jsx)("span",{className:"text-secondary",children:(0,I.LH)(E||BigInt(0))})," ",t.parentTokenSymbol]}),(0,r.jsx)(y.z,{variant:"link",size:"sm",onClick:function(){return i.push("/dex/swap?from=".concat(t.parentTokenSymbol,"&to=").concat("TKM20"==t.parentTokenSymbol?"TKM":"TKM20"))},className:"text-secondary ml-2",children:"去兑换"})]})]})})),(0,r.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,r.jsx)("p",{className:"mb-1",children:"计算公式："}),(0,r.jsxs)("p",{children:["所得 ",t.parentTokenSymbol," 数量 = 底池 ",t.parentTokenSymbol," 总量 * (销毁 ",t.symbol," 数量 /"," ",t.symbol," 总发行量)"]})]})]})]}),(0,r.jsx)(S.Z,{isLoading:O||Q,text:O?"提交交易...":"确认交易..."})]})},B=t(83494);function C(){var e=((0,s.useContext)(a.M)||{}).token,n=(0,i.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),t=n.launchInfo,c=n.isPending,l=n.error,d=(0,o.S)().handleContractError;return(0,s.useEffect)(function(){l&&d(l,"launch")},[l]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.Z,{title:"换回父币"}),(0,r.jsx)("main",{className:"flex-grow",children:c?(0,r.jsx)(w.Z,{}):t?(0,r.jsx)(T,{token:e,launchInfo:t}):(0,r.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},21803:function(e,n,t){"use strict";function r(e,n){let[t,r="0"]=e.split("."),s=t.startsWith("-");if(s&&(t=t.slice(1)),r=r.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${r}`))&&(t=`${BigInt(t)+1n}`),r="";else if(r.length>n){let[e,s,a]=[r.slice(0,n-1),r.slice(n-1,n),r.slice(n)],i=Math.round(Number(`${s}.${a}`));(r=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>n&&(r=r.slice(1),t=`${BigInt(t)+1n}`),r=r.slice(0,n)}else r=r.padEnd(n,"0");return BigInt(`${s?"-":""}${t}${r}`)}t.d(n,{v:function(){return r}})}},function(e){e.O(0,[8239,367,1617,3494,2252,6127,6202,2888,9774,179],function(){return e(e.s=65160)}),_N_E=e.O()}]);