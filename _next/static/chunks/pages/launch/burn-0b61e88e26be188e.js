try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b0b51792-02f5-4ceb-8715-19e0e1116373",e._sentryDebugIdIdentifier="sentry-dbid-b0b51792-02f5-4ceb-8715-19e0e1116373")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5781],{65160:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/burn",function(){return r(72587)}])},74193:function(e,n,r){"use strict";r.d(n,{NI:function(){return N},Wi:function(){return g},l0:function(){return h},lX:function(){return y},pf:function(){return j},xJ:function(){return p},zG:function(){return k}});var t=r(34788),s=r(12796),a=r(72253),i=r(14932),o=r(47702),c=r(85893),u=r(67294),l=r(88426),d=r(87536),m=r(40108),f=r(94193),h=d.RV,x=u.createContext({}),g=function(e){var n=(0,t._)({},(0,s._)(e));return(0,c.jsx)(x.Provider,{value:{name:n.name},children:(0,c.jsx)(d.Qr,(0,a._)({},n))})},v=function(){var e=u.useContext(x),n=u.useContext(b),r=(0,d.Gc)(),t=r.getFieldState,s=r.formState,i=t(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,a._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},i)},b=u.createContext({}),p=u.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=u.useId();return(0,c.jsx)(b.Provider,{value:{id:s},children:(0,c.jsx)("div",(0,a._)({ref:n,className:(0,m.cn)("space-y-2",r)},t))})});p.displayName="FormItem";var y=u.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=v(),i=s.error,u=s.formItemId;return(0,c.jsx)(f._,(0,a._)({ref:n,className:(0,m.cn)(i&&"text-destructive",r),htmlFor:u},t))});y.displayName="FormLabel";var N=u.forwardRef(function(e,n){var r=(0,t._)({},(0,s._)(e)),i=v(),o=i.error,u=i.formItemId,d=i.formDescriptionId,m=i.formMessageId;return(0,c.jsx)(l.g7,(0,a._)({ref:n,id:u,"aria-describedby":o?"".concat(d," ").concat(m):"".concat(d),"aria-invalid":!!o},r))});N.displayName="FormControl";var j=u.forwardRef(function(e,n){var r=e.className,t=(0,o._)(e,["className"]),s=v().formDescriptionId;return(0,c.jsx)("p",(0,a._)({ref:n,id:s,className:(0,m.cn)("text-sm text-muted-foreground",r)},t))});j.displayName="FormDescription";var k=u.forwardRef(function(e,n){var r=e.className,t=e.children,s=(0,o._)(e,["className","children"]),u=v(),l=u.error,d=u.formMessageId,f=l?String(null==l?void 0:l.message):t;return f?(0,c.jsx)("p",(0,i._)((0,a._)({ref:n,id:d,className:(0,m.cn)("text-sm font-medium text-destructive",r)},s),{children:f})):null});k.displayName="FormMessage"},94193:function(e,n,r){"use strict";r.d(n,{_:function(){return d}});var t=r(72253),s=r(47702),a=r(85893),i=r(67294),o=r(49102),c=r(12003),u=r(40108),l=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(function(e,n){var r=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)(o.f,(0,t._)({ref:n,className:(0,u.cn)(l(),r)},i))});d.displayName=o.f.displayName},64777:function(e,n,r){"use strict";var t=r(85893);n.Z=function(e){var n=e.title;return(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-lg font-bold",children:n})})}},42083:function(e,n,r){"use strict";var t=r(85893),s=r(23432);n.Z=function(){return(0,t.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},85794:function(e,n,r){"use strict";r.d(n,{A5:function(){return h},DA:function(){return v},hS:function(){return m},l3:function(){return g},yA:function(){return x},yG:function(){return d},z4:function(){return f}});var t=r(11010),s=r(97582),a=r(67294),i=r(71104),o=r(37541),c=r(37742),u=r(37474),l=r(84689),d=function(e,n,r){var t=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=(0,i.u)({address:e,abi:o.O,functionName:"allowance",args:[n,r],query:{enabled:!!e&&!!n&&!!r&&t}}),a=s.data,u=s.isPending,l=s.error,d=s.refetch;return{allowance:void 0!==a?(0,c.Z)(a):void 0,isPending:u,error:l,refetch:d}},m=function(e,n){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],t=(0,i.u)({address:e,abi:o.O,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n&&r}}),s=t.data,a=t.isPending,u=t.error,l=t.refetch;return{balance:void 0!==s?(0,c.Z)(s):void 0,isPending:a,error:u,refetch:l}},f=function(e){var n=(0,i.u)({address:e,abi:o.O,functionName:"symbol",args:[],query:{enabled:!!e}});return{symbol:n.data,isPending:n.isPending,error:n.error}},h=function(e){var n=(0,i.u)({address:e,abi:o.O,functionName:"totalSupply",args:[],query:{enabled:!!e}}),r=n.data,t=n.isPending,s=n.error;return{totalSupply:void 0!==r?(0,c.Z)(r):void 0,isPending:t,error:s}};function x(e){var n,r=(0,u.e9)(o.O,e,"approve"),i=r.execute,c=r.isPending,d=r.isConfirming,m=r.isConfirmed,f=r.error,h=r.hash,x=r.isTukeMode,g=(n=(0,t._)(function(n,r){return(0,s.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交approve交易:",{token:e,spender:n,value:r,isTukeMode:x}),[4,i([n,r])];case 1:return[2,t.sent()]}})}),function(e,r){return n.apply(this,arguments)});return(0,a.useEffect)(function(){h&&console.log("approve tx hash:",h),f&&(console.log("提交approve交易错误:"),(0,l.Vh)(f),(0,l.H)(f))},[h,f]),{approve:g,isPending:c,isConfirming:d,writeError:f,isConfirmed:m,hash:h,isTukeMode:x}}function g(e){var n,r=(0,u.e9)(o.O,e,"burnForParentToken"),i=r.execute,c=r.isPending,d=r.isConfirming,m=r.isConfirmed,f=r.error,h=r.hash,x=r.isTukeMode,g=(n=(0,t._)(function(n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交burnForParentToken交易:",{token:e,amount:n,isTukeMode:x}),[4,i([n])];case 1:return[2,r.sent()]}})}),function(e){return n.apply(this,arguments)});return(0,a.useEffect)(function(){h&&console.log("burnForParentToken tx hash:",h),f&&(console.log("提交burnForParentToken交易错误:"),(0,l.Vh)(f),(0,l.H)(f))},[h,f]),{burnForParentToken:g,isPending:c,isConfirming:d,writeError:f,isConfirmed:m,hash:h,isTukeMode:x}}function v(e){var n,r=(0,u.e9)(o.O,e,"transfer"),i=r.execute,c=r.isPending,d=r.isConfirming,m=r.isConfirmed,f=r.error,h=r.hash,x=r.isTukeMode,g=(n=(0,t._)(function(n,r){return(0,s.Jh)(this,function(t){switch(t.label){case 0:return console.log("提交transfer交易:",{token:e,to:n,amount:r,isTukeMode:x}),[4,i([n,r])];case 1:return[2,t.sent()]}})}),function(e,r){return n.apply(this,arguments)});return(0,a.useEffect)(function(){h&&console.log("transfer tx hash:",h),f&&(console.log("提交transfer交易错误:"),(0,l.Vh)(f),(0,l.H)(f))},[h,f]),{transfer:g,isPending:c,isConfirming:d,writeError:f,isConfirmed:m,hash:h,isTukeMode:x}}},72587:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return S}});var t=r(85893),s=r(67294),a=r(93778),i=r(70019),o=r(73591),c=r(11010),u=r(72253),l=r(14932),d=r(91309),m=r(97582),f=r(45901),h=r(56312),x=r(87536),g=r(42130),v=r(39360),b=r(86501),p=r(11163),y=r(27245),N=r(21774),j=r(74193),k=r(91529),_=r(85794),w=r(64777),I=r(42083),T=r(44576),P=function(e){var n,r=e.token;e.launchInfo;var a=(0,g.m)().address;(0,v.x)();var i=(0,p.useRouter)(),P=(0,_.hS)(null==r?void 0:r.address,a),C=P.balance,S=P.isPending,F=P.error,E=(0,_.hS)(null==r?void 0:r.parentTokenAddress,a),M=E.balance,A=(E.isPending,E.error),z=(0,_.hS)(null==r?void 0:r.parentTokenAddress,null==r?void 0:r.address),Z=z.balance,B=(z.isPending,z.error),D=(0,_.A5)(null==r?void 0:r.address),O=D.totalSupply,R=(D.isPending,D.error),H=(0,s.useMemo)(function(){return f.Ry({burnAmount:f.Z_().nonempty({message:"请输入销毁数量"}).refine(function(e){return Number(e)>0},{message:"销毁数量不能为0"})}).refine(function(e){if(!C)return!0;try{return!!(0,k.vz)(e.burnAmount)&&(0,k.vz)(e.burnAmount)<=C}catch(e){return!1}},{message:"销毁数量不能超过您的余额",path:["burnAmount"]})},[C]),V=(0,x.cI)({resolver:(0,h.F)(H),defaultValues:{burnAmount:""},mode:"onChange"}),J=V.watch("burnAmount");(0,s.useMemo)(function(){try{return J?(0,k.vz)(J):BigInt(0)}catch(e){return BigInt(0)}},[J]);var L=(0,d._)((0,s.useState)(BigInt(0)),2),q=L[0],G=L[1];(0,s.useEffect)(function(){var e=V.getValues("burnAmount");O&&Z&&e&&G((0,k.vz)(e)*Z/O)},[V.watch("burnAmount"),O,Z]);var K=(0,_.l3)(null==r?void 0:r.address),X=K.burnForParentToken,W=K.isPending,Q=K.isConfirming,U=K.isConfirmed,Y=K.writeError,$=(n=(0,c._)(function(e){return(0,m.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,X((0,k.vz)(e.burnAmount))];case 1:return n.sent(),[3,3];case 2:return console.error(n.sent()),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)});(0,s.useEffect)(function(){U&&(b.Am.success("销毁成功"),setTimeout(function(){i.push("/my?symbol=".concat(null==r?void 0:r.symbol))},1e3))},[U,i,null==r?void 0:r.symbol]);var ee=(0,o.S)().handleContractError;return((0,s.useEffect)(function(){F&&ee(F,"token"),B&&ee(B,"token"),R&&ee(R,"token"),A&&ee(A,"token"),Y&&ee(Y,"token")},[F,B,R,A,Y,ee]),!r||S)?(0,t.jsx)(I.Z,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(w.Z,{title:"换回父币"}),(0,t.jsx)("div",{className:"stats w-full",children:(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title text-sm mr-6",children:"父币托底池总量"}),(0,t.jsxs)("div",{className:"stat-value text-secondary mt-2",children:[(0,k.LH)(Z||BigInt(0)),(0,t.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:r.parentTokenSymbol})]}),(0,t.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["销毁 ",r.symbol,"，可从托底池取回 ",r.parentTokenSymbol]})]})}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(j.l0,(0,l._)((0,u._)({},V),{children:(0,t.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[(0,t.jsxs)("div",{className:"flex items-center text-sm my-0",children:[(0,t.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.symbol,":"," ",(0,t.jsx)("span",{className:"text-secondary",children:(0,k.LH)(C||BigInt(0))})]}),(0,t.jsx)(y.z,{variant:"link",size:"sm",onClick:function(){V.setValue("burnAmount",(0,k.bM)(C||BigInt(0)))},disabled:(C||BigInt(0))<=BigInt(0)||W||Q,className:"text-secondary",children:"最高"})]}),(0,t.jsx)(j.Wi,{control:V.control,name:"burnAmount",render:function(e){var n=e.field;return(0,t.jsxs)(j.xJ,{children:[(0,t.jsx)(j.NI,{children:(0,t.jsx)(N.I,(0,u._)({type:"number",placeholder:"请输入要销毁的 ".concat(r.symbol," 数量"),disabled:(C||BigInt(0))<=BigInt(0)||W||Q,className:"!ring-secondary-foreground"},n))}),(0,t.jsx)(j.zG,{})]})}}),(0,t.jsx)("div",{className:"flex items-center text-sm mt-1 mb-2",children:(0,t.jsxs)("span",{className:"text-greyscale-400",children:["预计可取回 ",(0,t.jsx)("span",{className:"text-secondary",children:(0,k.LH)(q)})," ",r.parentTokenSymbol]})}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(y.z,{className:"text-white py-2 rounded-lg",onClick:V.handleSubmit($),disabled:W||Q||U,children:W?"提交中...":Q?"确认中...":U?"交易成功":"销毁 ".concat(r.symbol,"，换回父币")})}),(0,t.jsxs)("div",{className:"flex items-center justify-center text-sm my-2",children:[(0,t.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.parentTokenSymbol,":"," ",(0,t.jsx)("span",{className:"text-secondary",children:(0,k.LH)(M||BigInt(0))})," ",r.parentTokenSymbol]}),(0,t.jsx)(y.z,{variant:"link",size:"sm",onClick:function(){return i.push("/dex/swap?from=".concat(r.parentTokenSymbol,"&to=").concat("TKM20"==r.parentTokenSymbol?"TKM":"TKM20"))},className:"text-secondary ml-2",children:"去兑换"})]})]})})),(0,t.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,t.jsx)("p",{className:"mb-1",children:"计算公式："}),(0,t.jsxs)("p",{children:["所得 ",r.parentTokenSymbol," 数量 = 底池 ",r.parentTokenSymbol," 总量 * (销毁 ",r.symbol," 数量 /"," ",r.symbol," 总发行量)"]})]})]})]}),(0,t.jsx)(T.Z,{isLoading:W||Q,text:W?"提交交易...":"确认交易..."})]})},C=r(83494);function S(){var e=((0,s.useContext)(a.M)||{}).token,n=(0,i.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),r=n.launchInfo,c=n.isPending,u=n.error,l=(0,o.S)().handleContractError;return(0,s.useEffect)(function(){u&&l(u,"launch")},[u]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{title:"换回父币"}),(0,t.jsx)("main",{className:"flex-grow",children:c?(0,t.jsx)(I.Z,{}):r?(0,t.jsx)(P,{token:e,launchInfo:r}):(0,t.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}}},function(e){e.O(0,[8501,4463,721,3494,3591,19,2888,9774,179],function(){return e(e.s=65160)}),_N_E=e.O()}]);