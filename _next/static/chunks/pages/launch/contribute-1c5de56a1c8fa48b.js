(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1109],{18449:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var s=n(76200);class r extends s.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[n,s="0"]=e.split("."),a=n.startsWith("-");if(a&&(n=n.slice(1)),s=s.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${s}`))&&(n=`${BigInt(n)+1n}`),s="";else if(s.length>t){let[e,r,a]=[s.slice(0,t-1),s.slice(t-1,t),s.slice(t)],i=Math.round(Number(`${r}.${a}`));(s=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(s=s.slice(1),n=`${BigInt(n)+1n}`),s=s.slice(0,t)}else s=s.padEnd(t,"0");return BigInt(`${a?"-":""}${n}${s}`)}},42038:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});var s=n(97685),r=e=>!!e||(s.oR.error("请先将钱包链接 ".concat("thinkium70001")),!1)},63346:(e,t,n)=>{"use strict";n.d(t,{D:()=>u,E:()=>c});var s=n(16927),r=n(4902),a=n(14232),i=n(38967),d=n(92165),o=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"stakeAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeLiquidity",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"tokenAmount",type:"uint256",internalType:"uint256"},{name:"parentTokenAmount",type:"uint256",internalType:"uint256"},{name:"tokenAmountMin",type:"uint256",internalType:"uint256"},{name:"parentTokenAmountMin",type:"uint256",internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[{name:"govVotesAdded",type:"uint256",internalType:"uint256"},{name:"slAmountAdded",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"StakeLiquidity",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"tokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],l="0xA6B78658F5327CfaE9FA8d68988520E75b44a396";function u(){var e=(0,i.VR)(o,l,"contributeFirstTokenWithETH"),t=e.execute,n=e.isPending,u=e.isConfirming,c=e.isConfirmed,m=e.error,p=e.hash,y=e.isTukeMode;return(0,a.useEffect)(()=>{p&&console.log("contributeFirstTokenWithETH tx hash:",p),m&&(console.log("提交contributeWithETH交易错误:"),(0,d.YN)(m),(0,d.vV)(m))},[p,m]),{contribute:(e,n,a)=>(0,s._)(function(){return(0,r.YH)(this,function(s){switch(s.label){case 0:return console.log("提交contributeWithETH交易:",{tokenAddress:e,to:n,ethAmount:a,isTukeMode:y}),[4,t([e,n],a)];case 1:return[2,s.sent()]}})})(),isPending:n,isConfirming:u,writeError:m,isConfirmed:c,hash:p,isTukeMode:y}}function c(){var e=(0,i.VR)(o,l,"stakeLiquidity"),t=e.execute,n=e.isPending,u=e.isConfirming,c=e.isConfirmed,m=e.error,p=e.hash,y=e.isTukeMode;return(0,a.useEffect)(()=>{p&&console.log("stakeLiquidity tx hash:",p),m&&(console.log("提交stakeLiquidity交易错误:"),(0,d.YN)(m),(0,d.vV)(m))},[p,m]),{stakeLiquidity:(e,n,a,i,d,o,l)=>(0,s._)(function(){return(0,r.YH)(this,function(s){switch(s.label){case 0:return console.log("提交stakeLiquidity交易:",{tokenAddress:e,tokenAmount:n,parentTokenAmount:a,tokenAmountMin:i,parentTokenAmountMin:d,promisedWaitingPhases:o,to:l,isTukeMode:y}),[4,t([e,n,a,i,d,o,l])];case 1:return[2,s.sent()]}})})(),isPending:n,isConfirming:u,isConfirmed:c,writeError:m,hash:p,isTukeMode:y}}},63822:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>D});var s=n(37876),r=n(14232),a=n(83416),i=n(40752),d=n(20451),o=n(60154),l=n(12293),u=n(16927),c=n(3576),m=n(62701),p=n(40854),y=n(4902),f=n(89099),v=n(22442),x=n(13810),h=n(88992),b=n(48230),T=n.n(b),g=n(8047),N=n(57238),k=n(97685),j=n(6960),A=n(77932),w=n(92659),_=n(42038),E=n(20442),C=n(63346),M=n(9215),I=n(25239),S=n(1709),F=n(99574),$=n(7446);let R=e=>{var t=e.token;e.launchInfo;var n=(0,g.F)(),a=n.address,o=n.chain,b=n.isConnected,R=(0,f.useRouter)(),D=(null==t?void 0:t.parentTokenSymbol)=="TestTKM20",P=D?"TKM":(null==t?void 0:t.parentTokenSymbol)||"",H=(0,N.A)({address:a,query:{enabled:D}}),L=H.data,W=H.isLoading,B=H.error,q=(0,M.lW)(null==t?void 0:t.parentTokenAddress,a,!D),V=q.balance,X=q.isPending,z=q.error,Y=D?(null==L?void 0:L.value)||0n:V||0n,J=D?W:X,O=(0,i.$r)(null==t?void 0:t.address,a),K=O.contributed,G=O.isPending,U=O.error,Q=(0,h.mN)({resolver:(0,x.u)((e=>v.Ik({contributeAmount:v.Yj().nonempty({message:"请输入申购数量"}).refine(e=>Number(e)>0,{message:"申购数量不能为 0"}).refine(t=>{var n;return(null!=(n=(0,E.XS)(t))?n:0n)<=e},{message:"申购数量不能超过余额 (".concat((0,E.Js)(e),")")})}))(Y)),defaultValues:{contributeAmount:""}}),Z=(0,M.zH)(null==t?void 0:t.parentTokenAddress),ee=Z.approve,et=Z.isPending,en=Z.isConfirming,es=Z.isConfirmed,er=Z.writeError,ea=(0,p._)((0,r.useState)(!1),2),ei=ea[0],ed=ea[1],eo=(0,M.Gp)(null==t?void 0:t.parentTokenAddress,a,"0x84A823E10226679Ed7BcDD046d08F97a52EC2cf1",!D),el=eo.allowance,eu=eo.isPending,ec=eo.error;(0,r.useEffect)(()=>{es&&!D&&(ed(!0),k.oR.success("授权".concat(null==t?void 0:t.parentTokenSymbol,"成功")))},[es,null==t?void 0:t.parentTokenSymbol,D]);var em=Q.watch("contributeAmount");(0,r.useEffect)(()=>{if(D)return void ed(!0);var e,t=null!=(e=(0,E.XS)(em))?e:0n;t>0n&&el&&el>0n&&el>=t?ed(!0):ed(!1)},[em,el,D]);var ep=(0,C.D)(),ey=ep.contribute,ef=ep.isPending,ev=ep.isConfirming,ex=ep.isConfirmed,eh=ep.writeError,eb=(0,i.LO)(),eT=eb.contribute,eg=eb.isPending,eN=eb.isConfirming,ek=eb.isConfirmed,ej=eb.writeError,eA=D?ef:eg,ew=D?ev:eN,e_=D?ex:ek,eE=e=>(0,u._)(function(){var n,s;return(0,y.YH)(this,function(r){switch(r.label){case 0:if(!(0,_.C)(o))return[2];if(!D&&!ei)return k.oR.error("请先授权"),[2];r.label=1;case 1:if(r.trys.push([1,6,,7]),s=null!=(n=(0,E.XS)(e.contributeAmount))?n:0n,!D)return[3,3];return[4,ey(null==t?void 0:t.address,a,s)];case 2:return r.sent(),[3,5];case 3:return[4,eT(null==t?void 0:t.address,s,a)];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return console.error(r.sent()),[3,7];case 7:return[2]}})})();(0,r.useEffect)(()=>{e_&&(k.oR.success("申购成功"),setTimeout(()=>{R.push("/launch?symbol=".concat(null==t?void 0:t.symbol))},2e3))},[e_,R,null==t?void 0:t.symbol]);var eC=(0,I.q)().setError;(0,r.useEffect)(()=>{b&&!J&&void 0!==Y&&Y<=0n&&eC({name:"余额不足",message:"请先获取 ".concat(P,"，再来申购")})},[Y,eC,b,J,P]);var eM=(0,d.g)().handleContractError;(0,r.useEffect)(()=>{var e=D?eh:ej,t=D?B:z;e&&eM(e,"launch"),U&&eM(U,"launch"),t&&eM(t,D?"balance":"token"),!D&&(er&&eM(er,"token"),ec&&eM(ec,"token"))},[eh,ej,U,B,z,er,ec,eM,D]);var eI=et||en,eS=(0,r.useRef)(null);return((0,r.useEffect)(()=>{!eu&&eS.current&&eS.current.blur()},[eu]),b)?!t||J||G?(0,s.jsx)(l.A,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-4 mt-2",children:[(0,s.jsx)(S.A,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,E.NJ)(K||0n),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:P})]})]})}),(0,s.jsx)(w.lV,(0,m._)((0,c._)({},Q),{children:(0,s.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"space-y-4",children:[(0,s.jsx)(w.zB,{control:Q.control,name:"contributeAmount",render:e=>{var t=e.field;return(0,s.jsxs)(w.eI,{children:[(0,s.jsx)(w.lR,{children:"申购数量："}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(A.p,(0,c._)({type:"number",placeholder:"请填写".concat(P,"数量"),disabled:!D&&eI||Y<=0n,className:"!ring-secondary-foreground"},t))}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:[(0,E.NJ)(Y)," ",P]}),(0,s.jsx)(j.$,{variant:"link",size:"sm",onClick:()=>{Q.setValue("contributeAmount",(0,E.Js)(Y))},disabled:!D&&eI||Y<=0n,className:"text-secondary",children:"全部"}),!D&&(null==t?void 0:t.parentTokenSymbol)==="TestTKM20"&&(0,s.jsx)(T(),{href:"/dex/deposit?symbol=".concat(t.symbol),children:(0,s.jsxs)(j.$,{variant:"link",size:"sm",className:"text-secondary",children:["获取",t.parentTokenSymbol]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:D?(0,s.jsx)(j.$,{className:"w-full text-white py-2 rounded-lg",onClick:Q.handleSubmit(eE),disabled:eA||ew||e_||Y<=0n,children:eA?"申购中...":ew?"确认中...":e_?"申购成功":"申购"}):(0,s.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,s.jsx)(j.$,{ref:eS,className:"w-1/2",onClick:Q.handleSubmit(e=>(0,u._)(function(){var t;return(0,y.YH)(this,function(n){switch(n.label){case 0:if(!(0,_.C)(o))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,ee("0x84A823E10226679Ed7BcDD046d08F97a52EC2cf1",null!=(t=(0,E.XS)(e.contributeAmount))?t:0n)];case 2:return n.sent(),[3,4];case 3:return console.error(n.sent()),[3,4];case 4:return[2]}})})()),disabled:eu||et||en||ei,children:eu?(0,s.jsx)($.A,{className:"animate-spin"}):et?"1.提交中...":en?"1.确认中...":ei?"1.".concat(null==t?void 0:t.parentTokenSymbol,"已授权"):"1.授权".concat(null==t?void 0:t.parentTokenSymbol)}),(0,s.jsx)(j.$,{className:"w-1/2 text-white py-2 rounded-lg",onClick:Q.handleSubmit(eE),disabled:!ei||eA||ew||e_,children:eA?"2.申购中...":ew?"2.确认中...":e_?"2.申购成功":"2.申购"})]})})]})}))]}),(0,s.jsx)(F.A,{isLoading:eA||ew||!D&&(et||en),text:eA||!D&&et?"提交交易...":"确认交易..."})]}):(0,s.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,s.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function D(){var e=((0,r.useContext)(a.N)||{}).token,t=(0,i.TU)(e?e.address:"0x0000000000000000000000000000000000000000"),n=t.launchInfo,u=t.isPending,c=t.error,m=(0,d.g)().handleContractError;return(0,r.useEffect)(()=>{c&&m(c,"launch")},[c]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{title:"申购"}),(0,s.jsx)("main",{className:"flex-grow",children:u?(0,s.jsx)(l.A,{}):n?(0,s.jsx)(R,{token:e,launchInfo:n}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},92659:(e,t,n)=>{"use strict";n.d(t,{lV:()=>v,MJ:()=>k,Rr:()=>j,zB:()=>h,eI:()=>g,lR:()=>N,C5:()=>A});var s=n(81110),r=n(40120),a=n(3576),i=n(62701),d=n(65699),o=n(37876),l=n(14232),u=n(82987),c=n(88992),m=n(30684),p=n(59773),y=(0,n(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=l.forwardRef((e,t)=>{var n=e.className,s=(0,d._)(e,["className"]);return(0,o.jsx)(p.b,(0,a._)({ref:t,className:(0,m.cn)(y(),n)},s))});f.displayName=p.b.displayName;var v=c.Op,x=l.createContext({}),h=e=>{var t=(0,s._)({},(0,r._)(e));return(0,o.jsx)(x.Provider,{value:{name:t.name},children:(0,o.jsx)(c.xI,(0,a._)({},t))})},b=()=>{var e=l.useContext(x),t=l.useContext(T),n=(0,c.xW)(),s=n.getFieldState,r=n.formState,i=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var d=t.id;return(0,a._)({id:d,name:e.name,formItemId:"".concat(d,"-form-item"),formDescriptionId:"".concat(d,"-form-item-description"),formMessageId:"".concat(d,"-form-item-message")},i)},T=l.createContext({}),g=l.forwardRef((e,t)=>{var n=e.className,s=(0,d._)(e,["className"]),r=l.useId();return(0,o.jsx)(T.Provider,{value:{id:r},children:(0,o.jsx)("div",(0,a._)({ref:t,className:(0,m.cn)("space-y-2",n)},s))})});g.displayName="FormItem";var N=l.forwardRef((e,t)=>{var n=e.className,s=(0,d._)(e,["className"]),r=b(),i=r.error,l=r.formItemId;return(0,o.jsx)(f,(0,a._)({ref:t,className:(0,m.cn)(i&&"text-destructive",n),htmlFor:l},s))});N.displayName="FormLabel";var k=l.forwardRef((e,t)=>{var n=(0,s._)({},(0,r._)(e)),i=b(),d=i.error,l=i.formItemId,c=i.formDescriptionId,m=i.formMessageId;return(0,o.jsx)(u.DX,(0,a._)({ref:t,id:l,"aria-describedby":d?"".concat(c," ").concat(m):"".concat(c),"aria-invalid":!!d},n))});k.displayName="FormControl";var j=l.forwardRef((e,t)=>{var n=e.className,s=(0,d._)(e,["className"]),r=b().formDescriptionId;return(0,o.jsx)("p",(0,a._)({ref:t,id:r,className:(0,m.cn)("text-sm text-muted-foreground",n)},s))});j.displayName="FormDescription";var A=l.forwardRef((e,t)=>{var n=e.className,s=e.children,r=(0,d._)(e,["className","children"]),l=b(),u=l.error,c=l.formMessageId,p=u?String(null==u?void 0:u.message):s;return p?(0,o.jsx)("p",(0,i._)((0,a._)({ref:t,id:c,className:(0,m.cn)("text-sm font-medium text-destructive",n)},r),{children:p})):null});A.displayName="FormMessage"},94004:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return n(63822)}])},99574:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var s=n(37876),r=n(14232),a=n(7446);let i=e=>{var t=e.isLoading,n=e.text;return((0,r.useEffect)(()=>{if(t){var e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}},[t]),t)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 touch-none overscroll-none",onTouchMove:e=>{e.preventDefault()},onTouchStart:e=>{e.preventDefault()},style:{touchAction:"none"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===n?"Loading":n})]})}):null}}},e=>{e.O(0,[3308,6547,8230,9985,154,3096,5139,3356,636,6593,8792],()=>e(e.s=94004)),_N_E=e.O()}]);