try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4aff7c4d-31c7-4f91-b36f-7de024a60abd",e._sentryDebugIdIdentifier="sentry-dbid-4aff7c4d-31c7-4f91-b36f-7de024a60abd")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8251],{58862:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return t(58314)}])},74193:function(e,n,t){"use strict";t.d(n,{NI:function(){return g},Wi:function(){return h},l0:function(){return p},lX:function(){return T},pf:function(){return k},xJ:function(){return x},zG:function(){return A}});var s=t(34788),r=t(12796),i=t(72253),a=t(14932),o=t(47702),d=t(85893),u=t(67294),l=t(88426),c=t(87536),m=t(40108),f=t(94193),p=c.RV,y=u.createContext({}),h=function(e){var n=(0,s._)({},(0,r._)(e));return(0,d.jsx)(y.Provider,{value:{name:n.name},children:(0,d.jsx)(c.Qr,(0,i._)({},n))})},v=function(){var e=u.useContext(y),n=u.useContext(b),t=(0,c.Gc)(),s=t.getFieldState,r=t.formState,a=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var o=n.id;return(0,i._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},a)},b=u.createContext({}),x=u.forwardRef(function(e,n){var t=e.className,s=(0,o._)(e,["className"]),r=u.useId();return(0,d.jsx)(b.Provider,{value:{id:r},children:(0,d.jsx)("div",(0,i._)({ref:n,className:(0,m.cn)("space-y-2",t)},s))})});x.displayName="FormItem";var T=u.forwardRef(function(e,n){var t=e.className,s=(0,o._)(e,["className"]),r=v(),a=r.error,u=r.formItemId;return(0,d.jsx)(f._,(0,i._)({ref:n,className:(0,m.cn)(a&&"text-destructive",t),htmlFor:u},s))});T.displayName="FormLabel";var g=u.forwardRef(function(e,n){var t=(0,s._)({},(0,r._)(e)),a=v(),o=a.error,u=a.formItemId,c=a.formDescriptionId,m=a.formMessageId;return(0,d.jsx)(l.g7,(0,i._)({ref:n,id:u,"aria-describedby":o?"".concat(c," ").concat(m):"".concat(c),"aria-invalid":!!o},t))});g.displayName="FormControl";var k=u.forwardRef(function(e,n){var t=e.className,s=(0,o._)(e,["className"]),r=v().formDescriptionId;return(0,d.jsx)("p",(0,i._)({ref:n,id:r,className:(0,m.cn)("text-sm text-muted-foreground",t)},s))});k.displayName="FormDescription";var A=u.forwardRef(function(e,n){var t=e.className,s=e.children,r=(0,o._)(e,["className","children"]),u=v(),l=u.error,c=u.formMessageId,f=l?String(null==l?void 0:l.message):s;return f?(0,d.jsx)("p",(0,a._)((0,i._)({ref:n,id:c,className:(0,m.cn)("text-sm font-medium text-destructive",t)},r),{children:f})):null});A.displayName="FormMessage"},94193:function(e,n,t){"use strict";t.d(n,{_:function(){return c}});var s=t(72253),r=t(47702),i=t(85893),a=t(67294),o=t(49102),d=t(12003),u=t(40108),l=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(function(e,n){var t=e.className,a=(0,r._)(e,["className"]);return(0,i.jsx)(o.f,(0,s._)({ref:n,className:(0,u.cn)(l(),t)},a))});c.displayName=o.f.displayName},12956:function(e,n,t){"use strict";t.d(n,{E:function(){return l},X:function(){return c}});var s=t(11010),r=t(97582),i=t(67294),a=t(37474),o=t(84689),d=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"stakeAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeLiquidity",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"tokenAmount",type:"uint256",internalType:"uint256"},{name:"parentTokenAmount",type:"uint256",internalType:"uint256"},{name:"tokenAmountMin",type:"uint256",internalType:"uint256"},{name:"parentTokenAmountMin",type:"uint256",internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[{name:"govVotesAdded",type:"uint256",internalType:"uint256"},{name:"slAmountAdded",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"StakeLiquidity",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"tokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],u="0xbc8c89d8f3Cb1DDb6625e13D3F5487CAcbd396EE";function l(){var e,n=(0,a.e9)(d,u,"contributeFirstTokenWithETH"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,h=(e=(0,s._)(function(e,n,s){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交contributeWithETH交易:",{tokenAddress:e,to:n,ethAmount:s,isTukeMode:y}),[4,t([e,n],s)];case 1:return[2,r.sent()]}})}),function(n,t,s){return e.apply(this,arguments)});return(0,i.useEffect)(function(){p&&console.log("contributeFirstTokenWithETH tx hash:",p),f&&(console.log("提交contributeWithETH交易错误:"),(0,o.Vh)(f),(0,o.H)(f))},[p,f]),{contribute:h,isPending:l,isConfirming:c,writeError:f,isConfirmed:m,hash:p,isTukeMode:y}}function c(){var e,n=(0,a.e9)(d,u,"stakeLiquidity"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,h=(e=(0,s._)(function(e,n,s,i,a,o,d){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return console.log("提交stakeLiquidity交易:",{tokenAddress:e,tokenAmount:n,parentTokenAmount:s,tokenAmountMin:i,parentTokenAmountMin:a,promisedWaitingPhases:o,to:d,isTukeMode:y}),[4,t([e,n,s,i,a,o,d])];case 1:return[2,r.sent()]}})}),function(n,t,s,r,i,a,o){return e.apply(this,arguments)});return(0,i.useEffect)(function(){p&&console.log("stakeLiquidity tx hash:",p),f&&(console.log("提交stakeLiquidity交易错误:"),(0,o.Vh)(f),(0,o.H)(f))},[p,f]),{stakeLiquidity:h,isPending:l,isConfirming:c,isConfirmed:m,writeError:f,hash:p,isTukeMode:y}}},58314:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var s=t(85893),r=t(67294),i=t(93778),a=t(70019),o=t(73591),d=t(83494),u=t(42083),l=t(11010),c=t(72253),m=t(14932),f=t(91309),p=t(97582),y=t(11163),h=t(63448),v=t(56312),b=t(87536),x=t(41664),T=t.n(x),g=t(42130),k=t(39360),A=t(62776),_=t(86501),N=t(27245),j=t(21774),w=t(74193),E=t(26858),I=t(12956),C=t(85794),M=t(95049),B=t(64777),D=t(44576),F=t(23432),S=function(e){var n,t,i,d,x=e.token;e.launchInfo;var S=(0,g.m)(),P=S.address,z=S.isConnected;(0,k.x)();var W=(0,y.useRouter)(),H=(null==x?void 0:x.parentTokenSymbol)=="TKM20",L=H?"TKM":(null==x?void 0:x.parentTokenSymbol)||"",R=(0,A.K)({address:P,query:{enabled:H}}),q=R.data,V=R.isLoading,Z=R.error,J=(0,C.hS)(null==x?void 0:x.parentTokenAddress,P,!H),X=J.balance,G=J.isPending,K=J.error,O=H?(null==q?void 0:q.value)||BigInt(0):X||BigInt(0),Q=H?V:G,Y=(0,a.ap)(null==x?void 0:x.address,P),U=Y.contributed,$=Y.isPending,ee=Y.error,en=((0,E.vz)("0.001"),(0,b.cI)({resolver:(0,v.F)((n=void 0,t="0.001",h.Ry({contributeAmount:h.Z_().nonempty({message:"请输入申购数量"}).refine(function(e){return Number(e)>0},{message:"申购数量不能为 0"}).refine(function(e){var n;return(null!==(n=(0,E.vz)(e))&&void 0!==n?n:BigInt(0))<=O},{message:"申购数量不能超过余额 (".concat((0,E.bM)(O),")")}).refine(function(e){var t;return!n||(null!==(t=(0,E.vz)(e))&&void 0!==t?t:BigInt(0))<=n},{message:"测试环境限制：首个父币最多可申购 ".concat(t)})}))),defaultValues:{contributeAmount:""},mode:"onChange",reValidateMode:"onChange"})),et=(0,C.yA)(null==x?void 0:x.parentTokenAddress),es=et.approve,er=et.isPending,ei=et.isConfirming,ea=et.isConfirmed,eo=et.writeError,ed=(0,f._)((0,r.useState)(!1),2),eu=ed[0],el=ed[1],ec=(0,C.yG)(null==x?void 0:x.parentTokenAddress,P,"0xfbb35BfeDf07E238c8Ef60aB937B4DB2CDA2D268",!H),em=ec.allowance,ef=ec.isPending,ep=ec.error;(0,r.useEffect)(function(){ea&&!H&&(el(!0),_.Am.success("授权".concat(null==x?void 0:x.parentTokenSymbol,"成功")))},[ea,null==x?void 0:x.parentTokenSymbol,H]);var ey=en.watch("contributeAmount");(0,r.useEffect)(function(){if(H){el(!0);return}var e,n=null!==(e=(0,E.vz)(ey))&&void 0!==e?e:BigInt(0);n>BigInt(0)&&em&&em>BigInt(0)&&em>=n?el(!0):el(!1)},[ey,em,H]);var eh=(i=(0,l._)(function(e){var n;return(0,p.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,es("0xfbb35BfeDf07E238c8Ef60aB937B4DB2CDA2D268",null!==(n=(0,E.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0))];case 1:return t.sent(),[3,3];case 2:return console.error(t.sent()),[3,3];case 3:return[2]}})}),function(e){return i.apply(this,arguments)}),ev=(0,I.E)(),eb=ev.contribute,ex=ev.isPending,eT=ev.isConfirming,eg=ev.isConfirmed,ek=ev.writeError,eA=(0,a.OY)(),e_=eA.contribute,eN=eA.isPending,ej=eA.isConfirming,ew=eA.isConfirmed,eE=eA.writeError,eI=H?ex:eN,eC=H?eT:ej,eM=H?eg:ew,eB=(d=(0,l._)(function(e){var n,t;return(0,p.Jh)(this,function(s){switch(s.label){case 0:if(!H&&!eu)return _.Am.error("请先授权"),[2];s.label=1;case 1:if(s.trys.push([1,6,,7]),t=null!==(n=(0,E.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0),!H)return[3,3];return[4,eb(null==x?void 0:x.address,P,t)];case 2:return s.sent(),[3,5];case 3:return[4,e_(null==x?void 0:x.address,t,P)];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return console.error(s.sent()),[3,7];case 7:return[2]}})}),function(e){return d.apply(this,arguments)});(0,r.useEffect)(function(){eM&&(_.Am.success("申购成功"),setTimeout(function(){W.push("/launch?symbol=".concat(null==x?void 0:x.symbol))},2e3))},[eM,W,null==x?void 0:x.symbol]);var eD=(0,M.V)().setError;(0,r.useEffect)(function(){z&&!Q&&void 0!==O&&O<=BigInt(0)&&eD({name:"余额不足",message:"请先获取 ".concat(L,"，再来申购")})},[O,eD,z,Q,L]);var eF=(0,o.S)().handleContractError;(0,r.useEffect)(function(){var e=H?ek:eE,n=H?Z:K;e&&eF(e,"launch"),ee&&eF(ee,"launch"),n&&eF(n,H?"balance":"token"),!H&&(eo&&eF(eo,"token"),ep&&eF(ep,"token"))},[ek,eE,ee,Z,K,eo,ep,eF,H]);var eS=er||ei,eP=(0,r.useRef)(null);return((0,r.useEffect)(function(){!ef&&eP.current&&eP.current.blur()},[ef]),z)?!x||Q||$?(0,s.jsx)(u.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-4 mt-2",children:[(0,s.jsx)(B.Z,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,E.LH)(U||BigInt(0)),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:L})]})]})}),(0,s.jsx)(w.l0,(0,m._)((0,c._)({},en),{children:(0,s.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,s.jsx)(w.Wi,{control:en.control,name:"contributeAmount",render:function(e){var n=e.field;return(0,s.jsxs)(w.xJ,{children:[(0,s.jsx)(w.lX,{children:"申购数量："}),(0,s.jsx)(w.NI,{children:(0,s.jsx)(j.I,(0,c._)({type:"number",max:void 0,placeholder:"请填写".concat(L,"数量"),disabled:!H&&eS||O<=BigInt(0),className:"!ring-secondary-foreground"},n))}),(0,s.jsx)(w.zG,{}),!1]})}}),(0,s.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:[(0,E.LH)(O)," ",L]}),(0,s.jsx)(N.z,{variant:"link",size:"sm",onClick:function(){en.setValue("contributeAmount",(0,E.bM)(O))},disabled:!H&&eS||O<=BigInt(0),className:"text-secondary",children:"全部"}),!H&&(null==x?void 0:x.parentTokenSymbol)==="TKM20"&&(0,s.jsx)(T(),{href:"/dex/deposit?symbol=".concat(x.symbol),children:(0,s.jsxs)(N.z,{variant:"link",size:"sm",className:"text-secondary",children:["获取",x.parentTokenSymbol]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:H?(0,s.jsx)(N.z,{className:"w-full text-white py-2 rounded-lg",onClick:en.handleSubmit(eB),disabled:eI||eC||eM||O<=BigInt(0),children:eI?"申购中...":eC?"确认中...":eM?"申购成功":"申购"}):(0,s.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,s.jsx)(N.z,{ref:eP,className:"w-1/2",onClick:en.handleSubmit(eh),disabled:ef||er||ei||eu,children:ef?(0,s.jsx)(F.Z,{className:"animate-spin"}):er?"1.提交中...":ei?"1.确认中...":eu?"1.".concat(null==x?void 0:x.parentTokenSymbol,"已授权"):"1.授权".concat(null==x?void 0:x.parentTokenSymbol)}),(0,s.jsx)(N.z,{className:"w-1/2 text-white py-2 rounded-lg",onClick:en.handleSubmit(eB),disabled:!eu||eI||eC||eM,children:eI?"2.申购中...":eC?"2.确认中...":eM?"2.申购成功":"2.申购"})]})})]})}))]}),(0,s.jsx)(D.Z,{isLoading:eI||eC||!H&&(er||ei),text:eI||!H&&er?"提交交易...":"确认交易..."})]}):(0,s.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,s.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function P(){var e=((0,r.useContext)(i.M)||{}).token,n=(0,a.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),t=n.launchInfo,l=n.isPending,c=n.error,m=(0,o.S)().handleContractError;return(0,r.useEffect)(function(){c&&m(c,"launch")},[c]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{title:"申购"}),(0,s.jsx)("main",{className:"flex-grow",children:l?(0,s.jsx)(u.Z,{}):t?(0,s.jsx)(S,{token:e,launchInfo:t}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}}},function(e){e.O(0,[8501,4463,1617,3494,3591,6127,6202,2888,9774,179],function(){return e(e.s=58862)}),_N_E=e.O()}]);