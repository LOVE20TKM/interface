(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1109],{7446:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},18449:(e,t,r)=>{"use strict";r.d(t,{X:()=>s});var n=r(76200);class a extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function s(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new a({value:e});let[r,n="0"]=e.split("."),s=r.startsWith("-");if(s&&(r=r.slice(1)),n=n.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${n}`))&&(r=`${BigInt(r)+1n}`),n="";else if(n.length>t){let[e,a,s]=[n.slice(0,t-1),n.slice(t-1,t),n.slice(t)],i=Math.round(Number(`${a}.${s}`));(n=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(n=n.slice(1),r=`${BigInt(r)+1n}`),n=n.slice(0,t)}else n=n.padEnd(t,"0");return BigInt(`${s?"-":""}${r}${n}`)}},20442:(e,t,r)=>{"use strict";r.d(t,{$w:()=>i,Ee:()=>y,Js:()=>d,LP:()=>m,NJ:()=>o,W_:()=>s,XS:()=>l,Xo:()=>u,lM:()=>f,mW:()=>c});var n=r(18449),a=r(32602),s=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",i=e=>{var t=Number(d(e));return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=Number(d(e));if(e<10n)return"0";if(4!==t)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(r);if(r>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(r);if(r>=10)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(r);if(r>=1||r>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(r);if(0===r)return"0";var n=r.toFixed(14),a=n.split(".");if(a.length<2)return n;var s=a[1],i=0,o=!0,l=!1,c=void 0;try{for(var u,m=s[Symbol.iterator]();!(o=(u=m.next()).done);o=!0){var f=u.value;if("0"===f)i++;else break}}catch(e){l=!0,c=e}finally{try{o||null==m.return||m.return()}finally{if(l)throw c}}var p=s.slice(i,i+4);return"0.0{".concat(i,"}").concat(p)},l=e=>{var t=parseInt("18",10);try{var r=e.replace(/,/g,"");return(0,n.X)(r,t)}catch(e){return console.error("parseUnits error:",e),0n}},d=e=>{var t=parseInt("18",10);return(0,a.J)(e,t)},c=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,u=e=>e>86400?"".concat(Math.floor(e/86400),"天").concat(Math.floor(e%86400/3600),"小时").concat(Math.floor(e%3600/60),"分"):e>3600?"".concat(Math.floor(e/3600),"小时").concat(Math.floor(e%3600/60),"分"):"".concat(Math.floor(e/60),"分").concat(e%60,"秒"),m=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=Number(e);if(n>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(n);if(n>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:r+1}).format(n);if(0===n)return"0";var a=n.toFixed(r+10),s=a.split(".");if(s.length<2)return a;var i=s[1],o=0,l=!0,d=!1,c=void 0;try{for(var u,m=i[Symbol.iterator]();!(l=(u=m.next()).done);l=!0){var f=u.value;if("0"===f)o++;else break}}catch(e){d=!0,c=e}finally{try{l||null==m.return||m.return()}finally{if(d)throw c}}var p=i.slice(o);return"0.0{".concat(o,"}").concat(p)},p=(e,t)=>e.toFixed(t).replace(/\.?0+$/,""),y=e=>{var t="string"==typeof e?parseFloat(e):e,r=Math.abs(t);return 0===r?"0%":r>=100?t.toLocaleString(void 0,{maximumFractionDigits:0})+"%":r>=10?p(t,1)+"%":r>=1?p(t,2)+"%":r>=.1?p(t,3)+"%":r>=.01?p(t,4)+"%":t.toExponential(4)+"%"}},42038:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var n=r(97685),a=e=>!!e||(n.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},46593:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var n=r(37876),a=r(14232),s=r(83416),i=r(40752),o=r(20451),l=r(66663),d=r(12293),c=r(16927),u=r(3576),m=r(62701),f=r(40854),p=r(4902),y=r(89099),v=r(60513),x=r(13810),h=r(88992),b=r(48230),g=r.n(b),N=r(8047),w=r(57238),j=r(97685),_=r(6960),T=r(77932),A=r(92659),F=r(42038),C=r(20442),k=r(59493),E=r(40162),I=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"ethAmount",type:"uint256",indexed:!1,internalType:"uint256"},{name:"wethAmount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],S=r(9215),M=r(25239),$=r(1709),D=r(99574),R=r(7446),W=e=>v.z.object({contributeAmount:v.z.string().nonempty({message:"请输入申购数量"}).refine(e=>Number(e)>0,{message:"申购数量不能为 0"}).refine(t=>{var r;return(null!=(r=(0,C.XS)(t))?r:0n)<=e},{message:"申购数量不能超过余额 (".concat((0,C.Js)(e),")")})});let B=e=>{var t=e.token;e.launchInfo;var r=(0,N.F)(),s=r.address,l=r.chain,v=r.isConnected,b=(0,y.useRouter)(),B=(null==t?void 0:t.parentTokenSymbol)=="TestTKM20",P=B?"TKM":(null==t?void 0:t.parentTokenSymbol)||"",X=(0,w.A)({address:s,query:{enabled:B}}),z=X.data,L=X.isLoading,J=X.error,U=(0,S.lW)(null==t?void 0:t.parentTokenAddress,s,!B),H=U.balance,O=U.isPending,V=U.error,q=B?(null==z?void 0:z.value)||0n:H||0n,K=B?L:O,G=(0,i.$r)(null==t?void 0:t.address,s),Q=G.contributed,Y=G.isPending,Z=G.error,ee=(0,h.mN)({resolver:(0,x.u)(W(q)),defaultValues:{contributeAmount:""}}),et=(0,S.zH)(null==t?void 0:t.parentTokenAddress),er=et.approve,en=et.isWriting,ea=et.isConfirming,es=et.isConfirmed,ei=et.writeError,eo=(0,f._)((0,a.useState)(!1),2),el=eo[0],ed=eo[1],ec=(0,S.Gp)(null==t?void 0:t.parentTokenAddress,s,"0x19C8E1E12D71E811ab5b70987579cbF2f856B388",!B),eu=ec.allowance,em=ec.isPending,ef=ec.error;(0,a.useEffect)(()=>{es&&!B&&(ed(!0),j.oR.success("授权".concat(null==t?void 0:t.parentTokenSymbol,"成功")))},[es,null==t?void 0:t.parentTokenSymbol,B]);var ep=ee.watch("contributeAmount");(0,a.useEffect)(()=>{if(B)return void ed(!0);var e,t=null!=(e=(0,C.XS)(ep))?e:0n;t>0n&&eu&&eu>0n&&eu>=t?ed(!0):ed(!1)},[ep,eu,B]);var ey=function(){var e=(0,c._)(function(e){var t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:if(!(0,F.C)(l))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,er("0x19C8E1E12D71E811ab5b70987579cbF2f856B388",null!=(t=(0,C.XS)(e.contributeAmount))?t:0n)];case 2:return r.sent(),[3,4];case 3:return console.error(r.sent()),[3,4];case 4:return[2]}})});return function(t){return e.apply(this,arguments)}}(),ev=function(){var e,t=(0,k.x)(),r=t.writeContract,n=t.isPending,a=t.data,s=t.error,i=(e=(0,c._)(function(e,t,n){var a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,r({address:"0x9CE12E214F7d770E4d708f9BD140C5F8468b1E02",abi:I,functionName:"contributeWithETH",args:[e,t],value:n})];case 1:return s.sent(),[3,3];case 2:throw console.error("Native Coin Contribute Failed:",a=s.sent()),a;case 3:return[2]}})}),function(t,r,n){return e.apply(this,arguments)}),o=(0,E.g)({hash:a});return{contribute:i,writeData:a,isWriting:n,writeError:s,isConfirming:o.isLoading,isConfirmed:o.isSuccess}}(),ex=ev.contribute,eh=ev.isWriting,eb=ev.isConfirming,eg=ev.isConfirmed,eN=ev.writeError,ew=(0,i.LO)(),ej=ew.contribute,e_=ew.isPending,eT=ew.isConfirming,eA=ew.isConfirmed,eF=ew.writeError,eC=B?eh:e_,ek=B?eb:eT,eE=B?eg:eA,eI=function(){var e=(0,c._)(function(e){var r,n;return(0,p.__generator)(this,function(a){switch(a.label){case 0:if(!(0,F.C)(l))return[2];if(!B&&!el)return j.oR.error("请先授权"),[2];a.label=1;case 1:if(a.trys.push([1,6,,7]),n=null!=(r=(0,C.XS)(e.contributeAmount))?r:0n,!B)return[3,3];return[4,ex(null==t?void 0:t.address,s,n)];case 2:return a.sent(),[3,5];case 3:return[4,ej(null==t?void 0:t.address,n,s)];case 4:a.sent(),a.label=5;case 5:return[3,7];case 6:return console.error(a.sent()),[3,7];case 7:return[2]}})});return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)(()=>{eE&&(j.oR.success("申购成功"),setTimeout(()=>{b.push("/launch?symbol=".concat(null==t?void 0:t.symbol))},2e3))},[eE,b,null==t?void 0:t.symbol]);var eS=(0,M.q)().setError;(0,a.useEffect)(()=>{v&&!K&&void 0!==q&&q<=0n&&eS({name:"余额不足",message:"请先获取 ".concat(P,"，再来申购")})},[q,eS,v,K,P]);var eM=(0,o.g)().handleContractError;(0,a.useEffect)(()=>{var e=B?eN:eF,t=B?J:V;e&&eM(e,"launch"),Z&&eM(Z,"launch"),t&&eM(t,B?"balance":"token"),!B&&(ei&&eM(ei,"token"),ef&&eM(ef,"token"))},[eN,eF,Z,J,V,ei,ef,eM,B]);var e$=en||ea,eD=(0,a.useRef)(null);return((0,a.useEffect)(()=>{!em&&eD.current&&eD.current.blur()},[em]),v)?!t||K||Y?(0,n.jsx)(d.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"px-4 mt-2",children:[(0,n.jsx)($.A,{title:"参与申购"}),(0,n.jsx)("div",{className:"stats w-full",children:(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,n.jsxs)("div",{className:"stat-value text-secondary",children:[(0,C.NJ)(Q||0n),(0,n.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:P})]})]})}),(0,n.jsx)(A.lV,(0,m._)((0,u._)({},ee),{children:(0,n.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"space-y-4",children:[(0,n.jsx)(A.zB,{control:ee.control,name:"contributeAmount",render:e=>{var t=e.field;return(0,n.jsxs)(A.eI,{children:[(0,n.jsx)(A.lR,{children:"申购数量："}),(0,n.jsx)(A.MJ,{children:(0,n.jsx)(T.p,(0,u._)({type:"number",placeholder:"请填写".concat(P,"数量"),disabled:!B&&e$||q<=0n,className:"!ring-secondary-foreground"},t))}),(0,n.jsx)(A.C5,{})]})}}),(0,n.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,n.jsxs)("span",{className:"text-greyscale-400",children:[(0,C.NJ)(q)," ",P]}),(0,n.jsx)(_.$,{variant:"link",size:"sm",onClick:()=>{ee.setValue("contributeAmount",(0,C.Js)(q))},disabled:!B&&e$||q<=0n,className:"text-secondary",children:"全部"}),!B&&(null==t?void 0:t.parentTokenSymbol)==="TestTKM20"&&(0,n.jsx)(g(),{href:"/dex/deposit?symbol=".concat(t.symbol),children:(0,n.jsxs)(_.$,{variant:"link",size:"sm",className:"text-secondary",children:["获取",t.parentTokenSymbol]})})]}),(0,n.jsx)("div",{className:"flex justify-center",children:B?(0,n.jsx)(_.$,{className:"w-full text-white py-2 rounded-lg",onClick:ee.handleSubmit(eI),disabled:eC||ek||eE||q<=0n,children:eC?"申购中...":ek?"确认中...":eE?"申购成功":"申购"}):(0,n.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,n.jsx)(_.$,{ref:eD,className:"w-1/2",onClick:ee.handleSubmit(ey),disabled:em||en||ea||el,children:em?(0,n.jsx)(R.A,{className:"animate-spin"}):en?"1.提交中...":ea?"1.确认中...":el?"1.".concat(null==t?void 0:t.parentTokenSymbol,"已授权"):"1.授权".concat(null==t?void 0:t.parentTokenSymbol)}),(0,n.jsx)(_.$,{className:"w-1/2 text-white py-2 rounded-lg",onClick:ee.handleSubmit(eI),disabled:!el||eC||ek||eE,children:eC?"2.申购中...":ek?"2.确认中...":eE?"2.申购成功":"2.申购"})]})})]})}))]}),(0,n.jsx)(D.A,{isLoading:eC||ek||!B&&(en||ea),text:eC||!B&&en?"提交交易...":"确认交易..."})]}):(0,n.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,n.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function P(){var e=((0,a.useContext)(s.N)||{}).token,t=(0,i.TU)(e?e.address:"0x0000000000000000000000000000000000000000"),r=t.launchInfo,c=t.isPending,u=t.error,m=(0,o.g)().handleContractError;return(0,a.useEffect)(()=>{u&&m(u,"launch")},[u]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.A,{title:"申购"}),(0,n.jsx)("main",{className:"flex-grow",children:c?(0,n.jsx)(d.A,{}):r?(0,n.jsx)(B,{token:e,launchInfo:r}):(0,n.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},77328:(e,t,r)=>{e.exports=r(89836)},86739:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},92659:(e,t,r)=>{"use strict";r.d(t,{lV:()=>v,MJ:()=>j,Rr:()=>_,zB:()=>h,eI:()=>N,lR:()=>w,C5:()=>T});var n=r(81110),a=r(40120),s=r(3576),i=r(62701),o=r(65699),l=r(37876),d=r(14232),c=r(39358),u=r(88992),m=r(30684),f=r(49794),p=(0,r(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),y=d.forwardRef((e,t)=>{var r=e.className,n=(0,o._)(e,["className"]);return(0,l.jsx)(f.b,(0,s._)({ref:t,className:(0,m.cn)(p(),r)},n))});y.displayName=f.b.displayName;var v=u.Op,x=d.createContext({}),h=e=>{var t=(0,n._)({},(0,a._)(e));return(0,l.jsx)(x.Provider,{value:{name:t.name},children:(0,l.jsx)(u.xI,(0,s._)({},t))})},b=()=>{var e=d.useContext(x),t=d.useContext(g),r=(0,u.xW)(),n=r.getFieldState,a=r.formState,i=n(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");var o=t.id;return(0,s._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},i)},g=d.createContext({}),N=d.forwardRef((e,t)=>{var r=e.className,n=(0,o._)(e,["className"]),a=d.useId();return(0,l.jsx)(g.Provider,{value:{id:a},children:(0,l.jsx)("div",(0,s._)({ref:t,className:(0,m.cn)("space-y-2",r)},n))})});N.displayName="FormItem";var w=d.forwardRef((e,t)=>{var r=e.className,n=(0,o._)(e,["className"]),a=b(),i=a.error,d=a.formItemId;return(0,l.jsx)(y,(0,s._)({ref:t,className:(0,m.cn)(i&&"text-destructive",r),htmlFor:d},n))});w.displayName="FormLabel";var j=d.forwardRef((e,t)=>{var r=(0,n._)({},(0,a._)(e)),i=b(),o=i.error,d=i.formItemId,u=i.formDescriptionId,m=i.formMessageId;return(0,l.jsx)(c.DX,(0,s._)({ref:t,id:d,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},r))});j.displayName="FormControl";var _=d.forwardRef((e,t)=>{var r=e.className,n=(0,o._)(e,["className"]),a=b().formDescriptionId;return(0,l.jsx)("p",(0,s._)({ref:t,id:a,className:(0,m.cn)("text-sm text-muted-foreground",r)},n))});_.displayName="FormDescription";var T=d.forwardRef((e,t)=>{var r=e.className,n=e.children,a=(0,o._)(e,["className","children"]),d=b(),c=d.error,u=d.formMessageId,f=c?String(null==c?void 0:c.message):n;return f?(0,l.jsx)("p",(0,i._)((0,s._)({ref:t,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",r)},a),{children:f})):null});T.displayName="FormMessage"},94004:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return r(46593)}])},99574:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(37876);r(14232);var a=r(7446);let s=e=>{var t=e.isLoading,r=e.text;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===r?"Loading":r})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[8230,6869,2569,5139,3356,636,6593,8792],()=>t(94004)),_N_E=e.O()}]);