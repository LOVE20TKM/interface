try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="98735205-5b2b-4341-ac9b-21aa166eb8c6",e._sentryDebugIdIdentifier="sentry-dbid-98735205-5b2b-4341-ac9b-21aa166eb8c6")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8251],{58862:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return t(58314)}])},74193:function(e,n,t){"use strict";t.d(n,{NI:function(){return T},Wi:function(){return v},l0:function(){return p},lX:function(){return g},pf:function(){return k},xJ:function(){return x},zG:function(){return _}});var s=t(34788),r=t(12796),i=t(72253),a=t(14932),d=t(47702),o=t(85893),u=t(67294),l=t(88426),c=t(87536),m=t(40108),f=t(94193),p=c.RV,y=u.createContext({}),v=function(e){var n=(0,s._)({},(0,r._)(e));return(0,o.jsx)(y.Provider,{value:{name:n.name},children:(0,o.jsx)(c.Qr,(0,i._)({},n))})},b=function(){var e=u.useContext(y),n=u.useContext(h),t=(0,c.Gc)(),s=t.getFieldState,r=t.formState,a=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var d=n.id;return(0,i._)({id:d,name:e.name,formItemId:"".concat(d,"-form-item"),formDescriptionId:"".concat(d,"-form-item-description"),formMessageId:"".concat(d,"-form-item-message")},a)},h=u.createContext({}),x=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=u.useId();return(0,o.jsx)(h.Provider,{value:{id:r},children:(0,o.jsx)("div",(0,i._)({ref:n,className:(0,m.cn)("space-y-2",t)},s))})});x.displayName="FormItem";var g=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=b(),a=r.error,u=r.formItemId;return(0,o.jsx)(f._,(0,i._)({ref:n,className:(0,m.cn)(a&&"text-destructive",t),htmlFor:u},s))});g.displayName="FormLabel";var T=u.forwardRef(function(e,n){var t=(0,s._)({},(0,r._)(e)),a=b(),d=a.error,u=a.formItemId,c=a.formDescriptionId,m=a.formMessageId;return(0,o.jsx)(l.g7,(0,i._)({ref:n,id:u,"aria-describedby":d?"".concat(c," ").concat(m):"".concat(c),"aria-invalid":!!d},t))});T.displayName="FormControl";var k=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=b().formDescriptionId;return(0,o.jsx)("p",(0,i._)({ref:n,id:r,className:(0,m.cn)("text-sm text-muted-foreground",t)},s))});k.displayName="FormDescription";var _=u.forwardRef(function(e,n){var t=e.className,s=e.children,r=(0,d._)(e,["className","children"]),u=b(),l=u.error,c=u.formMessageId,f=l?String(null==l?void 0:l.message):s;return f?(0,o.jsx)("p",(0,a._)((0,i._)({ref:n,id:c,className:(0,m.cn)("text-sm font-medium text-destructive",t)},r),{children:f})):null});_.displayName="FormMessage"},94193:function(e,n,t){"use strict";t.d(n,{_:function(){return c}});var s=t(72253),r=t(47702),i=t(85893),a=t(67294),d=t(49102),o=t(12003),u=t(40108),l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(function(e,n){var t=e.className,a=(0,r._)(e,["className"]);return(0,i.jsx)(d.f,(0,s._)({ref:n,className:(0,u.cn)(l(),t)},a))});c.displayName=d.f.displayName},12956:function(e,n,t){"use strict";t.d(n,{E:function(){return l},X:function(){return c}});var s=t(11010),r=t(97582),i=t(67294),a=t(37474),d=t(84689),o=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"stakeAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeLiquidity",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"tokenAmount",type:"uint256",internalType:"uint256"},{name:"parentTokenAmount",type:"uint256",internalType:"uint256"},{name:"tokenAmountMin",type:"uint256",internalType:"uint256"},{name:"parentTokenAmountMin",type:"uint256",internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[{name:"govVotesAdded",type:"uint256",internalType:"uint256"},{name:"slAmountAdded",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"StakeLiquidity",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"tokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],u="0xbc8c89d8f3Cb1DDb6625e13D3F5487CAcbd396EE";function l(){var e,n=(0,a.e9)(o,u,"contributeFirstTokenWithETH"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,v=(e=(0,s._)(function(e,n,s){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n],s)];case 1:return[2,r.sent()]}})}),function(n,t,s){return e.apply(this,arguments)});return(0,i.useEffect)(function(){f&&((0,d.Vh)(f),(0,d.H)(f))},[p,f]),{contribute:v,isPending:l,isConfirming:c,writeError:f,isConfirmed:m,hash:p,isTukeMode:y}}function c(){var e,n=(0,a.e9)(o,u,"stakeLiquidity"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,v=(e=(0,s._)(function(e,n,s,i,a,d,o){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n,s,i,a,d,o])];case 1:return[2,r.sent()]}})}),function(n,t,s,r,i,a,d){return e.apply(this,arguments)});return(0,i.useEffect)(function(){f&&((0,d.Vh)(f),(0,d.H)(f))},[p,f]),{stakeLiquidity:v,isPending:l,isConfirming:c,isConfirmed:m,writeError:f,hash:p,isTukeMode:y}}},58314:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var s=t(85893),r=t(67294),i=t(93778),a=t(70019),d=t(73591),o=t(83494),u=t(42083),l=t(11010),c=t(72253),m=t(14932),f=t(91309),p=t(97582),y=t(11163),v=t(63448),b=t(56312),h=t(87536),x=t(41664),g=t.n(x),T=t(42130),k=t(39360),_=t(62776),N=t(86501),j=t(27245),w=t(21774),A=t(74193),I=t(91529),E=t(12956),C=t(85794),M=t(95049),B=t(64777),D=t(44576),S=t(23432),F=function(e){var n,t,i,o,x=e.token;e.launchInfo;var F=(0,T.m)(),P=F.address,z=F.isConnected;(0,k.x)();var R=(0,y.useRouter)(),H=(null==x?void 0:x.parentTokenSymbol)=="TKM20",L=H?"TKM":(null==x?void 0:x.parentTokenSymbol)||"",W=(0,_.K)({address:P,query:{enabled:H}}),V=W.data,Z=W.isLoading,J=W.error,q=(0,C.hS)(null==x?void 0:x.parentTokenAddress,P,!H),X=q.balance,G=q.isPending,K=q.error,O=H?(null==V?void 0:V.value)||BigInt(0):X||BigInt(0),Q=H?Z:G,Y=(0,a.ap)(null==x?void 0:x.address,P),U=Y.contributed,$=Y.isPending,ee=Y.error,en=((0,I.vz)("0.001"),(0,h.cI)({resolver:(0,b.F)((n=void 0,t="0.001",v.Ry({contributeAmount:v.Z_().nonempty({message:"请输入申购数量"}).refine(function(e){return Number(e)>0},{message:"申购数量不能为 0"}).refine(function(e){var n;return(null!==(n=(0,I.vz)(e))&&void 0!==n?n:BigInt(0))<=O},{message:"申购数量不能超过余额 (".concat((0,I.bM)(O),")")}).refine(function(e){var t;return!n||(null!==(t=(0,I.vz)(e))&&void 0!==t?t:BigInt(0))<=n},{message:"测试环境限制：首个父币最多可申购 ".concat(t)})}))),defaultValues:{contributeAmount:""},mode:"onChange",reValidateMode:"onChange"})),et=(0,C.yA)(null==x?void 0:x.parentTokenAddress),es=et.approve,er=et.isPending,ei=et.isConfirming,ea=et.isConfirmed,ed=et.writeError,eo=(0,f._)((0,r.useState)(!1),2),eu=eo[0],el=eo[1],ec=(0,C.yG)(null==x?void 0:x.parentTokenAddress,P,"0xfbb35BfeDf07E238c8Ef60aB937B4DB2CDA2D268",!H),em=ec.allowance,ef=ec.isPending,ep=ec.error;(0,r.useEffect)(function(){ea&&!H&&(el(!0),N.Am.success("授权".concat(null==x?void 0:x.parentTokenSymbol,"成功")))},[ea,null==x?void 0:x.parentTokenSymbol,H]);var ey=en.watch("contributeAmount");(0,r.useEffect)(function(){if(H){el(!0);return}var e,n=null!==(e=(0,I.vz)(ey))&&void 0!==e?e:BigInt(0);n>BigInt(0)&&em&&em>BigInt(0)&&em>=n?el(!0):el(!1)},[ey,em,H]);var ev=(i=(0,l._)(function(e){var n;return(0,p.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,es("0xfbb35BfeDf07E238c8Ef60aB937B4DB2CDA2D268",null!==(n=(0,I.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0))];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})}),function(e){return i.apply(this,arguments)}),eb=(0,E.E)(),eh=eb.contribute,ex=eb.isPending,eg=eb.isConfirming,eT=eb.isConfirmed,ek=eb.writeError,e_=(0,a.OY)(),eN=e_.contribute,ej=e_.isPending,ew=e_.isConfirming,eA=e_.isConfirmed,eI=e_.writeError,eE=H?ex:ej,eC=H?eg:ew,eM=H?eT:eA,eB=(o=(0,l._)(function(e){var n,t;return(0,p.Jh)(this,function(s){switch(s.label){case 0:if(!H&&!eu)return N.Am.error("请先授权"),[2];s.label=1;case 1:if(s.trys.push([1,6,,7]),t=null!==(n=(0,I.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0),!H)return[3,3];return[4,eh(null==x?void 0:x.address,P,t)];case 2:return s.sent(),[3,5];case 3:return[4,eN(null==x?void 0:x.address,t,P)];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return s.sent(),[3,7];case 7:return[2]}})}),function(e){return o.apply(this,arguments)});(0,r.useEffect)(function(){eM&&(N.Am.success("申购成功"),setTimeout(function(){R.push("/launch?symbol=".concat(null==x?void 0:x.symbol))},2e3))},[eM,R,null==x?void 0:x.symbol]);var eD=(0,M.V)().setError;(0,r.useEffect)(function(){z&&!Q&&void 0!==O&&O<=BigInt(0)&&eD({name:"余额不足",message:"请先获取 ".concat(L,"，再来申购")})},[O,eD,z,Q,L]);var eS=(0,d.S)().handleContractError;(0,r.useEffect)(function(){var e=H?ek:eI,n=H?J:K;e&&eS(e,"launch"),ee&&eS(ee,"launch"),n&&eS(n,H?"balance":"token"),!H&&(ed&&eS(ed,"token"),ep&&eS(ep,"token"))},[ek,eI,ee,J,K,ed,ep,eS,H]);var eF=er||ei,eP=(0,r.useRef)(null);return((0,r.useEffect)(function(){!ef&&eP.current&&eP.current.blur()},[ef]),z)?!x||Q||$?(0,s.jsx)(u.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-4 mt-2",children:[(0,s.jsx)(B.Z,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,I.LH)(U||BigInt(0)),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:L})]})]})}),(0,s.jsx)(A.l0,(0,m._)((0,c._)({},en),{children:(0,s.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,s.jsx)(A.Wi,{control:en.control,name:"contributeAmount",render:function(e){var n=e.field;return(0,s.jsxs)(A.xJ,{children:[(0,s.jsx)(A.lX,{children:"申购数量："}),(0,s.jsx)(A.NI,{children:(0,s.jsx)(w.I,(0,c._)({type:"number",max:void 0,placeholder:"请填写".concat(L,"数量"),disabled:!H&&eF||O<=BigInt(0),className:"!ring-secondary-foreground"},n))}),(0,s.jsx)(A.zG,{}),!1]})}}),(0,s.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:[(0,I.LH)(O)," ",L]}),(0,s.jsx)(j.z,{variant:"link",size:"sm",onClick:function(){en.setValue("contributeAmount",(0,I.bM)(O))},disabled:!H&&eF||O<=BigInt(0),className:"text-secondary",children:"全部"}),!H&&(null==x?void 0:x.parentTokenSymbol)==="TKM20"&&(0,s.jsx)(g(),{href:"/dex/deposit?symbol=".concat(x.symbol),children:(0,s.jsxs)(j.z,{variant:"link",size:"sm",className:"text-secondary",children:["获取",x.parentTokenSymbol]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:H?(0,s.jsx)(j.z,{className:"w-full text-white py-2 rounded-lg",onClick:en.handleSubmit(eB),disabled:eE||eC||eM||O<=BigInt(0),children:eE?"申购中...":eC?"确认中...":eM?"申购成功":"申购"}):(0,s.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,s.jsx)(j.z,{ref:eP,className:"w-1/2",onClick:en.handleSubmit(ev),disabled:ef||er||ei||eu,children:ef?(0,s.jsx)(S.Z,{className:"animate-spin"}):er?"1.提交中...":ei?"1.确认中...":eu?"1.".concat(null==x?void 0:x.parentTokenSymbol,"已授权"):"1.授权".concat(null==x?void 0:x.parentTokenSymbol)}),(0,s.jsx)(j.z,{className:"w-1/2 text-white py-2 rounded-lg",onClick:en.handleSubmit(eB),disabled:!eu||eE||eC||eM,children:eE?"2.申购中...":eC?"2.确认中...":eM?"2.申购成功":"2.申购"})]})})]})}))]}),(0,s.jsx)(D.Z,{isLoading:eE||eC||!H&&(er||ei),text:eE||!H&&er?"提交交易...":"确认交易..."})]}):(0,s.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,s.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function P(){var e=((0,r.useContext)(i.M)||{}).token,n=(0,a.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),t=n.launchInfo,l=n.isPending,c=n.error,m=(0,d.S)().handleContractError;return(0,r.useEffect)(function(){c&&m(c,"launch")},[c]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{title:"申购"}),(0,s.jsx)("main",{className:"flex-grow",children:l?(0,s.jsx)(u.Z,{}):t?(0,s.jsx)(F,{token:e,launchInfo:t}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}}},function(e){e.O(0,[8239,3615,1617,3494,3591,6127,6202,2888,9774,179],function(){return e(e.s=58862)}),_N_E=e.O()}]);