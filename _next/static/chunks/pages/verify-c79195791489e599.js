(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{85719:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return n(48585)}])},34680:function(e,t,n){"use strict";n.d(t,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return a}});var r=n(85893),s=n(67294),i=n(40108);let l=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...s})});l.displayName="Card";let c=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",n),...s})});c.displayName="CardHeader";let a=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",n),...s})});a.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...s})});d.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",n),...s})});o.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",n),...s})});u.displayName="CardFooter"},68655:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},64777:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>{let{title:t}=e;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:t})})}},37122:function(e,t,n){"use strict";var r=n(85893),s=n(67294),i=n(92321),l=n(27245),c=n(41664),a=n.n(c),d=n(91529),o=n(93778),u=n(7080),f=n(87250),x=n(67068),m=n(42083),h=n(64777);t.Z=e=>{let{currentRound:t,showBtn:n=!0}=e,{token:c}=(0,s.useContext)(o.M)||{},{address:p}=(0,i.m)(),{votesNumByAccount:v,isPending:j,error:N}=(0,u.VI)(null==c?void 0:c.address,t,p||""),{scoreByVerifier:g,isPending:y,error:b}=(0,f.w3)(null==c?void 0:c.address,t,p||""),w=j||y?BigInt(0):v-g,{handleContractError:Z}=(0,x.S)();return((0,s.useEffect)(()=>{N&&Z(N,"vote"),b&&Z(b,"verify")},[N,b]),c)?p?(0,r.jsxs)("div",{className:"flex-col items-center px-4 pt-3 pb-2",children:[(0,r.jsx)(h.Z,{title:"行动验证"}),(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,r.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"已验证票数"}),(0,r.jsx)("div",{className:"stat-value text-xl ".concat(n?"":"text-secondary"),children:y?(0,r.jsx)(m.Z,{}):(0,d.LH)(g||BigInt(0),2)})]}),(0,r.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"未验证票数"}),(0,r.jsx)("div",{className:"stat-value text-xl ".concat(n?"":"text-secondary"),children:j||y?(0,r.jsx)(m.Z,{}):(0,d.LH)(w,2)})]})]}),n&&(0,r.jsx)("div",{className:"flex justify-center",children:j||y?(0,r.jsx)(m.Z,{}):w>5n&&v>g?(0,r.jsx)(l.z,{className:"w-1/2",asChild:!0,children:(0,r.jsx)(a(),{href:"/verify?symbol=".concat(c.symbol),children:"去验证"})}):(0,r.jsx)(l.z,{disabled:!0,className:"w-1/2",children:g>0?"已验证":"未投票，无需验证"})})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex-col items-center px-4 pt-6 pb-2",children:[(0,r.jsx)(h.Z,{title:"行动验证"}),(0,r.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):(0,r.jsx)(m.Z,{})}},91529:function(e,t,n){"use strict";n.d(t,{LH:function(){return l},Vu:function(){return i},bM:function(){return a},cK:function(){return o},eb:function(){return u},kP:function(){return d},vz:function(){return c}});var r=n(21803),s=n(15229);let i=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=Number(a(e));return e<10n?"0":n<1e-4?"<0.0001":new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(n)},c=e=>{let t=parseInt("18",10);try{let n=e.replace(/,/g,"");return(0,r.v)(n,t)}catch(e){return console.error("parseUnits error:",e),0n}},a=e=>{let t=parseInt("18",10);return(0,s.b)(e,t)},d=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,o=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=Number(e);if(r>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(r);if(r>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:n+1}).format(r);{if(0===r)return"0";let e=r.toFixed(n+10),t=e.split(".");if(t.length<2)return e;let s=t[1],i=0;for(let e of s)if("0"===e)i++;else break;let l=s.slice(i);return"0.{".concat(i,"}").concat(l)}}},48585:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var r=n(85893),s=n(67294),i=n(87250),l=n(67068),c=n(37436),a=n(37122),d=n(11163),o=n(41664),u=n.n(o),f=n(7080),x=n(94782),m=n(93778),h=n(34680),p=n(64777),v=n(42083),j=e=>{let{currentRound:t}=e,{token:n}=(0,s.useContext)(m.M)||{},i=(0,d.useRouter)(),{actionIds:c,isPending:a,error:o}=(0,f.$S)((null==n?void 0:n.address)||"",t),{actionInfos:j,isPending:N,error:g}=(0,x.fT)((null==n?void 0:n.address)||"",c||[]),{handleContractError:y}=(0,l.S)();if((0,s.useEffect)(()=>{o&&y(o,"vote"),g&&y(g,"submit")},[o,g]),j&&1===j.length){let e=j[0].head.id;return i.push("/verify/".concat(e,"?symbol=").concat(null==n?void 0:n.symbol,"&auto=true")),null}return!n||a||c&&c.length>0&&N?(0,r.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,r.jsx)(v.Z,{})}):(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)(p.Z,{title:"待验证行动"}),(0,r.jsx)("div",{className:"mt-4 space-y-4",children:null==j?void 0:j.map((e,t)=>(0,r.jsx)(h.Zb,{className:"shadow-none",children:(0,r.jsxs)(u(),{href:"/verify/".concat(e.head.id,"?symbol=").concat(null==n?void 0:n.symbol),children:[(0,r.jsxs)(h.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,r.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,r.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,r.jsx)(h.aY,{className:"px-3 pt-1 pb-2",children:(0,r.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus})})]})},e.head.id))})]})},N=()=>{let{currentRound:e,error:t}=(0,i.Bk)(),{handleContractError:n}=(0,l.S)();return(0,s.useEffect)(()=>{t&&n(t,"verify")},[t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{title:"验证"}),(0,r.jsxs)("main",{className:"flex-grow",children:[(0,r.jsx)(a.Z,{currentRound:e,showBtn:!1}),(0,r.jsx)(j,{currentRound:e})]})]})}},9008:function(e,t,n){e.exports=n(23867)},21803:function(e,t,n){"use strict";function r(e,t){let[n,r="0"]=e.split("."),s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${r}`))&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>t){let[e,s,i]=[r.slice(0,t-1),r.slice(t-1,t),r.slice(t)],l=Math.round(Number(`${s}.${i}`));(r=l>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${l}`).length>t&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,t)}else r=r.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${r}`)}n.d(t,{v:function(){return r}})}},function(e){e.O(0,[1664,7863,4782,3317,2888,9774,179],function(){return e(e.s=85719)}),_N_E=e.O()}]);