(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6185],{8917:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return n(67574)}])},20442:(e,t,n)=>{"use strict";n.d(t,{$w:()=>i,Ee:()=>x,Js:()=>o,LP:()=>u,NJ:()=>l,W_:()=>a,XS:()=>c,lM:()=>m,mW:()=>d});var s=n(18449),r=n(32602),a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",i=e=>{var t=Number(o(e));return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)},l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=Number(o(e));if(e<10n)return"0";if(t>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t);if(t>=100)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(t);if(t>=1||t>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(t);if(0===t)return"0";var n=t.toFixed(14),s=n.split(".");if(s.length<2)return n;var r=s[1],a=0,i=!0,l=!1,c=void 0;try{for(var d,u=r[Symbol.iterator]();!(i=(d=u.next()).done);i=!0){var m=d.value;if("0"===m)a++;else break}}catch(e){l=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(l)throw c}}var x=r.slice(a,a+4);return"0.0{".concat(a,"}").concat(x)},c=e=>{var t=parseInt("18",10);try{var n=e.replace(/,/g,"");return(0,s.X)(n,t)}catch(e){return console.error("parseUnits error:",e),0n}},o=e=>{var t=parseInt("18",10);return(0,r.J)(e,t)},d=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,u=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=Number(e);if(s>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(s);if(s>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:n+1}).format(s);if(0===s)return"0";var r=s.toFixed(n+10),a=r.split(".");if(a.length<2)return r;var i=a[1],l=0,c=!0,o=!1,d=void 0;try{for(var u,m=i[Symbol.iterator]();!(c=(u=m.next()).done);c=!0){var x=u.value;if("0"===x)l++;else break}}catch(e){o=!0,d=e}finally{try{c||null==m.return||m.return()}finally{if(o)throw d}}var h=i.slice(l);return"0.0{".concat(l,"}").concat(h)},x=e=>{var t="string"==typeof e?parseFloat(e):e,n=Math.abs(t);return 0===n?"0%":n>=100?t.toLocaleString(void 0,{maximumFractionDigits:0})+"%":n>=10?t.toFixed(1)+"%":n>=1?t.toFixed(2)+"%":n>=.1?t.toFixed(3)+"%":n>=.01?t.toFixed(4)+"%":t.toExponential(4)+"%"}},63934:(e,t,n)=>{"use strict";n.d(t,{y:()=>u});var s=n(63127),r=n(77434),a=n(629),i=n(24751),l=n(57742),c=n(1081),o=n(43387),d=n(79056);function u(e={}){let{query:t={},watch:n}=e,m=(0,o.U)(e),x=(0,s.jE)(),h=(0,c.i)({config:m}),f=e.chainId??h,v=function(e,t={}){return{gcTime:0,async queryFn({queryKey:t}){let{scopeKey:n,...s}=t[1];return await function(e,t={}){let{chainId:n,...s}=t,i=e.getClient({chainId:n});return(0,a.T)(i,r.G,"getBlockNumber")(s)}(e,s)??null},queryKey:function(e={}){return["blockNumber",(0,i.xO)(e)]}(t)}}(m,{...e,chainId:f});return(0,d.r)({...{config:e.config,chainId:e.chainId,..."object"==typeof n?n:{}},enabled:!!((t.enabled??!0)&&("object"==typeof n?n.enabled:n)),onBlockNumber(e){x.setQueryData(v.queryKey,e)}}),(0,l.IT)({...t,...v})}},67574:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var s=n(3576),r=n(62701),a=n(37876),i=n(14232),l=n(83416),c=n(40752),o=n(20451),d=n(66663),u=n(12293),m=n(63934),x=n(57607),h=n(20442),f=n(1709);let v=e=>{var t=e.token,n=e.launchInfo,s=Number(n.totalContributed)/Number(n.parentTokenFundraisingGoal),r=(100*s).toFixed(1),i=(0,m.y)().data;if(!n)return(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!t)return(0,a.jsx)(u.A,{});var l="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex-col items-center mb-2 mt-4 px-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.A,{title:"公平发射"}),n.hasEnded&&(0,a.jsx)("span",{className:"stat-title text-base text-red-500",children:"（已结束）"})]}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"申购累计筹集到"}),(0,a.jsxs)("div",{className:"stat-value",children:[(0,a.jsx)("span",{className:"text-3xl text-secondary",children:(0,h.NJ)(n.totalContributed)}),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:l})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsx)("span",{children:l}),"筹集目标"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:(0,h.NJ)(n.parentTokenFundraisingGoal)})]}),(0,a.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm",children:[(0,a.jsxs)("span",{children:[t.symbol," "]}),"发射总量"]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,h.NJ)(BigInt(x.F.fairLaunch)))})]})]}),(0,a.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",l," ="," ",(0,h.lM)((0,h.mW)((Number(x.F.fairLaunch)/Number(n.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",t.symbol]}),(0,a.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,a.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!n.hasEnded&&"（当前 ".concat(r,"%）")]}),(0,a.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!n.hasEnded&&s>=.5&&(()=>{var e=Number(n.secondHalfStartBlock)+Number(n.secondHalfMinBlocks),t=Number(i||0),r=e-t;return r<=0?s>=1?"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（当前区块：第").concat(t,"区块，还需等待").concat(r,"个区块）")})(),!n.hasEnded&&s<.5&&"，至少".concat(n.secondHalfMinBlocks.toString(),"个区块"),n.hasEnded&&"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,a.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,a.jsxs)("p",{children:["1. 代币总量：",(0,h.NJ)(BigInt(x.F.totalSupply))]}),(0,a.jsxs)("p",{children:["2. 发射数量：",(0,h.NJ)(BigInt(x.F.fairLaunch))," (10%)"]}),(0,a.jsxs)("p",{children:["3. 治理激励：",(0,h.NJ)(BigInt(x.F.govRewards))," (45%)"]}),(0,a.jsxs)("p",{children:["4. 行动激励：",(0,h.NJ)(BigInt(x.F.actionRewards))," (45%)"]}),(0,a.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,a.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,a.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})})};var g=n(16927),N=n(4902),j=n(6960),b=n(8047),p=n(89099),y=n(48230),w=n.n(y),k=n(97685),F=n(99574);let S=e=>{var t=e.token;e.launchInfo;var n=(0,b.F)(),s=n.address,r=n.isConnected,l=(0,m.y)().data,d=(0,p.useRouter)(),x=(0,c.$r)(null==t?void 0:t.address,r?s:"0x0000000000000000000000000000000000000000"),v=x.contributed,y=x.isPending,S=x.error,C=x.refetch,I=(0,c.MU)(null==t?void 0:t.address,r?s:"0x0000000000000000000000000000000000000000"),T=I.lastContributedBlock,E=I.isPending,B=I.error,_=BigInt("40")-((l?BigInt(l):0n)-(T||0n)),A=(0,c.S1)(),M=A.withdraw,J=A.isPending,D=A.writeError,U=A.isConfirming,H=A.isConfirmed,L=function(){var e=(0,g._)(function(){return(0,N.__generator)(this,function(e){switch(e.label){case 0:if(_>0n)return k.Ay.error("还需要等待 ".concat(_," 个区块才能撤回")),[2];return[4,M(null==t?void 0:t.address)];case 1:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}();(0,i.useEffect)(()=>{H&&(k.Ay.success("撤回成功"),C(),setTimeout(()=>{d.push("/dex/swap/?symbol=".concat(null==t?void 0:t.symbol,"&from=").concat(null==t?void 0:t.parentTokenSymbol))},1e3))},[H]);var P=(0,o.g)().handleContractError;if((0,i.useEffect)(()=>{S&&P(S,"launch"),B&&P(B,"launch"),D&&P(D,"launch")},[S,B,D]),!t||y||E)return(0,a.jsx)(u.A,{});var $="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-6",children:[(0,a.jsx)(f.A,{title:"参与申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,a.jsxs)("div",{className:"stat-value text-secondary",children:[(0,h.NJ)(v||0n),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:$})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[v&&v>0n&&(0,a.jsx)(j.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",onClick:L,disabled:J||U||H,children:J?"提交中...":U?"确认中...":H?"已撤回":"撤回申购"}),(0,a.jsx)(j.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/contribute?symbol=".concat(null==t?void 0:t.symbol),children:v&&v>0n?"增加申购":"去申购"})})]}),v&&v>0n&&(0,a.jsxs)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:["申购后需等 ","40"," 个区块才能撤回（当前还需等"," ",_>0?_.toString():"0"," 个区块）"]}),(0,a.jsx)(F.A,{isLoading:J||U,text:J?"提交交易...":"确认交易..."})]})},C=e=>{var t=e.token,n=e.launchInfo,s=(0,b.F)().address,r=((0,i.useContext)(l.N)||{}).clearToken,d=(0,c.$r)(null==t?void 0:t.address,s),m=d.contributed,v=(d.isPending,d.error),p=(0,c.nD)(null==t?void 0:t.address,s),y=p.claimed,S=p.isPending,C=p.error,I=(0,c.f5)(null==t?void 0:t.address,s),T=I.extraRefunded,E=(I.isPending,I.error),B=n.totalContributed?BigInt(x.F.fairLaunch)*(m||0n)/BigInt(n.totalContributed):0n,_=(0,c.G0)(),A=_.claim,M=_.isWriting,J=_.writeError,D=_.isConfirming,U=_.isConfirmed,H=function(){var e=(0,g._)(function(){return(0,N.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,A(null==t?void 0:t.address)];case 1:return e.sent(),[3,3];case 2:return console.error("领取失败:",e.sent()),[3,3];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}();(0,i.useEffect)(()=>{U?(k.Ay.success("领取成功"),null==r||r(),setTimeout(()=>{window.location.reload()},1e3)):J&&k.Ay.error("领取失败")},[U,J]);var L=(0,o.g)().handleContractError;if((0,i.useEffect)(()=>{J&&L(J,"launch"),C&&L(C,"launch"),E&&L(E,"launch"),v&&L(v,"launch")},[J,C,E,v]),!s)return"";if(S||!t)return(0,a.jsx)(u.A,{});var P="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,a.jsxs)("div",{className:"px-4 mt-2",children:[(0,a.jsx)(f.A,{title:"我的申购"}),(0,a.jsx)("div",{className:"stats w-full",children:(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,a.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,h.NJ)(B),(0,a.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:t.symbol})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(m)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.$,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,a.jsx)(j.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]}),Number(m)>0&&!y&&(0,a.jsx)(j.$,{className:"w-1/2",onClick:H,disabled:M||D||U,children:M?"领取中...":D?"确认中...":U?"已领取":"领取"}),Number(m)>0&&y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.$,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,a.jsx)(j.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(w(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]})]}),Number(m)>0&&y&&(0,a.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,a.jsxs)("span",{className:"text-secondary",children:[(0,h.NJ)(null!=m?m:0n)," "]}),P,"，申购返还了"," ",(0,a.jsx)("span",{className:"text-secondary",children:(0,h.NJ)(null!=T?T:0n)})," ",P]}),(0,a.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-2 mb-6"}),(0,a.jsx)(F.A,{isLoading:M||D,text:M?"提交交易...":"确认交易..."})]})};var I=n(19593);function T(){var e=(0,i.useContext)(l.N)||{token:null,setToken:null},t=e.token,n=e.setToken,m=(0,c.TU)(t?t.address:"0x0000000000000000000000000000000000000000"),x=m.launchInfo,h=m.isPending,f=m.error,g=(0,o.g)().handleContractError;return((0,i.useEffect)(()=>{f&&g(f,"launch")},[f]),(0,i.useEffect)(()=>{x&&t&&x.hasEnded&&!t.hasEnded&&n((0,r._)((0,s._)({},t),{hasEnded:!0}))},[x,t]),h||x)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{title:"公平发射"}),(0,a.jsxs)("main",{className:"flex-grow",children:[(0,a.jsx)(I.A,{}),h||!x?(0,a.jsx)(u.A,{}):(0,a.jsxs)(a.Fragment,{children:[t&&(x.hasEnded?(0,a.jsx)(C,{token:t,launchInfo:x}):(0,a.jsx)(S,{token:t,launchInfo:x})),(0,a.jsx)(v,{token:t,launchInfo:x})]})]})]}):(0,a.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}},79056:(e,t,n)=>{"use strict";n.d(t,{r:()=>c});var s=n(84194),r=n(629),a=n(14232),i=n(1081),l=n(43387);function c(e={}){let{enabled:t=!0,onBlockNumber:n,config:o,...d}=e,u=(0,l.U)(e),m=(0,i.i)({config:u}),x=e.chainId??m;(0,a.useEffect)(()=>{if(t&&n)return function(e,t){let n,a,{syncConnectedChain:i=e._internal.syncConnectedChain,...l}=t,c=t=>{n&&n();let a=e.getClient({chainId:t});return n=(0,r.T)(a,s.q,"watchBlockNumber")(l)},o=c(t.chainId);return i&&!t.chainId&&(a=e.subscribe(({chainId:e})=>e,async e=>c(e))),()=>{o?.(),a?.()}}(u,{...d,chainId:x,onBlockNumber:n})},[x,u,t,n,d.onError,d.emitMissed,d.emitOnBegin,d.poll,d.pollingInterval,d.syncConnectedChain])}},87577:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var s=n(40854),r=n(37876),a=n(14232),i=n(48447),l=n(33276),c=n(70801),o=n(97685),d=n(20442);let u=e=>{var t=e.address,n=e.word,u=e.showCopyButton,m=e.showAddress,x=e.colorClassName,h=void 0===x?"":x,f=(0,s._)((0,a.useState)(!1),2),v=f[0],g=f[1];return(0,r.jsxs)("span",{className:"flex items-center space-x-2",children:[n&&(0,r.jsx)("span",{className:"text-xs",children:n}),(void 0===m||m)&&(0,r.jsx)("span",{className:"text-xs ".concat(null!=h?h:"text-greyscale-500"),children:(0,d.W_)(t)}),(void 0===u||u)&&(0,r.jsx)(i.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?g(!0):o.Ay.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:v?(0,r.jsx)(l.A,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")}):(0,r.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")})})})]})}},99574:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var s=n(37876);n(14232);var r=n(7446);let a=e=>{var t=e.isLoading,n=e.text;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===n?"Loading":n})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[4571,4112,5752,2569,5139,3356,9593,636,6593,8792],()=>t(8917)),_N_E=e.O()}]);