(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{68786:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return s(10423)}])},27460:function(e,t,s){"use strict";var n=s(85893),a=s(67294),r=s(74855),l=s(78865),i=s(18289),c=s(86501),o=s(91529);t.Z=e=>{let{address:t,word:s,showCopyButton:d=!0,showAddress:m=!0,colorClassName:u=""}=e,[x,h]=(0,a.useState)(!1);return(0,n.jsxs)("span",{className:"flex items-center space-x-2",children:[s&&(0,n.jsx)("span",{className:"text-xs",children:s}),m&&(0,n.jsx)("span",{className:"text-xs ".concat(null!=u?u:"text-greyscale-500"),children:(0,o.Vu)(t)}),d&&(0,n.jsx)(r.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?h(!0):c.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:x?(0,n.jsx)(l.Z,{className:"h-4 w-4 ".concat(null!=u?u:"text-greyscale-500")}):(0,n.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=u?u:"text-greyscale-500")})})})]})}},44576:function(e,t,s){"use strict";var n=s(85893);s(67294);var a=s(23432);t.Z=e=>{let{isLoading:t,text:s="Loading"}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(a.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:s})]})}):null}},91529:function(e,t,s){"use strict";s.d(t,{LH:function(){return l},Vu:function(){return r},bM:function(){return c},cK:function(){return d},eb:function(){return m},kP:function(){return o},vz:function(){return i}});var n=s(21803),a=s(15229);let r=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=Number(c(e));if(e<10n)return"0";if(t>=1e5)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t);if(t>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(t);if(t>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(t);{if(t>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(t);if(0===t)return"0";let e=t.toFixed(14),s=e.split(".");if(s.length<2)return e;let n=s[1],a=0;for(let e of n)if("0"===e)a++;else break;let r=n.slice(a,a+4);return"0.0{".concat(a,"}").concat(r)}},i=e=>{let t=parseInt("18",10);try{let s=e.replace(/,/g,"");return(0,n.v)(s,t)}catch(e){return console.error("parseUnits error:",e),0n}},c=e=>{let t=parseInt("18",10);return(0,a.b)(e,t)},o=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,d=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=Number(e);if(n>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(n);if(n>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:s+1}).format(n);{if(0===n)return"0";let e=n.toFixed(s+10),t=e.split(".");if(t.length<2)return e;let a=t[1],r=0;for(let e of a)if("0"===e)r++;else break;let l=a.slice(r);return"0.0{".concat(r,"}").concat(l)}}},10423:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var n=s(85893),a=s(67294),r=s(93778),l=s(70019),i=s(67068),c=s(37436),o=s(42083),d=s(91529),m=s(42757),u=s(37413),x=e=>{let{token:t,launchInfo:s}=e,a=Number(s.totalContributed)/Number(s.parentTokenFundraisingGoal),r=(100*a).toFixed(1),{data:l}=(0,m.O)();if(!s)return(0,n.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!t)return(0,n.jsx)(o.Z,{});let i="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,n.jsxs)("div",{className:"flex-col items-center px-4",children:[(0,n.jsx)("div",{className:"grid place-items-center",children:(0,n.jsx)("div",{className:"stat-title text-base mr-6 ".concat(s.hasEnded?"text-red-500":"text-secondary"),children:s.hasEnded?"发射已结束":"发射进行中"})}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pb-1",children:[(0,n.jsxs)("div",{className:"stat-title text-sm",children:[(0,n.jsx)("span",{children:i}),"筹集目标"]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:(0,d.LH)(s.parentTokenFundraisingGoal)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pb-1",children:[(0,n.jsxs)("div",{className:"stat-title text-sm",children:[(0,n.jsxs)("span",{children:[t.symbol," "]}),"发射总量"]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,d.LH)(BigInt(u.v.fairLaunch)))})]})]}),(0,n.jsxs)("div",{className:"text-center text-xs mb-4 text-greyscale-500",children:["兑换比例：1 ",i," ="," ",(0,d.eb)((0,d.kP)((Number(u.v.fairLaunch)/Number(s.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",t.symbol]}),(0,n.jsx)("div",{className:"stats w-full border",children:(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"累计申购"}),(0,n.jsxs)("div",{className:"stat-value",children:[(0,n.jsx)("span",{className:"text-3xl text-secondary",children:(0,d.LH)(s.totalContributed)}),(0,n.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:i})]}),(0,n.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,n.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,n.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!s.hasEnded&&"（当前 ".concat(r,"%）")]}),(0,n.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!s.hasEnded&&a>=.5&&(()=>{let e=Number(s.secondHalfStartBlock)+Number(s.secondHalfMinBlocks),t=Number(l||0),n=e-t;return n<=0?a>=1?"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块（当前区块：第").concat(t,"区块，还需等待").concat(n,"个区块）")})(),!s.hasEnded&&a<.5&&"，至少".concat(s.secondHalfMinBlocks.toString(),"个区块"),s.hasEnded&&"（第 ".concat(s.secondHalfStartBlock.toString(),"区块），至少").concat(s.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,n.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,n.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,n.jsxs)("p",{children:["1. 代币总量：",(0,d.LH)(BigInt(u.v.totalSupply))]}),(0,n.jsxs)("p",{children:["2. 发射数量：",(0,d.LH)(BigInt(u.v.fairLaunch))," (10%)"]}),(0,n.jsxs)("p",{children:["3. 治理激励：",(0,d.LH)(BigInt(u.v.govRewards))," (45%)"]}),(0,n.jsxs)("p",{children:["4. 行动激励：",(0,d.LH)(BigInt(u.v.actionRewards))," (45%)"]}),(0,n.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,n.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,n.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})},h=s(27245),f=s(92321),j=s(11163),g=s(41664),N=s.n(g),p=s(86501),v=s(64777),b=s(44576),y=e=>{let{token:t,launchInfo:s}=e,{address:r,isConnected:c}=(0,f.m)(),{data:u}=(0,m.O)(),x=(0,j.useRouter)(),{contributed:g,isPending:y,error:k,refetch:w}=(0,l.ap)(null==t?void 0:t.address,c?r:"0x0000000000000000000000000000000000000000"),{lastContributedBlock:S,isPending:F,error:T}=(0,l.oz)(null==t?void 0:t.address,c?r:"0x0000000000000000000000000000000000000000"),E=BigInt("40")-((u?BigInt(u):0n)-(S||0n)),{withdraw:H,isPending:B,writeError:C,isConfirming:I,isConfirmed:L}=(0,l.Qc)(),Z=async()=>{if(E>0n){p.ZP.error("还需要等待 ".concat(E," 个区块才能撤回"));return}await H(null==t?void 0:t.address)};(0,a.useEffect)(()=>{L&&(p.ZP.success("撤回成功"),w(),setTimeout(()=>{x.push("/dex/swap/?symbol=".concat(null==t?void 0:t.symbol,"&from=").concat(null==t?void 0:t.parentTokenSymbol))},1e3))},[L]);let{handleContractError:P}=(0,i.S)();if((0,a.useEffect)(()=>{k&&P(k,"launch"),T&&P(T,"launch"),C&&P(C,"launch")},[k,T,C]),!t||y||F)return(0,n.jsx)(o.Z,{});let M="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)(v.Z,{title:"参与申购"}),(0,n.jsx)("div",{className:"stats w-full",children:(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,n.jsxs)("div",{className:"stat-value text-secondary",children:[(0,d.LH)(g||0n),(0,n.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:M})]})]})}),(0,n.jsxs)("div",{className:"flex justify-center gap-4",children:[g&&g>0n&&(0,n.jsx)(h.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",onClick:Z,disabled:B||I||L,children:B?"提交中...":I?"确认中...":L?"已撤回":"撤回申购"}),(0,n.jsx)(h.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(N(),{href:"/launch/contribute?symbol=".concat(null==t?void 0:t.symbol),children:g&&g>0n?"增加申购":"去申购"})})]}),g&&g>0n&&(0,n.jsxs)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:["申购后需等 ","40"," 个区块才能撤回（当前还需等"," ",E>0?E.toString():"0"," 个区块）"]}),(0,n.jsx)(b.Z,{isLoading:B||I,text:B?"提交交易...":"确认交易..."})]})},k=e=>{let{token:t,launchInfo:s}=e,{address:c}=(0,f.m)(),{clearToken:m}=(0,a.useContext)(r.M)||{},{contributed:x,isPending:j,error:g}=(0,l.ap)(null==t?void 0:t.address,c),{claimed:y,isPending:k,error:w}=(0,l.ur)(null==t?void 0:t.address,c),{extraRefunded:S,isPending:F,error:T}=(0,l.Vh)(null==t?void 0:t.address,c),E=s.totalContributed?BigInt(u.v.fairLaunch)*(x||0n)/BigInt(s.totalContributed):0n,{claim:H,isWriting:B,writeError:C,isConfirming:I,isConfirmed:L}=(0,l.z7)(),Z=async()=>{try{await H(null==t?void 0:t.address)}catch(e){console.error("领取失败:",e)}};(0,a.useEffect)(()=>{L?(p.ZP.success("领取成功"),null==m||m(),setTimeout(()=>{window.location.reload()},1e3)):C&&p.ZP.error("领取失败")},[L,C]);let{handleContractError:P}=(0,i.S)();if((0,a.useEffect)(()=>{C&&P(C,"launch"),w&&P(w,"launch"),T&&P(T,"launch"),g&&P(g,"launch")},[C,w,T,g]),!c)return"";if(k||!t)return(0,n.jsx)(o.Z,{});let M="TestTKM20"==t.parentTokenSymbol?"TKM":t.parentTokenSymbol;return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)(v.Z,{title:"我的领取"}),(0,n.jsx)("div",{className:"stats w-full",children:(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,n.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,d.LH)(E),(0,n.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:t.symbol})]})]})}),(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(x)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.z,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,n.jsx)(h.z,{className:"w-1/2",asChild:!0,children:(0,n.jsx)(N(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]}),Number(x)>0&&!y&&(0,n.jsx)(h.z,{className:"w-1/2",onClick:Z,disabled:B||I||L,children:B?"领取中...":I?"确认中...":L?"已领取":"领取"}),Number(x)>0&&y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.z,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,n.jsx)(h.z,{className:"w-1/2",asChild:!0,children:(0,n.jsx)(N(),{href:"/launch/burn?symbol=".concat(null==t?void 0:t.symbol),children:"底池销毁"})})]})]}),Number(x)>0&&y&&(0,n.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,n.jsxs)("span",{className:"text-secondary",children:[(0,d.LH)(null!=x?x:0n)," "]}),M,"，申购返还了"," ",(0,n.jsx)("span",{className:"text-secondary",children:(0,d.LH)(null!=S?S:0n)})," ",M]}),(0,n.jsx)(b.Z,{isLoading:B||I,text:B?"提交交易...":"确认交易..."})]})},w=s(4062);function S(){let{token:e,setToken:t}=(0,a.useContext)(r.M)||{token:null,setToken:null},{launchInfo:s,isPending:d,error:m}=(0,l.kF)(e?e.address:"0x0"),{handleContractError:u}=(0,i.S)();return((0,a.useEffect)(()=>{m&&u(m,"launch")},[m]),(0,a.useEffect)(()=>{s&&e&&s.hasEnded&&!e.hasEnded&&t({...e,hasEnded:!0})},[s,e]),d||s)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{title:"公平发射"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(w.Z,{}),d||!s?(0,n.jsx)(o.Z,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{token:e,launchInfo:s}),e&&(s.hasEnded?(0,n.jsx)(k,{token:e,launchInfo:s}):(0,n.jsx)(y,{token:e,launchInfo:s}))]})]})]}):(0,n.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}}},function(e){e.O(0,[2209,1335,6242,7863,7380,6202,4062,2888,9774,179],function(){return e(e.s=68786)}),_N_E=e.O()}]);