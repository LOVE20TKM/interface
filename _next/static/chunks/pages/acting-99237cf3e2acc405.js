try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ea027e97-4f81-489a-97d6-f92ac2597aed",e._sentryDebugIdIdentifier="sentry-dbid-ea027e97-4f81-489a-97d6-f92ac2597aed")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return t(29069)}])},34680:function(e,n,t){"use strict";t.d(n,{Ol:function(){return c},SZ:function(){return u},Zb:function(){return d},aY:function(){return x},eW:function(){return f},ll:function(){return l}});var r=t(72253),s=t(47702),a=t(85893),i=t(67294),o=t(40108),d=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t)},i))});d.displayName="Card";var c=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t)},i))});c.displayName="CardHeader";var l=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t)},i))});l.displayName="CardTitle";var u=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("text-sm text-muted-foreground",t)},i))});u.displayName="CardDescription";var x=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("p-6 pt-0",t)},i))});x.displayName="CardContent";var f=i.forwardRef(function(e,n){var t=e.className,i=(0,s._)(e,["className"]);return(0,a.jsx)("div",(0,r._)({ref:n,className:(0,o.cn)("flex items-center p-6 pt-0",t)},i))});f.displayName="CardFooter"},24920:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});var r=(0,t(31134).Z)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])},21338:function(e,n,t){"use strict";var r=t(91309),s=t(85893),a=t(67294),i=t(88504),o=t(93778),d=t(74089),c=t(42083);n.Z=function(e){var n=e.currentRound,t=e.roundType,l=e.showCountdown,u=(0,i.O)().data,x=(0,a.useContext)(o.M),f=x?x.token:void 0,m=!u||!f||void 0===f.voteOriginBlocks,g=(0,r._)((0,a.useState)(BigInt(0)),2),v=g[0],h=g[1],p=Number("30126")||0,N=Number("2868")||0,b=f?Number(f.voteOriginBlocks):0,j=p-(Number(u)-b)%p,y=j>0?Math.ceil(j*N/1e3):0,w=(0,r._)((0,a.useState)(y),2),B=w[0],A=w[1];(0,a.useEffect)(function(){if(u){var e=p-(Number(u)-b)%p;A(e>0?Math.ceil(e*N/1e3):0)}},[u,p,N,b]),(0,a.useEffect)(function(){n>BigInt(0)&&h(n)},[n]);var I=null!=v?v.toString():"0";return v<=BigInt(0)?(0,s.jsx)(s.Fragment,{}):m||null==v||v<BigInt(0)?((null==v||v<BigInt(0))&&(console.log("currentTokenRound",v),console.log("currentRound",n)),(0,s.jsx)(c.Z,{})):(0,s.jsx)("div",{className:"flex items-center mb-3",children:(0,s.jsxs)("span",{className:"text-sm text-greyscale-400",children:["(第",(0,s.jsx)("span",{className:"text-greyscale-400",children:I}),"轮","vote"===t?"投票":"verify"===t?"验证":"行动","阶段，",(0,s.jsx)("span",{className:"text-greyscale-400",children:"剩余"}),(0,s.jsx)("span",{className:"text-greyscale-400",children:Math.ceil(1e3*B/N)}),(0,s.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),void 0===l||l?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(d.Z,{initialTimeLeft:y,onTick:A})}):(0,s.jsx)("span",{className:"text-greyscale-400",children:B<60?"".concat(B,"秒"):B<=300?"".concat(Math.floor(B/60),"分钟").concat(B%60,"秒"):B<3600?"".concat(Math.floor(B/60),"分钟"):"".concat(Math.floor(B/3600),"小时").concat(Math.floor(B%3600/60),"分钟")}),(0,s.jsx)("span",{className:"text-greyscale-400",children:")"})]})})}},76341:function(e,n,t){"use strict";t.d(n,{a:function(){return d}});var r=t(72253),s=t(14932),a=t(67294),i=t(26868),o=t(77580),d=function(e){var n=e.baseToken,t=e.targetToken,d=(0,i.N)(n.address,(null==t?void 0:t.address)||"0x0000000000000000000000000000000000000000",!!t),c=d.pairAddress,l=d.isLoading,u=(0,o.QX)(c),x=u.reserve0,f=u.reserve1,m=u.isLoading,g=(0,o.A5)(c),v=g.totalSupply,h=g.isLoading,p=(0,o.Oc)(c),N=p.token0,b=p.isLoading,j=(0,o.$C)(c),y=j.token1,w=j.isLoading,B=(0,a.useMemo)(function(){if(!c||!x||!f||!v||!N||!y||!t||!(x>BigInt(0)&&f>BigInt(0)))return{pairExists:!1,poolTotalSupply:BigInt(0),poolBaseReserve:BigInt(0),poolTargetReserve:BigInt(0),baseTokenIsToken0:!1,baseToTargetPrice:BigInt(0),targetToBasePrice:BigInt(0)};var e=n.address.toLowerCase()===N.toLowerCase(),r=e?x:f,s=e?f:x,a=r>BigInt(0)?s*BigInt(1e18)/r:BigInt(0),i=s>BigInt(0)?r*BigInt(1e18)/s:BigInt(0);return{pairExists:!0,poolTotalSupply:v,poolBaseReserve:r,poolTargetReserve:s,baseTokenIsToken0:e,baseToTargetPrice:a,targetToBasePrice:i}},[c,x,f,v,N,y,n.address,t]);return(0,s._)((0,r._)({pairAddress:c},B),{isLoading:l||m||h||b||w,hasValidTokens:!!t})}},26868:function(e,n,t){"use strict";t.d(n,{N:function(){return a}});var r=t(71104),s=t(86171),a=function(e,n){var t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=(0,r.u)({address:"0x0ce7Aa2069d92De630AFf1B6b512f5E47af6Ffc8",abi:s.K,functionName:"getPair",args:[e,n],query:{enabled:!!e&&!!n&&e!==n&&t}});return{pairAddress:a.data,isLoading:a.isLoading,error:a.error}}},77580:function(e,n,t){"use strict";t.d(n,{$C:function(){return c},A5:function(){return o},Oc:function(){return d},QX:function(){return i},bQ:function(){return a},vG:function(){return l}});var r=t(71104),s=t(18456),a=function(e,n,t){var a=(0,r.u)({address:e,abi:s.y,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n&&"0x0000000000000000000000000000000000000000"!==e,staleTime:3e3,refetchInterval:t||!1}});return{lpBalance:a.data,isLoading:a.isLoading,error:a.error,refetch:a.refetch}},i=function(e,n){var t=(0,r.u)({address:e,abi:s.y,functionName:"getReserves",query:{enabled:!!e&&"0x0000000000000000000000000000000000000000"!==e,staleTime:3e3,refetchInterval:n||!1}}),a=t.data,i=t.isLoading,o=t.error,d=t.refetch;return{reserve0:null==a?void 0:a[0],reserve1:null==a?void 0:a[1],blockTimestampLast:null==a?void 0:a[2],reserves:a,isLoading:i,error:o,refetch:d}},o=function(e){var n=(0,r.u)({address:e,abi:s.y,functionName:"totalSupply",query:{enabled:!!e&&"0x0000000000000000000000000000000000000000"!==e,staleTime:3e3}});return{totalSupply:n.data,isLoading:n.isLoading,error:n.error,refetch:n.refetch}},d=function(e){var n=(0,r.u)({address:e,abi:s.y,functionName:"token0",query:{enabled:!!e&&"0x0000000000000000000000000000000000000000"!==e}});return{token0:n.data,isLoading:n.isLoading,error:n.error}},c=function(e){var n=(0,r.u)({address:e,abi:s.y,functionName:"token1",query:{enabled:!!e&&"0x0000000000000000000000000000000000000000"!==e}});return{token1:n.data,isLoading:n.isLoading,error:n.error}},l=function(e){var n=(0,r.u)({address:e,abi:s.y,functionName:"symbol",query:{enabled:!!e&&"0x0000000000000000000000000000000000000000"!==e}});return{lpSymbol:n.data,isLoading:n.isLoading,error:n.error}}},13523:function(e,n,t){"use strict";t.d(n,{id:function(){return a}});var r=t(71104),s=t(58494),a=function(e){var n=(0,r.u)({address:e,abi:s.U,functionName:"FACTORY_ADDRESS",query:{enabled:!!e}});return{factory:n.data,isPending:n.isPending,error:n.error}}},97357:function(e,n,t){"use strict";t.d(n,{GD:function(){return d},VW:function(){return s.VW}});var r=t(13523);t(80332);var s=t(36268),a=t(67294),i=t(92261),o=function(e,n){switch(e||"hasExtension"){case"always":return!0;case"hasExtension":return!!n.isExtensionAction;default:return!1}},d=function(e){var n=e.extensionAddress,t=e.isExtensionAction;e.account;var s=(0,r.id)(n),d=s.factory,c=s.isPending,l=(0,a.useMemo)(function(){return d?(0,i.qD)(d):null},[d]),u=(null==l?void 0:l.type)||null,x=(0,a.useMemo)(function(){if(!n||!t||c||!d||!l||!l.actionDetailTabs)return[];var e={isExtensionAction:t};return l.actionDetailTabs.filter(function(n){return o(n.showCondition,e)}).map(function(e){return{key:e.key,label:e.label}})},[n,t,c,d,l]);return{tabs:(0,a.useMemo)(function(){return x},[x]),isPending:(0,a.useMemo)(function(){return c},[c]),extensionType:u}}},29069:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return L}});var r=t(85893),s=t(67294),a=t(42130),i=t(27245),o=t(41664),d=t.n(o),c=t(42083),l=t(93778),u=t(73591),x=t(72253),f=t(14932),m=t(76341),g=function(e){var n=e.tokenAddress,t=e.enabled,r=void 0===t||t,a=(0,s.useMemo)(function(){var e="TUSDT",n="0x47Ba4471046fC0442078CF1519924cb205F02c7a";return e&&n?{symbol:e,address:n,decimals:18,isNative:!1}:null},[]),i=(0,s.useMemo)(function(){return n?{symbol:"LOVE20",address:n,decimals:18,isNative:!1}:null},[n]),o=(0,m.a)({baseToken:a||{symbol:"",address:"0x0000000000000000000000000000000000000000",decimals:18,isNative:!1},targetToken:i}),d=o.pairExists,c=o.poolBaseReserve,l=o.poolTargetReserve,u=o.baseToTargetPrice,g=o.isLoading,v=(0,s.useMemo)(function(){return r&&d&&c&&c!==BigInt(0)&&l&&l!==BigInt(0)&&a&&i?{totalPoolValue:l*BigInt(2),usdtAmount:c,love20Amount:l}:{totalPoolValue:BigInt(0),usdtAmount:BigInt(0),love20Amount:BigInt(0)}},[r,d,c,l,u,a,i]);return(0,f._)((0,x._)({pairExists:d,poolBaseReserve:c,poolTargetReserve:l,baseToTargetPrice:u},v),{isLoading:g,error:void 0,hasValidData:!!a&&!!i&&d})},v=t(91529),h=t(99958),p=function(e){var n=e.totalJoinedAmount,t=e.expectedReward,a=e.isPendingJoinedAmount,i=e.isPendingReward,o=((0,s.useContext)(l.M)||{}).token,d=g({tokenAddress:null==o?void 0:o.address,enabled:!!(null==o?void 0:o.address)}),x=d.totalPoolValue,f=d.isLoading,m=d.error,p=(0,s.useMemo)(function(){return(null!=n?n:BigInt(0))+x},[n,x]),N=(0,u.S)().handleContractError;return(0,s.useEffect)(function(){m&&N(m,"join")},[m]),(0,r.jsx)("div",{className:"px-4",children:(0,r.jsxs)("div",{className:"w-full border rounded-lg p-0",children:[(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,r.jsx)("div",{className:"stat-title text-sm pb-1",children:"参与行动代币总数"}),(0,r.jsx)("div",{className:"stat-value text-xl text-secondary",children:a?(0,r.jsx)(c.Z,{}):(0,v.LH)(n)})]}),(0,r.jsxs)("div",{className:"stat place-items-center pb-2",children:[(0,r.jsx)("div",{className:"stat-title text-sm pb-1",children:"预计新增铸币"}),(0,r.jsx)("div",{className:"stat-value text-xl text-secondary",children:i?(0,r.jsx)(c.Z,{}):(0,v.LH)(null!=t?t:BigInt(0))})]})]}),(0,r.jsxs)("div",{className:"text-center text-xs mb-2 text-greyscale-500",children:["预估年化收益率（APY）：",a||i||f?(0,r.jsx)(c.Z,{}):(0,h.Tn)(t,p)]})]})})},N=t(83494),b=t(24920),j=t(4307),y=t(34680),w=t(7399),B=t(21338),A=t(64777),I=t(27460),T=function(e){var n=e.currentRound,t=e.joinableActions,i=e.isPendingActions,o=((0,s.useContext)(l.M)||{}).token,x=(0,a.m)().address,f=(0,w.CY)((null==o?void 0:o.address)||""),m=f.rewardAvailable,p=f.isPending,N=f.error,T=g({tokenAddress:null==o?void 0:o.address,enabled:!!(null==o?void 0:o.address)}),R=T.totalPoolValue,k=T.isLoading,_=T.error,E=(null==t?void 0:t.reduce(function(e,n){return e+n.votesNum},BigInt(0)))||BigInt(0),P=o?n-BigInt(o.initialStakeRound)+BigInt(1):BigInt(0),C=(0,h.iF)(m,P),L=(0,u.S)().handleContractError;return(0,s.useEffect)(function(){N&&L(N,"mint"),_&&L(_,"join")},[N,_]),(0,r.jsxs)("div",{className:"px-4 py-6",children:[(0,r.jsx)(A.Z,{title:"本轮可参与的行动："}),(0,r.jsx)(B.Z,{currentRound:n,roundType:"act"}),!x&&(0,r.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"}),x&&i&&(0,r.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,r.jsx)(c.Z,{})}),x&&!i&&!(null==t?void 0:t.length)&&(0,r.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"本轮暂无行动"}),!i&&t&&t.length>0&&(0,r.jsx)("div",{className:"mt-2 space-y-4",children:null==t?void 0:t.sort(function(e,n){if(e.hasReward&&!n.hasReward)return -1;if(!e.hasReward&&n.hasReward)return 1;var t=Number(e.votesNum);return Number(n.votesNum)-t}).map(function(e,n){var t=e.joinedAmount,s=Number(E)>0?Number(e.votesNum||BigInt(0))/Number(E):0,a="/action/info?id=".concat(e.action.head.id,"&symbol=").concat(null==o?void 0:o.symbol),i=e.hasReward?"shadow-none":"shadow-none bg-gray-50",l=e.action.head.id===BigInt(19)||e.action.head.id===BigInt(15),u=l?e.joinedAmount+R:e.joinedAmount;return(0,r.jsx)(y.Zb,{className:i,children:(0,r.jsxs)(d(),{href:a,className:"relative block",children:[(0,r.jsx)(y.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-between items-baseline",children:(0,r.jsxs)("div",{className:"flex items-baseline",children:[(0,r.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,r.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.action.head.id)}),(0,r.jsx)("span",{className:"font-bold ".concat(e.hasReward?"text-greyscale-800":"text-greyscale-400"),children:"".concat(e.action.body.title)})]})}),(0,r.jsxs)(y.aY,{className:"px-3 pt-1 pb-2",children:[(0,r.jsx)("div",{className:"flex justify-between text-sm",children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(b.Z,{className:"text-greyscale-400 mr-1 h-3 w-3"}),(0,r.jsx)("span",{className:"text-greyscale-400",children:(0,r.jsx)(I.Z,{address:e.action.head.author,showCopyButton:!1})})]})}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"text-greyscale-400 text-xs mr-1",children:"投票占"}),(0,r.jsx)("span",{className:"text-secondary text-xs",children:(0,v.rl)(100*s)})]}),(0,r.jsxs)("span",{children:[(0,r.jsxs)("span",{className:"text-greyscale-400 text-xs mr-1",children:["参与代币",e.isConvertedJoinedValueSuccess?"(估)":""]}),(0,r.jsx)("span",{className:"text-secondary text-xs",children:(0,v.LH)(t)})]}),e.hasReward?(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"text-greyscale-400 text-xs mr-1",children:"APY"}),(0,r.jsx)("span",{className:"text-secondary text-xs",children:p||l&&k?(0,r.jsx)(c.Z,{}):(0,h.Tn)(BigInt(Math.floor(Number(C||BigInt(0))*s)),u)})]}):(0,r.jsx)("span",{className:"flex justify-between text-error text-sm",children:"无铸币激励"})]})]}),(0,r.jsx)(j.Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]})},e.action.head.id)})})]})},R=t(66247),k=t(20442),_=t(90278),E=t(7208),P=t(97357),C=function(e){var n=e.tokenAddress,t=e.currentRound,r=(0,a.m)().address,i=(0,_.jA)(n||"",t||BigInt(0),r),o=i.joinableActions,d=i.isPending,c=i.error,l=(0,s.useMemo)(function(){return(null==o?void 0:o.map(function(e){return e.action}))||[]},[o]),u=(0,P.VW)({tokenAddress:n,actionInfos:l}),m=u.baseData,g=u.isPending,v=u.error,h=(0,s.useMemo)(function(){if(o)return m&&0!==m.length?o.map(function(e,n){var t=m[n];return(null==t?void 0:t.isExtension)&&void 0!==t.convertedJoinedValue?(0,f._)((0,x._)({},e),{joinedAmount:t.convertedJoinedValue,accountsCount:t.accountsCount,isConvertedJoinedValueSuccess:t.isConvertedJoinedValueSuccess,isExtension:!0,extensionAddress:t.extension}):(0,f._)((0,x._)({},e),{isExtension:!1})}):o},[o,m]),p=(0,s.useMemo)(function(){return h&&0!==h.length?h.reduce(function(e,n){return e+n.joinedAmount},BigInt(0)):BigInt(0)},[h]),N=(0,E.XQ)(n||""),b=N.reward,j=N.isPending,y=N.error;return{joinableActions:h,totalJoinedAmount:p,expectedReward:b,isPending:d||g||j,isPendingActions:d,isPendingExtension:g,isPendingReward:j,error:c||v||y,errorActions:c,errorExtension:v,errorReward:y}},L=function(){var e=(0,a.m)().isConnected,n=((0,s.useContext)(l.M)||{}).token,t=e&&(null==n?void 0:n.hasEnded)===!0&&(null==n?void 0:n.hasEnded),o=(0,k.Bk)(t),x=o.currentRound,f=o.error,m=o.isPending,g=C({tokenAddress:null==n?void 0:n.address,currentRound:x||BigInt(0)}),v=(0,u.S)().handleContractError;return((0,s.useEffect)(function(){f&&v(f,"join"),g.errorActions&&v(g.errorActions,"dataViewer"),g.errorExtension&&v(g.errorExtension,"extension"),g.errorReward&&v(g.errorReward,"dataViewer")},[f,g.errorActions,g.errorExtension,g.errorReward]),t&&m)?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)(c.Z,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{title:"社区首页"}),(0,r.jsx)("main",{className:"flex-grow",children:e?n?n&&!n.hasEnded?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-4 mt-4",children:[(0,r.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"公平发射未结束，还不能参与社区行动"}),(0,r.jsx)(i.z,{className:"w-1/2",asChild:!0,children:(0,r.jsx)(d(),{href:"/launch?symbol=".concat(n.symbol),children:"查看公平发射"})})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{totalJoinedAmount:g.totalJoinedAmount,expectedReward:g.expectedReward,isPendingJoinedAmount:g.isPendingExtension,isPendingReward:g.isPendingReward}),(0,r.jsx)(T,{currentRound:x,joinableActions:g.joinableActions,isPendingActions:g.isPendingActions})]}):(0,r.jsx)(c.Z,{}):(0,r.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,r.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})})]})}}},function(e){e.O(0,[8501,4463,3798,8139,246,3494,3591,9419,8300,2112,6268,7399,2494,4762,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);