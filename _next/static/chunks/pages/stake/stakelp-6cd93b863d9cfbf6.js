try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="c07493c7-6622-4191-8da8-a4eb47de054a",e._sentryDebugIdIdentifier="sentry-dbid-c07493c7-6622-4191-8da8-a4eb47de054a")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8898],{5617:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stake/stakelp",function(){return n(54221)}])},34680:function(e,s,n){"use strict";n.d(s,{Ol:function(){return c},SZ:function(){return u},Zb:function(){return o},aY:function(){return m},eW:function(){return f},ll:function(){return d}});var t=n(72253),a=n(47702),r=n(85893),l=n(67294),i=n(40108),o=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n)},l))});o.displayName="Card";var c=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",n)},l))});c.displayName="CardHeader";var d=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",n)},l))});d.displayName="CardTitle";var u=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("text-sm text-muted-foreground",n)},l))});u.displayName="CardDescription";var m=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("p-6 pt-0",n)},l))});m.displayName="CardContent";var f=l.forwardRef(function(e,s){var n=e.className,l=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",n)},l))});f.displayName="CardFooter"},35810:function(e,s,n){"use strict";n.d(s,{$N:function(){return v},Be:function(){return b},Vq:function(){return u},cN:function(){return g},cZ:function(){return p},fK:function(){return h},hg:function(){return m}});var t=n(72253),a=n(14932),r=n(47702),l=n(85893),i=n(67294),o=n(12854),c=n(62190),d=n(40108),u=o.fC,m=o.xz,f=o.h_;o.x8;var x=i.forwardRef(function(e,s){var n=e.className,a=(0,r._)(e,["className"]);return(0,l.jsx)(o.aV,(0,t._)({ref:s,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n)},a))});x.displayName=o.aV.displayName;var p=i.forwardRef(function(e,s){var n=e.className,i=e.children,u=(0,r._)(e,["className","children"]);return(0,l.jsxs)(f,{children:[(0,l.jsx)(x,{}),(0,l.jsxs)(o.VY,(0,a._)((0,t._)({ref:s,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n)},u),{children:[i,(0,l.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(c.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});p.displayName=o.VY.displayName;var h=function(e){var s=e.className,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,t._)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s)},n))};h.displayName="DialogHeader";var g=function(e){var s=e.className,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,t._)({className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s)},n))};g.displayName="DialogFooter";var v=i.forwardRef(function(e,s){var n=e.className,a=(0,r._)(e,["className"]);return(0,l.jsx)(o.Dx,(0,t._)({ref:s,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",n)},a))});v.displayName=o.Dx.displayName;var b=i.forwardRef(function(e,s){var n=e.className,a=(0,r._)(e,["className"]);return(0,l.jsx)(o.dk,(0,t._)({ref:s,className:(0,d.cn)("text-sm text-muted-foreground",n)},a))});b.displayName=o.dk.displayName},88659:function(e,s,n){"use strict";n.d(s,{Bw:function(){return v},Ph:function(){return f},Ql:function(){return b},i4:function(){return p},ki:function(){return x}});var t=n(72253),a=n(14932),r=n(47702),l=n(85893),i=n(67294),o=n(76405),c=n(42171),d=n(15432),u=n(78865),m=n(40108),f=o.fC;o.ZA;var x=o.B4,p=i.forwardRef(function(e,s){var n=e.className,i=e.children,d=(0,r._)(e,["className","children"]);return(0,l.jsxs)(o.xz,(0,a._)((0,t._)({ref:s,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n)},d),{children:[i,(0,l.jsx)(o.JO,{asChild:!0,children:(0,l.jsx)(c.Z,{className:"h-4 w-4 opacity-50"})})]}))});p.displayName=o.xz.displayName;var h=i.forwardRef(function(e,s){var n=e.className,i=(0,r._)(e,["className"]);return(0,l.jsx)(o.u_,(0,a._)((0,t._)({ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",n)},i),{children:(0,l.jsx)(d.Z,{className:"h-4 w-4"})}))});h.displayName=o.u_.displayName;var g=i.forwardRef(function(e,s){var n=e.className,i=(0,r._)(e,["className"]);return(0,l.jsx)(o.$G,(0,a._)((0,t._)({ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",n)},i),{children:(0,l.jsx)(c.Z,{className:"h-4 w-4"})}))});g.displayName=o.$G.displayName;var v=i.forwardRef(function(e,s){var n=e.className,i=e.children,c=e.position,d=void 0===c?"popper":c,u=(0,r._)(e,["className","children","position"]);return(0,l.jsx)(o.h_,{children:(0,l.jsxs)(o.VY,(0,a._)((0,t._)({ref:s,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:d},u),{children:[(0,l.jsx)(h,{}),(0,l.jsx)(o.l_,{className:(0,m.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,l.jsx)(g,{})]}))})});v.displayName=o.VY.displayName,i.forwardRef(function(e,s){var n=e.className,a=(0,r._)(e,["className"]);return(0,l.jsx)(o.__,(0,t._)({ref:s,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",n)},a))}).displayName=o.__.displayName;var b=i.forwardRef(function(e,s){var n=e.className,i=e.children,c=(0,r._)(e,["className","children"]);return(0,l.jsxs)(o.ck,(0,a._)((0,t._)({ref:s,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},c),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(o.wU,{children:(0,l.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(o.eT,{children:i})]}))});b.displayName=o.ck.displayName,i.forwardRef(function(e,s){var n=e.className,a=(0,r._)(e,["className"]);return(0,l.jsx)(o.Z0,(0,t._)({ref:s,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",n)},a))}).displayName=o.Z0.displayName},13761:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]])},67997:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},55264:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},46611:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},27460:function(e,s,n){"use strict";var t=n(91309),a=n(85893),r=n(67294),l=n(74855),i=n(78865),o=n(18289),c=n(86501),d=n(91529);s.Z=function(e){var s=e.address,n=e.word,u=e.showCopyButton,m=e.showCopyLast4Button,f=e.showAddress,x=void 0===f||f,p=e.colorClassName,h=void 0===p?"":p,g=e.colorClassName2,v=void 0===g?"":g,b=(0,t._)((0,r.useState)(!1),2),N=b[0],j=b[1],y=(0,t._)((0,r.useState)(!1),2),k=y[0],w=y[1];(0,r.useEffect)(function(){j(!1),w(!1)},[s]);var _=function(e){e.preventDefault(),e.stopPropagation()};return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-1",children:[n&&(0,a.jsx)("span",{className:"text-xs",children:n}),x&&!v&&(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:(0,d.Vu)(s)}),x&&v&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:"".concat(s.substring(0,4),"...")}),(0,a.jsx)("span",{className:"font-mono text-xs ".concat(v),children:"".concat(s.substring(s.length-6))})]}),(void 0===u||u)&&(0,a.jsx)(l.CopyToClipboard,{text:s,onCopy:function(e,s){s?(j(!0),setTimeout(function(){return j(!1)},2e3)):c.ZP.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:_,"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:N?(0,a.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")}):(0,a.jsx)(o.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")})})}),void 0!==m&&m&&(0,a.jsx)(l.CopyToClipboard,{text:s.substring(s.length-4),onCopy:function(e,s){s?(w(!0),c.ZP.success("已复制后4位"),setTimeout(function(){return w(!1)},2e3)):c.ZP.error("复制失败")},children:(0,a.jsx)("button",{className:"text-xs px-2 py-1 rounded border border-gray-300 focus:outline-none active:bg-gray-200 md:hover:bg-gray-100 transition-colors",onClick:_,"aria-label":"复制地址后4位",style:{WebkitTapHighlightColor:"transparent"},children:k?(0,a.jsx)("span",{className:"".concat(null!=h?h:"text-greyscale-500"),children:"已复制"}):(0,a.jsx)("span",{className:"".concat(null!=h?h:"text-greyscale-500"),children:"后4位"})})})]})}},54221:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return X}});var t=n(85893),a=n(83494),r=n(42130),l=n(67294),i=n(91529),o=n(73591),c=n(933),d=n(93778),u=n(53696),m=n(27460),f=n(42083),x=function(e){var s=e.token,n=(0,r.m)().address,a=(0,l.useContext)(d.M)||{},x=a.token;a.setToken,a.clearToken;var p=s||x,h=(0,c.L)(null==p?void 0:p.address,n),g=h.slAmount,v=h.govVotes,b=h.isPending,N=h.error,j=(0,o.S)().handleContractError;return((0,l.useEffect)(function(){N&&j(N,"stake")},[N,j]),n)?!p||b?(0,t.jsx)(f.Z,{}):b||g?(0,t.jsx)("div",{className:"flex-col items-center px-4 py-2 mb-4",children:(0,t.jsxs)("div",{className:"stats bg-gray-100  w-full grid grid-cols-[1fr_2fr] divide-x-0 pt-4",children:[(0,t.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,t.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,t.jsx)("div",{className:"stat-value text-xl",children:b?(0,t.jsx)(f.Z,{}):(0,i.LH)(v||BigInt(0))})]}),(0,t.jsxs)("div",{className:"stat place-items-center pt-0 pl-1",children:[(0,t.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,t.jsx)(m.Z,{address:p.slTokenAddress,showAddress:!1}),(0,t.jsx)(u.Z,{tokenAddress:p.slTokenAddress,tokenSymbol:"sl"+p.symbol,tokenDecimals:p.decimals})]}),(0,t.jsx)("div",{className:"stat-value text-xl",children:b?(0,t.jsx)(f.Z,{}):(0,i.LH)(g||BigInt(0))})]})]})}):(0,t.jsx)(t.Fragment,{}):(0,t.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})},p=n(11010),h=n(12796),g=n(72253),v=n(14932),b=n(91309),N=n(97582),j=n(11163),y=n(86501),k=n(45901),w=n(56312),_=n(87536),T=n(67997),C=n(13761),I=n(46611),Z=n(55264),B=n(41664),z=n.n(B),S=n(27245),E=n(74193),R=n(88659),P=n(21774),A=n(34680),V=n(35810),D=n(99958),L=n(95049),M=n(85794),F=n(67516),H=n(20168),W=n(37541),Y=n(37742),O="0xbc8c89d8f3Cb1DDb6625e13D3F5487CAcbd396EE",q=function(e){var s=e.account,n=e.tokenAddress,t=e.parentTokenAddress,a=(0,l.useMemo)(function(){return s&&n&&t?[{address:"0x1DC7e680D833fF3470A3280eE663b27BC56fc32c",abi:H.z,functionName:"tokenPairInfoWithAccount",args:[s,n]},{address:n,abi:W.O,functionName:"allowance",args:[s,O]},{address:t,abi:W.O,functionName:"allowance",args:[s,O]}]:[]},[s,n,t]),r=(0,F.N)({contracts:a,query:{enabled:!!s&&!!n&&!!t&&a.length>0}}),i=r.data,o=r.isPending,c=r.error;return(0,l.useMemo)(function(){if(!i||!s||!n||!t)return{pairInfo:void 0,allowanceToken:void 0,allowanceParentToken:void 0,isPending:o,error:c};var e=(0,b._)(i,3),a=e[0],r=e[1],l=e[2];return{pairInfo:null==a?void 0:a.result,allowanceToken:(null==r?void 0:r.result)?(0,Y.Z)(r.result):void 0,allowanceParentToken:(null==l?void 0:l.result)?(0,Y.Z)(l.result):void 0,isPending:o,error:c}},[i,s,n,t,o,c])},$=n(12956),J=n(64777),G=n(44576),U=function(e){(0,h._)(e);var s,n,a,u,m=function(){y.Am.success("质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/gov?symbol=").concat(null==F?void 0:F.symbol)},2e3)},x=(0,r.m)().address,B=(0,l.useContext)(d.M);if(!B)throw Error("TokenContext 必须在 TokenProvider 内使用");var F=B.token,H=B.setToken,W=B.clearToken,Y=(0,L.V)().setError,O=(0,j.useRouter)().query.first,U=q({account:x,tokenAddress:null==F?void 0:F.address,parentTokenAddress:null==F?void 0:F.parentTokenAddress}),X=U.pairInfo,K=U.allowanceToken,Q=U.allowanceParentToken,ee=U.isPending,es=U.error,en=null!==(s=null==X?void 0:X.balanceOfToken)&&void 0!==s?s:BigInt(0),et=null!==(n=null==X?void 0:X.balanceOfParentToken)&&void 0!==n?n:BigInt(0),ea=X&&BigInt(X.pairReserveToken)>BigInt(0)&&BigInt(X.pairReserveParentToken)>BigInt(0),er=(0,b._)((0,l.useState)(!1),2),el=er[0],ei=er[1],eo=(0,c.VL)(null==F?void 0:F.address),ec=eo.initialStakeRound,ed=eo.isPending,eu=eo.error,em=Number("30")||4,ef=Number("120")||12,ex=(0,_.cI)({resolver:(0,w.F)((a=et||BigInt(0),u=en||BigInt(0),k.Ry({parentToken:k.dj(function(e){if("string"!=typeof e)return e;var s=e.replace(/。/g,".");return s.startsWith(".")&&(s="0"+s),s},k.Z_().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(function(e){var s=(0,i.vz)(e);return null!==s&&s>BigInt(0)},"质押父币数不能为 0").refine(function(e){var s=(0,i.vz)(e);return null!==s&&s<=a},"质押父币数不能超过当前持有")),stakeToken:k.dj(function(e){if("string"!=typeof e)return e;var s=e.replace(/。/g,".");return s.startsWith(".")&&(s="0"+s),s},k.Z_().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(function(e){var s=(0,i.vz)(e);return null!==s&&s>BigInt(0)},"质押 token 数不能为 0").refine(function(e){var s=(0,i.vz)(e);return null!==s&&s<=u},"质押 token 数不能超过当前持有")),releasePeriod:k.Z_().min(1,"请选择解锁期")}))),defaultValues:{parentToken:"",stakeToken:"",releasePeriod:""},mode:"onChange"}),ep=(0,c.L)(null==F?void 0:F.address,x),eh=(ep.govVotes,ep.promisedWaitingPhases),eg=ep.isPending,ev=ep.error,eb=(0,b._)((0,l.useState)(!1),2),eN=eb[0],ej=eb[1],ey=(0,b._)((0,l.useState)(!1),2),ek=ey[0],ew=ey[1],e_=(0,M.yA)(null==F?void 0:F.address),eT=e_.approve,eC=e_.isPending,eI=e_.isConfirming,eZ=e_.isConfirmed,eB=e_.writeError,ez=(0,M.yA)(null==F?void 0:F.parentTokenAddress),eS=ez.approve,eE=ez.isPending,eR=ez.isConfirming,eP=ez.isConfirmed,eA=ez.writeError;function eV(){return(eV=(0,p._)(function(e){var s;return(0,N.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),null===(s=(0,i.vz)(e.stakeToken)))throw Error("无效的输入格式");return[4,eT("0xbc8c89d8f3Cb1DDb6625e13D3F5487CAcbd396EE",s)];case 1:return n.sent(),[3,3];case 2:return console.error("Token 授权失败",n.sent()),y.Am.error("token 授权失败，请检查输入格式"),[3,3];case 3:return[2]}})})).apply(this,arguments)}function eD(){return(eD=(0,p._)(function(e){var s;return(0,N.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),null===(s=(0,i.vz)(e.parentToken)))throw Error("无效的输入格式");return[4,eS("0xbc8c89d8f3Cb1DDb6625e13D3F5487CAcbd396EE",s)];case 1:return n.sent(),[3,3];case 2:return console.error("父币授权失败",n.sent()),y.Am.error("父币授权失败，请检查输入格式"),[3,3];case 3:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(function(){eZ&&(ej(!0),y.Am.success("授权".concat(null==F?void 0:F.symbol,"成功")))},[eZ]),(0,l.useEffect)(function(){eP&&(ew(!0),y.Am.success("授权".concat(null==F?void 0:F.parentTokenSymbol,"成功")))},[eP]);var eL=(0,b._)((0,l.useState)(!1),2),eM=eL[0],eF=eL[1],eH=(0,b._)((0,l.useState)(!1),2),eW=eH[0],eY=eH[1],eO=ex.watch("parentToken"),eq=ex.watch("stakeToken"),e$=(0,i.vz)(eO),eJ=(0,i.vz)(eq);(0,l.useEffect)(function(){if(ea&&eM&&null!==e$&&e$>BigInt(0)){var e=e$*BigInt(X.pairReserveToken)/BigInt(X.pairReserveParentToken),s=Number((0,i.bM)(e)).toFixed(12).replace(/\.?0+$/,"");ex.setValue("stakeToken",s,{shouldValidate:!0}),eF(!1),eY(!1)}},[ea,eM,e$,X,ex]),(0,l.useEffect)(function(){if(ea&&eW&&null!==eJ&&eJ>BigInt(0)){var e=eJ*BigInt(X.pairReserveParentToken)/BigInt(X.pairReserveToken),s=Number((0,i.bM)(e)).toFixed(12).replace(/\.?0+$/,"");ex.setValue("parentToken",s,{shouldValidate:!0}),eF(!1),eY(!1)}},[ea,eW,eJ,X,ex]),(0,l.useEffect)(function(){e$>BigInt(0)&&Q&&Q>=e$?ew(!0):ew(!1)},[e$,Q]),(0,l.useEffect)(function(){eJ>BigInt(0)&&K&&K>=eJ?ej(!0):ej(!1)},[eJ,K]);var eG=(0,$.X)(),eU=eG.stakeLiquidity,eX=eG.isPending,eK=eG.isConfirming,eQ=eG.isConfirmed,e0=eG.writeError;function e1(){return(e1=(0,p._)(function(e){var s,n,t,a,r,l;return(0,N.Jh)(this,function(o){switch(o.label){case 0:if(!(eN&&ek))return y.Am.error("请先完成授权"),[2];if(s=(0,i.vz)(e.stakeToken),n=(0,i.vz)(e.parentToken),null===s||null===n)return y.Am.error("转换金额时出错，请检查输入格式"),[2];t=BigInt(Math.round(10*sn)),a=s*(BigInt(1e3)-t)/BigInt(1e3),r=n*(BigInt(1e3)-t)/BigInt(1e3),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,eU(null==F?void 0:F.address,s,n,a,r,BigInt(e.releasePeriod),x)];case 2:return o.sent(),[3,4];case 3:return console.error("Stake failed",l=o.sent()),e2(l,"stake"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(function(){eQ&&((null==F?void 0:F.initialStakeRound)&&F.initialStakeRound>0?m():ei(!0))},[eQ]),(0,l.useEffect)(function(){el&&!ed&&(ec||W(),m())},[el,ed]),(0,l.useEffect)(function(){F&&0==F.initialStakeRound&&ec&&ec>0&&H((0,v._)((0,g._)({},F),{initialStakeRound:Number(ec)}))},[F,ec]);var e2=(0,o.S)().handleContractError;(0,l.useEffect)(function(){es&&e2(es,"token"),eB&&e2(eB,"stake"),eA&&e2(eA,"stake"),e0&&e2(e0,"stake"),eu&&e2(eu,"stake"),ev&&e2(ev,"stake")},[es,eB,eA,e0,eu,ev]);var e4=eC||eE,e3=eI||eR,e5=e4||e3||eN&&ek;(0,l.useEffect)(function(){!F||"true"!==O||ed||ec||Y({name:"提示：",message:"新部署的代币，需先质押获取治理票，才能后续操作"})},[F,O,ed,ec]),(0,l.useEffect)(function(){ee||en||e5||!F||!F.symbol||Y({name:"余额不足",message:"您当前".concat(F.symbol,"数量为0，请先获取").concat(F.symbol)}),ee||et||e5||!F||!F.parentTokenSymbol||Y({name:"余额不足",message:"您当前".concat(F.parentTokenSymbol,"数量为0，请先获取").concat(F.parentTokenSymbol)})},[en,et,F,ee]);var e7=(0,l.useRef)(null),e8=(0,l.useRef)(eC);(0,l.useEffect)(function(){if(e8.current&&!eC){var e;null===(e=e7.current)||void 0===e||e.blur()}e8.current=eC},[eC]);var e6=(0,b._)((0,l.useState)(!1),2),e9=e6[0],se=e6[1],ss=(0,b._)((0,l.useState)(2.5),2),sn=ss[0],st=ss[1],sa=(0,b._)((0,l.useState)(!1),2),sr=sa[0],sl=sa[1],si=(0,b._)((0,l.useState)(""),2),so=si[0],sc=si[1];return!F||eg||ed?(0,t.jsx)(f.Z,{}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"bg-white px-4",children:[(0,t.jsxs)("div",{className:"w-full max-w-md sm:max-w-lg md:max-w-2xl lg:max-w-full mx-auto space-y-4",children:[(0,t.jsx)("div",{className:"w-full flex justify-between items-center",children:(0,t.jsx)(J.Z,{title:"质押获取治理票："})}),(0,t.jsx)(E.l0,(0,v._)((0,g._)({},ex),{children:(0,t.jsxs)("form",{onSubmit:ex.handleSubmit(function(e){return e1.apply(this,arguments)}),className:"space-y-3",children:[(0,t.jsx)(A.Zb,{children:(0,t.jsx)(A.aY,{className:"p-3 md:p-6",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"第1步: 填写质押数量"}),(0,t.jsx)(z(),{href:"/dex/swap",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline transition-colors",children:"获取代币"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsx)(E.Wi,{control:ex.control,name:"parentToken",render:function(e){var s=e.field;return(0,t.jsxs)(E.xJ,{children:[(0,t.jsx)(A.Zb,{className:"bg-[#f7f8f9] border-none",children:(0,t.jsxs)(A.aY,{className:"py-4 px-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)(P.I,(0,v._)((0,g._)({type:"number",placeholder:"0"},s),{disabled:e5,onChange:function(e){s.onChange(e),eF(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors ",children:(0,t.jsx)("span",{className:"font-medium text-gray-800",children:null==F?void 0:F.parentTokenSymbol})})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[[25,50].map(function(e){return(0,t.jsxs)(S.z,{variant:"outline",size:"sm",type:"button",onClick:function(){var s=et*BigInt(e)/BigInt(100);ex.setValue("parentToken",(0,i.bM)(s),{shouldValidate:!0}),eF(!0)},disabled:e5||et<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)}),(0,t.jsx)(S.z,{variant:"outline",size:"sm",type:"button",onClick:function(){ex.setValue("parentToken",(0,i.bM)(et||BigInt(0)),{shouldValidate:!0}),eF(!0)},disabled:et<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,i.LH)(et)," ",null==F?void 0:F.parentTokenSymbol]})]})]})}),(0,t.jsx)(E.zG,{})]})}}),(0,t.jsx)(E.Wi,{control:ex.control,name:"stakeToken",render:function(e){var s=e.field;return(0,t.jsxs)(E.xJ,{children:[(0,t.jsx)(A.Zb,{className:"bg-[#f7f8f9] border-none",children:(0,t.jsxs)(A.aY,{className:"py-4 px-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)(P.I,(0,v._)((0,g._)({type:"number",placeholder:"0"},s),{disabled:en<=BigInt(0),onChange:function(e){s.onChange(e),eY(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors",children:(0,t.jsx)("span",{className:"font-medium text-gray-800",children:null==F?void 0:F.symbol})})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[[25,50].map(function(e){return(0,t.jsxs)(S.z,{variant:"outline",size:"sm",type:"button",onClick:function(){var s=en*BigInt(e)/BigInt(100);ex.setValue("stakeToken",(0,i.bM)(s),{shouldValidate:!0}),eY(!0)},disabled:en<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)}),(0,t.jsx)(S.z,{variant:"outline",size:"sm",type:"button",onClick:function(){ex.setValue("stakeToken",(0,i.bM)(en||BigInt(0)),{shouldValidate:!0}),eY(!0)},disabled:en<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,i.LH)(en)," ",null==F?void 0:F.symbol]})]})]})}),(0,t.jsx)(E.zG,{})]})}})]}),ea&&(0,t.jsxs)("div",{className:"space-y-1 text-sm mt-2",children:[(0,t.jsxs)("div",{className:"text-gray-600 flex items-center gap-1",children:[(0,t.jsx)(T.Z,{className:"w-4 h-4"}),"质押比例按当前价格计算："]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"text-gray-600",children:e9?(0,t.jsxs)(t.Fragment,{children:["1 ",null==F?void 0:F.symbol," ="," ",(0,i.LH)(BigInt(X.pairReserveParentToken)*BigInt(1e18)/BigInt(X.pairReserveToken))," ",null==F?void 0:F.parentTokenSymbol]}):(0,t.jsxs)(t.Fragment,{children:["1 ",null==F?void 0:F.parentTokenSymbol," ="," ",(0,i.LH)(BigInt(X.pairReserveToken)*BigInt(1e18)/BigInt(X.pairReserveParentToken))," ",null==F?void 0:F.symbol]})}),(0,t.jsx)(S.z,{type:"button",variant:"ghost",size:"sm",onClick:function(){return se(!e9)},className:"h-6 w-6 p-0 hover:bg-gray-100 transition-colors",title:"切换比例显示",children:(0,t.jsx)(C.Z,{className:"h-3 w-3 text-gray-500"})})]})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm mt-2",children:[(0,t.jsxs)("div",{className:"text-gray-600 flex items-center gap-1 mr-2",children:[(0,t.jsx)(I.Z,{className:"w-4 h-4"}),"滑点上限：",sn,"%"]}),(0,t.jsxs)(V.Vq,{open:sr,onOpenChange:sl,children:[(0,t.jsx)(V.hg,{asChild:!0,children:(0,t.jsxs)(S.z,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2 text-xs hover:bg-gray-100 transition-colors",title:"设置滑点",children:[(0,t.jsx)(Z.Z,{className:"h-3 w-3"}),"设置"]})}),(0,t.jsxs)(V.cZ,{className:"sm:max-w-md",children:[(0,t.jsx)(V.fK,{children:(0,t.jsx)(V.$N,{children:"滑点设置"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"选择滑点"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[.5,1,2.5].map(function(e){return(0,t.jsxs)(S.z,{type:"button",variant:sn===e?"default":"outline",size:"sm",onClick:function(){st(e),sc(""),sl(!1)},className:"text-xs",children:[e,"%"]},e)})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"自定义滑点"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(P.I,{type:"number",placeholder:"输入滑点百分比",value:so,onChange:function(e){return sc(e.target.value)},className:"flex-1",min:"0",max:"50",step:"0.1"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"%"})]}),so&&(0,t.jsx)(S.z,{type:"button",size:"sm",onClick:function(){var e=parseFloat(so);e>=0&&e<=50?(st(e),sl(!1)):y.Am.error("滑点应在 0-50% 之间")},className:"w-full",children:"应用自定义滑点"})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsx)("p",{children:"• 滑点是指实际执行价格与预期价格之间的差异"}),(0,t.jsx)("p",{children:"• 较低的滑点可能导致交易失败，较高的滑点可能导致不利的价格"}),(0,t.jsx)("p",{children:"• 建议设置在 0.5% - 5% 之间"})]})]})]})]})]})]})})}),(0,t.jsx)(A.Zb,{children:(0,t.jsx)(A.aY,{className:"p-3 md:p-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第2步: 选择解锁期"})}),(0,t.jsx)(E.Wi,{control:ex.control,name:"releasePeriod",render:function(e){var s=e.field;return(0,t.jsxs)(E.xJ,{children:[(0,t.jsx)(E.NI,{children:(0,t.jsxs)(R.Ph,{onValueChange:function(e){return s.onChange(e)},value:s.value,children:[(0,t.jsx)(R.i4,{className:"w-full !ring-secondary-foreground",children:(0,t.jsx)(R.ki,{placeholder:"选择解锁期"})}),(0,t.jsx)(R.Bw,{children:Array.from({length:ef-em+1},function(e,s){return s+em}).filter(function(e){return e>=eh}).map(function(e){return(0,t.jsx)(R.Ql,{value:String(e),children:(0,D.Cn)(e)},e)})})]})}),(0,t.jsx)(E.pf,{children:'"解锁期" 是指，取消质押后多久才能取回代币 (注意：是从取消质押的阶段结束时开始计算)'}),(0,t.jsx)(E.zG,{})]})}})]})})}),(0,t.jsx)(A.Zb,{children:(0,t.jsx)(A.aY,{className:"p-3 md:p-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第3步: 授权并存入"})}),(0,t.jsxs)("div",{className:"flex justify-center lg:justify-start space-x-2",children:[(0,t.jsx)(S.z,{type:"button",className:"flex-1 lg:w-auto lg:px-4",ref:e7,disabled:eC||eI||eN,onClick:ex.handleSubmit(function(e){return eV.apply(this,arguments)}),children:eC?"1.提交中...":eI?"1.确认中...":eN?"1.".concat(null==F?void 0:F.symbol,"已授权"):"1.授权".concat(null==F?void 0:F.symbol)}),(0,t.jsx)(S.z,{type:"button",className:"flex-1 lg:w-auto lg:px-4",disabled:!eN||eE||eR||ek,onClick:ex.handleSubmit(function(e){return eD.apply(this,arguments)}),children:eE?"2.提交中...":eR?"2.确认中...":ek?"2.".concat(null==F?void 0:F.parentTokenSymbol,"已授权"):"2.授权".concat(null==F?void 0:F.parentTokenSymbol)}),(0,t.jsx)(S.z,{type:"submit",className:"flex-1 lg:w-auto lg:px-4",disabled:!eN||!ek||eX||eK||eQ,children:eX?"3.提交中...":eK?"3.确认中...":eQ?"3.已提交":"3.提交"})]})]})})})]})}))]}),(0,t.jsx)(G.Z,{isLoading:e4||e3||eX||eK||ed&&el,text:e4||eX?"提交交易...":"确认交易..."})]})})},X=function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Z,{title:"质押LP"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(x,{}),(0,t.jsx)(U,{}),(0,t.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,t.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,t.jsx)(T.Z,{className:"w-4 h-4"}),"提示"]}),(0,t.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"SL代币："}),(0,t.jsx)("div",{className:"text-sm text-blue-700",children:"代币对儿由质押合约注入 Uniswap V2 流动性池，并铸造SL代币作为流动性质押凭证"}),(0,t.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理票："}),(0,t.jsx)("div",{className:"text-sm text-blue-700",children:"所得治理票数 = SL代币数量 * 解锁期阶段数"}),(0,t.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、单个地址的验证激励：当轮治理总激励 * 50% * 当轮该地址参与验证的治理票数 / 当轮参与验证的治理票总数"}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的加速激励：当轮治理总激励 * 50% * 该地址加速质押代币数量 / 当轮所有参与验证地址的加速质押代币总数"}),(0,t.jsx)("div",{className:"text-sm text-blue-700",children:"4、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})}}},function(e){e.O(0,[8501,4463,721,246,5771,3494,3591,2494,6998,2888,9774,179],function(){return e(e.s=5617)}),_N_E=e.O()}]);