try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="1cccfdb3-1079-4b99-8984-4688d76ab9dd",e._sentryDebugIdIdentifier="sentry-dbid-1cccfdb3-1079-4b99-8984-4688d76ab9dd")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4706],{94163:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stake/staketoken",function(){return n(54448)}])},74193:function(e,s,n){"use strict";n.d(s,{NI:function(){return g},Wi:function(){return h},l0:function(){return x},lX:function(){return j},pf:function(){return y},xJ:function(){return N},zG:function(){return _}});var t=n(34788),r=n(12796),a=n(72253),l=n(14932),i=n(47702),o=n(85893),c=n(67294),d=n(88426),u=n(87536),m=n(40108),f=n(94193),x=u.RV,p=c.createContext({}),h=function(e){var s=(0,t._)({},(0,r._)(e));return(0,o.jsx)(p.Provider,{value:{name:s.name},children:(0,o.jsx)(u.Qr,(0,a._)({},s))})},b=function(){var e=c.useContext(p),s=c.useContext(v),n=(0,u.Gc)(),t=n.getFieldState,r=n.formState,l=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var i=s.id;return(0,a._)({id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message")},l)},v=c.createContext({}),N=c.forwardRef(function(e,s){var n=e.className,t=(0,i._)(e,["className"]),r=c.useId();return(0,o.jsx)(v.Provider,{value:{id:r},children:(0,o.jsx)("div",(0,a._)({ref:s,className:(0,m.cn)("space-y-2",n)},t))})});N.displayName="FormItem";var j=c.forwardRef(function(e,s){var n=e.className,t=(0,i._)(e,["className"]),r=b(),l=r.error,c=r.formItemId;return(0,o.jsx)(f._,(0,a._)({ref:s,className:(0,m.cn)(l&&"text-destructive",n),htmlFor:c},t))});j.displayName="FormLabel";var g=c.forwardRef(function(e,s){var n=(0,t._)({},(0,r._)(e)),l=b(),i=l.error,c=l.formItemId,u=l.formDescriptionId,m=l.formMessageId;return(0,o.jsx)(d.g7,(0,a._)({ref:s,id:c,"aria-describedby":i?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!i},n))});g.displayName="FormControl";var y=c.forwardRef(function(e,s){var n=e.className,t=(0,i._)(e,["className"]),r=b().formDescriptionId;return(0,o.jsx)("p",(0,a._)({ref:s,id:r,className:(0,m.cn)("text-sm text-muted-foreground",n)},t))});y.displayName="FormDescription";var _=c.forwardRef(function(e,s){var n=e.className,t=e.children,r=(0,i._)(e,["className","children"]),c=b(),d=c.error,u=c.formMessageId,f=d?String(null==d?void 0:d.message):t;return f?(0,o.jsx)("p",(0,l._)((0,a._)({ref:s,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",n)},r),{children:f})):null});_.displayName="FormMessage"},94193:function(e,s,n){"use strict";n.d(s,{_:function(){return u}});var t=n(72253),r=n(47702),a=n(85893),l=n(67294),i=n(49102),o=n(12003),c=n(40108),d=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=l.forwardRef(function(e,s){var n=e.className,l=(0,r._)(e,["className"]);return(0,a.jsx)(i.f,(0,t._)({ref:s,className:(0,c.cn)(d(),n)},l))});u.displayName=i.f.displayName},88659:function(e,s,n){"use strict";n.d(s,{Bw:function(){return v},Ph:function(){return f},Ql:function(){return N},i4:function(){return p},ki:function(){return x}});var t=n(72253),r=n(14932),a=n(47702),l=n(85893),i=n(67294),o=n(76405),c=n(42171),d=n(15432),u=n(78865),m=n(40108),f=o.fC;o.ZA;var x=o.B4,p=i.forwardRef(function(e,s){var n=e.className,i=e.children,d=(0,a._)(e,["className","children"]);return(0,l.jsxs)(o.xz,(0,r._)((0,t._)({ref:s,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n)},d),{children:[i,(0,l.jsx)(o.JO,{asChild:!0,children:(0,l.jsx)(c.Z,{className:"h-4 w-4 opacity-50"})})]}))});p.displayName=o.xz.displayName;var h=i.forwardRef(function(e,s){var n=e.className,i=(0,a._)(e,["className"]);return(0,l.jsx)(o.u_,(0,r._)((0,t._)({ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",n)},i),{children:(0,l.jsx)(d.Z,{className:"h-4 w-4"})}))});h.displayName=o.u_.displayName;var b=i.forwardRef(function(e,s){var n=e.className,i=(0,a._)(e,["className"]);return(0,l.jsx)(o.$G,(0,r._)((0,t._)({ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",n)},i),{children:(0,l.jsx)(c.Z,{className:"h-4 w-4"})}))});b.displayName=o.$G.displayName;var v=i.forwardRef(function(e,s){var n=e.className,i=e.children,c=e.position,d=void 0===c?"popper":c,u=(0,a._)(e,["className","children","position"]);return(0,l.jsx)(o.h_,{children:(0,l.jsxs)(o.VY,(0,r._)((0,t._)({ref:s,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:d},u),{children:[(0,l.jsx)(h,{}),(0,l.jsx)(o.l_,{className:(0,m.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,l.jsx)(b,{})]}))})});v.displayName=o.VY.displayName,i.forwardRef(function(e,s){var n=e.className,r=(0,a._)(e,["className"]);return(0,l.jsx)(o.__,(0,t._)({ref:s,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",n)},r))}).displayName=o.__.displayName;var N=i.forwardRef(function(e,s){var n=e.className,i=e.children,c=(0,a._)(e,["className","children"]);return(0,l.jsxs)(o.ck,(0,r._)((0,t._)({ref:s,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},c),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(o.wU,{children:(0,l.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(o.eT,{children:i})]}))});N.displayName=o.ck.displayName,i.forwardRef(function(e,s){var n=e.className,r=(0,a._)(e,["className"]);return(0,l.jsx)(o.Z0,(0,t._)({ref:s,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",n)},r))}).displayName=o.Z0.displayName},67997:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},27460:function(e,s,n){"use strict";var t=n(91309),r=n(85893),a=n(67294),l=n(74855),i=n(78865),o=n(18289),c=n(86501),d=n(26858);s.Z=function(e){var s=e.address,n=e.word,u=e.showCopyButton,m=e.showCopyLast4Button,f=e.showAddress,x=void 0===f||f,p=e.colorClassName,h=void 0===p?"":p,b=e.colorClassName2,v=void 0===b?"":b,N=(0,t._)((0,a.useState)(!1),2),j=N[0],g=N[1],y=(0,t._)((0,a.useState)(!1),2),_=y[0],w=y[1];(0,a.useEffect)(function(){g(!1),w(!1)},[s]);var k=function(e){e.preventDefault(),e.stopPropagation()};return(0,r.jsxs)("span",{className:"inline-flex items-center space-x-1",children:[n&&(0,r.jsx)("span",{className:"text-xs",children:n}),x&&!v&&(0,r.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:(0,d.Vu)(s)}),x&&v&&(0,r.jsxs)("span",{className:"text-[0px]",children:[(0,r.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,r.jsx)("span",{className:"font-mono text-xs ".concat(v),children:"".concat(s.substring(s.length-4))})]}),(void 0===u||u)&&(0,r.jsx)(l.CopyToClipboard,{text:s,onCopy:function(e,s){s?(g(!0),setTimeout(function(){return g(!1)},2e3)):c.ZP.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:k,"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:j?(0,r.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")}):(0,r.jsx)(o.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")})})}),void 0!==m&&m&&(0,r.jsx)(l.CopyToClipboard,{text:s.substring(s.length-4),onCopy:function(e,s){s?(w(!0),c.ZP.success("已复制后4位"),setTimeout(function(){return w(!1)},2e3)):c.ZP.error("复制失败")},children:(0,r.jsx)("button",{className:"text-xs px-2 py-1 rounded border border-gray-300 focus:outline-none active:bg-gray-200 md:hover:bg-gray-100 transition-colors",onClick:k,"aria-label":"复制地址后4位",style:{WebkitTapHighlightColor:"transparent"},children:_?(0,r.jsx)("span",{className:"".concat(null!=h?h:"text-greyscale-500"),children:"已复制"}):(0,r.jsx)("span",{className:"".concat(null!=h?h:"text-greyscale-500"),children:"后4位"})})})]})}},54448:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return D}});var t=n(85893),r=n(67294),a=n(42130),l=n(67997),i=n(93778),o=n(85794),c=n(73591),d=n(7224),u=n(83494),m=n(42083),f=n(11010),x=n(72253),p=n(14932),h=n(91309),b=n(97582),v=n(39360),N=n(86501),j=n(56312),g=n(87536),y=n(63448),_=n(74193),w=n(21774),k=n(27245),C=n(88659),I=n(23432),Z=n(26858),T=n(99958),E=n(92180),A=n(64777),P=n(44576),B=function(e){var s,n,l=e.tokenBalance,d=(0,a.m)().address;(0,v.x)();var u=((0,r.useContext)(i.M)||{}).token,B=(0,h._)((0,r.useState)(!1),2),F=B[0],R=B[1],S=(0,o.yA)(null==u?void 0:u.address),z=S.approve,D=S.isPending,M=S.isConfirming,G=S.isConfirmed,L=S.writeError,V=(0,E.aE)(),W=V.stakeToken,J=V.isPending,H=V.isConfirming,X=V.isConfirmed,O=V.writeError,Q=(0,E.L)(null==u?void 0:u.address,d),Y=Q.promisedWaitingPhases,$=Q.isPending,U=Q.error,q=(0,o.yG)(null==u?void 0:u.address,d,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb"),K=q.allowance,ee=q.isPending,es=q.error,en=(0,r.useRef)(null),et=(0,r.useRef)(ee);(0,r.useEffect)(function(){if(et.current&&!ee){var e;null===(e=en.current)||void 0===e||e.blur()}et.current=ee},[ee]);var er=Number("30")||1,ea=Number("120")||2,el=(0,g.cI)({resolver:(0,j.F)(y.Ry({stakeTokenAmount:y.Z_().refine(function(e){return""!==e.trim()},{message:"请输入质押数量"}).refine(function(e){return Number(e)>0},{message:"质押代币数不能为0"}).refine(function(e){return(0,Z.vz)(e)<=l},{message:"质押代币数不能大于持有代币数"}),releasePeriod:y.Z_().min(1,"请选择解锁期")})),defaultValues:{stakeTokenAmount:"",releasePeriod:""},mode:"onChange"}),ei=(s=(0,f._)(function(e){var s;return(0,b.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,z("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",(0,Z.vz)(e.stakeTokenAmount))];case 1:return n.sent(),[3,3];case 2:return console.error("Approve failed",s=n.sent()),ed(s,"token"),[3,3];case 3:return[2]}})}),function(e){return s.apply(this,arguments)});(0,r.useEffect)(function(){G&&(R(!0),N.Am.success("授权".concat(null==u?void 0:u.symbol,"成功")))},[G,null==u?void 0:u.symbol]);var eo=(n=(0,f._)(function(e){var s;return(0,b.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,W(null==u?void 0:u.address,(0,Z.vz)(e.stakeTokenAmount),BigInt(e.releasePeriod),d)];case 1:return n.sent(),[3,3];case 2:return console.error("Stake failed",s=n.sent()),ed(s,"stake"),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)});(0,r.useEffect)(function(){X&&(N.Am.success("质押成功"),el.reset(),setTimeout(function(){window.location.href="".concat("/interface","/gov?symbol=").concat(null==u?void 0:u.symbol)},2e3))},[X,el,null==u?void 0:u.symbol]);var ec=el.watch("stakeTokenAmount");(0,r.useEffect)(function(){var e=BigInt(0);try{e=(0,Z.vz)(ec||"0")}catch(s){e=BigInt(0)}e>BigInt(0)&&K&&K>BigInt(0)&&K>=e?R(!0):R(!1)},[ec,K,ee]);var ed=(0,c.S)().handleContractError;return((0,r.useEffect)(function(){O&&ed(O,"stake"),L&&ed(L,"token"),es&&ed(es,"token"),U&&ed(U,"stake")},[O,L,es,U,ed]),$)?(0,t.jsx)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:(0,t.jsx)(m.Z,{})}):(0,t.jsxs)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:[(0,t.jsx)("div",{className:"w-full text-left mb-4",children:(0,t.jsx)(A.Z,{title:"质押增加治理收益"})}),(0,t.jsx)(_.l0,(0,p._)((0,x._)({},el),{children:(0,t.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"w-full max-w-md space-y-4",children:[(0,t.jsx)(_.Wi,{control:el.control,name:"stakeTokenAmount",render:function(e){var s=e.field;return(0,t.jsxs)(_.xJ,{children:[(0,t.jsx)(_.lX,{className:"text-sm",children:"质押数："}),(0,t.jsx)(_.NI,{children:(0,t.jsx)(w.I,(0,x._)({type:"number",placeholder:"输入 ".concat(null==u?void 0:u.symbol," 数量"),className:"!ring-secondary-foreground"},s))}),(0,t.jsxs)(_.pf,{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{children:["持有 ",(0,t.jsx)("span",{className:"mr-2",children:(0,Z.LH)(l)}),null==u?void 0:u.symbol]}),(0,t.jsx)(k.z,{variant:"link",size:"sm",type:"button",onClick:function(){el.setValue("stakeTokenAmount",(0,Z.bM)(l||BigInt(0)))},disabled:l<=BigInt(0),className:"text-secondary mr-2",children:"全部"})]}),(0,t.jsx)(_.zG,{})]})}}),(0,t.jsx)(_.Wi,{control:el.control,name:"releasePeriod",render:function(e){var s=e.field;return(0,t.jsxs)(_.xJ,{children:[(0,t.jsx)(_.lX,{children:"解锁期："}),(0,t.jsx)(_.NI,{children:(0,t.jsxs)(C.Ph,{onValueChange:function(e){return s.onChange(e)},value:s.value,children:[(0,t.jsx)(C.i4,{className:"w-full !ring-secondary-foreground",children:(0,t.jsx)(C.ki,{placeholder:"选择解锁期长度"})}),(0,t.jsx)(C.Bw,{children:Array.from({length:ea-er+1},function(e,s){return s+er}).filter(function(e){return e>=Y}).map(function(e){return(0,t.jsx)(C.Ql,{value:String(e),children:(0,T.Cn)(e)},e)})})]})}),(0,t.jsx)(_.pf,{children:"提示：取消质押后，需等待解锁期过后才能取回代币"}),(0,t.jsx)(_.zG,{})]})}}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,t.jsx)(k.z,{ref:en,className:"w-1/2",disabled:ee||D||M||F,onClick:function(){return el.handleSubmit(ei)()},children:ee?(0,t.jsx)(I.Z,{className:"animate-spin h-4 w-4"}):D?"1.授权中...":M?"1.确认中...":F?"1.".concat(null==u?void 0:u.symbol,"已授权"):"1.授权".concat(null==u?void 0:u.symbol)}),(0,t.jsx)(k.z,{className:"w-1/2",disabled:!F||J||H||X,onClick:function(){return el.handleSubmit(eo)()},children:J?"2.质押中...":H?"2.确认中...":X?"2.已质押":"2.质押"})]})]})})),(0,t.jsx)(P.Z,{isLoading:D||M||J||H,text:D||J?"提交交易...":"确认交易..."})]})},F=n(77156),R=n(27460),S=n(53696);function z(){var e=((0,r.useContext)(i.M)||{}).token,s=(0,a.m)().address,n=(0,F.hS)((null==e?void 0:e.stTokenAddress)||"",s||"0x0000000000000000000000000000000000000000"),l=n.balance,o=n.isPending,d=n.error,u=(0,c.S)().handleContractError;return((0,r.useEffect)(function(){d&&u(d,"token")},[d]),null==e?void 0:e.stTokenAddress)?(0,t.jsx)("div",{className:"px-4 pt-0 pb-6",children:(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 text-sm mt-4",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{className:"mr-2",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"font-bold text-2xl mr-2 font-mono",children:["st",e.symbol]}),(0,t.jsx)(R.Z,{address:e.stTokenAddress}),(0,t.jsx)(S.Z,{tokenAddress:e.stTokenAddress,tokenSymbol:e.symbol||"",tokenDecimals:e.decimals||0})]})})}),(0,t.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,t.jsx)("span",{className:"text-sm text-greyscale-500 mr-1",children:"我持有:"}),(0,t.jsx)("span",{className:"text-sm text-secondary",children:o?(0,t.jsx)(m.Z,{}):(0,Z.LH)(l||BigInt(0))})]})]})}):(0,t.jsx)(m.Z,{})}var D=function(){var e=((0,r.useContext)(i.M)||{}).token,s=(0,a.m)().address,n=(0,o.hS)(null==e?void 0:e.address,s).balance,f=(0,d.tT)(null==e?void 0:e.slTokenAddress),x=f.tokenAmount,p=f.isPending,h=f.error,b=(0,c.S)().handleContractError;return(0,r.useEffect)(function(){h&&b(h,"slToken")},[h]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{title:"质押代币"}),(0,t.jsxs)("main",{className:"flex-grow",children:[p&&(0,t.jsx)(m.Z,{}),!p&&!x&&(0,t.jsx)("div",{className:"flex justify-center items-center mt-10",children:"需要先质押流动性LP，才可以质押代币"}),x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z,{}),(0,t.jsx)(B,{tokenBalance:n||BigInt(0)})]}),(0,t.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,t.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,t.jsx)(l.Z,{className:"w-4 h-4"}),"提示"]}),(0,t.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、质押代币可获得 加速激励"}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的验证激励：当轮治理总激励 * 50% * 当轮该地址参与验证的治理票数 / 当轮参与验证的治理票总数"}),(0,t.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"4、单个地址的加速激励：当轮治理总激励 * 50% * 该地址加速质押代币数量 / 当轮所有参与验证地址的加速质押代币总数"}),(0,t.jsx)("div",{className:"text-sm text-blue-700",children:"5、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})}}},function(e){e.O(0,[8501,4463,1617,246,5771,3494,3591,6127,2180,8499,225,2888,9774,179],function(){return e(e.s=94163)}),_N_E=e.O()}]);