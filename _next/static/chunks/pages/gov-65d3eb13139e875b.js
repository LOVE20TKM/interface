(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9800],{18651:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(40854),l=t(37876),n=t(14232),r=t(63934),c=t(83416);let i=e=>{var s=e.initialTimeLeft,t=e.onTick,r=(0,a._)((0,n.useState)(Date.now()+1e3*s),2),c=r[0],i=r[1],d=(0,a._)((0,n.useState)(s),2),o=d[0],x=d[1];(0,n.useEffect)(()=>{i(Date.now()+1e3*s)},[s]),(0,n.useEffect)(()=>{var e=setInterval(()=>{var s=Math.max(0,Math.floor((c-Date.now())/1e3));x(s),t&&t(s),s<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[c,t]);var m=Math.floor(o/86400),u=Math.floor(o%86400/3600),v=Math.floor(o%3600/60);return(0,l.jsxs)("div",{className:"inline-flex gap-1 text-greyscale-400",children:[m>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":m}})}),"天"]}),(u>0||m>0)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":u}})}),"时"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":v}})}),"分"]}),m<=0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"countdown font-mono",children:(0,l.jsx)("span",{style:{"--value":o%60}})}),"秒"]})]})};var d=t(12293);let o=e=>{var s=e.currentRound,t=e.roundType,o=e.showCountdown,x=(0,r.y)().data,m=(0,n.useContext)(c.N),u=m?m.token:void 0,v=!x||!u||void 0===u.voteOriginBlocks,h=(0,a._)((0,n.useState)(0n),2),j=h[0],N=h[1],f=Number("120")||0,y=Number("255")||0,g=u?Number(u.voteOriginBlocks):0,p=f-(Number(x)-g)%f,b=p>0?Math.ceil(p*y/100):0,w=(0,a._)((0,n.useState)(b),2),A=w[0],C=w[1];(0,n.useEffect)(()=>{if(x){var e=f-(Number(x)-g)%f;C(e>0?Math.ceil(e*y/100):0)}},[x,f,y,g]),(0,n.useEffect)(()=>{s>0n&&N(s)},[s]);var k=null!=j?j.toString():"0";return j<=0n?(0,l.jsx)(l.Fragment,{}):v||null==j||j<0n?((null==j||j<0n)&&(console.log("currentTokenRound",j),console.log("currentRound",s)),(0,l.jsx)(d.A,{})):(0,l.jsx)("div",{className:"flex items-center mb-3",children:(0,l.jsxs)("span",{className:"text-sm text-greyscale-400",children:["( 第",(0,l.jsx)("span",{className:"text-greyscale-400",children:k}),"轮","vote"===t?"投票":"verify"===t?"验证":"行动","阶段，",(0,l.jsx)("span",{className:"text-greyscale-400",children:"剩余"}),(0,l.jsx)("span",{className:"text-greyscale-400",children:Math.ceil(100*A/y)}),(0,l.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),void 0===o||o?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(i,{initialTimeLeft:b,onTick:C})}):(0,l.jsx)("span",{className:"text-greyscale-400",children:A<60?"".concat(A,"秒"):A<=300?"".concat(Math.floor(A/60),"分钟").concat(A%60,"秒"):A<3600?"".concat(Math.floor(A/60),"分钟"):"".concat(Math.floor(A/3600),"小时").concat(Math.floor(A%3600/60),"分钟")}),(0,l.jsx)("span",{className:"text-greyscale-400",children:" )"})]})})}},42883:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var a=t(37876),l=t(14232),n=t(8047),r=t(6960),c=t(48230),i=t.n(c),d=t(3576),o=t(65699),x=t(64345),m=t(30684),u=x.bL,v=l.forwardRef((e,s)=>{var t=e.className,l=(0,o._)(e,["className"]);return(0,a.jsx)(x.B8,(0,d._)({ref:s,className:(0,m.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t)},l))});v.displayName=x.B8.displayName;var h=l.forwardRef((e,s)=>{var t=e.className,l=(0,o._)(e,["className"]);return(0,a.jsx)(x.l9,(0,d._)({ref:s,className:(0,m.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t)},l))});h.displayName=x.l9.displayName;var j=l.forwardRef((e,s)=>{var t=e.className,l=(0,o._)(e,["className"]);return(0,a.jsx)(x.UC,(0,d._)({ref:s,className:(0,m.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t)},l))});j.displayName=x.UC.displayName;var N=t(83416),f=t(19591),y=t(20451),g=t(60154),p=t(62537),b=t(78572),w=t(52372),A=t(12293),C=t(4066),k=t(20442);let _=e=>{var s=e.currentRound,t=((0,l.useContext)(N.N)||{}).token,n=(0,w.W6)(null==t?void 0:t.address),c=n.govData,d=n.isPending,o=n.error,x=(0,y.g)().handleContractError;if((0,l.useEffect)(()=>{o&&x(o,"govData")},[o]),!t)return(0,a.jsx)(A.A,{});var m=s-BigInt(t.initialStakeRound)+1n,u=(0,C.I)(null==c?void 0:c.rewardAvailable,m);return(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("div",{className:"border rounded-lg p-0",children:[(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pb-2 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm pb-1",children:"总治理票数"}),(0,a.jsx)("div",{className:"stat-value text-secondary text-xl",children:d?(0,a.jsx)(A.A,{}):(0,k.NJ)((null==c?void 0:c.govVotes)||BigInt(0))})]}),(0,a.jsxs)("div",{className:"stat place-items-center pb-2 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm pb-1",children:"预计新增铸币"}),(0,a.jsx)("div",{className:"stat-value text-secondary text-xl",children:d?(0,a.jsx)(A.A,{}):(0,k.NJ)(u)})]})]}),(0,a.jsxs)("div",{className:"text-center text-xs mx-8 text-greyscale-500 border-b border-greyscale-200 pb-2",children:["预估年化收益率（APY）：",(0,C.bD)(null==c?void 0:c.rewardAvailable,null==c?void 0:c.tokenAmountForSl,null==c?void 0:c.stAmount)]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,a.jsxs)("div",{className:"stat place-items-center pb-0 pt-0 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"流动性质押凭证SL代币"}),(0,a.jsx)("div",{className:"stat-value text-lg text-gray-600",children:d?(0,a.jsx)(A.A,{}):(0,a.jsxs)(i(),{href:"/gov/liquid?symbol=".concat(null==t?void 0:t.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,a.jsx)("span",{className:"cursor-pointer",children:(0,k.NJ)((null==c?void 0:c.slAmount)||BigInt(0))}),(0,a.jsx)(b.A,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(r.$,{variant:"link",className:"text-secondary font-normal border-secondary pt-0",asChild:!0,children:(0,a.jsx)(i(),{href:"/gov/stakelp/?symbol=".concat(t.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,a.jsxs)("div",{className:"stat place-items-center pb-0 pt-0 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"代币质押凭证ST代币"}),(0,a.jsx)("div",{className:"stat-value text-lg text-gray-600",children:d?(0,a.jsx)(A.A,{}):(0,k.NJ)((null==c?void 0:c.stAmount)||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(r.$,{variant:"link",className:"text-secondary font-normal border-secondary pt-0",asChild:!0,children:(0,a.jsx)(i(),{href:"/gov/staketoken?symbol=".concat(t.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]})]})})};var E=t(98684),R=t(1709),B=t(18651);let M=e=>{var s=e.currentRound,t=e.validGovVotes,c=e.isPendingValidGovVotes,d=((0,l.useContext)(N.N)||{}).token,o=(0,n.F)().address,x=(0,E.Pb)((null==d?void 0:d.address)||"",s,o||""),m=x.votesNumByAccount,u=x.isPending,v=x.error,h=(0,y.g)().handleContractError;if((0,l.useEffect)(()=>{v&&h(v,"vote")},[v]),!d)return"";if(!o)return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,a.jsx)(R.A,{title:"我的投票"}),(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})});var j=c||!1,f=t||0n;return(0,a.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)(R.A,{title:"我的投票"}),(0,a.jsx)(r.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(i(),{href:"/vote/actions/?symbol=".concat(null==d?void 0:d.symbol),children:"投票中的行动"})})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的已投票数"}),(0,a.jsx)("div",{className:"stat-value text-xl",children:u?(0,a.jsx)(A.A,{}):(0,k.NJ)(m||BigInt(0))})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-2",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的未投票数"}),(0,a.jsx)("div",{className:"stat-value text-xl",children:j||u?(0,a.jsx)(A.A,{}):f?(0,k.NJ)(f-m||BigInt(0)):"0"})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:j||u?(0,a.jsx)(A.A,{}):f>m+10n?(0,a.jsx)(r.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(i(),{href:"/vote?symbol=".concat(d.symbol),children:"去投票"})}):(0,a.jsx)(r.$,{disabled:!0,className:"w-1/2",children:f>0?"已投票":"无治理票，不能投票"})}),(0,a.jsx)("div",{className:"flex justify-center mt-2",children:(0,a.jsx)(B.A,{currentRound:s,roundType:"vote",showCountdown:!1})})]})};var F=t(65575),P=t(29898);let T=e=>{var s=e.currentRound,t=e.showBtn,c=void 0===t||t,d=((0,l.useContext)(N.N)||{}).token,o=(0,n.F)().address,x=(0,E.Pb)(null==d?void 0:d.address,s,o||""),m=x.votesNumByAccount,u=x.isPending,v=x.error,h=(0,P.$d)(null==d?void 0:d.address,s,o||""),j=h.scoreByVerifier,f=h.isPending,g=h.error,p=(()=>{if(u||f)return 0n;var e=(0,F.oQ)(m),s=(0,F.oQ)(j);try{return e>=s?e-s:0n}catch(e){return console.error("计算剩余验证票数出错:",e),0n}})(),b=(0,y.g)().handleContractError;return((0,l.useEffect)(()=>{v&&b(v,"vote"),g&&b(g,"verify")},[v,g]),d)?o?(0,a.jsxs)("div",{className:"flex-col items-center px-4 pb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)(R.A,{title:"我的验证"}),c&&s>=1n&&(0,a.jsx)(r.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(i(),{href:"/verify/actions/?symbol=".concat(null==d?void 0:d.symbol),children:"验证中的行动"})})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"已验证票数"}),(0,a.jsx)("div",{className:"stat-value text-xl ".concat(c?"":"text-secondary"),children:f?(0,a.jsx)(A.A,{}):(0,k.NJ)((0,F.oQ)(j))})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-2",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"未验证票数"}),(0,a.jsx)("div",{className:"stat-value text-xl ".concat(c?"":"text-secondary"),children:u||f?(0,a.jsx)(A.A,{}):(0,k.NJ)(p)})]})]}),c&&(0,a.jsx)("div",{className:"flex justify-center",children:u||f?(0,a.jsx)(A.A,{}):p>5n&&(0,F.oQ)(m)>(0,F.oQ)(j)?(0,a.jsx)(r.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(i(),{href:"/verify?symbol=".concat(d.symbol),children:"去验证"})}):(0,a.jsx)(r.$,{disabled:!0,className:"w-1/2",children:(0,F.oQ)(j)>0n?"已验证":"未投票，无需验证"})}),(0,a.jsx)("div",{className:"flex justify-center mt-2",children:(0,a.jsx)(B.A,{currentRound:s,roundType:"verify",showCountdown:!1})})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex-col items-center px-4 pt-6 pb-2",children:[(0,a.jsx)(R.A,{title:"行动验证"}),(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):(0,a.jsx)(A.A,{})};var $=t(65104),I=t(63934),V=t(40752),S=t(62288);let J=e=>{var s=e.token,t=(0,I.y)().data,c=(0,n.F)().address,d=(0,V.TU)(s?s.address:"0x0000000000000000000000000000000000000000"),o=(d.launchInfo,d.isPending),x=d.error,m=(0,V.Of)(s?s.address:"0x0000000000000000000000000000000000000000",c).remainingLaunchCount,u=(0,S.MZ)(s?s.address:"0x0000000000000000000000000000000000000000",c).numOfMintGovRewardByAccount,v=(0,y.g)().handleContractError;if(l.useEffect(()=>{x&&v(x,"launch")},[x]),o||!t)return(0,a.jsx)(a.Fragment,{});var h=Number("2")||180n,j=Number(h)-Number(u)%Number(h);return console.log("remainingLaunchCount",m),console.log("numOfMintGovRewardByAccount",u),console.log("remainingMintTimes",j),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)(R.A,{title:"子币发射"}),m&&m&&(0,a.jsx)(r.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(i(),{href:"/tokens/children/?symbol=".concat(null==s?void 0:s.symbol),children:"子币列表"})})]}),(0,a.jsxs)("div",{className:"w-full text-center mb-4",children:[m&&m>0?(0,a.jsx)(r.$,{variant:"outline",size:"sm",className:"mt-2 w-1/2 text-secondary border-secondary",disabled:void 0===m||m<=0,asChild:!0,children:(0,a.jsxs)(i(),{href:"/launch/deploy?symbol=".concat(null==s?void 0:s.symbol),children:[(0,a.jsx)($.A,{className:"w-4 h-4"}),"开启子币公平发射"]})}):(0,a.jsx)(r.$,{disabled:!0,className:"w-1/2",children:"开启子币公平发射"}),(0,a.jsxs)("div",{className:"px-4 mt-2 mb-4 text-center",children:[(0,a.jsxs)("p",{className:"text-greyscale-500 text-sm",children:["剩余开启次数：",Number(m),"次，再完成 ",j,"次治理奖励铸币，可增加1次"]}),(0,a.jsxs)("p",{className:"text-greyscale-500 text-sm",children:["（须持有 TestLOVE20不少于 ",Number("3")/10,"%的治理票）"]})]}),(0,a.jsx)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4 text-left",children:(0,a.jsxs)("p",{children:["公平发射募集目标：",(0,k.NJ)((0,F.oQ)("2E+25")),"个"," ",null==s?void 0:s.symbol]})})]})]})};var O=t(92474);let D=()=>{var e=((0,l.useContext)(N.N)||{}).token,s=(0,n.F)(),t=s.address,c=s.isConnected,d=(0,f.vC)(),o=d.currentRound,x=d.error,m=d.isPending,b=(0,f.Fd)((null==e?void 0:e.address)||"",t||""),w=b.validGovVotes,C=b.isPending,k=b.error,E=(0,y.g)().handleContractError;l.useEffect(()=>{k&&E(k,"stake"),x&&E(x,"vote")},[k,x]);var R=w>0n;return c&&(m||C)?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(A.A,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{title:"治理首页"}),(0,a.jsx)("main",{className:"flex-grow",children:c?e?e&&!e.hasEnded?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{}),(0,a.jsxs)("div",{className:"flex flex-col items-center p-4 mt-4",children:[(0,a.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"公平发射未结束，还不能参与治理"}),(0,a.jsx)(r.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(i(),{href:"/launch?symbol=".concat(e.symbol),children:"查看公平发射"})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u,{defaultValue:"my-assets",className:"w-full px-4",children:[(0,a.jsxs)(v,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(h,{value:"my-assets",children:"我的治理资产"}),(0,a.jsx)(h,{value:"community-assets",children:"社区治理资产"})]}),(0,a.jsx)(j,{value:"my-assets",children:(0,a.jsx)("div",{className:"border rounded-lg px-2 py-4 mt-2",children:(0,a.jsx)(O.A,{token:e,enableWithdraw:!1})})}),(0,a.jsx)(j,{value:"community-assets",children:(0,a.jsx)(_,{currentRound:o||0n})})]}),C?(0,a.jsx)("div",{className:"flex justify-center p-4",children:(0,a.jsx)(A.A,{})}):R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M,{currentRound:o||0n,validGovVotes:w,isPendingValidGovVotes:C}),(0,a.jsx)(T,{currentRound:o>2?o-2n:0n}),(0,a.jsx)(J,{token:e})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center p-4 mt-4",children:[(0,a.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"您当前没有治理票，获取治理票后才能治理"}),(0,a.jsx)(r.$,{className:"w-1/2",asChild:!0,children:(0,a.jsx)(i(),{href:"/gov/stakelp/?symbol=".concat(null==e?void 0:e.symbol),children:"质押获取治理票"})})]})]}):(0,a.jsx)(A.A,{}):(0,a.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,a.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})})]})}},67717:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov",function(){return t(42883)}])},87577:(e,s,t)=>{"use strict";t.d(s,{A:()=>x});var a=t(40854),l=t(37876),n=t(14232),r=t(48447),c=t(33276),i=t(70801),d=t(97685),o=t(20442);let x=e=>{var s=e.address,t=e.word,x=e.showCopyButton,m=e.showAddress,u=void 0===m||m,v=e.colorClassName,h=void 0===v?"":v,j=e.colorClassName2,N=void 0===j?"":j,f=(0,a._)((0,n.useState)(!1),2),y=f[0],g=f[1];return(0,l.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[t&&(0,l.jsx)("span",{className:"text-xs",children:t}),u&&!N&&(0,l.jsx)("span",{className:"text-xs ".concat(null!=h?h:"text-greyscale-500"),children:(0,o.W_)(s)}),u&&N&&(0,l.jsxs)("span",{className:"text-[0px]",children:[(0,l.jsx)("span",{className:"text-xs ".concat(null!=h?h:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,l.jsx)("span",{className:"text-xs ".concat(N),children:"".concat(s.substring(s.length-4))})]}),(void 0===x||x)&&(0,l.jsx)(r.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?g(!0):d.Ay.error("复制失败")},children:(0,l.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:y?(0,l.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")}):(0,l.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3308,9374,8230,8809,5701,4267,2958,154,3096,5139,9513,3356,2288,9898,7121,125,2537,2474,636,6593,8792],()=>s(67717)),_N_E=e.O()}]);