try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="1f9deef7-2711-492f-b08e-06960952f3da",e._sentryDebugIdIdentifier="sentry-dbid-1f9deef7-2711-492f-b08e-06960952f3da")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3295],{56223:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/verify_detail",function(){return s(78886)}])},78886:function(e,t,s){"use strict";s.r(t);var i=s(72253),n=s(14932),r=s(91309),d=s(85893),a=s(67294),l=s(11163),x=s(42130),c=s(36893),o=s(93950),h=s(73591),m=s(83494),u=s(42083),p=s(11418),b=s(27460),f=s(90963),j=s(64777),g=s(93778),v=s(91529);t.default=function(){var e=(0,l.useRouter)(),t=e.query,s=t.id,N=t.round,w=s?BigInt(s):void 0,y=N?BigInt(N):void 0,k=(0,x.m)().address,W=((0,a.useContext)(g.M)||{}).token,S=(0,r._)((0,a.useState)(BigInt(0)),2),A=S[0],I=S[1],_=(0,c.r)({tokenAddress:null==W?void 0:W.address,actionId:w,account:k}),z=_.actionInfo,B=_.participantCount,T=_.totalAmount,C=_.userJoinedAmount,L=_.isJoined,E=_.isPending,Z=_.error,M=_.currentRound;(0,a.useEffect)(function(){y?I(y):W&&M&&M-BigInt(W.initialStakeRound)>=BigInt(2)&&I(M-BigInt(2))},[y,M,W]);var D=(0,o.Aw)((null==W?void 0:W.address)||"0x",A||BigInt(0),w||BigInt(0)),P=D.verificationMatrix,R=D.isPending,F=D.error,H=function(t){I(BigInt(t)),e.push({pathname:e.pathname,query:(0,n._)((0,i._)({},e.query),{round:t.toString()})},void 0,{shallow:!0})},J=(0,h.S)().handleContractError;return((0,a.useEffect)(function(){Z&&J(Z,"verify_detail"),F&&J(F,"verify_detail_matrix")},[Z,F]),void 0===w)?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsx)("main",{className:"flex-grow",children:(0,d.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,d.jsx)("div",{className:"text-center text-red-500",children:"参数错误：缺少行动ID参数"})})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsxs)("div",{className:"flex-grow",children:[(0,d.jsx)("div",{className:"px-4 pt-0 pb-3",children:z&&(0,d.jsx)(p.Z,{actionInfo:z,participantCount:B,totalAmount:T,isJoined:L,userJoinedAmount:C,isPending:E,showActionButtons:!1,linkToActionInfo:!0})}),E?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(u.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载数据中..."})]})})}):Z?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载失败：",Z.message||"获取行动信息失败，请稍后重试"]})})}):z?function(){if(R)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(u.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载验证矩阵中..."})]})});if(F)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载验证矩阵失败：",F.message||"获取验证矩阵失败，请稍后重试"]})});if(!P||0===P.verifiers.length)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-gray-600",children:"暂无验证数据"})});var e=P.verifiers,t=P.verifiees,s=P.scores,i=t.map(function(t,i){return e.reduce(function(e,t,n){var r,d=null===(r=s[n])||void 0===r?void 0:r[i];return e+(void 0!==d?Number(d):0)},0)}),n=t.map(function(e,t){return t}).sort(function(e,t){return i[t]-i[e]}),r=e.map(function(e,i){return t.reduce(function(e,t,n){var r,d=null===(r=s[i])||void 0===r?void 0:r[n];return e+(void 0!==d?Number(d):0)},0)}),a=i.reduce(function(e,t){return e+t},0),l=function(e,t){var i,n=null===(i=s[e])||void 0===i?void 0:i[t],d=r[e];if(void 0===n||0===d)return"0%";var a=Number(n)/d*100;return"".concat((0,v.rl)(a))};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"bg-white rounded-lg mx-4 mb-4",children:(0,d.jsx)("div",{className:"px-4 ",children:(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsx)("div",{className:"flex items-center",children:A>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.Z,{title:"第 ".concat(A.toString()," 轮验证明细")}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500 ml-2",children:"("}),(0,d.jsx)(f.Z,{currentRound:W&&M?(0,v.cK)(M-BigInt(2),W):BigInt(0),handleChangedRound:H}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500",children:")"})]})})})})}),(0,d.jsx)("div",{className:"w-full max-w-full overflow-hidden px-4",children:(0,d.jsx)("div",{className:"overflow-x-auto bg-white max-w-full table-container-webview",children:(0,d.jsxs)("table",{className:"w-full min-w-[846px]",style:{tableLayout:"fixed"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-30",style:{WebkitTextSizeAdjust:"100%",width:"156px",minWidth:"156px",maxWidth:"156px",backgroundColor:"#f9fafb",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsx)("div",{className:"text-gray-600 mb-1 whitespace-nowrap",style:{fontSize:"12px"},children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"flex flex-col items-center mr-1",children:(0,d.jsx)("span",{className:"text-xs text-gray-400 mt-[-2px]",children:(0,d.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:"inline",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)("path",{d:"M6 2v8M6 10l3-3M6 10L3 7",stroke:"#A3A3A3",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})})})}),(0,d.jsx)("span",{children:"行动参与者"}),(0,d.jsx)("span",{className:"mx-1 text-gray-400",children:"/"}),(0,d.jsxs)("span",{className:"flex flex-row items-center",children:[(0,d.jsx)("span",{children:"验证者"}),(0,d.jsx)("span",{className:"text-xs text-gray-400 ml-1",children:(0,d.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:"inline",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)("path",{d:"M2 6h8M10 6l-3-3M10 6l-3 3",stroke:"#A3A3A3",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})})}),(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-[156px] z-30",style:{WebkitTextSizeAdjust:"100%",width:"46px",minWidth:"46px",maxWidth:"46px",backgroundColor:"#f9fafb",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsxs)("div",{className:"text-gray-600 mb-1 whitespace-nowrap",style:{fontSize:"12px"},children:["得票",(0,d.jsx)("br",{}),"占比"]})}),e.map(function(e,t){return(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(0,d.jsx)("div",{children:(0,d.jsx)(b.Z,{address:e,colorClassName:"text-gray-700"})})},"verifier-".concat(t))}),(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"152px",minWidth:"152px",maxWidth:"152px"},children:(0,d.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"得票总数(占比)"})})]})}),(0,d.jsxs)("tbody",{children:[n.map(function(n,r){var x=t[n];return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-20",style:{WebkitTextSizeAdjust:"100%",width:"156px",minWidth:"156px",maxWidth:"156px",backgroundColor:"#f9fafb",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsx)("div",{style:{fontSize:"12px"},children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsxs)("span",{className:"text-xs text-gray-500 font-mono min-w-[16px] mt-0.5",children:[r+1,"."]}),(0,d.jsx)("div",{className:"flex-1",children:"0x0000000000000000000000000000000000000000"===x?(0,d.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"弃权票"}):(0,d.jsx)(b.Z,{address:x,colorClassName:"text-gray-700"})})]})})}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 bg-gray-50 sticky left-[156px] z-20",style:{WebkitTextSizeAdjust:"100%",width:"46px",minWidth:"46px",maxWidth:"46px",backgroundColor:"#f9fafb",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("span",{className:"text-xs font-bold text-gray-700",children:a>0?(0,v.rl)(i[n]/a*100):"0%"})})}),e.map(function(e,t){var i;return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(null===(i=s[t])||void 0===i?void 0:i[n])!==void 0?(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono whitespace-nowrap",children:(0,v.LH)(s[t][n])}),(0,d.jsxs)("span",{className:"text-gray-500",children:["(",l(t,n),")"]})]}):(0,d.jsx)("span",{className:"font-mono whitespace-nowrap",style:{fontSize:"14px"},children:"-"})},"score-".concat(t,"-").concat(n))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"152px",minWidth:"152px",maxWidth:"152px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(i[n]))}),(0,d.jsxs)("span",{className:"text-blue-500",children:["(",a>0?(0,v.rl)(i[n]/a*100):"0%",")"]})]})})]},"verifiee-".concat(n))}),(0,d.jsxs)("tr",{className:"",children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-blue-50 sticky left-0 z-20 font-bold",style:{WebkitTextSizeAdjust:"100%",width:"156px",minWidth:"156px",maxWidth:"156px",backgroundColor:"#dbeafe",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsxs)("div",{className:"text-center text-sm text-blue-600",children:["汇总 (",t.length-1," 个参与者)"]})}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 bg-blue-50 sticky left-[156px] z-20 font-bold",style:{WebkitTextSizeAdjust:"100%",width:"46px",minWidth:"46px",maxWidth:"46px",backgroundColor:"#dbeafe",boxShadow:"1px 0 0 0 #d1d5db"},children:(0,d.jsx)("div",{className:"text-center text-xs text-blue-600",children:"100%"})}),e.map(function(e,t){var s=r[t];return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(s))}),(0,d.jsxs)("span",{className:"text-blue-500",children:["(",(0,v.rl)(a>0?s/a*100:0),")"]})]})},"summary-".concat(t))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"152px",minWidth:"152px",maxWidth:"152px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(a))}),(0,d.jsx)("span",{className:"text-blue-500",children:"(100%)"})]})})]})]})]})})}),(0,d.jsx)("div",{className:"bg-white mx-4 mt-4 rounded-lg",children:(0,d.jsx)("div",{className:"px-4 py-3 text-xs text-gray-500",children:(0,d.jsx)("p",{className:"md:hidden text-blue-600",children:"• 手机端请左右滑动表格查看完整内容"})})})]})}():(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-yellow-600",children:"行动不存在：找不到指定的行动信息"})})})]})]})}}},function(e){e.O(0,[8239,367,6143,3494,2252,3950,7724,4139,2888,9774,179],function(){return e(e.s=56223)}),_N_E=e.O()}]);