try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="61478a64-cb6e-4fb9-99e0-d432444fae01",e._sentryDebugIdIdentifier="sentry-dbid-61478a64-cb6e-4fb9-99e0-d432444fae01")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3295],{56223:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/verify_detail",function(){return s(78886)}])},78886:function(e,t,s){"use strict";s.r(t);var i=s(72253),n=s(14932),r=s(91309),d=s(85893),a=s(67294),l=s(11163),c=s(42130),x=s(36893),o=s(93950),u=s(73591),h=s(83494),m=s(42083),p=s(11418),f=s(27460),j=s(90963),g=s(64777),b=s(93778),v=s(91529);t.default=function(){var e=(0,l.useRouter)(),t=e.query,s=t.id,N=t.round,y=s?BigInt(s):void 0,w=N?BigInt(N):void 0,W=(0,c.m)().address,I=((0,a.useContext)(b.M)||{}).token,k=(0,r._)((0,a.useState)(BigInt(0)),2),_=k[0],B=k[1],A=(0,x.r)({tokenAddress:null==I?void 0:I.address,actionId:y,account:W}),S=A.actionInfo,z=A.participantCount,T=A.totalAmount,C=A.userJoinedAmount,E=A.isJoined,Z=A.isPending,D=A.error,L=A.currentRound;(0,a.useEffect)(function(){w?B(w):I&&L&&L-BigInt(I.initialStakeRound)>=BigInt(2)&&B(L-BigInt(2))},[w,L,I]);var P=(0,o.Aw)((null==I?void 0:I.address)||"0x",_||BigInt(0),y||BigInt(0)),R=P.verificationMatrix,F=P.isPending,H=P.error,J=function(t){B(BigInt(t)),e.push({pathname:e.pathname,query:(0,n._)((0,i._)({},e.query),{round:t.toString()})},void 0,{shallow:!0})},q=(0,u.S)().handleContractError;return((0,a.useEffect)(function(){D&&q(D,"verify_detail"),H&&q(H,"verify_detail_matrix")},[D,H]),void 0===y)?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsx)("main",{className:"flex-grow",children:(0,d.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,d.jsx)("div",{className:"text-center text-red-500",children:"参数错误：缺少行动ID参数"})})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsxs)("div",{className:"flex-grow",children:[(0,d.jsx)("div",{className:"px-4 pt-0 pb-3",children:S&&(0,d.jsx)(p.Z,{actionInfo:S,participantCount:z,totalAmount:T,isJoined:E,userJoinedAmount:C,isPending:Z,showActionButtons:!1,linkToActionInfo:!0})}),Z?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(m.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载数据中..."})]})})}):D?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载失败：",D.message||"获取行动信息失败，请稍后重试"]})})}):S?function(){if(F)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(m.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载验证矩阵中..."})]})});if(H)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载验证矩阵失败：",H.message||"获取验证矩阵失败，请稍后重试"]})});if(!R||0===R.verifiers.length)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-gray-600",children:"暂无验证数据"})});var e=R.verifiers,t=R.verifiees,s=R.scores,i=t.map(function(t,i){return e.reduce(function(e,t,n){var r,d=null===(r=s[n])||void 0===r?void 0:r[i];return e+(void 0!==d?Number(d):0)},0)}),n=t.map(function(e,t){return t}).sort(function(e,t){return i[t]-i[e]}),r=e.map(function(e,i){return t.reduce(function(e,t,n){var r,d=null===(r=s[i])||void 0===r?void 0:r[n];return e+(void 0!==d?Number(d):0)},0)}),a=i.reduce(function(e,t){return e+t},0),l=function(e,t){var i,n=null===(i=s[e])||void 0===i?void 0:i[t],d=r[e];if(void 0===n||0===d)return"0%";var a=Number(n)/d*100;return"".concat((0,v.rl)(a))};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"bg-white rounded-lg mx-4 mb-4",children:(0,d.jsx)("div",{className:"px-4 ",children:(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsx)("div",{className:"flex items-center",children:_>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Z,{title:"第 ".concat(_.toString()," 轮验证明细")}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500 ml-2",children:"("}),(0,d.jsx)(j.Z,{currentRound:I&&L?(0,v.cK)(L-BigInt(2),I):BigInt(0),handleChangedRound:J}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500",children:")"})]})})})})}),(0,d.jsx)("div",{className:"w-full max-w-full overflow-hidden px-4",children:(0,d.jsx)("div",{className:"overflow-x-auto bg-white max-w-full table-container-webview",children:(0,d.jsxs)("table",{className:"w-full min-w-[800px]",style:{tableLayout:"fixed"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-20",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsx)("div",{className:"text-gray-600 mb-1 whitespace-nowrap",style:{fontSize:"12px"},children:"行动参与者\xa0\xa0\\\xa0\xa0验证者"})}),e.map(function(e,t){return(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(0,d.jsx)("div",{children:(0,d.jsx)(f.Z,{address:e,colorClassName:"text-gray-700"})})},"verifier-".concat(t))}),(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(0,d.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"总票数"})})]})}),(0,d.jsxs)("tbody",{children:[n.map(function(n,r){var c=t[n];return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-10",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsx)("div",{style:{fontSize:"12px"},children:"0x0000000000000000000000000000000000000000"===c?(0,d.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"弃权票"}):(0,d.jsx)(f.Z,{address:c,colorClassName:"text-gray-700"})})}),e.map(function(e,t){var i;return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center",style:{WebkitTextSizeAdjust:"100%",width:"148px",minWidth:"148px",maxWidth:"148px"},children:(null===(i=s[t])||void 0===i?void 0:i[n])!==void 0?(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono whitespace-nowrap",children:(0,v.LH)(s[t][n])}),(0,d.jsxs)("span",{className:"text-gray-500",children:["(",l(t,n),")"]})]}):(0,d.jsx)("span",{className:"font-mono whitespace-nowrap",style:{fontSize:"14px"},children:"-"})},"score-".concat(t,"-").concat(n))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(i[n]))}),(0,d.jsxs)("span",{className:"text-blue-500",children:["(",a>0?(0,v.rl)(i[n]/a*100):"0%",")"]})]})})]},"verifiee-".concat(n))}),(0,d.jsxs)("tr",{className:"",children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-blue-50 sticky left-0 z-10 font-bold",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsxs)("div",{className:"text-center text-sm text-blue-600",children:["汇总 (",t.length," 个参与者)"]})}),e.map(function(e,t){var s=r[t];return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(s))}),(0,d.jsxs)("span",{className:"text-blue-500",children:["(",(0,v.rl)(a>0?s/a*100:0),")"]})]})},"summary-".concat(t))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"136px",minWidth:"136px",maxWidth:"136px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(a))}),(0,d.jsx)("span",{className:"text-blue-500",children:"(100%)"})]})})]})]})]})})}),(0,d.jsx)("div",{className:"bg-white mx-4 mt-4 rounded-lg",children:(0,d.jsx)("div",{className:"px-4 py-3 text-xs text-gray-500",children:(0,d.jsx)("p",{className:"md:hidden text-blue-600",children:"• 手机端请左右滑动表格查看完整内容"})})})]})}():(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-yellow-600",children:"行动不存在：找不到指定的行动信息"})})})]})]})}}},function(e){e.O(0,[8239,367,6143,3494,2252,3950,7724,4139,2888,9774,179],function(){return e(e.s=56223)}),_N_E=e.O()}]);