try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="52e02ad1-52fd-4f0d-a664-1494d9644bcb",e._sentryDebugIdIdentifier="sentry-dbid-52e02ad1-52fd-4f0d-a664-1494d9644bcb")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2156],{55778:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/detail",function(){return s(48827)}])},35810:function(e,t,s){"use strict";s.d(t,{$N:function(){return p},Be:function(){return h},Vq:function(){return u},cN:function(){return N},cZ:function(){return v},fK:function(){return g},hg:function(){return f}});var n=s(72253),a=s(14932),r=s(47702),o=s(85893),i=s(67294),c=s(12854),l=s(62190),d=s(40108),u=c.fC,f=c.xz,m=c.h_;c.x8;var x=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.aV,(0,n._)({ref:t,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a))});x.displayName=c.aV.displayName;var v=i.forwardRef(function(e,t){var s=e.className,i=e.children,u=(0,r._)(e,["className","children"]);return(0,o.jsxs)(m,{children:[(0,o.jsx)(x,{}),(0,o.jsxs)(c.VY,(0,a._)((0,n._)({ref:t,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},u),{children:[i,(0,o.jsxs)(c.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,o.jsx)(l.Z,{className:"h-4 w-4"}),(0,o.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});v.displayName=c.VY.displayName;var g=function(e){var t=e.className,s=(0,r._)(e,["className"]);return(0,o.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t)},s))};g.displayName="DialogHeader";var N=function(e){var t=e.className,s=(0,r._)(e,["className"]);return(0,o.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};N.displayName="DialogFooter";var p=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.Dx,(0,n._)({ref:t,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s)},a))});p.displayName=c.Dx.displayName;var h=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.dk,(0,n._)({ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s)},a))});h.displayName=c.dk.displayName},26986:function(e,t,s){"use strict";s.d(t,{OX:function(){return g},Qz:function(){return u},dy:function(){return d},iI:function(){return p},sc:function(){return v},u6:function(){return h},uh:function(){return m},ze:function(){return N}});var n=s(72253),a=s(14932),r=s(47702),o=s(85893),i=s(67294),c=s(53798),l=s(40108),d=function(e){var t=e.shouldScaleBackground,s=(0,r._)(e,["shouldScaleBackground"]);return(0,o.jsx)(c.dy.Root,(0,n._)({shouldScaleBackground:void 0===t||t},s))};d.displayName="Drawer";var u=c.dy.Trigger,f=c.dy.Portal,m=c.dy.Close,x=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.dy.Overlay,(0,n._)({ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80",s)},a))});x.displayName=c.dy.Overlay.displayName;var v=i.forwardRef(function(e,t){var s=e.className,i=e.children,d=(0,r._)(e,["className","children"]);return(0,o.jsxs)(f,{children:[(0,o.jsx)(x,{}),(0,o.jsxs)(c.dy.Content,(0,a._)((0,n._)({ref:t,className:(0,l.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s)},d),{children:[(0,o.jsx)("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),i]}))]})});v.displayName="DrawerContent";var g=function(e){var t=e.className,s=(0,r._)(e,["className"]);return(0,o.jsx)("div",(0,n._)({className:(0,l.cn)("grid gap-1.5 p-4 text-center sm:text-left",t)},s))};g.displayName="DrawerHeader";var N=function(e){var t=e.className,s=(0,r._)(e,["className"]);return(0,o.jsx)("div",(0,n._)({className:(0,l.cn)("mt-auto flex flex-col gap-2 p-4",t)},s))};N.displayName="DrawerFooter";var p=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.dy.Title,(0,n._)({ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s)},a))});p.displayName=c.dy.Title.displayName;var h=i.forwardRef(function(e,t){var s=e.className,a=(0,r._)(e,["className"]);return(0,o.jsx)(c.dy.Description,(0,n._)({ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s)},a))});h.displayName=c.dy.Description.displayName},27460:function(e,t,s){"use strict";var n=s(91309),a=s(85893),r=s(67294),o=s(74855),i=s(78865),c=s(18289),l=s(86501),d=s(91529);t.Z=function(e){var t=e.address,s=e.word,u=e.showCopyButton,f=e.showAddress,m=void 0===f||f,x=e.colorClassName,v=void 0===x?"":x,g=e.colorClassName2,N=void 0===g?"":g,p=(0,n._)((0,r.useState)(!1),2),h=p[0],y=p[1];return(0,r.useEffect)(function(){y(!1)},[t]),(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[s&&(0,a.jsx)("span",{className:"text-xs",children:s}),m&&!N&&(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=v?v:"text-greyscale-500"),children:(0,d.Vu)(t)}),m&&N&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=v?v:"text-greyscale-500"),children:"".concat(t.substring(0,6),"...")}),(0,a.jsx)("span",{className:"font-mono text-xs ".concat(N),children:"".concat(t.substring(t.length-4))})]}),(void 0===u||u)&&(0,a.jsx)(o.CopyToClipboard,{text:t,onCopy:function(e,t){t?(y(!0),setTimeout(function(){return y(!1)},2e3)):l.ZP.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:h?(0,a.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=v?v:"text-greyscale-500")}):(0,a.jsx)(c.Z,{className:"h-4 w-4 ".concat(null!=v?v:"text-greyscale-500")})})})]})}},35312:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var n=s(67294),a=s(92180),r=s(93950),o=s(93778),i=s(42130),c=Number("3")/1e3,l=function(){var e=((0,n.useContext)(o.M)||{}).token,t=(0,i.m)().address,s=(0,a.Ty)((null==e?void 0:e.address)||"",t||""),l=s.validGovVotes,d=s.isPending,u=s.error,f=(0,r._H)(null==e?void 0:e.address),m=f.govData,x=f.isPending,v=f.error,g=(0,n.useMemo)(function(){return l&&(null==m?void 0:m.govVotes)&&m.govVotes!==BigInt(0)?Number(l)/Number(m.govVotes):0},[l,null==m?void 0:m.govVotes]);return{hasEnoughVotes:(0,n.useMemo)(function(){return g>=c},[g]),percentage:g,validGovVotes:l,govData:m,SUBMIT_MIN_PERCENTAGE:c,isPending:d||x,error:null!=u?u:v}}},48827:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var n=s(91309),a=s(85893),r=s(67294),o=s(11163),i=s(83494),c=s(20725),l=s(27245),d=s(86501),u=s(39360),f=s(93566),m=s(73591),x=s(35312),v=s(93778),g=s(17301),N=s(42083),p=s(44576),h=s(91529),y=function(e){var t=e.actionId,s=e.submitted,n=e.onRoundChange,i=((0,r.useContext)(v.M)||{}).token;(0,u.x)();var c=(0,o.useRouter)(),y=(0,f.Bk)(),b=y.currentRound,j=y.isPending,_=y.error;(0,r.useEffect)(function(){n&&"function"==typeof n&&n(b)},[b,n]);var w=(0,x.C)(),C=w.hasEnoughVotes,k=w.percentage,E=w.validGovVotes,I=w.govData,B=w.SUBMIT_MIN_PERCENTAGE,R=w.isPending,P=w.error,D=(0,f.qd)(),T=D.submit,V=D.isPending,Z=D.isConfirming,z=D.isConfirmed,S=D.writeError;(0,r.useEffect)(function(){z&&!S&&(d.Am.success("推举成功",{duration:2e3}),setTimeout(function(){c.push("/vote/?symbol=".concat(null==i?void 0:i.symbol))},2e3))},[z,S]);var A=(0,m.S)().handleContractError;return((0,r.useEffect)(function(){_&&A(_,"submit"),P&&A(P,"submit"),S&&A(S,"submit")},[_,P,S]),R||j)?(0,a.jsx)(N.Z,{}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col m-4",children:[!C&&void 0!==E&&(null==I?void 0:I.govVotes)&&(0,a.jsx)(g.Z,{type:"error",message:"有效治理票，须达到总治理票的".concat((100*B).toFixed(1),"%，才能新建、推举行动（您当前有效治理票为").concat((0,h.LH)(E),"，占比").concat((100*k).toFixed(2),"%）"),className:"mb-4"}),(0,a.jsx)("div",{className:"flex justify-center",children:s||z?(0,a.jsxs)("div",{className:"flex space-x-4 justify-center w-full",children:[(0,a.jsx)(l.z,{disabled:!0,className:"w-1/2",children:"已推举"}),s&&!z&&(0,a.jsx)(l.z,{onClick:function(){return c.push("/vote/?symbol=".concat(null==i?void 0:i.symbol))},className:"w-1/2",children:"去投票"})]}):(0,a.jsxs)(l.z,{onClick:function(){V||Z||!C||T(null==i?void 0:i.address,t)},className:"submit-action-button w-1/2",disabled:V||Z||!C,children:[V&&"提交中...",Z&&"确认中...",!V&&!Z&&"推举本行动"]})}),(0,a.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4 w-full",children:[(0,a.jsx)("p",{className:"mb-1",children:"说明："}),(0,a.jsxs)("p",{children:["1. 有效治理票数 ≥ 总治理票的",Number("3")/10,"%，才能推举；"]}),(0,a.jsx)("p",{children:"2. 每轮次，1个地址最多可 创建/推举 1 个行动；"})]})]}),(0,a.jsx)(p.Z,{isLoading:V||Z,text:V?"提交交易...":"确认交易..."})]})},b=s(42130),j=s(92180),_=s(7080),w=function(e){var t=e.actionId,s=e.onRoundChange,n=(0,b.m)().address,i=((0,r.useContext)(v.M)||{}).token,c=(0,o.useRouter)(),u=(0,_.Bk)(),f=u.currentRound,x=(u.isPending,u.error);(0,r.useEffect)(function(){s&&"function"==typeof s&&s(f)},[f,s]);var g=(0,j.Ty)(null==i?void 0:i.address,n),y=g.validGovVotes,w=g.isPending,C=g.error,k=(0,_.Ol)(null==i?void 0:i.address,f,n,t),E=k.votesNumByAccountByActionId,I=k.isPending,B=k.error,R=(0,_.VI)((null==i?void 0:i.address)||"",f,n||""),P=R.votesNumByAccount,D=R.isPending,T=R.error,V=w||D||I,Z=V?BigInt(0):y-P,z=(0,_.rv)(),S=z.vote,A=z.isPending,M=z.isConfirming,H=z.isConfirmed,F=z.writeError,G=(0,m.S)().handleContractError;return(0,r.useEffect)(function(){F&&G(F,"vote"),x&&G(x,"vote"),B&&G(B,"vote"),C&&G(C,"stake"),T&&G(T,"vote")},[F,x,B,C,T]),(0,r.useEffect)(function(){H&&!F&&(d.ZP.success("提交成功",{duration:2e3}),setTimeout(function(){c.push("/vote/actions/?symbol=".concat(null==i?void 0:i.symbol))},2e3))},[H,F]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-3 p-4 mb-2",children:[(0,a.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0 mb-2",children:[(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title",children:"我已投本行动票数"}),(0,a.jsx)("div",{className:"stat-value text-2xl",children:I?(0,a.jsx)(N.Z,{}):(0,h.LH)(E)})]}),(0,a.jsxs)("div",{className:"stat place-items-center",children:[(0,a.jsx)("div",{className:"stat-title",children:"我的剩余票数"}),(0,a.jsx)("div",{className:"stat-value text-2xl",children:V?(0,a.jsx)(N.Z,{}):(0,h.LH)(Z)})]})]}),!I&&Z>BigInt(10)?(0,a.jsx)(l.z,{className:"w-1/2",onClick:function(){A||M||S(null==i?void 0:i.address,[t],[Z])},disabled:A||M,children:A||M?(0,a.jsx)(N.Z,{}):"将100%票投给此行动"}):(0,a.jsx)(l.z,{className:"w-1/2",disabled:!0,children:V?(0,a.jsx)(N.Z,{}):"没有剩余票数"}),!w&&(0,a.jsxs)("div",{className:"text-sm text-greyscale-500 text-center",children:["提示: 每轮最大可投票数，等于您的治理票数 (",(0,h.LH)(y),")"]})]}),(0,a.jsx)(p.Z,{isLoading:A||M,text:A?"提交交易...":"确认交易..."})]})},C=function(){var e=(0,o.useRouter)().query,t=e.id,s=e.type,l=e.submitted,d=(0,n._)((0,r.useState)(null),2),u=d[0],f=d[1],m=function(e){f(e)},x=(0,n._)((0,r.useState)(void 0),2),v=(x[0],x[1]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{title:"行动详情",showBackButton:!0}),(0,a.jsxs)("main",{className:"flex-grow",children:["submit"===s&&(0,a.jsx)(y,{actionId:BigInt(t||0),submitted:"true"===l,onRoundChange:m}),"vote"===s&&(0,a.jsx)(w,{actionId:BigInt(t||0),onRoundChange:m}),(0,a.jsx)(c.Z,{actionId:BigInt(t||0),round:BigInt(u||0),showSubmitter:"submit"!==s,onActionInfo:v})]})]})}}},function(e){e.O(0,[8239,367,5249,3494,2252,3950,2180,7724,725,2888,9774,179],function(){return e(e.s=55778)}),_N_E=e.O()}]);