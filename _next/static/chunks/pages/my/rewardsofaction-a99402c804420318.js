try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3e41d20a-2c9c-472c-88ac-0fc25524d079",e._sentryDebugIdIdentifier="sentry-dbid-3e41d20a-2c9c-472c-88ac-0fc25524d079")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2479],{34541:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/rewardsofaction",function(){return t(98461)}])},64777:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.title;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:n})})}},42083:function(e,n,t){"use strict";var r=t(85893),s=t(23432);n.Z=function(){return(0,r.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},93566:function(e,n,t){"use strict";t.d(n,{$A:function(){return h},Bk:function(){return x},Xo:function(){return b},dI:function(){return f},qd:function(){return m},sK:function(){return g}});var r=t(11010),s=t(97582),i=t(67294),a=t(71104),c=t(7724),d=t(37742),o=t(84689),u=t(37474),l="0xeBB295af1D4ee9ed92e55EFF4ca5Eb8D4AB81aCE",f=function(e,n){var t=(0,a.u)({address:l,abi:c.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},x=function(){var e=(0,a.u)({address:l,abi:c.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,r=e.error;return{currentRound:(0,d.Zu)(n),isPending:t,error:r}},h=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:r.data,isPending:r.isPending,error:r.error}},g=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:r.data,isPending:r.isPending,error:r.error}};function m(){var e,n=(0,u.e9)(c.d,l,"submit"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,x=n.error,h=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){x&&((0,o.Vh)(x),(0,o.H)(x))},[h,x,f]),{submit:m,isPending:a,isConfirming:d,writeError:x,isConfirmed:f,hash:h,isTukeMode:g}}function b(){var e,n=(0,u.e9)(c.d,l,"submitNewAction"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,x=n.error,h=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){x&&((0,o.Vh)(x),(0,o.H)(x))},[h,x,f]),{submitNewAction:m,isPending:a,isConfirming:d,writeError:x,isConfirmed:f,hash:h,isTukeMode:g}}},98461:function(e,n,t){"use strict";t.r(n);var r=t(11010),s=t(72253),i=t(14932),a=t(91309),c=t(4586),d=t(97582),o=t(85893),u=t(67294),l=t(42130),f=t(11163),x=t(86501),h=t(93778),g=t(7208),m=t(93566),b=t(20442),j=t(7399),y=t(73591),N=t(83494),v=t(64777),w=t(42083),I=t(44576),p=t(27245),B=t(91529),_=t(6743),E=BigInt(20);n.default=function(){var e,n=(0,f.useRouter)(),t=n.query.id,P=n.isReady&&"string"==typeof t&&""!==t.trim()?BigInt(t):void 0,k=((0,u.useContext)(h.M)||{}).token,C=(0,l.m)().address,S=(0,b.Bk)(),Z=S.currentRound,M=S.isPending,R=S.error,T=(0,a._)((0,u.useState)(BigInt(0)),2),D=T[0],A=T[1],F=(0,a._)((0,u.useState)(BigInt(0)),2),q=F[0],H=F[1],J=(0,a._)((0,u.useState)(!0),2),O=J[0],V=J[1],X=(0,a._)((0,u.useState)(!1),2),z=X[0],K=X[1],L=(0,u.useRef)(null),$=(0,m.dI)(null==k?void 0:k.address,P),G=$.actionInfo,Q=$.isPending,U=$.error,W=(0,g.B$)(z&&(null==k?void 0:k.address)?k.address:"0x0",z&&C?C:"0x0",z&&P||BigInt(0),z?D:BigInt(0),z?q:BigInt(0)),Y=W.rewards,ee=W.isPending,en=W.error,et=(0,u.useMemo)(function(){return Y||[]},[Y]),er=(0,j.Rb)(),es=er.mintActionReward,ei=er.isPending,ea=er.isConfirming,ec=er.isConfirmed,ed=er.writeError,eo=(0,a._)((0,u.useState)(null),2),eu=eo[0],el=eo[1],ef=(0,a._)((0,u.useState)([]),2),ex=ef[0],eh=ef[1];(0,u.useEffect)(function(){if(G&&k&&void 0!==Z&&!z){var e=Z>2?Z-BigInt(2):BigInt(0);A(e>BigInt(20)?e-BigInt(20):BigInt(0)),H(e),K(!0)}},[G,k,Z,z]),(0,u.useEffect)(function(){k&&z&&V(D>BigInt(0))},[D,k,z]),(0,u.useEffect)(function(){z&&(et&&et.length>0?eh((0,c._)(et).sort(function(e,n){return e.round<n.round?1:e.round>n.round?-1:0})):eh([]))},[et,z]),(0,u.useEffect)(function(){ec&&(eu&&eh(function(e){return e.map(function(e){return e.round===eu.round?(0,i._)((0,s._)({},e),{isMinted:!0}):e})}),x.ZP.success("铸造成功"),(null==k?void 0:k.address)&&C&&(0,_.j)(C,k.address,!1))},[ec,k,C,eu]);var eg=(e=(0,r._)(function(e,n){return(0,d.Jh)(this,function(t){switch(t.label){case 0:if(!((null==k?void 0:k.address)&&C))return[3,2];return el({actionId:n,round:e}),[4,es(k.address,e,n)];case 1:t.sent(),t.label=2;case 2:return[2]}})}),function(n,t){return e.apply(this,arguments)}),em=(0,u.useCallback)(function(){if(k){var e=BigInt(0);A(function(n){return n>e?n-E>=e?n-E:e:n})}},[k]);(0,u.useEffect)(function(){if(L.current&&z){var e=L.current,n=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&!ee&&O&&em()})},{root:null,rootMargin:"200px",threshold:0});return n.observe(e),function(){n.unobserve(e),n.disconnect()}}},[em,ee,O,z]);var eb=(0,y.S)().handleContractError;return((0,u.useEffect)(function(){U&&eb(U,"actionInfo"),R&&eb(R,"currentRound"),en&&eb(en,"dataViewer"),ed&&eb(ed,"mint")},[U,R,en,ed,eb]),n.isReady)?void 0===P?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"flex flex-col space-y-6 p-4",children:(0,o.jsx)("div",{className:"text-center text-red-500 py-4",children:"缺少行动ID参数"})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsxs)("main",{className:"flex-grow",children:[!k||Q||M?(0,o.jsx)(w.Z,{}):(0,o.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,o.jsx)(v.Z,{title:"铸造行动激励："}),G&&(0,o.jsx)("div",{className:"",children:(0,o.jsx)("div",{className:"flex items-center mb-3",children:(0,o.jsxs)("div",{className:"flex items-baseline mr-2",children:[(0,o.jsx)("span",{className:"text-greyscale-500",children:"No."}),(0,o.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(G.head.id)}),(0,o.jsx)("span",{className:"font-bold text-greyscale-800",children:G.body.title})]})})}),(0,o.jsxs)("table",{className:"table w-full table-auto",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,o.jsx)("th",{children:"轮次"}),(0,o.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,o.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,o.jsx)("tbody",{children:0!==ex.length||ee?ex.map(function(e,n){return(0,o.jsxs)("tr",{className:n===ex.length-1?"border-none":"border-b border-gray-100",children:[(0,o.jsx)("td",{children:(0,B.cK)(e.round,k).toString()}),(0,o.jsx)("td",{className:"text-center",children:(0,B.LH)(e.reward||BigInt(0))}),(0,o.jsx)("td",{className:"text-center",children:e.reward>BigInt(0)&&!e.isMinted?(0,o.jsx)(p.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:function(){return eg(e.round,BigInt(P))},disabled:ei||ea,children:"铸造"}):e.isMinted?(0,o.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,o.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},"".concat(P,"-").concat(e.round.toString()))}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"该行动在指定轮次范围内没有获得激励"})})})]}),(0,o.jsx)("div",{ref:L,className:"h-12 flex justify-center items-center",children:ee?(0,o.jsx)(w.Z,{}):O?(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"上滑加载更多..."}):(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多激励"})})]}),(0,o.jsx)(I.Z,{isLoading:ei||ea,text:ei?"提交交易...":"确认交易..."})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)(w.Z,{})})]})}}},function(e){e.O(0,[8239,5115,3494,3591,7724,7399,2888,9774,179],function(){return e(e.s=34541)}),_N_E=e.O()}]);