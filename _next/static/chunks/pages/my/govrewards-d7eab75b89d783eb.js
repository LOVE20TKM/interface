(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9280],{37162:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return n(27029)}])},68655:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},64777:function(e,t,n){"use strict";var s=n(85893);t.Z=e=>{let{title:t}=e;return(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-lg font-bold",children:t})})}},42083:function(e,t,n){"use strict";var s=n(85893),i=n(23432);t.Z=()=>(0,s.jsx)(i.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},44576:function(e,t,n){"use strict";var s=n(85893);n(67294);var i=n(23432);t.Z=e=>{let{isLoading:t,text:n="Loading"}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(i.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:n})]})}):null}},48105:function(e,t,n){"use strict";n.d(t,{S:function(){return i}});var s=n(86501);let i=e=>!!e||(s.Am.error("请先将钱包链接 ".concat("thinkium801")),!1)},27029:function(e,t,n){"use strict";n.r(t);var s=n(85893),i=n(67294),r=n(92321),a=n(27245),c=n(48105),l=n(91529),d=n(93778),u=n(45551),o=n(10403),x=n(7399),m=n(37436),f=n(64777),h=n(42083),g=n(44576);t.default=()=>{let{token:e}=(0,i.useContext)(d.M)||{},{address:t,chain:n}=(0,r.m)(),{currentRound:j,error:N}=(0,x.Bk)(),[y,p]=(0,i.useState)(0n),[b,k]=(0,i.useState)(0n),[v,w]=(0,i.useState)(!0),S=(0,i.useRef)(null);(0,i.useEffect)(()=>{j&&e&&(j-BigInt(e.initialStakeRound)>=0n?k(j):k(BigInt(e.initialStakeRound)))},[j,e]),(0,i.useEffect)(()=>{b&&e&&(b-BigInt(e.initialStakeRound)>=20n?p(b-20n):p(BigInt(e.initialStakeRound)))},[b,e]);let{rewards:E,isPending:Z,error:I}=(0,u.Ci)(null==e?void 0:e.address,t,y,b),[$,_]=(0,i.useState)([]);(0,i.useEffect)(()=>{E&&(_([...E].sort((e,t)=>e.round>t.round?-1:1)),w(b-y>20n&&E.length>=b-y-20n))},[E]);let{mintGovReward:B,isWriting:C,isConfirming:R,isConfirmed:z,writeError:L}=(0,x.xg)(),[M,O]=(0,i.useState)(null);(0,i.useEffect)(()=>{z&&_(e=>e.map(e=>e.round===M?{...e,unminted:0n,minted:e.unminted}:e))},[z,M]);let P=async s=>{(0,c.S)(n)&&(null==e?void 0:e.address)&&t&&(O(s),await B(e.address,s))},{handleContractError:A}=(0,o.S)();(0,i.useEffect)(()=>{I&&A(I,"dataViewer"),N&&A(N,"mint"),L&&A(L,"mint")},[I,N,L,A]);let T=(0,i.useCallback)(()=>{if(!e)return;let t=BigInt(e.initialStakeRound);p(e=>e>t?e-20n>=t?e-20n:t:e)},[e]);return(0,i.useEffect)(()=>{if(!S.current)return;let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&T()})});return e.observe(S.current),()=>{e.disconnect()}},[T]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{title:"治理激励"}),(0,s.jsxs)("main",{className:"flex-grow",children:[e?(0,s.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,s.jsx)(f.Z,{title:"铸造治理奖励"}),0===$.length?(0,s.jsx)("div",{className:"flex justify-center items-center",children:Z?"":(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"暂无数据"})}):(0,s.jsxs)("table",{className:"table w-full table-auto",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,s.jsx)("th",{children:"轮次"}),(0,s.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,s.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,s.jsx)("tbody",{children:$.map(t=>(0,s.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,s.jsx)("td",{children:e?(0,l.cK)(t.round,e).toString():"-"}),(0,s.jsx)("td",{className:"text-center",children:(0,l.LH)(t.unminted||t.minted||0n)}),(0,s.jsx)("td",{className:"text-center",children:t.unminted>0n?(0,s.jsx)(a.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>P(t.round),disabled:C||R,children:"铸造"}):t.minted>0n?(0,s.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,s.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString()))})]}),(0,s.jsx)("div",{ref:S,className:"h-12 flex justify-center items-center",children:Z?(0,s.jsx)(h.Z,{}):v?(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):y>e.initialStakeRound?(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"}):""})]}):(0,s.jsx)(h.Z,{}),(0,s.jsx)(g.Z,{isLoading:C||R,text:C?"提交交易...":"确认交易..."})]})]})}},9008:function(e,t,n){e.exports=n(23867)},21803:function(e,t,n){"use strict";function s(e,t){let[n,s="0"]=e.split("."),i=n.startsWith("-");if(i&&(n=n.slice(1)),s=s.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${s}`))&&(n=`${BigInt(n)+1n}`),s="";else if(s.length>t){let[e,i,r]=[s.slice(0,t-1),s.slice(t-1,t),s.slice(t)],a=Math.round(Number(`${i}.${r}`));(s=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>t&&(s=s.slice(1),n=`${BigInt(n)+1n}`),s=s.slice(0,t)}else s=s.padEnd(t,"0");return BigInt(`${i?"-":""}${n}${s}`)}n.d(t,{v:function(){return s}})}},function(e){e.O(0,[2083,2042,2888,9774,179],function(){return e(e.s=37162)}),_N_E=e.O()}]);