(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(37876);let a=e=>{var t=e.title;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},7446:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(37876),a=r(7446);let i=()=>(0,n.jsx)(a.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return r(26515)}])},18449:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var n=r(76200);class a extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function i(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new a({value:e});let[r,n="0"]=e.split("."),i=r.startsWith("-");if(i&&(r=r.slice(1)),n=n.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${n}`))&&(r=`${BigInt(r)+1n}`),n="";else if(n.length>t){let[e,a,i]=[n.slice(0,t-1),n.slice(t-1,t),n.slice(t)],s=Math.round(Number(`${a}.${i}`));(n=s>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${s}`).length>t&&(n=n.slice(1),r=`${BigInt(r)+1n}`),n=n.slice(0,t)}else n=n.padEnd(t,"0");return BigInt(`${i?"-":""}${r}${n}`)}},20442:(e,t,r)=>{"use strict";r.d(t,{$w:()=>s,Ee:()=>h,Js:()=>o,LP:()=>m,NJ:()=>l,W_:()=>i,XS:()=>c,Xo:()=>d,lM:()=>x,mW:()=>u});var n=r(18449),a=r(32602),i=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",s=e=>{var t=Number(o(e));return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=Number(o(e));if(e<10n)return"0";if(4!==t)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(r);if(r>=1e3)return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(r);if(r>=10)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(r);if(r>=1||r>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:4}).format(r);if(0===r)return"0";var n=r.toFixed(14),a=n.split(".");if(a.length<2)return n;var i=a[1],s=0,l=!0,c=!1,u=void 0;try{for(var d,m=i[Symbol.iterator]();!(l=(d=m.next()).done);l=!0){var x=d.value;if("0"===x)s++;else break}}catch(e){c=!0,u=e}finally{try{l||null==m.return||m.return()}finally{if(c)throw u}}var f=i.slice(s,s+4);return"0.0{".concat(s,"}").concat(f)},c=e=>{var t=parseInt("18",10);try{var r=e.replace(/,/g,"");return(0,n.X)(r,t)}catch(e){return console.error("parseUnits error:",e),0n}},o=e=>{var t=parseInt("18",10);return(0,a.J)(e,t)},u=e=>e.includes(".")?parseFloat(e.replace(/,/g,"")).toString():e,d=e=>e>86400?"".concat(Math.floor(e/86400),"天").concat(Math.floor(e%86400/3600),"小时").concat(Math.floor(e%3600/60),"分"):e>3600?"".concat(Math.floor(e/3600),"小时").concat(Math.floor(e%3600/60),"分"):"".concat(Math.floor(e/60),"分").concat(e%60,"秒"),m=(e,t)=>e&&t?e-BigInt(t.initialStakeRound)+1n:0n,x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=Number(e);if(n>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:t}).format(n);if(n>=.001)return new Intl.NumberFormat("en-US",{maximumFractionDigits:r+1}).format(n);if(0===n)return"0";var a=n.toFixed(r+10),i=a.split(".");if(i.length<2)return a;var s=i[1],l=0,c=!0,o=!1,u=void 0;try{for(var d,m=s[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){var x=d.value;if("0"===x)l++;else break}}catch(e){o=!0,u=e}finally{try{c||null==m.return||m.return()}finally{if(o)throw u}}var f=s.slice(l);return"0.0{".concat(l,"}").concat(f)},f=(e,t)=>e.toFixed(t).replace(/\.?0+$/,""),h=e=>{var t="string"==typeof e?parseFloat(e):e,r=Math.abs(t);return 0===r?"0%":r>=100?t.toLocaleString(void 0,{maximumFractionDigits:0})+"%":r>=10?f(t,1)+"%":r>=1?f(t,2)+"%":r>=.1?f(t,3)+"%":r>=.01?f(t,4)+"%":t.toExponential(4)+"%"}},26515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var n=r(16927),a=r(3576),i=r(62701),s=r(40854),l=r(4902),c=r(37876),o=r(14232),u=r(8047),d=r(6960),m=r(42038),x=r(20442),f=r(83416),h=r(52372),g=r(20451),v=r(62288),N=r(66663),b=r(1709),y=r(12293),p=r(99574);let j=()=>{var e=((0,o.useContext)(f.N)||{}).token,t=(0,u.F)(),r=t.address,j=t.chain,w=(0,v.vC)(),S=w.currentRound,k=w.error,I=(0,s._)((0,o.useState)(0n),2),_=I[0],F=I[1],E=(0,s._)((0,o.useState)(0n),2),$=E[0],A=E[1],C=(0,s._)((0,o.useState)(!0),2),B=C[0],M=C[1],R=(0,o.useRef)(null);(0,o.useEffect)(()=>{S&&e&&(S-BigInt(e.initialStakeRound)>=0n?A(S):A(BigInt(e.initialStakeRound)))},[S,e]),(0,o.useEffect)(()=>{$&&e&&($-BigInt(e.initialStakeRound)>=20n?F($-20n):F(BigInt(e.initialStakeRound)))},[$,e]);var D=(0,h.k3)(null==e?void 0:e.address,r,_,$),U=D.rewards,L=D.isPending,X=D.error,J=(0,s._)((0,o.useState)([]),2),P=J[0],W=J[1];(0,o.useEffect)(()=>{U&&(W([...U].sort((e,t)=>e.round>t.round?-1:1)),M($-_>20n&&U.length>=$-_-20n))},[U]);var z=(0,v.Jv)(),O=z.mintGovReward,T=z.isWriting,q=z.isConfirming,G=z.isConfirmed,V=z.writeError,H=(0,s._)((0,o.useState)(null),2),K=H[0],Q=H[1];(0,o.useEffect)(()=>{G&&W(e=>e.map(e=>e.round===K?(0,i._)((0,a._)({},e),{unminted:0n,minted:e.unminted}):e))},[G,K]);var Y=function(){var t=(0,n._)(function(t){return(0,l.__generator)(this,function(n){switch(n.label){case 0:if(!(0,m.C)(j))return[2];if(!((null==e?void 0:e.address)&&r))return[3,2];return Q(t),[4,O(e.address,t)];case 1:n.sent(),n.label=2;case 2:return[2]}})});return function(e){return t.apply(this,arguments)}}(),Z=(0,g.g)().handleContractError;(0,o.useEffect)(()=>{X&&Z(X,"dataViewer"),k&&Z(k,"mint"),V&&Z(V,"mint")},[X,k,V,Z]);var ee=(0,o.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);F(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return(0,o.useEffect)(()=>{if(R.current){var e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&ee()})});return e.observe(R.current),()=>{e.disconnect()}}},[ee]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(N.A,{title:"治理激励"}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(b.A,{title:"铸造治理奖励"}),0===P.length?(0,c.jsx)("div",{className:"flex justify-center items-center",children:L?"":(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"暂无数据"})}):(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:P.map(t=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,x.LP)(t.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,x.NJ)(t.unminted||t.minted||0n)}),(0,c.jsx)("td",{className:"text-center",children:t.unminted>0n?(0,c.jsx)(d.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>Y(t.round),disabled:T||q,children:"铸造"}):t.minted>0n?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString()))})]}),(0,c.jsx)("div",{ref:R,className:"h-12 flex justify-center items-center",children:L?(0,c.jsx)(y.A,{}):B?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):_>e.initialStakeRound?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"}):""})]}):(0,c.jsx)(y.A,{}),(0,c.jsx)(p.A,{isLoading:T||q,text:T?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var n=r(97685),a=e=>!!e||(n.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},77328:(e,t,r)=>{e.exports=r(89836)},86739:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},99574:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(37876);r(14232);var a=r(7446);let i=e=>{var t=e.isLoading,r=e.text;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===r?"Loading":r})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[2569,2288,636,6593,8792],()=>t(17739)),_N_E=e.O()}]);