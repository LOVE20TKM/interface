try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="618ef37a-49f6-4abc-bbe2-bfcffc795f6b",e._sentryDebugIdIdentifier="sentry-dbid-618ef37a-49f6-4abc-bbe2-bfcffc795f6b")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2479],{34541:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/rewardsofaction",function(){return t(98461)}])},64777:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.title;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:n})})}},42083:function(e,n,t){"use strict";var r=t(85893),s=t(23432);n.Z=function(){return(0,r.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},93566:function(e,n,t){"use strict";t.d(n,{$A:function(){return x},Bk:function(){return h},Xo:function(){return b},dI:function(){return f},qd:function(){return m},sK:function(){return g}});var r=t(11010),s=t(97582),i=t(67294),a=t(71104),c=t(7724),d=t(37742),o=t(84689),u=t(37474),l="0xeBB295af1D4ee9ed92e55EFF4ca5Eb8D4AB81aCE",f=function(e,n){var t=(0,a.u)({address:l,abi:c.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},h=function(){var e=(0,a.u)({address:l,abi:c.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,r=e.error;return{currentRound:(0,d.Zu)(n),isPending:t,error:r}},x=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:r.data,isPending:r.isPending,error:r.error}},g=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:r.data,isPending:r.isPending,error:r.error}};function m(){var e,n=(0,u.e9)(c.d,l,"submit"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,h=n.error,x=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){h&&((0,o.Vh)(h),(0,o.H)(h))},[x,h,f]),{submit:m,isPending:a,isConfirming:d,writeError:h,isConfirmed:f,hash:x,isTukeMode:g}}function b(){var e,n=(0,u.e9)(c.d,l,"submitNewAction"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,h=n.error,x=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){h&&((0,o.Vh)(h),(0,o.H)(h))},[x,h,f]),{submitNewAction:m,isPending:a,isConfirming:d,writeError:h,isConfirmed:f,hash:x,isTukeMode:g}}},98461:function(e,n,t){"use strict";t.r(n);var r=t(11010),s=t(72253),i=t(14932),a=t(91309),c=t(4586),d=t(97582),o=t(85893),u=t(67294),l=t(42130),f=t(11163),h=t(86501),x=t(93778),g=t(7208),m=t(93566),b=t(20442),j=t(7399),N=t(73591),y=t(83494),I=t(64777),v=t(42083),p=t(44576),w=t(27245),B=t(91529),_=t(6743),E=BigInt(20);n.default=function(){var e,n=(0,f.useRouter)(),t=n.query.id,P=n.isReady&&"string"==typeof t&&""!==t.trim()?BigInt(t):void 0,k=((0,u.useContext)(x.M)||{}).token,C=(0,l.m)().address,S=(0,b.Bk)(),$=S.currentRound,Z=S.isPending,M=S.error,R=(0,a._)((0,u.useState)(BigInt(0)),2),T=R[0],D=R[1],A=(0,a._)((0,u.useState)(BigInt(0)),2),F=A[0],q=A[1],H=(0,a._)((0,u.useState)(!0),2),J=H[0],O=H[1],V=(0,a._)((0,u.useState)(!1),2),X=V[0],z=V[1],K=(0,u.useRef)(null),L=(0,m.dI)(null==k?void 0:k.address,P),W=L.actionInfo,G=L.isPending,Q=L.error,U=(0,g.B$)(X&&(null==k?void 0:k.address)?k.address:"0x0",X&&C?C:"0x0",X&&P||BigInt(0),X?T:BigInt(0),X?F:BigInt(0)),Y=U.rewards,ee=U.isPending,en=U.error,et=(0,u.useMemo)(function(){return Y||[]},[Y]),er=(0,j.Rb)(),es=er.mintActionReward,ei=er.isPending,ea=er.isConfirming,ec=er.isConfirmed,ed=er.writeError,eo=(0,a._)((0,u.useState)(null),2),eu=eo[0],el=eo[1],ef=(0,a._)((0,u.useState)([]),2),eh=ef[0],ex=ef[1];(0,u.useEffect)(function(){if(W&&k&&void 0!==$&&!X){var e=$>2?$-BigInt(2):BigInt(0);D(e>BigInt(20)?e-BigInt(20):BigInt(0)),q(e),z(!0)}},[W,k,$,X]),(0,u.useEffect)(function(){k&&X&&O(T>BigInt(0))},[T,k,X]),(0,u.useEffect)(function(){X&&(et&&et.length>0?ex((0,c._)(et).sort(function(e,n){return e.round<n.round?1:e.round>n.round?-1:0})):ex([]))},[et,X]),(0,u.useEffect)(function(){ec&&(eu&&ex(function(e){return e.map(function(e){return e.round===eu.round?(0,i._)((0,s._)({},e),{isMinted:!0}):e})}),h.ZP.success("铸造成功"),(null==k?void 0:k.address)&&C&&(0,_.j)(C,k.address,!1))},[ec,k,C,eu]);var eg=(e=(0,r._)(function(e,n){return(0,d.Jh)(this,function(t){switch(t.label){case 0:if(!((null==k?void 0:k.address)&&C))return[3,2];return el({actionId:n,round:e}),[4,es(k.address,e,n)];case 1:t.sent(),t.label=2;case 2:return[2]}})}),function(n,t){return e.apply(this,arguments)}),em=(0,u.useCallback)(function(){if(k){var e=BigInt(0);D(function(n){return n>e?n-E>=e?n-E:e:n})}},[k]);(0,u.useEffect)(function(){if(K.current&&X){var e=K.current,n=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&!ee&&J&&em()})},{root:null,rootMargin:"200px",threshold:0});return n.observe(e),function(){n.unobserve(e),n.disconnect()}}},[em,ee,J,X]);var eb=(0,N.S)().handleContractError;return((0,u.useEffect)(function(){Q&&eb(Q,"actionInfo"),M&&eb(M,"currentRound"),en&&eb(en,"dataViewer"),ed&&eb(ed,"mint")},[Q,M,en,ed,eb]),n.isReady)?void 0===P?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"flex flex-col space-y-6 p-4",children:(0,o.jsx)("div",{className:"text-center text-red-500 py-4",children:"缺少行动ID参数"})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsxs)("main",{className:"flex-grow",children:[!k||G||Z?(0,o.jsx)(v.Z,{}):(0,o.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,o.jsx)(I.Z,{title:"铸造行动激励："}),W&&(0,o.jsx)("div",{className:"",children:(0,o.jsx)("div",{className:"flex items-center mb-3",children:(0,o.jsxs)("div",{className:"flex items-baseline mr-2",children:[(0,o.jsx)("span",{className:"text-greyscale-500",children:"No."}),(0,o.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(W.head.id)}),(0,o.jsx)("span",{className:"font-bold text-greyscale-800",children:W.body.title})]})})}),(0,o.jsxs)("table",{className:"table w-full table-auto",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,o.jsx)("th",{children:"轮次"}),(0,o.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,o.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,o.jsx)("tbody",{children:0!==eh.length||ee?eh.map(function(e,n){return(0,o.jsxs)("tr",{className:n===eh.length-1?"border-none":"border-b border-gray-100",children:[(0,o.jsx)("td",{children:(0,B.cK)(e.round,k).toString()}),(0,o.jsx)("td",{className:"text-center",children:(0,B.LH)(e.reward||BigInt(0))}),(0,o.jsx)("td",{className:"text-center",children:e.reward>BigInt(0)&&!e.isMinted?(0,o.jsx)(w.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:function(){return eg(e.round,BigInt(P))},disabled:ei||ea,children:"铸造"}):e.isMinted?(0,o.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,o.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},"".concat(P,"-").concat(e.round.toString()))}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"该行动在指定轮次范围内没有获得激励"})})})]}),(0,o.jsx)("div",{ref:K,className:"h-12 flex justify-center items-center",children:ee?(0,o.jsx)(v.Z,{}):J?(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"上滑加载更多..."}):(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多激励"})})]}),(0,o.jsx)(p.Z,{isLoading:ei||ea,text:ei?"提交交易...":"确认交易..."})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)(v.Z,{})})]})}},21803:function(e,n,t){"use strict";function r(e,n){let[t,r="0"]=e.split("."),s=t.startsWith("-");if(s&&(t=t.slice(1)),r=r.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${r}`))&&(t=`${BigInt(t)+1n}`),r="";else if(r.length>n){let[e,s,i]=[r.slice(0,n-1),r.slice(n-1,n),r.slice(n)],a=Math.round(Number(`${s}.${i}`));(r=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>n&&(r=r.slice(1),t=`${BigInt(t)+1n}`),r=r.slice(0,n)}else r=r.padEnd(n,"0");return BigInt(`${s?"-":""}${t}${r}`)}t.d(n,{v:function(){return r}})}},function(e){e.O(0,[8239,367,3494,2252,7724,7399,2888,9774,179],function(){return e(e.s=34541)}),_N_E=e.O()}]);