(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var n=s(37876);let r=e=>{var t=e.title;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},7446:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var n=(0,s(11713).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},12293:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(37876),r=s(7446);let i=()=>(0,n.jsx)(r.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return s(26515)}])},18449:(e,t,s)=>{"use strict";s.d(t,{X:()=>i});var n=s(76200);class r extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function i(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[s,n="0"]=e.split("."),i=s.startsWith("-");if(i&&(s=s.slice(1)),n=n.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${n}`))&&(s=`${BigInt(s)+1n}`),n="";else if(n.length>t){let[e,r,i]=[n.slice(0,t-1),n.slice(t-1,t),n.slice(t)],a=Math.round(Number(`${r}.${i}`));(n=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>t&&(n=n.slice(1),s=`${BigInt(s)+1n}`),n=n.slice(0,t)}else n=n.padEnd(t,"0");return BigInt(`${i?"-":""}${s}${n}`)}},26515:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s(16927),r=s(3576),i=s(62701),a=s(40854),l=s(4902),c=s(37876),d=s(14232),u=s(8047),o=s(6960),x=s(42038),m=s(20442),h=s(83416),f=s(52372),g=s(20451),j=s(62288),v=s(66663),N=s(1709),y=s(12293),b=s(99574);let p=()=>{var e=((0,d.useContext)(h.N)||{}).token,t=(0,u.F)(),s=t.address,p=t.chain,w=(0,j.vC)(),_=w.currentRound,k=w.error,E=(0,a._)((0,d.useState)(0n),2),A=E[0],$=E[1],C=(0,a._)((0,d.useState)(0n),2),S=C[0],I=C[1],B=(0,a._)((0,d.useState)(!0),2),R=B[0],L=B[1],P=(0,d.useRef)(null);(0,d.useEffect)(()=>{_&&e&&(_-BigInt(e.initialStakeRound)>=0n?I(_):I(BigInt(e.initialStakeRound)))},[_,e]),(0,d.useEffect)(()=>{S&&e&&(S-BigInt(e.initialStakeRound)>=20n?$(S-20n):$(BigInt(e.initialStakeRound)))},[S,e]);var z=(0,f.k3)(null==e?void 0:e.address,s,A,S),M=z.rewards,O=z.isPending,X=z.error,F=(0,a._)((0,d.useState)([]),2),J=F[0],T=F[1];(0,d.useEffect)(()=>{M&&(T([...M].sort((e,t)=>e.round>t.round?-1:1)),L(S-A>20n&&M.length>=S-A-20n))},[M]);var W=(0,j.Jv)(),q=W.mintGovReward,D=W.isWriting,G=W.isConfirming,V=W.isConfirmed,H=W.writeError,K=(0,a._)((0,d.useState)(null),2),Q=K[0],U=K[1];(0,d.useEffect)(()=>{V&&T(e=>e.map(e=>e.round===Q?(0,i._)((0,r._)({},e),{unminted:0n,minted:e.unminted}):e))},[V,Q]);var Y=function(){var t=(0,n._)(function(t){return(0,l.__generator)(this,function(n){switch(n.label){case 0:if(!(0,x.C)(p))return[2];if(!((null==e?void 0:e.address)&&s))return[3,2];return U(t),[4,q(e.address,t)];case 1:n.sent(),n.label=2;case 2:return[2]}})});return function(e){return t.apply(this,arguments)}}(),Z=(0,g.g)().handleContractError;(0,d.useEffect)(()=>{X&&Z(X,"dataViewer"),k&&Z(k,"mint"),H&&Z(H,"mint")},[X,k,H,Z]);var ee=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);$(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return(0,d.useEffect)(()=>{if(P.current){var e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&ee()})});return e.observe(P.current),()=>{e.disconnect()}}},[ee]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(v.A,{title:"治理激励"}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(N.A,{title:"铸造治理奖励"}),0===J.length?(0,c.jsx)("div",{className:"flex justify-center items-center",children:O?"":(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"暂无数据"})}):(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:J.map(t=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,m.LP)(t.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,m.NJ)(t.unminted||t.minted||0n)}),(0,c.jsx)("td",{className:"text-center",children:t.unminted>0n?(0,c.jsx)(o.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>Y(t.round),disabled:D||G,children:"铸造"}):t.minted>0n?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString()))})]}),(0,c.jsx)("div",{ref:P,className:"h-12 flex justify-center items-center",children:O?(0,c.jsx)(y.A,{}):R?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):A>e.initialStakeRound?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"}):""})]}):(0,c.jsx)(y.A,{}),(0,c.jsx)(b.A,{isLoading:D||G,text:D?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,s)=>{"use strict";s.d(t,{C:()=>r});var n=s(97685),r=e=>!!e||(n.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},77328:(e,t,s)=>{e.exports=s(89836)},86739:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var n=(0,s(11713).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},99574:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(37876);s(14232);var r=s(7446);let i=e=>{var t=e.isLoading,s=e.text;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(r.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===s?"Loading":s})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[2569,5389,636,6593,8792],()=>t(17739)),_N_E=e.O()}]);