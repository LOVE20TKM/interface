(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var n=s(37876);let r=e=>{var t=e.title;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},12293:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(37876),r=s(7446);let a=()=>(0,n.jsx)(r.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return s(26515)}])},18449:(e,t,s)=>{"use strict";s.d(t,{X:()=>a});var n=s(76200);class r extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[s,n="0"]=e.split("."),a=s.startsWith("-");if(a&&(s=s.slice(1)),n=n.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${n}`))&&(s=`${BigInt(s)+1n}`),n="";else if(n.length>t){let[e,r,a]=[n.slice(0,t-1),n.slice(t-1,t),n.slice(t)],i=Math.round(Number(`${r}.${a}`));(n=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(n=n.slice(1),s=`${BigInt(s)+1n}`),n=n.slice(0,t)}else n=n.padEnd(t,"0");return BigInt(`${a?"-":""}${s}${n}`)}},26515:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var n=s(16927),r=s(3576),a=s(62701),i=s(40854),c=s(4902),l=s(37876),d=s(14232),u=s(8047),o=s(6960),x=s(42038),m=s(20442),h=s(83416),f=s(52372),g=s(29898),v=s(62288),j=s(20451),N=s(60154),b=s(1709),w=s(12293),p=s(99574);let y=()=>{var e=((0,d.useContext)(h.N)||{}).token,t=(0,u.F)(),s=t.address,y=t.chain,_=(0,g.vC)(),$=_.currentRound,E=_.error,C=(0,i._)((0,d.useState)(0n),2),k=C[0],I=C[1],S=(0,i._)((0,d.useState)(0n),2),A=S[0],B=S[1],R=(0,i._)((0,d.useState)(!0),2),P=R[0],M=R[1],T=(0,d.useRef)(null);(0,d.useEffect)(()=>{$&&e&&($<=BigInt(e.initialStakeRound)?B(0n):B(BigInt($>=1n?$-1n:0n)))},[$,e]),(0,d.useEffect)(()=>{A&&e&&(A-BigInt(e.initialStakeRound)>=20n?I(A-20n):I(BigInt(e.initialStakeRound)))},[A,e]);var L=(0,f.k3)(null==e?void 0:e.address,s,k,A),F=L.rewards,J=L.isPending,O=L.error,X=(0,i._)((0,d.useState)([]),2),q=X[0],z=X[1];(0,d.useEffect)(()=>{F&&(z([...F].sort((e,t)=>e.round>t.round?-1:1)),M(A-k>20n&&F.length>=A-k-20n))},[F]);var D=(0,v.Jv)(),G=D.mintGovReward,H=D.isPending,V=D.isConfirming,W=D.isConfirmed,Y=D.writeError,K=(0,i._)((0,d.useState)(null),2),Q=K[0],U=K[1];(0,d.useEffect)(()=>{W&&z(e=>e.map(e=>e.round===Q?(0,a._)((0,r._)({},e),{isMinted:!0}):e))},[W,Q]);var Z=function(){var t=(0,n._)(function(t){return(0,c.YH)(this,function(n){switch(n.label){case 0:if(!(0,x.C)(y))return[2];if(!((null==e?void 0:e.address)&&s))return[3,2];return U(t),[4,G(e.address,t)];case 1:n.sent(),n.label=2;case 2:return[2]}})});return function(e){return t.apply(this,arguments)}}(),ee=(0,j.g)().handleContractError;(0,d.useEffect)(()=>{O&&ee(O,"dataViewer"),E&&ee(E,"mint"),Y&&ee(Y,"mint")},[O,E,Y,ee]);var et=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);I(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return(0,d.useEffect)(()=>{if(T.current){var e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&et()})});return e.observe(T.current),()=>{e.disconnect()}}},[et]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N.A,{title:"治理激励"}),(0,l.jsxs)("main",{className:"flex-grow",children:[e?(0,l.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,l.jsx)(b.A,{title:"铸造治理奖励"}),0n===A&&void 0!==$?(0,l.jsx)("div",{className:"text-center text-gray-500 py-4",children:"当前还不能铸造奖励，请耐心等待"}):0===q.length&&0n!==A?(0,l.jsx)("div",{className:"flex justify-center items-center",children:J?"":(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"暂无数据"})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("table",{className:"table w-full table-auto",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,l.jsx)("th",{children:"轮次"}),(0,l.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,l.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,l.jsx)("tbody",{children:q.map(t=>(0,l.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,l.jsx)("td",{children:e?(0,m.LP)(t.round,e).toString():"-"}),(0,l.jsx)("td",{className:"text-center",children:(0,m.NJ)(t.reward||0n)}),(0,l.jsx)("td",{className:"text-center",children:t.reward>0n&&!t.isMinted?(0,l.jsx)(o.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>Z(t.round),disabled:H||V,children:"铸造"}):t.isMinted?(0,l.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,l.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString()))})]}),(0,l.jsx)("div",{ref:T,className:"h-12 flex justify-center items-center",children:J?(0,l.jsx)(w.A,{}):P?(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):k>e.initialStakeRound?(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"}):""})]})]}):(0,l.jsx)(w.A,{}),(0,l.jsx)(p.A,{isLoading:H||V,text:H?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,s)=>{"use strict";s.d(t,{C:()=>r});var n=s(97685),r=e=>!!e||(n.oR.error("请先将钱包链接 ".concat("thinkium70001")),!1)},69167:(e,t,s)=>{"use strict";s.d(t,{v:()=>d});var n=s(57616),r=s(94833),a=s(14237),i=s(66655),c=s(8481),l=s(57771);async function d(e,t){let{abi:s,address:d,args:u,dataSuffix:o,functionName:x,...m}=t,h=m.account?(0,n.J)(m.account):e.account,f=(0,a.p)({abi:s,args:u,functionName:x});try{let{data:n}=await (0,c.T)(e,l.T,"call")({batch:!1,data:`${f}${o?o.replace("0x",""):""}`,to:d,...m,account:h}),a=(0,r.e)({abi:s,args:u,functionName:x,data:n||"0x"}),i=s.filter(e=>"name"in e&&e.name===t.functionName);return{result:a,request:{abi:i,address:d,args:u,dataSuffix:o,functionName:x,...m,account:h}}}catch(e){throw(0,i.j)(e,{abi:s,address:d,args:u,docsPath:"/docs/contract/simulateContract",functionName:x,sender:h?.address})}}},81675:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});var n=s(69167),r=s(629),a=s(90203);async function i(e,t){let s,{abi:i,chainId:c,connector:l,...d}=t;s=t.account?t.account:(await (0,a.r)(e,{chainId:c,connector:l})).account;let u=e.getClient({chainId:c}),o=(0,r.T)(u,n.v,"simulateContract"),{result:x,request:m}=await o({...d,abi:i,account:s});return{chainId:u.chain.id,result:x,request:{...m,chainId:c}}}},99574:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(37876);s(14232);var r=s(7446);let a=e=>{var t=e.isLoading,s=e.text;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(r.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===s?"Loading":s})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[3308,9374,154,3096,2288,9898,636,6593,8792],()=>t(17739)),_N_E=e.O()}]);