(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var s=n(37876);let r=e=>{var t=e.title;return(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-lg font-bold",children:t})})}},12293:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var s=n(37876),r=n(7446);let a=()=>(0,s.jsx)(r.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return n(26515)}])},18449:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var s=n(76200);class r extends s.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[n,s="0"]=e.split("."),a=n.startsWith("-");if(a&&(n=n.slice(1)),s=s.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${s}`))&&(n=`${BigInt(n)+1n}`),s="";else if(s.length>t){let[e,r,a]=[s.slice(0,t-1),s.slice(t-1,t),s.slice(t)],i=Math.round(Number(`${r}.${a}`));(s=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(s=s.slice(1),n=`${BigInt(n)+1n}`),s=s.slice(0,t)}else s=s.padEnd(t,"0");return BigInt(`${a?"-":""}${n}${s}`)}},26515:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var s=n(16927),r=n(3576),a=n(62701),i=n(40854),l=n(4902),c=n(37876),d=n(14232),o=n(8047),u=n(6960),x=n(42038),m=n(20442),h=n(83416),f=n(52372),v=n(29898),g=n(62288),j=n(20451),N=n(60154),b=n(1709),w=n(12293),y=n(99574);let p=()=>{var e=((0,d.useContext)(h.N)||{}).token,t=(0,o.F)(),n=t.address,p=t.chain,_=(0,v.vC)(),E=_.currentRound,S=_.error,$=(0,i._)((0,d.useState)(0n),2),k=$[0],C=$[1],I=(0,i._)((0,d.useState)(0n),2),A=I[0],B=I[1],R=(0,i._)((0,d.useState)(!0),2),M=R[0],P=R[1],L=(0,d.useRef)(null);(0,d.useEffect)(()=>{E&&e&&(E<=BigInt(e.initialStakeRound)?B(0n):B(BigInt(E>=1n?E-1n:0n)))},[E,e]),(0,d.useEffect)(()=>{A&&e&&(A-BigInt(e.initialStakeRound)>=20n?C(A-20n):C(BigInt(e.initialStakeRound)))},[A,e]);var T=(0,f.k3)(null==e?void 0:e.address,n,k,A),D=T.rewards,F=T.isPending,O=T.error,X=(0,i._)((0,d.useState)([]),2),z=X[0],J=X[1];(0,d.useEffect)(()=>{D&&(J([...D].sort((e,t)=>e.round>t.round?-1:1)),P(A-k>20n&&D.length>=A-k-20n))},[D]);var G=(0,g.Jv)(),H=G.mintGovReward,V=G.isPending,W=G.isConfirming,Y=G.isConfirmed,q=G.writeError,K=(0,i._)((0,d.useState)(null),2),Q=K[0],U=K[1];(0,d.useEffect)(()=>{Y&&J(e=>e.map(e=>e.round===Q?(0,a._)((0,r._)({},e),{isMinted:!0}):e))},[Y,Q]);var Z=function(){var t=(0,s._)(function(t){return(0,l.YH)(this,function(s){switch(s.label){case 0:if(!(0,x.C)(p))return[2];if(!((null==e?void 0:e.address)&&n))return[3,2];return U(t),[4,H(e.address,t)];case 1:s.sent(),s.label=2;case 2:return[2]}})});return function(e){return t.apply(this,arguments)}}(),ee=(0,j.g)().handleContractError;(0,d.useEffect)(()=>{O&&ee(O,"dataViewer"),S&&ee(S,"mint"),q&&ee(q,"mint")},[O,S,q,ee]);var et=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);C(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return(0,d.useEffect)(()=>{if(L.current){var e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&et()})});return e.observe(L.current),()=>{e.disconnect()}}},[et]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(N.A,{title:"治理激励"}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(b.A,{title:"铸造治理奖励"}),0n===A&&void 0!==E?(0,c.jsx)("div",{className:"text-center text-gray-500 py-4",children:"当前还不能铸造奖励，请耐心等待"}):0===z.length&&0n!==A?(0,c.jsx)("div",{className:"flex justify-center items-center",children:F?"":(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"暂无数据"})}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:z.map(t=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,m.LP)(t.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,m.NJ)(t.reward||0n)}),(0,c.jsx)("td",{className:"text-center",children:t.reward>0n&&!t.isMinted?(0,c.jsx)(u.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>Z(t.round),disabled:V||W,children:"铸造"}):t.isMinted?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString()))})]}),(0,c.jsx)("div",{ref:L,className:"h-12 flex justify-center items-center",children:F?(0,c.jsx)(w.A,{}):M?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):k>e.initialStakeRound?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"}):""})]})]}):(0,c.jsx)(w.A,{}),(0,c.jsx)(y.A,{isLoading:V||W,text:V?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});var s=n(97685),r=e=>!!e||(s.oR.error("请先将钱包链接 ".concat("thinkium70001")),!1)},99574:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var s=n(37876),r=n(14232),a=n(7446);let i=e=>{var t=e.isLoading,n=e.text;return((0,r.useEffect)(()=>{if(t){var e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}},[t]),t)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 touch-none overscroll-none",onTouchMove:e=>{e.preventDefault()},onTouchStart:e=>{e.preventDefault()},style:{touchAction:"none"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===n?"Loading":n})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[3308,9374,154,3096,2288,9898,636,6593,8792],()=>t(17739)),_N_E=e.O()}]);