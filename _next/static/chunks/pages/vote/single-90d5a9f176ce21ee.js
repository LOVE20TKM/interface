try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="69b00268-883e-4c88-97ec-bc25f3e90431",e._sentryDebugIdIdentifier="sentry-dbid-69b00268-883e-4c88-97ec-bc25f3e90431")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{38052:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/single",function(){return t(58993)}])},20725:function(e,s,t){"use strict";var n=t(85893),i=t(67294),d=t(93566),l=t(73591),a=t(93778),r=t(91529),c=t(72107),o=t(31084),x=t(44746),u=t(27460),m=t(42083),f=t(5971);s.Z=function(e){var s=e.actionId,t=e.round,h=e.showSubmitter,v=(e.showVerifyHistory,e.onActionInfo),j=e.isExtensionAction,b=e.extensionAddress,g=e.factory,N=((0,i.useContext)(a.M)||{}).token,y=(0,d.dI)(null==N?void 0:N.address,s),p=y.actionInfo,w=y.isPending,I=y.error;(0,i.useEffect)(function(){v&&p&&v(p)},[p]);var Z=(0,d.sK)(null==N?void 0:N.address,h?t:BigInt(0),s),A=Z.submitInfo,k=Z.isPending,E=Z.error,_=(null==A?void 0:A.submitter)||"N/A",B=(0,l.S)().handleContractError;return((0,i.useEffect)(function(){I&&B(I,"submit"),E&&B(E,"submit")},[I,E]),w)?(0,n.jsx)(m.Z,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mx-auto p-4 pb-2 ",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==p?void 0:p.head.id.toString()]}),(0,n.jsx)("span",{className:"text-xl font-bold text-black",children:null==p?void 0:p.body.title})]}),(0,n.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,n.jsx)(u.Z,{address:null==p?void 0:p.head.author})]}),h&&(0,n.jsxs)("div",{className:"flex items-center",children:["推举人"," ",k?(0,n.jsx)(m.Z,{}):(0,n.jsx)(u.Z,{address:_})]})]})]}),(0,n.jsx)("div",{className:"mx-auto p-4 pb-2",children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最小参与代币数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(0,r.LH)((null==p?void 0:p.body.minStake)||BigInt(0))})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最大激励地址数"}),(0,n.jsx)(x.Z,{title:"最大激励地址数说明",content:(0,n.jsxs)("p",{className:"leading-relaxed text-base",children:["每轮从所有参与行动的代币中，随机抽取",(0,n.jsx)("span",{className:"font-mono font-bold text-blue-600 mx-1 text-base",children:null==p?void 0:p.body.maxRandomAccounts.toString()}),"份代币，返回对应地址。若多份代币对应相同地址，则会合并为一个地址。"]})})]}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==p?void 0:p.body.maxRandomAccounts.toString())||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold mb-2",children:"验证规则"}),(0,n.jsx)("div",{className:"text-greyscale-500",children:(0,n.jsx)(c.L,{text:null==p?void 0:p.body.verificationRule,preserveLineBreaks:!0})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold mb-2",children:"报名参加行动时，行动者要提供的信息"}),(null==p?void 0:p.body.verificationKeys)&&(null==p?void 0:p.body.verificationKeys.length)>0?(0,n.jsx)("ul",{className:"list-disc pl-5",children:p.body.verificationKeys.map(function(e,s){return(0,n.jsxs)("li",{className:"text-greyscale-500",children:[(0,n.jsxs)("div",{className:"text-sm font-bold text-greyscale-900 mb-1",children:[(0,n.jsx)(o.Z,{text:e,showWarning:!0})," :"]}),(0,n.jsx)("div",{children:(0,n.jsx)(o.Z,{text:p.body.verificationInfoGuides[s],showWarning:!0,preserveLineBreaks:!0})})]},s)})}):(0,n.jsx)("span",{className:"text-greyscale-500",children:"无"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,n.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==p?void 0:p.body.whiteListAddress)&&"0x0000000000000000000000000000000000000000"!==p.body.whiteListAddress?(0,n.jsx)("span",{className:"flex items-center mr-2",children:(0,n.jsx)(u.Z,{address:p.body.whiteListAddress})}):"无限制"})]}),j&&b&&g&&(0,n.jsx)(f.Z,{extensionAddress:b,factoryAddress:g.address,actionId:s,actionInfo:p})]})})]})}},42083:function(e,s,t){"use strict";var n=t(85893),i=t(23432);s.Z=function(){return(0,n.jsx)(i.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},58993:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var n=t(91309),i=t(85893),d=t(67294),l=t(11163),a=t(42130),r=t(93778),c=t(45231),o=t(83494),x=t(20725),u=t(27245),m=t(86501),f=t(933),h=t(72260),v=t(73591),j=t(91529),b=t(42083),g=t(44576),N=function(e){var s=e.actionId,t=e.onRoundChange,n=(0,a.m)().address,c=((0,d.useContext)(r.M)||{}).token,o=(0,l.useRouter)(),x=(0,h.Bk)(),N=x.currentRound,y=(x.isPending,x.error);(0,d.useEffect)(function(){t&&"function"==typeof t&&t(N)},[N,t]);var p=(0,f.Ty)(null==c?void 0:c.address,n),w=p.validGovVotes,I=p.isPending,Z=p.error,A=(0,h.Ol)(null==c?void 0:c.address,N,n,s),k=A.votesNumByAccountByActionId,E=A.isPending,_=A.error,B=(0,h.VI)((null==c?void 0:c.address)||"",N,n||""),C=B.votesNumByAccount,L=B.isPending,P=B.error,S=I||L||E,R=S?BigInt(0):w-C,T=(0,h.rv)(),H=T.vote,D=T.isPending,K=T.isConfirming,F=T.isConfirmed,M=T.writeError,O=(0,v.S)().handleContractError;return(0,d.useEffect)(function(){M&&O(M,"vote"),y&&O(y,"vote"),_&&O(_,"vote"),Z&&O(Z,"stake"),P&&O(P,"vote")},[M,y,_,Z,P]),(0,d.useEffect)(function(){F&&!M&&(m.ZP.success("提交成功",{duration:2e3}),setTimeout(function(){o.push("/vote/actions/?symbol=".concat(null==c?void 0:c.symbol))},2e3))},[F,M]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col items-center space-y-3 p-4 mb-2",children:[(0,i.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0 mb-2",children:[(0,i.jsxs)("div",{className:"stat place-items-center",children:[(0,i.jsx)("div",{className:"stat-title",children:"我已投本行动票数"}),(0,i.jsx)("div",{className:"stat-value text-2xl",children:E?(0,i.jsx)(b.Z,{}):(0,j.LH)(k)})]}),(0,i.jsxs)("div",{className:"stat place-items-center",children:[(0,i.jsx)("div",{className:"stat-title",children:"我的剩余票数"}),(0,i.jsx)("div",{className:"stat-value text-2xl",children:S?(0,i.jsx)(b.Z,{}):(0,j.LH)(R)})]})]}),!E&&R>BigInt(10)?(0,i.jsx)(u.z,{className:"w-1/2",onClick:function(){D||K||H(null==c?void 0:c.address,[s],[R])},disabled:D||K,children:D||K?(0,i.jsx)(b.Z,{}):"将100%票投给此行动"}):(0,i.jsx)(u.z,{className:"w-1/2",disabled:!0,children:S?(0,i.jsx)(b.Z,{}):"没有剩余票数"}),!I&&(0,i.jsxs)("div",{className:"text-sm text-greyscale-500 text-center",children:["提示: 每轮最大可投票数，等于您的治理票数 (",(0,j.LH)(w),")"]})]}),(0,i.jsx)(g.Z,{isLoading:D||K,text:D?"提交交易...":"确认交易..."})]})},y=function(){var e=(0,l.useRouter)().query.id,s=e?BigInt(e):void 0,t=(0,a.m)().address,u=((0,d.useContext)(r.M)||{}).token,m=(0,n._)((0,d.useState)(null),2),f=m[0],h=m[1],v=(0,c.Q)({tokenAddress:null==u?void 0:u.address,actionId:s,account:t}),j=v.isExtensionAction,b=v.extensionAddress,g=v.factory;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z,{title:"行动详情",showBackButton:!0}),(0,i.jsxs)("main",{className:"flex-grow",children:[(0,i.jsx)(N,{actionId:BigInt(e||0),onRoundChange:function(e){h(e)}}),(0,i.jsx)(x.Z,{actionId:BigInt(e||0),round:BigInt(f||0),showSubmitter:!0,isExtensionAction:j,extensionAddress:b,factory:g})]})]})}}},function(e){e.O(0,[8501,4463,3798,8139,3494,3591,8300,2112,6268,6097,9330,7568,4018,2888,9774,179],function(){return e(e.s=38052)}),_N_E=e.O()}]);