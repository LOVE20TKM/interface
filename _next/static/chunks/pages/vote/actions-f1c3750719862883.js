(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2576],{3125:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(37876),n=t(14232),r=t(98684),l=t(20451),c=t(66663),i=t(89099),d=t(70641),o=t(61809),x=t(96108),m=t(6960),h=t(28638),u=t(48230),j=t.n(u),N=t(64115),v=t(83416),y=t(87577),f=t(1709),p=t(12293),g=t(20442);let b=e=>{var s=e.currentRound,t=((0,n.useContext)(v.N)||{}).token;(0,i.useRouter)();var c=(0,r.ch)((null==t?void 0:t.address)||"",s),u=c.votes,b=c.actionIds,w=c.isPending,A=c.error,C=(0,N.VD)((null==t?void 0:t.address)||"",s),I=C.actionSubmits,_=C.isPending;C.error;var E=Array.from(new Set((null==I?void 0:I.map(e=>BigInt(e.actionId)))||[])).sort((e,s)=>Number(e)-Number(s)),B=(0,N.ui)((null==t?void 0:t.address)||"",E),k=B.actionInfos,P=B.isPending,R=B.error;console.log("actionInfos",k);var F=e=>{if(!b||!u)return 0n;var s=b.findIndex(s=>s===e);return -1!==s?u[s]:0n},S=(null==u?void 0:u.reduce((e,s)=>e+s,0n))||0n,z=(0,l.g)().handleContractError;return((0,n.useEffect)(()=>{A&&z(A,"vote"),R&&z(R,"submit")},[A,R]),w||_||E&&E.length>0&&P)?(0,a.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,a.jsx)(p.A,{})}):t?(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(f.A,{title:"投票中的行动"}),t&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(m.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(j(),{href:"/vote/actions4submit?symbol=".concat(null==t?void 0:t.symbol),children:"推举其他行动"})}),(0,a.jsx)(m.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(j(),{href:"/gov?symbol=".concat(null==t?void 0:t.symbol),children:"返回治理首页"})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:E.length>0?(0,a.jsx)(a.Fragment,{children:null==k?void 0:k.map((e,s)=>{var n,r=null==I||null==(n=I.find(s=>BigInt(s.actionId)===BigInt(e.head.id)))?void 0:n.submitter;return(0,a.jsx)(h.Zp,{className:"shadow-none flex items-center relative",children:(0,a.jsxs)(j(),{href:"/action/".concat(e.head.id,"?type=vote&symbol=").concat(null==t?void 0:t.symbol),className:"w-full",children:[(0,a.jsxs)(h.aR,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,a.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,a.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.head.id)}),(0,a.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,a.jsxs)(h.Wu,{className:"px-3 pt-1 pb-2",children:[(0,a.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,a.jsxs)("div",{className:"flex justify-between gap-0 mt-1 text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(d.A,{className:"text-greyscale-400 mr-1 h-3 w-3 -translate-y-0.5"}),(0,a.jsx)("span",{className:"text-greyscale-400",children:(0,a.jsx)(y.A,{address:e.head.author,showCopyButton:!1,colorClassName2:"text-secondary"})})]}),(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(o.A,{className:"text-greyscale-400 mr-1 h-3 w-3 -translate-y-0.5"}),(0,a.jsx)("span",{className:"text-greyscale-400",children:(0,a.jsx)(y.A,{address:r,colorClassName2:"text-secondary",showCopyButton:!1})})]}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"text-greyscale-400 mr-1",children:"票数"}),(0,a.jsxs)("span",{className:"text-secondary",children:[(0,g.NJ)(F(BigInt(e.head.id)),0)," (",0===Number(F(BigInt(e.head.id)))?"0":(100*Number(F(BigInt(e.head.id)))/Number(S)).toFixed(1),"%)"]})]})]})]}),(0,a.jsx)(x.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]},e.head.id)},e.head.id)})}):(0,a.jsx)("div",{className:"text-sm text-greyscale-500 text-center mt-8",children:"还没推举行动，请先推举"})})]}):(0,a.jsx)(p.A,{})},w=()=>{var e=(0,r.vC)(),s=e.currentRound,t=e.isPending,i=e.error,d=(0,l.g)().handleContractError;return(0,n.useEffect)(()=>{i&&d(i,"vote")},[i]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{title:"投票中的行动"}),(0,a.jsx)("main",{className:"flex-grow",children:t?(0,a.jsx)(p.A,{}):(0,a.jsx)(b,{currentRound:s})})]})}},50876:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/actions",function(){return t(3125)}])},96108:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var a=(0,t(11713).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[2569,4115,1265,636,6593,8792],()=>s(50876)),_N_E=e.O()}]);