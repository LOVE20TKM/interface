(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2576],{1709:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(37876);let a=e=>{var t=e.title;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},3125:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var n=r(37876),a=r(14232),s=r(98684),o=r(20451),c=r(66663),l=r(89099),i=r(91754),d=r(96108),u=r(6960),p=r(28638),f=r(48230),m=r.n(f),y=r(64115),x=r(83416),h=r(87577),v=r(1709),b=r(12293),g=r(20442);let j=e=>{var t=e.currentRound,r=((0,a.useContext)(x.N)||{}).token;(0,l.useRouter)();var c=(0,s.ch)((null==r?void 0:r.address)||"",t),f=c.votes,j=c.actionIds,N=c.isPending,w=c.error,C=(0,y.VD)((null==r?void 0:r.address)||"",t),O=C.actionSubmits,A=C.isPending;C.error;var _=Array.from(new Set((null==O?void 0:O.map(e=>BigInt(e.actionId)))||[])).sort((e,t)=>Number(e)-Number(t)),k=(0,y.ui)((null==r?void 0:r.address)||"",_),P=k.actionInfos,E=k.isPending,R=k.error;console.log("actionInfos",P);var D=e=>{if(!j||!f)return 0n;var t=j.findIndex(t=>t===e);return -1!==t?f[t]:0n},S=(null==f?void 0:f.reduce((e,t)=>e+t,0n))||0n,I=(0,o.g)().handleContractError;return((0,a.useEffect)(()=>{w&&I(w,"vote"),R&&I(R,"submit")},[w,R]),N||A||_&&_.length>0&&E)?(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(b.A,{})}):r?(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(v.A,{title:"投票中的行动"}),r&&(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(u.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(m(),{href:"/vote/actions4submit?symbol=".concat(null==r?void 0:r.symbol),children:"推举其他行动"})}),(0,n.jsx)(u.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(m(),{href:"/gov?symbol=".concat(null==r?void 0:r.symbol),children:"返回治理首页"})})]})]}),(0,n.jsx)("div",{className:"space-y-4",children:_.length>0?(0,n.jsx)(n.Fragment,{children:null==P?void 0:P.map((e,t)=>{var a;return null==O||null==(a=O.find(t=>BigInt(t.actionId)===BigInt(e.head.id)))||a.submitter,(0,n.jsx)(p.Zp,{className:"shadow-none flex items-center relative",children:(0,n.jsxs)(m(),{href:"/action/".concat(e.head.id,"?type=vote&symbol=").concat(null==r?void 0:r.symbol),className:"w-full",children:[(0,n.jsxs)(p.aR,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,n.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,n.jsxs)(p.Wu,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between gap-0 mt-1 text-sm",children:[(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)(i.A,{className:"text-greyscale-400 mr-1 h-3 w-3 -translate-y-0.5"}),(0,n.jsx)("span",{className:"text-greyscale-400",children:(0,n.jsx)(h.A,{address:e.head.author,showCopyButton:!1,colorClassName2:"text-secondary"})})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票数"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(D(BigInt(e.head.id)))})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"占比"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,g.Ee)(100*Number(D(BigInt(e.head.id)))/Number(S))})]})]})]}),(0,n.jsx)(d.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]},e.head.id)},e.head.id)})}):(0,n.jsx)("div",{className:"text-sm text-greyscale-500 text-center mt-8",children:"还没推举行动，请先推举"})})]}):(0,n.jsx)(b.A,{})},N=()=>{var e=(0,s.vC)(),t=e.currentRound,r=e.isPending,l=e.error,i=(0,o.g)().handleContractError;return(0,a.useEffect)(()=>{l&&i(l,"vote")},[l]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.A,{title:"投票中的行动"}),(0,n.jsx)("main",{className:"flex-grow",children:r?(0,n.jsx)(b.A,{}):(0,n.jsx)(j,{currentRound:t})})]})}},7446:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(37876),a=r(7446);let s=()=>(0,n.jsx)(a.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},18449:(e,t,r)=>{"use strict";r.d(t,{X:()=>s});var n=r(76200);class a extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function s(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new a({value:e});let[r,n="0"]=e.split("."),s=r.startsWith("-");if(s&&(r=r.slice(1)),n=n.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${n}`))&&(r=`${BigInt(r)+1n}`),n="";else if(n.length>t){let[e,a,s]=[n.slice(0,t-1),n.slice(t-1,t),n.slice(t)],o=Math.round(Number(`${a}.${s}`));(n=o>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${o}`).length>t&&(n=n.slice(1),r=`${BigInt(r)+1n}`),n=n.slice(0,t)}else n=n.padEnd(t,"0");return BigInt(`${s?"-":""}${r}${n}`)}},26269:(e,t,r)=>{"use strict";var n=r(99680),a={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,s,o,c,l,i,d,u,p=!1;t||(t={}),o=t.debug||!1;try{if(l=n(),i=document.createRange(),d=document.getSelection(),(u=document.createElement("span")).textContent=e,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),void 0===r.clipboardData){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var n=a[t.format]||a.default;window.clipboardData.setData(n,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))}),document.body.appendChild(u),i.selectNodeContents(u),d.addRange(i),!document.execCommand("copy"))throw Error("copy command was unsuccessful");p=!0}catch(n){o&&console.error("unable to copy using execCommand: ",n),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),p=!0}catch(n){o&&console.error("unable to copy using clipboardData: ",n),o&&console.error("falling back to prompt"),r="message"in t?t.message:"Copy to clipboard: #{key}, Enter",s=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C",c=r.replace(/#{\s*key\s*}/g,s),window.prompt(c,e)}}finally{d&&("function"==typeof d.removeRange?d.removeRange(i):d.removeAllRanges()),u&&document.body.removeChild(u),l()}return p}},28638:(e,t,r)=>{"use strict";r.d(t,{BT:()=>u,Wu:()=>p,ZB:()=>d,Zp:()=>l,aR:()=>i,wL:()=>f});var n=r(3576),a=r(65699),s=r(37876),o=r(14232),c=r(30684),l=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r)},o))});l.displayName="Card";var i=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",r)},o))});i.displayName="CardHeader";var d=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",r)},o))});d.displayName="CardTitle";var u=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("text-sm text-muted-foreground",r)},o))});u.displayName="CardDescription";var p=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("p-6 pt-0",r)},o))});p.displayName="CardContent";var f=o.forwardRef((e,t)=>{var r=e.className,o=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",r)},o))});f.displayName="CardFooter"},33276:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},46852:(e,t,r)=>{"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var a=c(r(14232)),s=c(r(26269)),o=["text","onCopy","options","children"];function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){f(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&d(l,e);var t,r,c=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=p(l);return e=t?Reflect.construct(r,arguments,p(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return f(u(e=c.call.apply(c,[this].concat(r))),"onClick",function(t){var r=e.props,n=r.text,o=r.onCopy,c=r.children,l=r.options,i=a.default.Children.only(c),d=(0,s.default)(n,l);o&&o(n,d),i&&i.props&&"function"==typeof i.props.onClick&&i.props.onClick(t)}),e}return r=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),r=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,o),n=a.default.Children.only(t);return a.default.cloneElement(n,i(i({},r),{},{onClick:this.onClick}))}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(l.prototype,r),Object.defineProperty(l,"prototype",{writable:!1}),l}(a.default.PureComponent);t.CopyToClipboard=m,f(m,"defaultProps",{onCopy:void 0,options:void 0})},48447:(e,t,r)=>{"use strict";var n=r(46852).CopyToClipboard;n.CopyToClipboard=n,e.exports=n},50876:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/actions",function(){return r(3125)}])},70801:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},77328:(e,t,r)=>{e.exports=r(89836)},86739:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},87577:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(40854),a=r(37876),s=r(14232),o=r(48447),c=r(33276),l=r(70801),i=r(97685),d=r(20442);let u=e=>{var t=e.address,r=e.word,u=e.showCopyButton,p=e.showAddress,f=void 0===p||p,m=e.colorClassName,y=void 0===m?"":m,x=e.colorClassName2,h=void 0===x?"":x,v=(0,n._)((0,s.useState)(!1),2),b=v[0],g=v[1];return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[r&&(0,a.jsx)("span",{className:"text-xs",children:r}),f&&!h&&(0,a.jsx)("span",{className:"text-xs ".concat(null!=y?y:"text-greyscale-500"),children:(0,d.W_)(t)}),f&&h&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"text-xs ".concat(null!=y?y:"text-greyscale-500"),children:"".concat(t.substring(0,6),"...")}),(0,a.jsx)("span",{className:"text-xs ".concat(h),children:"".concat(t.substring(t.length-4))})]}),(void 0===u||u)&&(0,a.jsx)(o.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?g(!0):i.Ay.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:b?(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=y?y:"text-greyscale-500")}):(0,a.jsx)(l.A,{className:"h-4 w-4 ".concat(null!=y?y:"text-greyscale-500")})})})]})}},91754:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])},96108:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11713).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},99680:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2569,2840,636,6593,8792],()=>t(50876)),_N_E=e.O()}]);