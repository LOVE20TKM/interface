(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6375],{2316:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/stakelp",function(){return r(88150)}])},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876),a=r(7446);let n=()=>(0,s.jsx)(a.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},26269:(e,t,r)=>{"use strict";var s=r(99680),a={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,n,l,o,i,c,d,u,m=!1;t||(t={}),l=t.debug||!1;try{if(i=s(),c=document.createRange(),d=document.getSelection(),(u=document.createElement("span")).textContent=e,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),void 0===r.clipboardData){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var s=a[t.format]||a.default;window.clipboardData.setData(s,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))}),document.body.appendChild(u),c.selectNodeContents(u),d.addRange(c),!document.execCommand("copy"))throw Error("copy command was unsuccessful");m=!0}catch(s){l&&console.error("unable to copy using execCommand: ",s),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),m=!0}catch(s){l&&console.error("unable to copy using clipboardData: ",s),l&&console.error("falling back to prompt"),r="message"in t?t.message:"Copy to clipboard: #{key}, Enter",n=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C",o=r.replace(/#{\s*key\s*}/g,n),window.prompt(o,e)}}finally{d&&("function"==typeof d.removeRange?d.removeRange(c):d.removeAllRanges()),u&&document.body.removeChild(u),i()}return m}},28638:(e,t,r)=>{"use strict";r.d(t,{BT:()=>u,Wu:()=>m,ZB:()=>d,Zp:()=>i,aR:()=>c,wL:()=>f});var s=r(3576),a=r(65699),n=r(37876),l=r(14232),o=r(30684),i=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r)},l))});i.displayName="Card";var c=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r)},l))});c.displayName="CardHeader";var d=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r)},l))});d.displayName="CardTitle";var u=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r)},l))});u.displayName="CardDescription";var m=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("p-6 pt-0",r)},l))});m.displayName="CardContent";var f=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r)},l))});f.displayName="CardFooter"},42038:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var s=r(97685),a=e=>!!e||(s.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},46852:(e,t,r)=>{"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var a=o(r(14232)),n=o(r(26269)),l=["text","onCopy","options","children"];function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){f(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&d(i,e);var t,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=m(i);return e=t?Reflect.construct(r,arguments,m(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];return f(u(e=o.call.apply(o,[this].concat(r))),"onClick",function(t){var r=e.props,s=r.text,l=r.onCopy,o=r.children,i=r.options,c=a.default.Children.only(o),d=(0,n.default)(s,i);l&&l(s,d),c&&c.props&&"function"==typeof c.props.onClick&&c.props.onClick(t)}),e}return r=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),r=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)r=n[s],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,l),s=a.default.Children.only(t);return a.default.cloneElement(s,c(c({},r),{},{onClick:this.onClick}))}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(a.default.PureComponent);t.CopyToClipboard=p,f(p,"defaultProps",{onCopy:void 0,options:void 0})},48447:(e,t,r)=>{"use strict";var s=r(46852).CopyToClipboard;s.CopyToClipboard=s,e.exports=s},70801:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var s=(0,r(11713).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},78256:(e,t,r)=>{"use strict";r.d(t,{bq:()=>x,eb:()=>b,gC:()=>y,l6:()=>f,yv:()=>p});var s=r(3576),a=r(62701),n=r(65699),l=r(37876),o=r(14232),i=r(760),c=r(30822),d=r(21575),u=r(33276),m=r(30684),f=i.bL;i.YJ;var p=i.WT,x=o.forwardRef((e,t)=>{var r=e.className,o=e.children,d=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.l9,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r)},d),{children:[o,(0,l.jsx)(i.In,{asChild:!0,children:(0,l.jsx)(c.A,{className:"h-4 w-4 opacity-50"})})]}))});x.displayName=i.l9.displayName;var v=o.forwardRef((e,t)=>{var r=e.className,o=(0,n._)(e,["className"]);return(0,l.jsx)(i.PP,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,l.jsx)(d.A,{className:"h-4 w-4"})}))});v.displayName=i.PP.displayName;var h=o.forwardRef((e,t)=>{var r=e.className,o=(0,n._)(e,["className"]);return(0,l.jsx)(i.wn,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,l.jsx)(c.A,{className:"h-4 w-4"})}))});h.displayName=i.wn.displayName;var y=o.forwardRef((e,t)=>{var r=e.className,o=e.children,c=e.position,d=void 0===c?"popper":c,u=(0,n._)(e,["className","children","position"]);return(0,l.jsx)(i.ZL,{children:(0,l.jsxs)(i.UC,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:d},u),{children:[(0,l.jsx)(v,{}),(0,l.jsx)(i.LM,{className:(0,m.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),(0,l.jsx)(h,{})]}))})});y.displayName=i.UC.displayName,o.forwardRef((e,t)=>{var r=e.className,a=(0,n._)(e,["className"]);return(0,l.jsx)(i.JU,(0,s._)({ref:t,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r)},a))}).displayName=i.JU.displayName;var b=o.forwardRef((e,t)=>{var r=e.className,o=e.children,c=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.q7,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r)},c),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(i.VF,{children:(0,l.jsx)(u.A,{className:"h-4 w-4"})})}),(0,l.jsx)(i.p4,{children:o})]}))});b.displayName=i.q7.displayName,o.forwardRef((e,t)=>{var r=e.className,a=(0,n._)(e,["className"]);return(0,l.jsx)(i.wv,(0,s._)({ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",r)},a))}).displayName=i.wv.displayName},88150:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var s=r(37876),a=r(66663),n=r(8047),l=r(14232),o=r(20442),i=r(20451),c=r(19591),d=r(83416),u=r(75695),m=r(87577),f=r(12293);let p=e=>{var t=e.token,r=(0,n.F)().address,a=(0,l.useContext)(d.N)||{},p=a.token;a.setToken,a.clearToken;var x=t||p,v=(0,c.n3)(null==x?void 0:x.address,r),h=v.slAmount,y=v.govVotes,b=v.isPending,g=v.error,j=(0,i.g)().handleContractError;return((0,l.useEffect)(()=>{g&&j(g,"stake")},[g,j]),r)?!x||b?(0,s.jsx)(f.A,{}):b||h?(0,s.jsx)("div",{className:"flex-col items-center px-4 py-2 mb-4",children:(0,s.jsxs)("div",{className:"stats bg-gray-100  w-full grid grid-cols-[1fr_2fr] divide-x-0 pt-4",children:[(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,s.jsx)("div",{className:"stat-value text-xl",children:b?(0,s.jsx)(f.A,{}):(0,o.NJ)(y||0n,2)})]}),(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,s.jsx)(m.A,{address:x.slTokenAddress,showAddress:!1}),(0,s.jsx)(u.A,{tokenAddress:x.slTokenAddress,tokenSymbol:"sl"+x.symbol,tokenDecimals:x.decimals})]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:b?(0,s.jsx)(f.A,{}):(0,o.NJ)(h||0n,2)})]})]})}):(0,s.jsx)(s.Fragment,{}):(0,s.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})};var x=r(16927),v=r(40120),h=r(3576),y=r(62701),b=r(40854),g=r(4902),j=r(89099),N=r(48230),w=r.n(N),k=r(97685),_=r(60513),C=r(13810),T=r(88992),R=r(62212),S=(0,r(11713).A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),A=r(6960),P=r(92659),E=r(78256),O=r(77932),I=r(28638),D=r(42038),B=r(4066),F=r(25239),z=r(9215),J=r(52372),V=r(1709),L=r(99574);let M=e=>{(0,v._)(e);var t,r,a,u,m,p,N=function(){k.oR.success("质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my/?symbol=").concat(null==U?void 0:U.symbol)},2e3)},M=(0,n.F)(),W=M.address,X=M.chain,$=(0,l.useContext)(d.N);if(!$)throw Error("TokenContext 必须在 TokenProvider 内使用");var U=$.token,q=$.setToken,Z=$.clearToken,H=(0,F.q)().setError,Y=(0,j.useRouter)().query.first,G=(0,J.ec)(W,null==U?void 0:U.address,null==U?void 0:U.parentTokenAddress),K=G.pairInfo,Q=G.isPending,ee=G.error,et=null!=(t=null==K?void 0:K.balanceOfToken)?t:0n,er=null!=(r=null==K?void 0:K.balanceOfParentToken)?r:0n,es=null!=(a=null==K?void 0:K.allowanceOfToken)?a:0n,ea=null!=(u=null==K?void 0:K.allowanceOfParentToken)?u:0n,en=K&&BigInt(K.pairReserveToken)>0n&&BigInt(K.pairReserveParentToken)>0n,el=(0,b._)((0,l.useState)(!1),2),eo=el[0],ei=el[1],ec=(0,c.CF)(null==U?void 0:U.address),ed=ec.initialStakeRound,eu=ec.isPending,em=ec.error,ef=(0,T.mN)({resolver:(0,C.u)((m=er||0n,p=et||0n,_.z.object({parentToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var t=e.replace(/。/g,".");return t.startsWith(".")&&(t="0"+t),t},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t>0n},"质押父币数不能为 0").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t<=m},"质押父币数不能超过当前持有")),stakeToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var t=e.replace(/。/g,".");return t.startsWith(".")&&(t="0"+t),t},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t>0n},"质押 token 数不能为 0").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t<=p},"质押 token 数不能超过当前持有")),releasePeriod:_.z.string().min(1,"请选择解锁期")}))),defaultValues:{parentToken:"",stakeToken:"",releasePeriod:""},mode:"onChange"}),ep=(0,c.n3)(null==U?void 0:U.address,W),ex=(ep.govVotes,ep.promisedWaitingPhases),ev=ep.isPending,eh=ep.error,ey=(0,b._)((0,l.useState)(!1),2),eb=ey[0],eg=ey[1],ej=(0,b._)((0,l.useState)(!1),2),eN=ej[0],ew=ej[1],ek=(0,z.zH)(null==U?void 0:U.address),e_=ek.approve,eC=ek.isWriting,eT=ek.isConfirming,eR=ek.isConfirmed,eS=ek.writeError,eA=(0,z.zH)(null==U?void 0:U.parentTokenAddress),eP=eA.approve,eE=eA.isWriting,eO=eA.isConfirming,eI=eA.isConfirmed,eD=eA.writeError;function eB(){return(eB=(0,x._)(function(e){var t;return(0,g.__generator)(this,function(r){switch(r.label){case 0:if(!(0,D.C)(X))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(t=(0,o.XS)(e.stakeToken)))throw Error("无效的输入格式");return[4,e_("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t)];case 2:return r.sent(),[3,4];case 3:return console.error("Token 授权失败",r.sent()),k.oR.error("token 授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}function eF(){return(eF=(0,x._)(function(e){var t;return(0,g.__generator)(this,function(r){switch(r.label){case 0:if(!(0,D.C)(X))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(t=(0,o.XS)(e.parentToken)))throw Error("无效的输入格式");return[4,eP("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t)];case 2:return r.sent(),[3,4];case 3:return console.error("父币授权失败",r.sent()),k.oR.error("父币授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{eR&&(eg(!0),k.oR.success("授权".concat(null==U?void 0:U.symbol,"成功")))},[eR]),(0,l.useEffect)(()=>{eI&&(ew(!0),k.oR.success("授权".concat(null==U?void 0:U.parentTokenSymbol,"成功")))},[eI]);var ez=(0,b._)((0,l.useState)(!1),2),eJ=ez[0],eV=ez[1],eL=(0,b._)((0,l.useState)(!1),2),eM=eL[0],eW=eL[1],eX=ef.watch("parentToken"),e$=ef.watch("stakeToken"),eU=(0,o.XS)(eX),eq=(0,o.XS)(e$);(0,l.useEffect)(()=>{if(en&&eJ&&null!==eU&&eU>0n){var e=eU*BigInt(K.pairReserveToken)/BigInt(K.pairReserveParentToken),t=Number((0,o.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ef.setValue("stakeToken",t),eV(!1),eW(!1)}},[en,eJ,eU,K,ef]),(0,l.useEffect)(()=>{if(en&&eM&&null!==eq&&eq>0n){var e=eq*BigInt(K.pairReserveParentToken)/BigInt(K.pairReserveToken),t=Number((0,o.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ef.setValue("parentToken",t),eV(!1),eW(!1)}},[en,eM,eq,K,ef]),(0,l.useEffect)(()=>{eU>0n&&ea>=eU?ew(!0):ew(!1)},[eU,ea]),(0,l.useEffect)(()=>{eq>0n&&es>=eq?eg(!0):eg(!1)},[eq,es]);var eZ=(0,c.E_)(),eH=eZ.stakeLiquidity,eY=eZ.isWriting,eG=eZ.isConfirming,eK=eZ.isConfirmed,eQ=eZ.writeError;function e0(){return(e0=(0,x._)(function(e){var t,r,s;return(0,g.__generator)(this,function(a){switch(a.label){case 0:if(!(0,D.C)(X))return[2];if(!(eb&&eN))return k.oR.error("请先完成授权"),[2];if(t=(0,o.XS)(e.stakeToken),r=(0,o.XS)(e.parentToken),null===t||null===r)return k.oR.error("转换金额时出错，请检查输入格式"),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,eH(null==U?void 0:U.address,t,r,BigInt(e.releasePeriod),W)];case 2:return a.sent(),[3,4];case 3:return console.error("Stake failed",s=a.sent()),e1(s,"stake"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{eK&&((null==U?void 0:U.initialStakeRound)&&U.initialStakeRound>0?N():ei(!0))},[eK]),(0,l.useEffect)(()=>{eo&&!eu&&(ed||Z(),N())},[eo,eu]),(0,l.useEffect)(()=>{U&&0==U.initialStakeRound&&ed&&ed>0&&q((0,y._)((0,h._)({},U),{initialStakeRound:Number(ed)}))},[U,ed]);var e1=(0,i.g)().handleContractError;(0,l.useEffect)(()=>{ee&&e1(ee,"token"),eS&&e1(eS,"stake"),eD&&e1(eD,"stake"),eQ&&e1(eQ,"stake"),em&&e1(em,"stake"),eh&&e1(eh,"stake")},[ee,eS,eD,eQ,em,eh]);var e2=eC||eE,e4=eT||eO,e3=e2||e4||eb&&eN;(0,l.useEffect)(()=>{!U||"true"!==Y||eu||ed||H({name:"提示：",message:"新部署的代币，需先质押获取治理票，才能后续操作"})},[U,Y,eu,ed]),(0,l.useEffect)(()=>{Q||et||e3||!U||!U.symbol||H({name:"余额不足",message:"您当前".concat(U.symbol,"数量为0，请先获取").concat(U.symbol)}),Q||er||e3||!U||!U.parentTokenSymbol||H({name:"余额不足",message:"您当前".concat(U.parentTokenSymbol,"数量为0，请先获取").concat(U.parentTokenSymbol)})},[et,er,U,Q]);var e6=(0,l.useRef)(null),e7=(0,l.useRef)(eC);(0,l.useEffect)(()=>{if(e7.current&&!eC){var e;null==(e=e6.current)||e.blur()}e7.current=eC},[eC]);var e8=(0,b._)((0,l.useState)(!1),2),e5=e8[0],e9=e8[1];return!U||ev||eu?(0,s.jsx)(f.A,{}):(0,s.jsx)("div",{className:"bg-white px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md sm:max-w-lg md:max-w-2xl lg:max-w-full mx-auto space-y-4",children:[(0,s.jsx)("div",{className:"w-full flex justify-between items-center",children:(0,s.jsx)(V.A,{title:"质押获取治理票："})}),(0,s.jsx)(P.lV,(0,y._)((0,h._)({},ef),{children:(0,s.jsxs)("form",{onSubmit:ef.handleSubmit(function(e){return e0.apply(this,arguments)}),className:"space-y-3",children:[(0,s.jsx)(I.Zp,{children:(0,s.jsx)(I.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"第1步: 填写质押数量"}),(0,s.jsx)(w(),{href:"/dex/swap",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline transition-colors",children:"获取代币"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsx)(P.zB,{control:ef.control,name:"parentToken",render:e=>{var t=e.field;return(0,s.jsxs)(P.eI,{children:[(0,s.jsx)(I.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,s.jsxs)(I.Wu,{className:"py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(O.p,(0,y._)((0,h._)({type:"number",placeholder:"0"},t),{disabled:e3,onChange:e=>{t.onChange(e),eV(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors ",children:(0,s.jsx)("span",{className:"font-medium text-gray-800",children:null==U?void 0:U.parentTokenSymbol})})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,s.jsxs)(A.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var t=er*BigInt(e)/100n;ef.setValue("parentToken",(0,o.Js)(t)),eV(!0)},disabled:e3||er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,s.jsx)(A.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ef.setValue("parentToken",(0,o.Js)(er||0n)),eV(!0)},disabled:er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,o.NJ)(er)," ",null==U?void 0:U.parentTokenSymbol]})]})]})}),(0,s.jsx)(P.C5,{})]})}}),(0,s.jsx)(P.zB,{control:ef.control,name:"stakeToken",render:e=>{var t=e.field;return(0,s.jsxs)(P.eI,{children:[(0,s.jsx)(I.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,s.jsxs)(I.Wu,{className:"py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(O.p,(0,y._)((0,h._)({type:"number",placeholder:"0"},t),{disabled:et<=0n,onChange:e=>{t.onChange(e),eW(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors",children:(0,s.jsx)("span",{className:"font-medium text-gray-800",children:null==U?void 0:U.symbol})})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,s.jsxs)(A.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var t=et*BigInt(e)/100n;ef.setValue("stakeToken",(0,o.Js)(t)),eW(!0)},disabled:et<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,s.jsx)(A.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ef.setValue("stakeToken",(0,o.Js)(et||0n)),eW(!0)},disabled:et<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,o.NJ)(et)," ",null==U?void 0:U.symbol]})]})]})}),(0,s.jsx)(P.C5,{})]})}})]}),en&&(0,s.jsxs)("div",{className:"space-y-1 text-sm mt-2",children:[(0,s.jsxs)("div",{className:"text-gray-600 flex items-center gap-1",children:[(0,s.jsx)(R.A,{className:"w-4 h-4"}),"质押比例按当前价格计算："]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-gray-600",children:e5?(0,s.jsxs)(s.Fragment,{children:["1 ",null==U?void 0:U.symbol," ="," ",(0,o.NJ)(BigInt(K.pairReserveParentToken)*BigInt(1e18)/BigInt(K.pairReserveToken))," ",null==U?void 0:U.parentTokenSymbol]}):(0,s.jsxs)(s.Fragment,{children:["1 ",null==U?void 0:U.parentTokenSymbol," ="," ",(0,o.NJ)(BigInt(K.pairReserveToken)*BigInt(1e18)/BigInt(K.pairReserveParentToken))," ",null==U?void 0:U.symbol]})}),(0,s.jsx)(A.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>e9(!e5),className:"h-6 w-6 p-0 hover:bg-gray-100 transition-colors",title:"切换比例显示",children:(0,s.jsx)(S,{className:"h-3 w-3 text-gray-500"})})]})]})]})})}),(0,s.jsx)(I.Zp,{children:(0,s.jsx)(I.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第2步: 选择解锁期"})}),(0,s.jsx)(P.zB,{control:ef.control,name:"releasePeriod",render:e=>{var t=e.field;return(0,s.jsxs)(P.eI,{children:[(0,s.jsx)(P.MJ,{children:(0,s.jsxs)(E.l6,{onValueChange:e=>t.onChange(e),value:t.value,children:[(0,s.jsx)(E.bq,{className:"w-full !ring-secondary-foreground",children:(0,s.jsx)(E.yv,{placeholder:"选择解锁期"})}),(0,s.jsx)(E.gC,{children:Array.from({length:2},(e,t)=>t+1).filter(e=>e>=ex).map(e=>(0,s.jsx)(E.eb,{value:String(e),children:(0,B.u$)(e)},e))})]})}),(0,s.jsx)(P.Rr,{children:'"解锁期" 是指，取消质押后多久才能取回代币 (注意：是从取消质押的阶段结束时开始计算)'}),(0,s.jsx)(P.C5,{})]})}})]})})}),(0,s.jsx)(I.Zp,{children:(0,s.jsx)(I.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第3步: 授权并存入"})}),(0,s.jsxs)("div",{className:"flex justify-center lg:justify-start space-x-2",children:[(0,s.jsx)(A.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",ref:e6,disabled:eC||eT||eb,onClick:ef.handleSubmit(function(e){return eB.apply(this,arguments)}),children:eC?"1.提交中...":eT?"1.确认中...":eb?"1.".concat(null==U?void 0:U.symbol,"已授权"):"1.授权".concat(null==U?void 0:U.symbol)}),(0,s.jsx)(A.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",disabled:!eb||eE||eO||eN,onClick:ef.handleSubmit(function(e){return eF.apply(this,arguments)}),children:eE?"2.提交中...":eO?"2.确认中...":eN?"2.".concat(null==U?void 0:U.parentTokenSymbol,"已授权"):"2.授权".concat(null==U?void 0:U.parentTokenSymbol)}),(0,s.jsx)(A.$,{type:"submit",className:"flex-1 lg:w-auto lg:px-4",disabled:!eb||!eN||eY||eG||eK,children:eY?"3.提交中...":eG?"3.确认中...":eK?"3.已提交":"3.提交"})]})]})})})]})})),(0,s.jsx)(L.A,{isLoading:e2||e4||eY||eG||eu&&eo,text:e2||eY?"提交交易...":"确认交易..."})]})})},W=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.A,{title:"质押LP"}),(0,s.jsxs)("main",{className:"flex-grow",children:[(0,s.jsx)(p,{}),(0,s.jsx)(M,{}),(0,s.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,s.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,s.jsx)(R.A,{className:"w-4 h-4"}),"提示"]}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"SL代币："}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"代币对儿由质押合约注入 Uniswap V2 流动性池，并铸造SL代币作为流动性质押凭证"}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理票："}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"所得治理票数 = SL代币数量 * 解锁期阶段数"}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、单个地址的验证激励：当轮治理总激励 * 50% * 该地址行使验证权的治理票数 / 行使验权的治理票总数"}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的加速激励：当轮治理总激励 * 50% * 该地址质押代币数量 / 质押代币总数量"}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"4、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})},92659:(e,t,r)=>{"use strict";r.d(t,{lV:()=>v,MJ:()=>w,Rr:()=>k,zB:()=>y,eI:()=>j,lR:()=>N,C5:()=>_});var s=r(81110),a=r(40120),n=r(3576),l=r(62701),o=r(65699),i=r(37876),c=r(14232),d=r(39358),u=r(88992),m=r(30684),f=r(49794),p=(0,r(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]);return(0,i.jsx)(f.b,(0,n._)({ref:t,className:(0,m.cn)(p(),r)},s))});x.displayName=f.b.displayName;var v=u.Op,h=c.createContext({}),y=e=>{var t=(0,s._)({},(0,a._)(e));return(0,i.jsx)(h.Provider,{value:{name:t.name},children:(0,i.jsx)(u.xI,(0,n._)({},t))})},b=()=>{var e=c.useContext(h),t=c.useContext(g),r=(0,u.xW)(),s=r.getFieldState,a=r.formState,l=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");var o=t.id;return(0,n._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},l)},g=c.createContext({}),j=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=c.useId();return(0,i.jsx)(g.Provider,{value:{id:a},children:(0,i.jsx)("div",(0,n._)({ref:t,className:(0,m.cn)("space-y-2",r)},s))})});j.displayName="FormItem";var N=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=b(),l=a.error,c=a.formItemId;return(0,i.jsx)(x,(0,n._)({ref:t,className:(0,m.cn)(l&&"text-destructive",r),htmlFor:c},s))});N.displayName="FormLabel";var w=c.forwardRef((e,t)=>{var r=(0,s._)({},(0,a._)(e)),l=b(),o=l.error,c=l.formItemId,u=l.formDescriptionId,m=l.formMessageId;return(0,i.jsx)(d.DX,(0,n._)({ref:t,id:c,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},r))});w.displayName="FormControl";var k=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=b().formDescriptionId;return(0,i.jsx)("p",(0,n._)({ref:t,id:a,className:(0,m.cn)("text-sm text-muted-foreground",r)},s))});k.displayName="FormDescription";var _=c.forwardRef((e,t)=>{var r=e.className,s=e.children,a=(0,o._)(e,["className","children"]),c=b(),d=c.error,u=c.formMessageId,f=d?String(null==d?void 0:d.message):s;return f?(0,i.jsx)("p",(0,l._)((0,n._)({ref:t,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",r)},a),{children:f})):null});_.displayName="FormMessage"},95167:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var s=(0,r(11713).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},99574:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876);r(14232);var a=r(7446);let n=e=>{var t=e.isLoading,r=e.text;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===r?"Loading":r})]})}):null}},99680:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],s=0;s<e.rangeCount;s++)r.push(e.getRangeAt(s));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}}},e=>{var t=t=>e(e.s=t);e.O(0,[6869,4571,3921,2569,5139,9591,548,636,6593,8792],()=>t(2316)),_N_E=e.O()}]);