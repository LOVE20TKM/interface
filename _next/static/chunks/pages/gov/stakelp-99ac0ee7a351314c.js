(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6375],{2316:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/stakelp",function(){return r(88150)}])},4066:(e,s,r)=>{"use strict";r.d(s,{BN:()=>n,I:()=>c,bD:()=>t,u$:()=>l,u3:()=>i});var a=r(20442),t=(e,s,r)=>{if(!e||!s)return"0%";var t=31536e5/Number("255"),n=BigInt("120");if(0===t||0n===n)return console.error("配置错误: NEXT_PUBLIC_BLOCK_TIME 或 NEXT_PUBLIC_PHASE_BLOCKS 未设置"),"0%";var l=e?99n*e*99n/2000000n:BigInt(0),i=(2n*s||BigInt(0))+(r||BigInt(0));if(i===BigInt(0))return"0%";var c=Number(l)/Number(i)/(Number(n)/t)*100;return(0,a.Ee)(c)},n=(e,s)=>{if(!e||!s||0n===s)return"∞";var r=31536e5/Number("255"),t=BigInt("120");if(0===r||0n===t)return console.error("配置错误: BLOCK_TIME 或 PHASE_BLOCKS 未设置或为0"),"0%";var n=Number(e)/Number(s)/(Number(t)/r)*100;return(0,a.Ee)(n)},l=function(e){var s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Number("120")||0,t=Number("255")||0,n=e*a,l=Math.ceil(n*t/100);if(l>=86400){var i=Math.ceil(l/86400);s="".concat(i,"天")}else if(l>=3600){var c=Math.ceil(l/3600);s="".concat(c,"小时")}else{var o=Math.ceil(l/60);s="".concat(o,"分钟")}var d="".concat(n.toLocaleString(),"区块，约").concat(s);return r||(d="".concat(e,"个阶段（").concat(d,")")),d},i=(e,s)=>{if(!e)return BigInt(0);var r=1000n-BigInt("1")-BigInt("1"),a=BigInt(0);return s<=1n?e*BigInt("1")/1000n:e*r*BigInt("1")/1000000n},c=(e,s)=>{if(!e)return BigInt(0);var r=1000n-BigInt("1")-BigInt("1"),a=BigInt(0);return 1n===s?e*BigInt("1")/1000n:2n===s?e*r*BigInt("1")/1000000n:e*r*r*BigInt("1")/1000000000n}},12293:(e,s,r)=>{"use strict";r.d(s,{A:()=>n});var a=r(37876),t=r(7446);let n=()=>(0,a.jsx)(t.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},28638:(e,s,r)=>{"use strict";r.d(s,{BT:()=>m,Wu:()=>u,ZB:()=>d,Zp:()=>c,aR:()=>o,wL:()=>x});var a=r(3576),t=r(65699),n=r(37876),l=r(14232),i=r(30684),c=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r)},l))});c.displayName="Card";var o=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r)},l))});o.displayName="CardHeader";var d=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r)},l))});d.displayName="CardTitle";var m=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("text-sm text-muted-foreground",r)},l))});m.displayName="CardDescription";var u=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("p-6 pt-0",r)},l))});u.displayName="CardContent";var x=l.forwardRef((e,s)=>{var r=e.className,l=(0,t._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",r)},l))});x.displayName="CardFooter"},75695:(e,s,r)=>{"use strict";r.d(s,{A:()=>x});var a=r(16927),t=r(40854),n=r(4902),l=r(37876),i=r(14232),c=r(7446),o=r(95167),d=r(8047),m=r(44571),u=r(97685);function x(e){var s,r=e.tokenAddress,x=e.tokenSymbol,f=e.tokenDecimals,p=e.tokenImage,h=(0,t._)((0,i.useState)(!1),2),v=h[0],N=h[1],g=(0,d.F)().isConnected,b=(0,m.G)().data,j=(s=(0,a._)(function(){return(0,n.YH)(this,function(e){switch(e.label){case 0:if(!g)return alert("请先连接你的钱包"),[2];N(!0),e.label=1;case 1:if(e.trys.push([1,3,4,5]),!b)return alert("无法获取钱包客户端"),[2];return[4,b.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:r,symbol:x,decimals:f,image:p}}})];case 2:return e.sent()?u.Ay.success("代币已成功添加到 MetaMask 钱包"):u.Ay.error("用户拒绝添加代币"),[3,5];case 3:return console.error("添加代币失败:",e.sent()),u.Ay.error("添加代币失败，请检查控制台以获取更多信息"),[3,5];case 4:return N(!1),[7];case 5:return[2]}})}),function(){return s.apply(this,arguments)});return x.length>11?null:(0,l.jsx)("button",{onClick:j,disabled:v,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:v?(0,l.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-greyscale-500"})})}},78256:(e,s,r)=>{"use strict";r.d(s,{bq:()=>p,eb:()=>g,gC:()=>N,l6:()=>x,yv:()=>f});var a=r(3576),t=r(62701),n=r(65699),l=r(37876),i=r(14232),c=r(3628),o=r(30822),d=r(21575),m=r(33276),u=r(30684),x=c.bL;c.YJ;var f=c.WT,p=i.forwardRef((e,s)=>{var r=e.className,i=e.children,d=(0,n._)(e,["className","children"]);return(0,l.jsxs)(c.l9,(0,t._)((0,a._)({ref:s,className:(0,u.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r)},d),{children:[i,(0,l.jsx)(c.In,{asChild:!0,children:(0,l.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]}))});p.displayName=c.l9.displayName;var h=i.forwardRef((e,s)=>{var r=e.className,i=(0,n._)(e,["className"]);return(0,l.jsx)(c.PP,(0,t._)((0,a._)({ref:s,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",r)},i),{children:(0,l.jsx)(d.A,{className:"h-4 w-4"})}))});h.displayName=c.PP.displayName;var v=i.forwardRef((e,s)=>{var r=e.className,i=(0,n._)(e,["className"]);return(0,l.jsx)(c.wn,(0,t._)((0,a._)({ref:s,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",r)},i),{children:(0,l.jsx)(o.A,{className:"h-4 w-4"})}))});v.displayName=c.wn.displayName;var N=i.forwardRef((e,s)=>{var r=e.className,i=e.children,o=e.position,d=void 0===o?"popper":o,m=(0,n._)(e,["className","children","position"]);return(0,l.jsx)(c.ZL,{children:(0,l.jsxs)(c.UC,(0,t._)((0,a._)({ref:s,className:(0,u.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:d},m),{children:[(0,l.jsx)(h,{}),(0,l.jsx)(c.LM,{className:(0,u.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,l.jsx)(v,{})]}))})});N.displayName=c.UC.displayName,i.forwardRef((e,s)=>{var r=e.className,t=(0,n._)(e,["className"]);return(0,l.jsx)(c.JU,(0,a._)({ref:s,className:(0,u.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r)},t))}).displayName=c.JU.displayName;var g=i.forwardRef((e,s)=>{var r=e.className,i=e.children,o=(0,n._)(e,["className","children"]);return(0,l.jsxs)(c.q7,(0,t._)((0,a._)({ref:s,className:(0,u.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r)},o),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(c.VF,{children:(0,l.jsx)(m.A,{className:"h-4 w-4"})})}),(0,l.jsx)(c.p4,{children:i})]}))});g.displayName=c.q7.displayName,i.forwardRef((e,s)=>{var r=e.className,t=(0,n._)(e,["className"]);return(0,l.jsx)(c.wv,(0,a._)({ref:s,className:(0,u.cn)("-mx-1 my-1 h-px bg-muted",r)},t))}).displayName=c.wv.displayName},87577:(e,s,r)=>{"use strict";r.d(s,{A:()=>m});var a=r(40854),t=r(37876),n=r(14232),l=r(48447),i=r(33276),c=r(70801),o=r(97685),d=r(20442);let m=e=>{var s=e.address,r=e.word,m=e.showCopyButton,u=e.showAddress,x=void 0===u||u,f=e.colorClassName,p=void 0===f?"":f,h=e.colorClassName2,v=void 0===h?"":h,N=(0,a._)((0,n.useState)(!1),2),g=N[0],b=N[1];return(0,t.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[r&&(0,t.jsx)("span",{className:"text-xs",children:r}),x&&!v&&(0,t.jsx)("span",{className:"text-xs ".concat(null!=p?p:"text-greyscale-500"),children:(0,d.W_)(s)}),x&&v&&(0,t.jsxs)("span",{className:"text-[0px]",children:[(0,t.jsx)("span",{className:"text-xs ".concat(null!=p?p:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,t.jsx)("span",{className:"text-xs ".concat(v),children:"".concat(s.substring(s.length-4))})]}),(void 0===m||m)&&(0,t.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?b(!0):o.Ay.error("复制失败")},children:(0,t.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:g?(0,t.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")}):(0,t.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")})})})]})}},88150:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>D});var a=r(37876),t=r(60154),n=r(8047),l=r(14232),i=r(20442),c=r(20451),o=r(19591),d=r(83416),m=r(75695),u=r(87577),x=r(12293);let f=e=>{var s=e.token,r=(0,n.F)().address,t=(0,l.useContext)(d.N)||{},f=t.token;t.setToken,t.clearToken;var p=s||f,h=(0,o.n3)(null==p?void 0:p.address,r),v=h.slAmount,N=h.govVotes,g=h.isPending,b=h.error,j=(0,c.g)().handleContractError;return((0,l.useEffect)(()=>{b&&j(b,"stake")},[b,j]),r)?!p||g?(0,a.jsx)(x.A,{}):g||v?(0,a.jsx)("div",{className:"flex-col items-center px-4 py-2 mb-4",children:(0,a.jsxs)("div",{className:"stats bg-gray-100  w-full grid grid-cols-[1fr_2fr] divide-x-0 pt-4",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,a.jsx)("div",{className:"stat-value text-xl",children:g?(0,a.jsx)(x.A,{}):(0,i.NJ)(N||0n)})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,a.jsx)(u.A,{address:p.slTokenAddress,showAddress:!1}),(0,a.jsx)(m.A,{tokenAddress:p.slTokenAddress,tokenSymbol:"sl"+p.symbol,tokenDecimals:p.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl",children:g?(0,a.jsx)(x.A,{}):(0,i.NJ)(v||0n)})]})]})}):(0,a.jsx)(a.Fragment,{}):(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})};var p=r(16927),h=r(40120),v=r(3576),N=r(62701),g=r(40854),b=r(4902),j=r(89099),y=r(48230),k=r.n(y),w=r(97685),_=r(60513),C=r(13810),T=r(88992),I=r(62212),S=(0,r(11713).A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),R=r(6960),A=r(92659),B=r(78256),E=r(77932),P=r(28638),F=r(42038),z=r(4066),L=r(25239),M=r(9215),J=r(52372),V=r(1709),X=r(99574);let $=e=>{(0,h._)(e);var s,r,t,m,u,f,y=function(){w.oR.success("质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/gov?symbol=").concat(null==q?void 0:q.symbol)},2e3)},$=(0,n.F)(),D=$.address,W=$.chain,O=(0,l.useContext)(d.N);if(!O)throw Error("TokenContext 必须在 TokenProvider 内使用");var q=O.token,H=O.setToken,U=O.clearToken,Z=(0,L.q)().setError,Y=(0,j.useRouter)().query.first,K=(0,J.ec)(D,null==q?void 0:q.address,null==q?void 0:q.parentTokenAddress),G=K.pairInfo,Q=K.isPending,ee=K.error,es=null!=(s=null==G?void 0:G.balanceOfToken)?s:0n,er=null!=(r=null==G?void 0:G.balanceOfParentToken)?r:0n,ea=null!=(t=null==G?void 0:G.allowanceOfToken)?t:0n,et=null!=(m=null==G?void 0:G.allowanceOfParentToken)?m:0n,en=G&&BigInt(G.pairReserveToken)>0n&&BigInt(G.pairReserveParentToken)>0n,el=(0,g._)((0,l.useState)(!1),2),ei=el[0],ec=el[1],eo=(0,o.CF)(null==q?void 0:q.address),ed=eo.initialStakeRound,em=eo.isPending,eu=eo.error,ex=Number("1")||4,ef=Number("4")||12,ep=(0,T.mN)({resolver:(0,C.u)((u=er||0n,f=es||0n,_.z.object({parentToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var s=e.replace(/。/g,".");return s.startsWith(".")&&(s="0"+s),s},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var s=(0,i.XS)(e);return null!==s&&s>0n},"质押父币数不能为 0").refine(e=>{var s=(0,i.XS)(e);return null!==s&&s<=u},"质押父币数不能超过当前持有")),stakeToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var s=e.replace(/。/g,".");return s.startsWith(".")&&(s="0"+s),s},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var s=(0,i.XS)(e);return null!==s&&s>0n},"质押 token 数不能为 0").refine(e=>{var s=(0,i.XS)(e);return null!==s&&s<=f},"质押 token 数不能超过当前持有")),releasePeriod:_.z.string().min(1,"请选择解锁期")}))),defaultValues:{parentToken:"",stakeToken:"",releasePeriod:""},mode:"onChange"}),eh=(0,o.n3)(null==q?void 0:q.address,D),ev=(eh.govVotes,eh.promisedWaitingPhases),eN=eh.isPending,eg=eh.error,eb=(0,g._)((0,l.useState)(!1),2),ej=eb[0],ey=eb[1],ek=(0,g._)((0,l.useState)(!1),2),ew=ek[0],e_=ek[1],eC=(0,M.zH)(null==q?void 0:q.address),eT=eC.approve,eI=eC.isPending,eS=eC.isConfirming,eR=eC.isConfirmed,eA=eC.writeError,eB=(0,M.zH)(null==q?void 0:q.parentTokenAddress),eE=eB.approve,eP=eB.isPending,eF=eB.isConfirming,ez=eB.isConfirmed,eL=eB.writeError;function eM(){return(eM=(0,p._)(function(e){var s;return(0,b.YH)(this,function(r){switch(r.label){case 0:if(!(0,F.C)(W))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(s=(0,i.XS)(e.stakeToken)))throw Error("无效的输入格式");return[4,eT("0xe5aF1b0f6cE14296039d9505d8A91c77be36A0FD",s)];case 2:return r.sent(),[3,4];case 3:return console.error("Token 授权失败",r.sent()),w.oR.error("token 授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}function eJ(){return(eJ=(0,p._)(function(e){var s;return(0,b.YH)(this,function(r){switch(r.label){case 0:if(!(0,F.C)(W))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(s=(0,i.XS)(e.parentToken)))throw Error("无效的输入格式");return[4,eE("0xe5aF1b0f6cE14296039d9505d8A91c77be36A0FD",s)];case 2:return r.sent(),[3,4];case 3:return console.error("父币授权失败",r.sent()),w.oR.error("父币授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{eR&&(ey(!0),w.oR.success("授权".concat(null==q?void 0:q.symbol,"成功")))},[eR]),(0,l.useEffect)(()=>{ez&&(e_(!0),w.oR.success("授权".concat(null==q?void 0:q.parentTokenSymbol,"成功")))},[ez]);var eV=(0,g._)((0,l.useState)(!1),2),eX=eV[0],e$=eV[1],eD=(0,g._)((0,l.useState)(!1),2),eW=eD[0],eO=eD[1],eq=ep.watch("parentToken"),eH=ep.watch("stakeToken"),eU=(0,i.XS)(eq),eZ=(0,i.XS)(eH);(0,l.useEffect)(()=>{if(en&&eX&&null!==eU&&eU>0n){var e=eU*BigInt(G.pairReserveToken)/BigInt(G.pairReserveParentToken),s=Number((0,i.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ep.setValue("stakeToken",s),e$(!1),eO(!1)}},[en,eX,eU,G,ep]),(0,l.useEffect)(()=>{if(en&&eW&&null!==eZ&&eZ>0n){var e=eZ*BigInt(G.pairReserveParentToken)/BigInt(G.pairReserveToken),s=Number((0,i.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ep.setValue("parentToken",s),e$(!1),eO(!1)}},[en,eW,eZ,G,ep]),(0,l.useEffect)(()=>{eU>0n&&et>=eU?e_(!0):e_(!1)},[eU,et]),(0,l.useEffect)(()=>{eZ>0n&&ea>=eZ?ey(!0):ey(!1)},[eZ,ea]);var eY=(0,o.E_)(),eK=eY.stakeLiquidity,eG=eY.isWriting,eQ=eY.isConfirming,e0=eY.isConfirmed,e1=eY.writeError;function e2(){return(e2=(0,p._)(function(e){var s,r,a;return(0,b.YH)(this,function(t){switch(t.label){case 0:if(!(0,F.C)(W))return[2];if(!(ej&&ew))return w.oR.error("请先完成授权"),[2];if(s=(0,i.XS)(e.stakeToken),r=(0,i.XS)(e.parentToken),null===s||null===r)return w.oR.error("转换金额时出错，请检查输入格式"),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,eK(null==q?void 0:q.address,s,r,BigInt(e.releasePeriod),D)];case 2:return t.sent(),[3,4];case 3:return console.error("Stake failed",a=t.sent()),e4(a,"stake"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{e0&&((null==q?void 0:q.initialStakeRound)&&q.initialStakeRound>0?y():ec(!0))},[e0]),(0,l.useEffect)(()=>{ei&&!em&&(ed||U(),y())},[ei,em]),(0,l.useEffect)(()=>{q&&0==q.initialStakeRound&&ed&&ed>0&&H((0,N._)((0,v._)({},q),{initialStakeRound:Number(ed)}))},[q,ed]);var e4=(0,c.g)().handleContractError;(0,l.useEffect)(()=>{ee&&e4(ee,"token"),eA&&e4(eA,"stake"),eL&&e4(eL,"stake"),e1&&e4(e1,"stake"),eu&&e4(eu,"stake"),eg&&e4(eg,"stake")},[ee,eA,eL,e1,eu,eg]);var e3=eI||eP,e5=eS||eF,e6=e3||e5||ej&&ew;(0,l.useEffect)(()=>{!q||"true"!==Y||em||ed||Z({name:"提示：",message:"新部署的代币，需先质押获取治理票，才能后续操作"})},[q,Y,em,ed]),(0,l.useEffect)(()=>{Q||es||e6||!q||!q.symbol||Z({name:"余额不足",message:"您当前".concat(q.symbol,"数量为0，请先获取").concat(q.symbol)}),Q||er||e6||!q||!q.parentTokenSymbol||Z({name:"余额不足",message:"您当前".concat(q.parentTokenSymbol,"数量为0，请先获取").concat(q.parentTokenSymbol)})},[es,er,q,Q]);var e7=(0,l.useRef)(null),e8=(0,l.useRef)(eI);(0,l.useEffect)(()=>{if(e8.current&&!eI){var e;null==(e=e7.current)||e.blur()}e8.current=eI},[eI]);var e9=(0,g._)((0,l.useState)(!1),2),se=e9[0],ss=e9[1];return!q||eN||em?(0,a.jsx)(x.A,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-white px-4",children:[(0,a.jsxs)("div",{className:"w-full max-w-md sm:max-w-lg md:max-w-2xl lg:max-w-full mx-auto space-y-4",children:[(0,a.jsx)("div",{className:"w-full flex justify-between items-center",children:(0,a.jsx)(V.A,{title:"质押获取治理票："})}),(0,a.jsx)(A.lV,(0,N._)((0,v._)({},ep),{children:(0,a.jsxs)("form",{onSubmit:ep.handleSubmit(function(e){return e2.apply(this,arguments)}),className:"space-y-3",children:[(0,a.jsx)(P.Zp,{children:(0,a.jsx)(P.Wu,{className:"p-3 md:p-6",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"第1步: 填写质押数量"}),(0,a.jsx)(k(),{href:"/dex/swap",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline transition-colors",children:"获取代币"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsx)(A.zB,{control:ep.control,name:"parentToken",render:e=>{var s=e.field;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(P.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,a.jsxs)(P.Wu,{className:"py-4 px-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(E.p,(0,N._)((0,v._)({type:"number",placeholder:"0"},s),{disabled:e6,onChange:e=>{s.onChange(e),e$(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors ",children:(0,a.jsx)("span",{className:"font-medium text-gray-800",children:null==q?void 0:q.parentTokenSymbol})})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,a.jsxs)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var s=er*BigInt(e)/100n;ep.setValue("parentToken",(0,i.Js)(s)),e$(!0)},disabled:e6||er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,a.jsx)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ep.setValue("parentToken",(0,i.Js)(er||0n)),e$(!0)},disabled:er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,i.NJ)(er)," ",null==q?void 0:q.parentTokenSymbol]})]})]})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:ep.control,name:"stakeToken",render:e=>{var s=e.field;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(P.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,a.jsxs)(P.Wu,{className:"py-4 px-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(E.p,(0,N._)((0,v._)({type:"number",placeholder:"0"},s),{disabled:es<=0n,onChange:e=>{s.onChange(e),eO(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors",children:(0,a.jsx)("span",{className:"font-medium text-gray-800",children:null==q?void 0:q.symbol})})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,a.jsxs)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var s=es*BigInt(e)/100n;ep.setValue("stakeToken",(0,i.Js)(s)),eO(!0)},disabled:es<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,a.jsx)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ep.setValue("stakeToken",(0,i.Js)(es||0n)),eO(!0)},disabled:es<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,i.NJ)(es)," ",null==q?void 0:q.symbol]})]})]})}),(0,a.jsx)(A.C5,{})]})}})]}),en&&(0,a.jsxs)("div",{className:"space-y-1 text-sm mt-2",children:[(0,a.jsxs)("div",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(I.A,{className:"w-4 h-4"}),"质押比例按当前价格计算："]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-gray-600",children:se?(0,a.jsxs)(a.Fragment,{children:["1 ",null==q?void 0:q.symbol," ="," ",(0,i.NJ)(BigInt(G.pairReserveParentToken)*BigInt(1e18)/BigInt(G.pairReserveToken))," ",null==q?void 0:q.parentTokenSymbol]}):(0,a.jsxs)(a.Fragment,{children:["1 ",null==q?void 0:q.parentTokenSymbol," ="," ",(0,i.NJ)(BigInt(G.pairReserveToken)*BigInt(1e18)/BigInt(G.pairReserveParentToken))," ",null==q?void 0:q.symbol]})}),(0,a.jsx)(R.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>ss(!se),className:"h-6 w-6 p-0 hover:bg-gray-100 transition-colors",title:"切换比例显示",children:(0,a.jsx)(S,{className:"h-3 w-3 text-gray-500"})})]})]})]})})}),(0,a.jsx)(P.Zp,{children:(0,a.jsx)(P.Wu,{className:"p-3 md:p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第2步: 选择解锁期"})}),(0,a.jsx)(A.zB,{control:ep.control,name:"releasePeriod",render:e=>{var s=e.field;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.MJ,{children:(0,a.jsxs)(B.l6,{onValueChange:e=>s.onChange(e),value:s.value,children:[(0,a.jsx)(B.bq,{className:"w-full !ring-secondary-foreground",children:(0,a.jsx)(B.yv,{placeholder:"选择解锁期"})}),(0,a.jsx)(B.gC,{children:Array.from({length:ef-ex+1},(e,s)=>s+ex).filter(e=>e>=ev).map(e=>(0,a.jsx)(B.eb,{value:String(e),children:(0,z.u$)(e)},e))})]})}),(0,a.jsx)(A.Rr,{children:'"解锁期" 是指，取消质押后多久才能取回代币 (注意：是从取消质押的阶段结束时开始计算)'}),(0,a.jsx)(A.C5,{})]})}})]})})}),(0,a.jsx)(P.Zp,{children:(0,a.jsx)(P.Wu,{className:"p-3 md:p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第3步: 授权并存入"})}),(0,a.jsxs)("div",{className:"flex justify-center lg:justify-start space-x-2",children:[(0,a.jsx)(R.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",ref:e7,disabled:eI||eS||ej,onClick:ep.handleSubmit(function(e){return eM.apply(this,arguments)}),children:eI?"1.提交中...":eS?"1.确认中...":ej?"1.".concat(null==q?void 0:q.symbol,"已授权"):"1.授权".concat(null==q?void 0:q.symbol)}),(0,a.jsx)(R.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",disabled:!ej||eP||eF||ew,onClick:ep.handleSubmit(function(e){return eJ.apply(this,arguments)}),children:eP?"2.提交中...":eF?"2.确认中...":ew?"2.".concat(null==q?void 0:q.parentTokenSymbol,"已授权"):"2.授权".concat(null==q?void 0:q.parentTokenSymbol)}),(0,a.jsx)(R.$,{type:"submit",className:"flex-1 lg:w-auto lg:px-4",disabled:!ej||!ew||eG||eQ||e0,children:eG?"3.提交中...":eQ?"3.确认中...":e0?"3.已提交":"3.提交"})]})]})})})]})}))]}),(0,a.jsx)(X.A,{isLoading:e3||e5||eG||eQ||em&&ei,text:e3||eG?"提交交易...":"确认交易..."})]})})},D=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.A,{title:"质押LP"}),(0,a.jsxs)("main",{className:"flex-grow",children:[(0,a.jsx)(f,{}),(0,a.jsx)($,{}),(0,a.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,a.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,a.jsx)(I.A,{className:"w-4 h-4"}),"提示"]}),(0,a.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"SL代币："}),(0,a.jsx)("div",{className:"text-sm text-blue-700",children:"代币对儿由质押合约注入 Uniswap V2 流动性池，并铸造SL代币作为流动性质押凭证"}),(0,a.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理票："}),(0,a.jsx)("div",{className:"text-sm text-blue-700",children:"所得治理票数 = SL代币数量 * 解锁期阶段数"}),(0,a.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,a.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,a.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、单个地址的验证激励：当轮治理总激励 * 50% * 该地址行使验证权的治理票数 / 行使验权的治理票总数"}),(0,a.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的加速激励：当轮治理总激励 * 50% * 该地址质押代币数量 / 质押代币总数量"}),(0,a.jsx)("div",{className:"text-sm text-blue-700",children:"4、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})},92659:(e,s,r)=>{"use strict";r.d(s,{lV:()=>h,MJ:()=>k,Rr:()=>w,zB:()=>N,eI:()=>j,lR:()=>y,C5:()=>_});var a=r(81110),t=r(40120),n=r(3576),l=r(62701),i=r(65699),c=r(37876),o=r(14232),d=r(39358),m=r(88992),u=r(30684),x=r(49794),f=(0,r(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=o.forwardRef((e,s)=>{var r=e.className,a=(0,i._)(e,["className"]);return(0,c.jsx)(x.b,(0,n._)({ref:s,className:(0,u.cn)(f(),r)},a))});p.displayName=x.b.displayName;var h=m.Op,v=o.createContext({}),N=e=>{var s=(0,a._)({},(0,t._)(e));return(0,c.jsx)(v.Provider,{value:{name:s.name},children:(0,c.jsx)(m.xI,(0,n._)({},s))})},g=()=>{var e=o.useContext(v),s=o.useContext(b),r=(0,m.xW)(),a=r.getFieldState,t=r.formState,l=a(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");var i=s.id;return(0,n._)({id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message")},l)},b=o.createContext({}),j=o.forwardRef((e,s)=>{var r=e.className,a=(0,i._)(e,["className"]),t=o.useId();return(0,c.jsx)(b.Provider,{value:{id:t},children:(0,c.jsx)("div",(0,n._)({ref:s,className:(0,u.cn)("space-y-2",r)},a))})});j.displayName="FormItem";var y=o.forwardRef((e,s)=>{var r=e.className,a=(0,i._)(e,["className"]),t=g(),l=t.error,o=t.formItemId;return(0,c.jsx)(p,(0,n._)({ref:s,className:(0,u.cn)(l&&"text-destructive",r),htmlFor:o},a))});y.displayName="FormLabel";var k=o.forwardRef((e,s)=>{var r=(0,a._)({},(0,t._)(e)),l=g(),i=l.error,o=l.formItemId,m=l.formDescriptionId,u=l.formMessageId;return(0,c.jsx)(d.DX,(0,n._)({ref:s,id:o,"aria-describedby":i?"".concat(m," ").concat(u):"".concat(m),"aria-invalid":!!i},r))});k.displayName="FormControl";var w=o.forwardRef((e,s)=>{var r=e.className,a=(0,i._)(e,["className"]),t=g().formDescriptionId;return(0,c.jsx)("p",(0,n._)({ref:s,id:t,className:(0,u.cn)("text-sm text-muted-foreground",r)},a))});w.displayName="FormDescription";var _=o.forwardRef((e,s)=>{var r=e.className,a=e.children,t=(0,i._)(e,["className","children"]),o=g(),d=o.error,m=o.formMessageId,x=d?String(null==d?void 0:d.message):a;return x?(0,c.jsx)("p",(0,l._)((0,n._)({ref:s,id:m,className:(0,u.cn)("text-sm font-medium text-destructive",r)},t),{children:x})):null});_.displayName="FormMessage"},95167:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var a=(0,r(11713).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[3308,9374,8230,6869,8809,3297,154,3096,5139,9513,636,6593,8792],()=>s(2316)),_N_E=e.O()}]);