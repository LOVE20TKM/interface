(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3994],{12293:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});var r=a(37876),t=a(7446);let n=()=>(0,r.jsx)(t.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},78256:(e,s,a)=>{"use strict";a.d(s,{bq:()=>p,eb:()=>j,gC:()=>N,l6:()=>x,yv:()=>f});var r=a(3576),t=a(62701),n=a(65699),l=a(37876),c=a(14232),i=a(3628),d=a(30822),o=a(21575),m=a(33276),u=a(30684),x=i.bL;i.YJ;var f=i.WT,p=c.forwardRef((e,s)=>{var a=e.className,c=e.children,o=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.l9,(0,t._)((0,r._)({ref:s,className:(0,u.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},o),{children:[c,(0,l.jsx)(i.In,{asChild:!0,children:(0,l.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]}))});p.displayName=i.l9.displayName;var h=c.forwardRef((e,s)=>{var a=e.className,c=(0,n._)(e,["className"]);return(0,l.jsx)(i.PP,(0,t._)((0,r._)({ref:s,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",a)},c),{children:(0,l.jsx)(o.A,{className:"h-4 w-4"})}))});h.displayName=i.PP.displayName;var v=c.forwardRef((e,s)=>{var a=e.className,c=(0,n._)(e,["className"]);return(0,l.jsx)(i.wn,(0,t._)((0,r._)({ref:s,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",a)},c),{children:(0,l.jsx)(d.A,{className:"h-4 w-4"})}))});v.displayName=i.wn.displayName;var N=c.forwardRef((e,s)=>{var a=e.className,c=e.children,d=e.position,o=void 0===d?"popper":d,m=(0,n._)(e,["className","children","position"]);return(0,l.jsx)(i.ZL,{children:(0,l.jsxs)(i.UC,(0,t._)((0,r._)({ref:s,className:(0,u.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:o},m),{children:[(0,l.jsx)(h,{}),(0,l.jsx)(i.LM,{className:(0,u.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:c}),(0,l.jsx)(v,{})]}))})});N.displayName=i.UC.displayName,c.forwardRef((e,s)=>{var a=e.className,t=(0,n._)(e,["className"]);return(0,l.jsx)(i.JU,(0,r._)({ref:s,className:(0,u.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},t))}).displayName=i.JU.displayName;var j=c.forwardRef((e,s)=>{var a=e.className,c=e.children,d=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.q7,(0,t._)((0,r._)({ref:s,className:(0,u.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a)},d),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(i.VF,{children:(0,l.jsx)(m.A,{className:"h-4 w-4"})})}),(0,l.jsx)(i.p4,{children:c})]}))});j.displayName=i.q7.displayName,c.forwardRef((e,s)=>{var a=e.className,t=(0,n._)(e,["className"]);return(0,l.jsx)(i.wv,(0,r._)({ref:s,className:(0,u.cn)("-mx-1 my-1 h-px bg-muted",a)},t))}).displayName=i.wv.displayName},87577:(e,s,a)=>{"use strict";a.d(s,{A:()=>m});var r=a(40854),t=a(37876),n=a(14232),l=a(48447),c=a(33276),i=a(70801),d=a(97685),o=a(20442);let m=e=>{var s=e.address,a=e.word,m=e.showCopyButton,u=e.showAddress,x=void 0===u||u,f=e.colorClassName,p=void 0===f?"":f,h=e.colorClassName2,v=void 0===h?"":h,N=(0,r._)((0,n.useState)(!1),2),j=N[0],b=N[1];return(0,t.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[a&&(0,t.jsx)("span",{className:"text-xs",children:a}),x&&!v&&(0,t.jsx)("span",{className:"text-xs ".concat(null!=p?p:"text-greyscale-500"),children:(0,o.W_)(s)}),x&&v&&(0,t.jsxs)("span",{className:"text-[0px]",children:[(0,t.jsx)("span",{className:"text-xs ".concat(null!=p?p:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,t.jsx)("span",{className:"text-xs ".concat(v),children:"".concat(s.substring(s.length-4))})]}),(void 0===m||m)&&(0,t.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?b(!0):d.Ay.error("复制失败")},children:(0,t.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:j?(0,t.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")}):(0,t.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=p?p:"text-greyscale-500")})})})]})}},90356:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/staketoken",function(){return a(97103)}])},92659:(e,s,a)=>{"use strict";a.d(s,{lV:()=>h,MJ:()=>w,Rr:()=>_,zB:()=>N,eI:()=>y,lR:()=>g,C5:()=>k});var r=a(81110),t=a(40120),n=a(3576),l=a(62701),c=a(65699),i=a(37876),d=a(14232),o=a(39358),m=a(88992),u=a(30684),x=a(49794),f=(0,a(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=d.forwardRef((e,s)=>{var a=e.className,r=(0,c._)(e,["className"]);return(0,i.jsx)(x.b,(0,n._)({ref:s,className:(0,u.cn)(f(),a)},r))});p.displayName=x.b.displayName;var h=m.Op,v=d.createContext({}),N=e=>{var s=(0,r._)({},(0,t._)(e));return(0,i.jsx)(v.Provider,{value:{name:s.name},children:(0,i.jsx)(m.xI,(0,n._)({},s))})},j=()=>{var e=d.useContext(v),s=d.useContext(b),a=(0,m.xW)(),r=a.getFieldState,t=a.formState,l=r(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");var c=s.id;return(0,n._)({id:c,name:e.name,formItemId:"".concat(c,"-form-item"),formDescriptionId:"".concat(c,"-form-item-description"),formMessageId:"".concat(c,"-form-item-message")},l)},b=d.createContext({}),y=d.forwardRef((e,s)=>{var a=e.className,r=(0,c._)(e,["className"]),t=d.useId();return(0,i.jsx)(b.Provider,{value:{id:t},children:(0,i.jsx)("div",(0,n._)({ref:s,className:(0,u.cn)("space-y-2",a)},r))})});y.displayName="FormItem";var g=d.forwardRef((e,s)=>{var a=e.className,r=(0,c._)(e,["className"]),t=j(),l=t.error,d=t.formItemId;return(0,i.jsx)(p,(0,n._)({ref:s,className:(0,u.cn)(l&&"text-destructive",a),htmlFor:d},r))});g.displayName="FormLabel";var w=d.forwardRef((e,s)=>{var a=(0,r._)({},(0,t._)(e)),l=j(),c=l.error,d=l.formItemId,m=l.formDescriptionId,u=l.formMessageId;return(0,i.jsx)(o.DX,(0,n._)({ref:s,id:d,"aria-describedby":c?"".concat(m," ").concat(u):"".concat(m),"aria-invalid":!!c},a))});w.displayName="FormControl";var _=d.forwardRef((e,s)=>{var a=e.className,r=(0,c._)(e,["className"]),t=j().formDescriptionId;return(0,i.jsx)("p",(0,n._)({ref:s,id:t,className:(0,u.cn)("text-sm text-muted-foreground",a)},r))});_.displayName="FormDescription";var k=d.forwardRef((e,s)=>{var a=e.className,r=e.children,t=(0,c._)(e,["className","children"]),d=j(),o=d.error,m=d.formMessageId,x=o?String(null==o?void 0:o.message):r;return x?(0,i.jsx)("p",(0,l._)((0,n._)({ref:s,id:m,className:(0,u.cn)("text-sm font-medium text-destructive",a)},t),{children:x})):null});k.displayName="FormMessage"},95167:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});var r=(0,a(11713).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},97103:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>J});var r=a(37876),t=a(14232),n=a(8047),l=a(62212),c=a(83416),i=a(9215),d=a(20451),o=a(67121),m=a(60154),u=a(12293),x=a(16927),f=a(3576),p=a(62701),h=a(40854),v=a(4902),N=a(97685),j=a(13810),b=a(88992),y=a(60513),g=a(92659),w=a(77932),_=a(6960),k=a(78256),A=a(7446),C=a(42038),R=a(20442),F=a(4066),P=a(19591),E=a(1709),I=a(99574);let T=e=>{var s=e.tokenBalance,a=(0,n.F)(),l=a.address,o=a.chain,m=((0,t.useContext)(c.N)||{}).token,T=(0,h._)((0,t.useState)(!1),2),S=T[0],z=T[1],D=(0,i.zH)(null==m?void 0:m.address),M=D.approve,J=D.isPending,B=D.isConfirming,L=D.isConfirmed,X=D.writeError,V=(0,P.Lg)(),W=V.stakeToken,q=V.isPending,U=V.isConfirming,$=V.isConfirmed,H=V.writeError,O=(0,P.n3)(null==m?void 0:m.address,l),Y=O.promisedWaitingPhases,G=O.isPending,Z=O.error,K=(0,i.Gp)(null==m?void 0:m.address,l,"0xe5aF1b0f6cE14296039d9505d8A91c77be36A0FD"),Q=K.allowance,ee=K.isPending,es=K.error,ea=(0,t.useRef)(null),er=(0,t.useRef)(ee);(0,t.useEffect)(()=>{if(er.current&&!ee){var e;null==(e=ea.current)||e.blur()}er.current=ee},[ee]);var et=Number("1")||1,en=Number("4")||2,el=(0,b.mN)({resolver:(0,j.u)(y.z.object({stakeTokenAmount:y.z.string().refine(e=>""!==e.trim(),{message:"请输入质押数量"}).refine(e=>Number(e)>0,{message:"质押代币数不能为0"}).refine(e=>(0,R.XS)(e)<=s,{message:"质押代币数不能大于持有代币数"}),releasePeriod:y.z.string().min(1,"请选择解锁期")})),defaultValues:{stakeTokenAmount:"",releasePeriod:""},mode:"onChange"}),ec=function(){var e=(0,x._)(function(e){var s;return(0,v.YH)(this,function(a){switch(a.label){case 0:if(!(0,C.C)(o))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,M("0xe5aF1b0f6cE14296039d9505d8A91c77be36A0FD",(0,R.XS)(e.stakeTokenAmount))];case 2:return a.sent(),[3,4];case 3:return console.error("Approve failed",s=a.sent()),eo(s,"token"),[3,4];case 4:return[2]}})});return function(s){return e.apply(this,arguments)}}();(0,t.useEffect)(()=>{L&&(z(!0),N.oR.success("授权".concat(null==m?void 0:m.symbol,"成功")))},[L,null==m?void 0:m.symbol]);var ei=function(){var e=(0,x._)(function(e){var s;return(0,v.YH)(this,function(a){switch(a.label){case 0:if(!(0,C.C)(o))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,W(null==m?void 0:m.address,(0,R.XS)(e.stakeTokenAmount),BigInt(e.releasePeriod),l)];case 2:return a.sent(),[3,4];case 3:return console.error("Stake failed",s=a.sent()),eo(s,"stake"),[3,4];case 4:return[2]}})});return function(s){return e.apply(this,arguments)}}();(0,t.useEffect)(()=>{$&&(N.oR.success("质押成功"),el.reset(),setTimeout(()=>{window.location.href="".concat("/interface","/gov?symbol=").concat(null==m?void 0:m.symbol)},2e3))},[$,el,null==m?void 0:m.symbol]);var ed=el.watch("stakeTokenAmount");(0,t.useEffect)(()=>{var e=0n;try{e=(0,R.XS)(ed||"0")}catch(s){e=0n}e>0n&&Q&&Q>0n&&Q>=e?z(!0):z(!1)},[ed,Q,ee]);var eo=(0,d.g)().handleContractError;return((0,t.useEffect)(()=>{H&&eo(H,"stake"),X&&eo(X,"token"),es&&eo(es,"token"),Z&&eo(Z,"stake")},[H,X,es,Z,eo]),G)?(0,r.jsx)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:(0,r.jsx)(u.A,{})}):(0,r.jsxs)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:[(0,r.jsx)("div",{className:"w-full text-left mb-4",children:(0,r.jsx)(E.A,{title:"质押增加治理收益"})}),(0,r.jsx)(g.lV,(0,p._)((0,f._)({},el),{children:(0,r.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"w-full max-w-md space-y-4",children:[(0,r.jsx)(g.zB,{control:el.control,name:"stakeTokenAmount",render:e=>{var a=e.field;return(0,r.jsxs)(g.eI,{children:[(0,r.jsx)(g.lR,{className:"text-sm",children:"质押数："}),(0,r.jsx)(g.MJ,{children:(0,r.jsx)(w.p,(0,f._)({type:"number",placeholder:"输入 ".concat(null==m?void 0:m.symbol," 数量"),className:"!ring-secondary-foreground"},a))}),(0,r.jsxs)(g.Rr,{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{children:["持有 ",(0,r.jsx)("span",{className:"mr-2",children:(0,R.NJ)(s)}),null==m?void 0:m.symbol]}),(0,r.jsx)(_.$,{variant:"link",size:"sm",type:"button",onClick:()=>{el.setValue("stakeTokenAmount",(0,R.Js)(s||0n))},disabled:s<=0n,className:"text-secondary mr-2",children:"全部"})]}),(0,r.jsx)(g.C5,{})]})}}),(0,r.jsx)(g.zB,{control:el.control,name:"releasePeriod",render:e=>{var s=e.field;return(0,r.jsxs)(g.eI,{children:[(0,r.jsx)(g.lR,{children:"解锁期："}),(0,r.jsx)(g.MJ,{children:(0,r.jsxs)(k.l6,{onValueChange:e=>s.onChange(e),value:s.value,children:[(0,r.jsx)(k.bq,{className:"w-full !ring-secondary-foreground",children:(0,r.jsx)(k.yv,{placeholder:"选择解锁期长度"})}),(0,r.jsx)(k.gC,{children:Array.from({length:en-et+1},(e,s)=>s+et).filter(e=>e>=Y).map(e=>(0,r.jsx)(k.eb,{value:String(e),children:(0,F.u$)(e)},e))})]})}),(0,r.jsx)(g.Rr,{children:"提示：取消质押后，需等待解锁期过后才能取回代币"}),(0,r.jsx)(g.C5,{})]})}}),(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsx)(_.$,{ref:ea,className:"w-1/2",disabled:ee||J||B||S,onClick:()=>el.handleSubmit(ec)(),children:ee?(0,r.jsx)(A.A,{className:"animate-spin h-4 w-4"}):J?"1.授权中...":B?"1.确认中...":S?"1.".concat(null==m?void 0:m.symbol,"已授权"):"1.授权".concat(null==m?void 0:m.symbol)}),(0,r.jsx)(_.$,{className:"w-1/2",disabled:!S||q||U||$,onClick:()=>el.handleSubmit(ei)(),children:q?"2.质押中...":U?"2.确认中...":$?"2.已质押":"2.质押"})]})]})})),(0,r.jsx)(I.A,{isLoading:J||B||q||U,text:J||q?"提交交易...":"确认交易..."})]})};var S=a(42472),z=a(87577),D=a(75695);function M(){var e=((0,t.useContext)(c.N)||{}).token,s=(0,n.F)().address,a=(0,S.lW)((null==e?void 0:e.stTokenAddress)||"",s||"0x0000000000000000000000000000000000000000"),l=a.balance,i=a.isPending,o=a.error,m=(0,d.g)().handleContractError;return((0,t.useEffect)(()=>{o&&m(o,"token")},[o]),null==e?void 0:e.stTokenAddress)?(0,r.jsx)("div",{className:"px-4 pt-0 pb-6",children:(0,r.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 text-sm mt-4",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("div",{className:"mr-2",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"font-bold text-2xl mr-2",children:["st",e.symbol]}),(0,r.jsx)(z.A,{address:e.stTokenAddress}),(0,r.jsx)(D.A,{tokenAddress:e.stTokenAddress,tokenSymbol:e.symbol||"",tokenDecimals:e.decimals||0})]})})}),(0,r.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,r.jsx)("span",{className:"text-sm text-greyscale-500 mr-1",children:"我持有:"}),(0,r.jsx)("span",{className:"text-sm text-secondary",children:i?(0,r.jsx)(u.A,{}):(0,R.NJ)(l||0n)})]})]})}):(0,r.jsx)(u.A,{})}let J=()=>{var e=((0,t.useContext)(c.N)||{}).token,s=(0,n.F)().address,a=(0,i.lW)(null==e?void 0:e.address,s).balance,x=(0,o.Cl)(null==e?void 0:e.slTokenAddress),f=x.tokenAmount,p=x.isPending,h=x.error,v=(0,d.g)().handleContractError;return(0,t.useEffect)(()=>{h&&v(h,"slToken")},[h]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{title:"质押代币"}),(0,r.jsxs)("main",{className:"flex-grow",children:[p&&(0,r.jsx)(u.A,{}),!p&&!f&&(0,r.jsx)("div",{className:"flex justify-center items-center mt-10",children:"需要先质押流动性LP，才可以质押代币"}),f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M,{}),(0,r.jsx)(T,{tokenBalance:a||0n})]}),(0,r.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,r.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"提示"]}),(0,r.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、质押代币可获得 加速激励"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的验证激励：当轮治理总激励 * 50% * 该地址行使验证权的治理票数 / 行使验权的治理票总数"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"4、单个地址的加速激励：当轮治理总激励 * 50% * 该地址质押代币数量 / 质押代币总数量"}),(0,r.jsx)("div",{className:"text-sm text-blue-700",children:"5、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3308,9374,6869,4571,3297,154,3096,5139,9513,7121,125,636,6593,8792],()=>s(90356)),_N_E=e.O()}]);