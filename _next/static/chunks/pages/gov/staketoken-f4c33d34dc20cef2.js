(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7809],{51906:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/staketoken",function(){return t(27614)}])},76929:function(e,s,t){"use strict";t.d(s,{l0:function(){return m},NI:function(){return b},pf:function(){return N},Wi:function(){return x},xJ:function(){return h},lX:function(){return j},zG:function(){return y}});var r=t(85893),n=t(67294),l=t(4222),a=t(87536),i=t(40108),o=t(41850);let d=(0,t(12003).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(o.f,{ref:s,className:(0,i.cn)(d(),t),...n})});c.displayName=o.f.displayName;let m=a.RV,u=n.createContext({}),x=e=>{let{...s}=e;return(0,r.jsx)(u.Provider,{value:{name:s.name},children:(0,r.jsx)(a.Qr,{...s})})},f=()=>{let e=n.useContext(u),s=n.useContext(p),{getFieldState:t,formState:r}=(0,a.Gc)(),l=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},p=n.createContext({}),h=n.forwardRef((e,s)=>{let{className:t,...l}=e,a=n.useId();return(0,r.jsx)(p.Provider,{value:{id:a},children:(0,r.jsx)("div",{ref:s,className:(0,i.cn)("space-y-2",t),...l})})});h.displayName="FormItem";let j=n.forwardRef((e,s)=>{let{className:t,...n}=e,{error:l,formItemId:a}=f();return(0,r.jsx)(c,{ref:s,className:(0,i.cn)(l&&"text-destructive",t),htmlFor:a,...n})});j.displayName="FormLabel";let b=n.forwardRef((e,s)=>{let{...t}=e,{error:n,formItemId:a,formDescriptionId:i,formMessageId:o}=f();return(0,r.jsx)(l.g7,{ref:s,id:a,"aria-describedby":n?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!n,...t})});b.displayName="FormControl";let N=n.forwardRef((e,s)=>{let{className:t,...n}=e,{formDescriptionId:l}=f();return(0,r.jsx)("p",{ref:s,id:l,className:(0,i.cn)("text-sm text-muted-foreground",t),...n})});N.displayName="FormDescription";let y=n.forwardRef((e,s)=>{let{className:t,children:n,...l}=e,{error:a,formMessageId:o}=f(),d=a?String(null==a?void 0:a.message):n;return d?(0,r.jsx)("p",{ref:s,id:o,className:(0,i.cn)("text-sm font-medium text-destructive",t),...l,children:d}):null});y.displayName="FormMessage"},88659:function(e,s,t){"use strict";t.d(s,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return h},i4:function(){return u},ki:function(){return m}});var r=t(85893),n=t(67294),l=t(86443),a=t(42171),i=t(15432),o=t(78865),d=t(40108);let c=l.fC;l.ZA;let m=l.B4,u=n.forwardRef((e,s)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(l.xz,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[n,(0,r.jsx)(l.JO,{asChild:!0,children:(0,r.jsx)(a.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=l.xz.displayName;let x=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(l.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=l.u_.displayName;let f=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(l.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(a.Z,{className:"h-4 w-4"})})});f.displayName=l.$G.displayName;let p=n.forwardRef((e,s)=>{let{className:t,children:n,position:a="popper",...i}=e;return(0,r.jsx)(l.h_,{children:(0,r.jsxs)(l.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...i,children:[(0,r.jsx)(x,{}),(0,r.jsx)(l.l_,{className:(0,d.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(f,{})]})})});p.displayName=l.VY.displayName,n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(l.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})}).displayName=l.__.displayName;let h=n.forwardRef((e,s)=>{let{className:t,children:n,...a}=e;return(0,r.jsxs)(l.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.wU,{children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(l.eT,{children:n})]})});h.displayName=l.ck.displayName,n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(l.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=l.Z0.displayName},27460:function(e,s,t){"use strict";var r=t(85893),n=t(67294),l=t(74855),a=t(78865),i=t(18289),o=t(86501),d=t(91529);s.Z=e=>{let{address:s,word:t,showCopyButton:c=!0,showAddress:m=!0,colorClassName:u=""}=e,[x,f]=(0,n.useState)(!1);return(0,r.jsxs)("span",{className:"flex items-center space-x-2",children:[t&&(0,r.jsx)("span",{className:"text-xs",children:t}),m&&(0,r.jsx)("span",{className:"text-xs ".concat(null!=u?u:"text-greyscale-500"),children:(0,d.Vu)(s)}),c&&(0,r.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?f(!0):o.ZP.error("复制失败")},children:(0,r.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:x?(0,r.jsx)(a.Z,{className:"h-4 w-4 ".concat(null!=u?u:"text-greyscale-500")}):(0,r.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=u?u:"text-greyscale-500")})})})]})}},42083:function(e,s,t){"use strict";var r=t(85893),n=t(23432);s.Z=()=>(0,r.jsx)(n.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},27614:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return R}});var r=t(85893),n=t(67294),l=t(92321),a=t(67997),i=t(93778),o=t(19638),d=t(67068),c=t(7224),m=t(37436),u=t(42083),x=t(86501),f=t(56312),p=t(87536),h=t(1604),j=t(76929),b=t(21774),N=t(27245),y=t(88659),v=t(23432),g=t(48105),w=t(91529),k=t(99958),A=t(92180),C=t(64777),Z=t(44576),_=e=>{let{tokenBalance:s}=e,{address:t,chain:a}=(0,l.m)(),{token:c}=(0,n.useContext)(i.M)||{},[m,_]=(0,n.useState)(!1),{approve:z,isWriting:T,isConfirming:P,isConfirmed:E,writeError:R}=(0,o.yA)(null==c?void 0:c.address),{stakeToken:S,isWriting:F,isConfirming:I,isConfirmed:B,writeError:G}=(0,A.aE)(),{promisedWaitingPhases:V,isPending:L,error:M}=(0,A.L)(null==c?void 0:c.address,t),{allowance:D,isPending:W,error:X}=(0,o.yG)(null==c?void 0:c.address,t,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A"),J=(0,n.useRef)(null),O=(0,n.useRef)(W);(0,n.useEffect)(()=>{if(O.current&&!W){var e;null===(e=J.current)||void 0===e||e.blur()}O.current=W},[W]);let Q=(0,p.cI)({resolver:(0,f.F)(h.z.object({stakeTokenAmount:h.z.string().refine(e=>""!==e.trim(),{message:"请输入质押数量"}).refine(e=>Number(e)>0,{message:"质押代币数不能为0"}).refine(e=>(0,w.vz)(e)<=s,{message:"质押代币数不能大于持有代币数"}),releasePeriod:h.z.string().min(1,"请选择解锁期")})),defaultValues:{stakeTokenAmount:"",releasePeriod:""},mode:"onChange"}),H=async e=>{if((0,g.S)(a))try{await z("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",(0,w.vz)(e.stakeTokenAmount))}catch(e){x.Am.error((null==e?void 0:e.message)||"授权失败"),console.error("Approve failed",e)}};(0,n.useEffect)(()=>{E&&(_(!0),x.Am.success("授权".concat(null==c?void 0:c.symbol,"成功")))},[E,null==c?void 0:c.symbol]);let Y=async e=>{if((0,g.S)(a))try{await S(null==c?void 0:c.address,(0,w.vz)(e.stakeTokenAmount),BigInt(e.releasePeriod),t)}catch(e){console.error("Stake failed",e)}};(0,n.useEffect)(()=>{B&&(x.Am.success("质押成功"),Q.reset(),setTimeout(()=>{window.location.href="".concat("/interface","/gov?symbol=").concat(null==c?void 0:c.symbol)},2e3))},[B,Q,null==c?void 0:c.symbol]);let $=Q.watch("stakeTokenAmount");(0,n.useEffect)(()=>{let e=0n;try{e=(0,w.vz)($||"0")}catch(s){e=0n}e>0n&&D&&D>0n&&D>=e?_(!0):_(!1)},[$,D,W]);let{handleContractError:U}=(0,d.S)();return((0,n.useEffect)(()=>{G&&U(G,"stake"),R&&U(R,"token"),X&&U(X,"token"),M&&U(M,"stake")},[G,R,X,M]),L)?(0,r.jsx)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:(0,r.jsx)(u.Z,{})}):(0,r.jsxs)("div",{className:"w-full flex flex-col items-center pt-0 p-6",children:[(0,r.jsx)("div",{className:"w-full text-left mb-4",children:(0,r.jsx)(C.Z,{title:"质押增加治理收益"})}),(0,r.jsx)(j.l0,{...Q,children:(0,r.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"w-full max-w-md space-y-4",children:[(0,r.jsx)(j.Wi,{control:Q.control,name:"stakeTokenAmount",render:e=>{let{field:t}=e;return(0,r.jsxs)(j.xJ,{children:[(0,r.jsx)(j.lX,{className:"text-sm",children:"质押数："}),(0,r.jsx)(j.NI,{children:(0,r.jsx)(b.I,{type:"number",placeholder:"输入 ".concat(null==c?void 0:c.symbol," 数量"),className:"!ring-secondary-foreground",...t})}),(0,r.jsxs)(j.pf,{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{children:["持有 ",(0,r.jsx)("span",{className:"mr-2",children:(0,w.LH)(s)}),null==c?void 0:c.symbol]}),(0,r.jsx)(N.z,{variant:"link",size:"sm",type:"button",onClick:()=>{Q.setValue("stakeTokenAmount",(0,w.bM)(s||0n))},disabled:s<=0n,className:"text-secondary mr-2",children:"全部"})]}),(0,r.jsx)(j.zG,{})]})}}),(0,r.jsx)(j.Wi,{control:Q.control,name:"releasePeriod",render:e=>{let{field:s}=e;return(0,r.jsxs)(j.xJ,{children:[(0,r.jsx)(j.lX,{children:"解锁期："}),(0,r.jsx)(j.NI,{children:(0,r.jsxs)(y.Ph,{onValueChange:e=>s.onChange(e),value:s.value,children:[(0,r.jsx)(y.i4,{className:"w-full !ring-secondary-foreground",children:(0,r.jsx)(y.ki,{placeholder:"选择解锁期长度"})}),(0,r.jsx)(y.Bw,{children:Array.from({length:9},(e,s)=>s+4).filter(e=>e>=V).map(e=>(0,r.jsx)(y.Ql,{value:String(e),children:(0,k.Cn)(e)},e))})]})}),(0,r.jsx)(j.pf,{children:"提示：取消质押后，需等待解锁期过后才能取回代币"}),(0,r.jsx)(j.zG,{})]})}}),(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsx)(N.z,{ref:J,className:"w-1/2",disabled:W||T||P||m,onClick:()=>Q.handleSubmit(H)(),children:W?(0,r.jsx)(v.Z,{className:"animate-spin h-4 w-4"}):T?"1.授权中...":P?"1.确认中...":m?"1.".concat(null==c?void 0:c.symbol,"已授权"):"1.授权".concat(null==c?void 0:c.symbol)}),(0,r.jsx)(N.z,{className:"w-1/2",disabled:!m||F||I||B,onClick:()=>Q.handleSubmit(Y)(),children:F?"2.质押中...":I?"2.确认中...":B?"2.已质押":"2.质押"})]})]})}),(0,r.jsx)(Z.Z,{isLoading:T||P||F||I,text:T||F?"提交交易...":"确认交易..."})]})},z=t(77156),T=t(27460),P=t(34426);function E(){let{token:e}=(0,n.useContext)(i.M)||{},{address:s}=(0,l.m)(),{balance:t,isPending:a,error:o}=(0,z.hS)((null==e?void 0:e.stTokenAddress)||"",s||"0x0"),{handleContractError:c}=(0,d.S)();return((0,n.useEffect)(()=>{o&&c(o,"token")},[o]),null==e?void 0:e.stTokenAddress)?(0,r.jsx)("div",{className:"px-4 pt-0 pb-6",children:(0,r.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 text-sm mt-4",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("div",{className:"mr-2",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"font-bold text-2xl mr-2",children:["st",e.symbol]}),(0,r.jsx)(T.Z,{address:e.stTokenAddress}),(0,r.jsx)(P.Z,{tokenAddress:e.stTokenAddress,tokenSymbol:e.symbol||"",tokenDecimals:e.decimals||0})]})})}),(0,r.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,r.jsx)("span",{className:"text-sm text-greyscale-500 mr-1",children:"我持有:"}),(0,r.jsx)("span",{className:"text-sm text-secondary",children:a?(0,r.jsx)(u.Z,{}):(0,w.LH)(t||0n)})]})]})}):(0,r.jsx)(u.Z,{})}var R=()=>{let{token:e}=(0,n.useContext)(i.M)||{},{address:s}=(0,l.m)(),{balance:t}=(0,o.hS)(null==e?void 0:e.address,s),{tokenAmount:x,isPending:f,error:p}=(0,c.tT)(null==e?void 0:e.slTokenAddress),{handleContractError:h}=(0,d.S)();return(0,n.useEffect)(()=>{p&&h(p,"slToken")},[p]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{title:"质押代币"}),(0,r.jsxs)("main",{className:"flex-grow",children:[f&&(0,r.jsx)(u.Z,{}),!f&&!x&&(0,r.jsx)("div",{className:"flex justify-center items-center mt-10",children:"需要先质押流动性LP，才可以质押代币"}),x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E,{}),(0,r.jsx)(_,{tokenBalance:t||0n})]}),(0,r.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,r.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,r.jsx)(a.Z,{className:"w-4 h-4"}),"提示"]}),(0,r.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、质押代币可获得 加速激励"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的验证激励：当轮治理总激励 * 50% * 该地址行使验证权的治理票数 / 行使验权的治理票总数"}),(0,r.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"4、单个地址的加速激励：当轮治理总激励 * 50% * 该地址质押代币数量 / 质押代币总数量"}),(0,r.jsx)("div",{className:"text-sm text-blue-700",children:"5、溢出：单个地址的加速激励 超过投票激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})}}},function(e){e.O(0,[5828,2209,5974,7863,7380,4323,7224,1761,2888,9774,179],function(){return e(e.s=51906)}),_N_E=e.O()}]);