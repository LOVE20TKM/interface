(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6375],{2316:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/stakelp",function(){return r(88150)}])},4066:(e,t,r)=>{"use strict";r.d(t,{BN:()=>n,bD:()=>a,u$:()=>l,u3:()=>o});var s=r(20442),a=(e,t,r)=>{if(!e||!t)return"0%";var a=31536e5/Number("255"),n=BigInt("33784");if(0===a||0n===n)return console.error("配置错误: NEXT_PUBLIC_BLOCK_TIME 或 NEXT_PUBLIC_PHASE_BLOCKS 未设置"),"0%";var l=e?99n*e*99n/2000000n:BigInt(0),o=(2n*t||BigInt(0))+(r||BigInt(0));if(o===BigInt(0))return"0%";var i=Number(l)/Number(o)/(Number(n)/a)*100;return(0,s.Ee)(i)},n=(e,t)=>{if(!e||!t||0n===t)return"0%";var r=31536e5/Number("255"),a=BigInt("33784");if(0===r||0n===a)return console.error("配置错误: BLOCK_TIME 或 PHASE_BLOCKS 未设置或为0"),"0%";var n=Number(e)/Number(t)/(Number(a)/r)*100;return(0,s.Ee)(n)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Number("33784")||0,s=Number("255")||0,a=e*r,n=Math.ceil(Math.ceil(a*s/100)/86400),l="".concat(a.toLocaleString(),"区块，约").concat(n,"天");return t||(l="".concat(e,"个阶段（").concat(l,")")),l},o=(e,t)=>{if(!e)return BigInt(0);var r=100n-(BigInt("5")+BigInt("5"))/10n,s=BigInt(0);return t<=1n?e*BigInt("5")/1000n:e*r*BigInt("5")/100000n}},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876),a=r(7446);let n=()=>(0,s.jsx)(a.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},26269:(e,t,r)=>{"use strict";var s=r(99680),a={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,n,l,o,i,c,d,u,m=!1;t||(t={}),l=t.debug||!1;try{if(i=s(),c=document.createRange(),d=document.getSelection(),(u=document.createElement("span")).textContent=e,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),void 0===r.clipboardData){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var s=a[t.format]||a.default;window.clipboardData.setData(s,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))}),document.body.appendChild(u),c.selectNodeContents(u),d.addRange(c),!document.execCommand("copy"))throw Error("copy command was unsuccessful");m=!0}catch(s){l&&console.error("unable to copy using execCommand: ",s),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),m=!0}catch(s){l&&console.error("unable to copy using clipboardData: ",s),l&&console.error("falling back to prompt"),r="message"in t?t.message:"Copy to clipboard: #{key}, Enter",n=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C",o=r.replace(/#{\s*key\s*}/g,n),window.prompt(o,e)}}finally{d&&("function"==typeof d.removeRange?d.removeRange(c):d.removeAllRanges()),u&&document.body.removeChild(u),i()}return m}},28638:(e,t,r)=>{"use strict";r.d(t,{BT:()=>u,Wu:()=>m,ZB:()=>d,Zp:()=>i,aR:()=>c,wL:()=>p});var s=r(3576),a=r(65699),n=r(37876),l=r(14232),o=r(30684),i=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r)},l))});i.displayName="Card";var c=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r)},l))});c.displayName="CardHeader";var d=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r)},l))});d.displayName="CardTitle";var u=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r)},l))});u.displayName="CardDescription";var m=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("p-6 pt-0",r)},l))});m.displayName="CardContent";var p=l.forwardRef((e,t)=>{var r=e.className,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,s._)({ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r)},l))});p.displayName="CardFooter"},42038:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var s=r(97685),a=e=>!!e||(s.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},46852:(e,t,r)=>{"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var a=o(r(14232)),n=o(r(26269)),l=["text","onCopy","options","children"];function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&d(i,e);var t,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=m(i);return e=t?Reflect.construct(r,arguments,m(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];return p(u(e=o.call.apply(o,[this].concat(r))),"onClick",function(t){var r=e.props,s=r.text,l=r.onCopy,o=r.children,i=r.options,c=a.default.Children.only(o),d=(0,n.default)(s,i);l&&l(s,d),c&&c.props&&"function"==typeof c.props.onClick&&c.props.onClick(t)}),e}return r=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),r=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)r=n[s],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,l),s=a.default.Children.only(t);return a.default.cloneElement(s,c(c({},r),{},{onClick:this.onClick}))}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(a.default.PureComponent);t.CopyToClipboard=f,p(f,"defaultProps",{onCopy:void 0,options:void 0})},48447:(e,t,r)=>{"use strict";var s=r(46852).CopyToClipboard;s.CopyToClipboard=s,e.exports=s},70801:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var s=(0,r(11713).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},75695:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var s=r(16927),a=r(40854),n=r(4902),l=r(37876),o=r(14232),i=r(7446),c=r(95167),d=r(8047),u=r(44571),m=r(97685);function p(e){var t,r=e.tokenAddress,p=e.tokenSymbol,f=e.tokenDecimals,x=e.tokenImage,h=(0,a._)((0,o.useState)(!1),2),v=h[0],b=h[1],y=(0,d.F)().isConnected,g=(0,u.G)().data,N=(t=(0,s._)(function(){return(0,n.__generator)(this,function(e){switch(e.label){case 0:if(!y)return alert("请先连接你的钱包"),[2];b(!0),e.label=1;case 1:if(e.trys.push([1,3,4,5]),!g)return alert("无法获取钱包客户端"),[2];return[4,g.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:r,symbol:p,decimals:f,image:x}}})];case 2:return e.sent()?m.Ay.success("代币已成功添加到 MetaMask 钱包"):m.Ay.error("用户拒绝添加代币"),[3,5];case 3:return console.error("添加代币失败:",e.sent()),m.Ay.error("添加代币失败，请检查控制台以获取更多信息"),[3,5];case 4:return b(!1),[7];case 5:return[2]}})}),function(){return t.apply(this,arguments)});return(0,l.jsx)("button",{onClick:N,disabled:v,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:v?(0,l.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(c.A,{className:"h-4 w-4 text-greyscale-500"})})}},78256:(e,t,r)=>{"use strict";r.d(t,{bq:()=>x,eb:()=>y,gC:()=>b,l6:()=>p,yv:()=>f});var s=r(3576),a=r(62701),n=r(65699),l=r(37876),o=r(14232),i=r(760),c=r(30822),d=r(21575),u=r(33276),m=r(30684),p=i.bL;i.YJ;var f=i.WT,x=o.forwardRef((e,t)=>{var r=e.className,o=e.children,d=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.l9,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r)},d),{children:[o,(0,l.jsx)(i.In,{asChild:!0,children:(0,l.jsx)(c.A,{className:"h-4 w-4 opacity-50"})})]}))});x.displayName=i.l9.displayName;var h=o.forwardRef((e,t)=>{var r=e.className,o=(0,n._)(e,["className"]);return(0,l.jsx)(i.PP,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,l.jsx)(d.A,{className:"h-4 w-4"})}))});h.displayName=i.PP.displayName;var v=o.forwardRef((e,t)=>{var r=e.className,o=(0,n._)(e,["className"]);return(0,l.jsx)(i.wn,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",r)},o),{children:(0,l.jsx)(c.A,{className:"h-4 w-4"})}))});v.displayName=i.wn.displayName;var b=o.forwardRef((e,t)=>{var r=e.className,o=e.children,c=e.position,d=void 0===c?"popper":c,u=(0,n._)(e,["className","children","position"]);return(0,l.jsx)(i.ZL,{children:(0,l.jsxs)(i.UC,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:d},u),{children:[(0,l.jsx)(h,{}),(0,l.jsx)(i.LM,{className:(0,m.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),(0,l.jsx)(v,{})]}))})});b.displayName=i.UC.displayName,o.forwardRef((e,t)=>{var r=e.className,a=(0,n._)(e,["className"]);return(0,l.jsx)(i.JU,(0,s._)({ref:t,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r)},a))}).displayName=i.JU.displayName;var y=o.forwardRef((e,t)=>{var r=e.className,o=e.children,c=(0,n._)(e,["className","children"]);return(0,l.jsxs)(i.q7,(0,a._)((0,s._)({ref:t,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r)},c),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(i.VF,{children:(0,l.jsx)(u.A,{className:"h-4 w-4"})})}),(0,l.jsx)(i.p4,{children:o})]}))});y.displayName=i.q7.displayName,o.forwardRef((e,t)=>{var r=e.className,a=(0,n._)(e,["className"]);return(0,l.jsx)(i.wv,(0,s._)({ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",r)},a))}).displayName=i.wv.displayName},87577:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(40854),a=r(37876),n=r(14232),l=r(48447),o=r(33276),i=r(70801),c=r(97685),d=r(20442);let u=e=>{var t=e.address,r=e.word,u=e.showCopyButton,m=e.showAddress,p=void 0===m||m,f=e.colorClassName,x=void 0===f?"":f,h=e.colorClassName2,v=void 0===h?"":h,b=(0,s._)((0,n.useState)(!1),2),y=b[0],g=b[1];return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[r&&(0,a.jsx)("span",{className:"text-xs",children:r}),p&&!v&&(0,a.jsx)("span",{className:"text-xs ".concat(null!=x?x:"text-greyscale-500"),children:(0,d.W_)(t)}),p&&v&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"text-xs ".concat(null!=x?x:"text-greyscale-500"),children:"".concat(t.substring(0,6),"...")}),(0,a.jsx)("span",{className:"text-xs ".concat(v),children:"".concat(t.substring(t.length-4))})]}),(void 0===u||u)&&(0,a.jsx)(l.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?g(!0):c.Ay.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:y?(0,a.jsx)(o.A,{className:"h-4 w-4 ".concat(null!=x?x:"text-greyscale-500")}):(0,a.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=x?x:"text-greyscale-500")})})})]})}},88150:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>X});var s=r(37876),a=r(66663),n=r(8047),l=r(14232),o=r(20442),i=r(20451),c=r(19591),d=r(83416),u=r(75695),m=r(87577),p=r(12293);let f=e=>{var t=e.token,r=(0,n.F)().address,a=(0,l.useContext)(d.N)||{},f=a.token;a.setToken,a.clearToken;var x=t||f,h=(0,c.n3)(null==x?void 0:x.address,r),v=h.slAmount,b=h.govVotes,y=h.isPending,g=h.error,N=(0,i.g)().handleContractError;return((0,l.useEffect)(()=>{g&&N(g,"stake")},[g,N]),r)?!x||y?(0,s.jsx)(p.A,{}):y||v?(0,s.jsx)("div",{className:"flex-col items-center px-4 py-2 mb-4",children:(0,s.jsxs)("div",{className:"stats bg-gray-100  w-full grid grid-cols-[1fr_2fr] divide-x-0 pt-4",children:[(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,s.jsx)("div",{className:"stat-value text-xl",children:y?(0,s.jsx)(p.A,{}):(0,o.NJ)(b||0n,2)})]}),(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,s.jsx)(m.A,{address:x.slTokenAddress,showAddress:!1}),(0,s.jsx)(u.A,{tokenAddress:x.slTokenAddress,tokenSymbol:"sl"+x.symbol,tokenDecimals:x.decimals})]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:y?(0,s.jsx)(p.A,{}):(0,o.NJ)(v||0n,2)})]})]})}):(0,s.jsx)(s.Fragment,{}):(0,s.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})};var x=r(16927),h=r(40120),v=r(3576),b=r(62701),y=r(40854),g=r(4902),N=r(89099),j=r(48230),w=r.n(j),k=r(97685),_=r(60513),C=r(13810),T=r(88992),S=r(62212),A=(0,r(11713).A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),R=r(6960),E=r(92659),I=r(78256),P=r(77932),O=r(28638),B=r(42038),D=r(4066),F=r(25239),z=r(9215),L=r(52372),M=r(1709),J=r(99574);let V=e=>{(0,h._)(e);var t,r,a,u,m,f,j=function(){k.oR.success("质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my/?symbol=").concat(null==$?void 0:$.symbol)},2e3)},V=(0,n.F)(),X=V.address,W=V.chain,U=(0,l.useContext)(d.N);if(!U)throw Error("TokenContext 必须在 TokenProvider 内使用");var $=U.token,q=U.setToken,Z=U.clearToken,H=(0,F.q)().setError,K=(0,N.useRouter)().query.first,G=(0,L.ec)(X,null==$?void 0:$.address,null==$?void 0:$.parentTokenAddress),Y=G.pairInfo,Q=G.isPending,ee=G.error,et=null!=(t=null==Y?void 0:Y.balanceOfToken)?t:0n,er=null!=(r=null==Y?void 0:Y.balanceOfParentToken)?r:0n,es=null!=(a=null==Y?void 0:Y.allowanceOfToken)?a:0n,ea=null!=(u=null==Y?void 0:Y.allowanceOfParentToken)?u:0n,en=Y&&BigInt(Y.pairReserveToken)>0n&&BigInt(Y.pairReserveParentToken)>0n,el=(0,y._)((0,l.useState)(!1),2),eo=el[0],ei=el[1],ec=(0,c.CF)(null==$?void 0:$.address),ed=ec.initialStakeRound,eu=ec.isPending,em=ec.error,ep=(0,T.mN)({resolver:(0,C.u)((m=er||0n,f=et||0n,_.z.object({parentToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var t=e.replace(/。/g,".");return t.startsWith(".")&&(t="0"+t),t},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t>0n},"质押父币数不能为 0").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t<=m},"质押父币数不能超过当前持有")),stakeToken:_.z.preprocess(e=>{if("string"!=typeof e)return e;var t=e.replace(/。/g,".");return t.startsWith(".")&&(t="0"+t),t},_.z.string().regex(/^\d+(\.\d{1,18})?$/,"请输入合法数值，最多支持18位小数").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t>0n},"质押 token 数不能为 0").refine(e=>{var t=(0,o.XS)(e);return null!==t&&t<=f},"质押 token 数不能超过当前持有")),releasePeriod:_.z.string().min(1,"请选择解锁期")}))),defaultValues:{parentToken:"",stakeToken:"",releasePeriod:""},mode:"onChange"}),ef=(0,c.n3)(null==$?void 0:$.address,X),ex=(ef.govVotes,ef.promisedWaitingPhases),eh=ef.isPending,ev=ef.error,eb=(0,y._)((0,l.useState)(!1),2),ey=eb[0],eg=eb[1],eN=(0,y._)((0,l.useState)(!1),2),ej=eN[0],ew=eN[1],ek=(0,z.zH)(null==$?void 0:$.address),e_=ek.approve,eC=ek.isWriting,eT=ek.isConfirming,eS=ek.isConfirmed,eA=ek.writeError,eR=(0,z.zH)(null==$?void 0:$.parentTokenAddress),eE=eR.approve,eI=eR.isWriting,eP=eR.isConfirming,eO=eR.isConfirmed,eB=eR.writeError;function eD(){return(eD=(0,x._)(function(e){var t;return(0,g.__generator)(this,function(r){switch(r.label){case 0:if(!(0,B.C)(W))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(t=(0,o.XS)(e.stakeToken)))throw Error("无效的输入格式");return[4,e_("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t)];case 2:return r.sent(),[3,4];case 3:return console.error("Token 授权失败",r.sent()),k.oR.error("token 授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}function eF(){return(eF=(0,x._)(function(e){var t;return(0,g.__generator)(this,function(r){switch(r.label){case 0:if(!(0,B.C)(W))return[2];r.label=1;case 1:if(r.trys.push([1,3,,4]),null===(t=(0,o.XS)(e.parentToken)))throw Error("无效的输入格式");return[4,eE("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t)];case 2:return r.sent(),[3,4];case 3:return console.error("父币授权失败",r.sent()),k.oR.error("父币授权失败，请检查输入格式"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{eS&&(eg(!0),k.oR.success("授权".concat(null==$?void 0:$.symbol,"成功")))},[eS]),(0,l.useEffect)(()=>{eO&&(ew(!0),k.oR.success("授权".concat(null==$?void 0:$.parentTokenSymbol,"成功")))},[eO]);var ez=(0,y._)((0,l.useState)(!1),2),eL=ez[0],eM=ez[1],eJ=(0,y._)((0,l.useState)(!1),2),eV=eJ[0],eX=eJ[1],eW=ep.watch("parentToken"),eU=ep.watch("stakeToken"),e$=(0,o.XS)(eW),eq=(0,o.XS)(eU);(0,l.useEffect)(()=>{if(en&&eL&&null!==e$&&e$>0n){var e=e$*BigInt(Y.pairReserveToken)/BigInt(Y.pairReserveParentToken),t=Number((0,o.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ep.setValue("stakeToken",t),eM(!1),eX(!1)}},[en,eL,e$,Y,ep]),(0,l.useEffect)(()=>{if(en&&eV&&null!==eq&&eq>0n){var e=eq*BigInt(Y.pairReserveParentToken)/BigInt(Y.pairReserveToken),t=Number((0,o.Js)(e)).toFixed(12).replace(/\.?0+$/,"");ep.setValue("parentToken",t),eM(!1),eX(!1)}},[en,eV,eq,Y,ep]),(0,l.useEffect)(()=>{e$>0n&&ea>=e$?ew(!0):ew(!1)},[e$,ea]),(0,l.useEffect)(()=>{eq>0n&&es>=eq?eg(!0):eg(!1)},[eq,es]);var eZ=(0,c.E_)(),eH=eZ.stakeLiquidity,eK=eZ.isWriting,eG=eZ.isConfirming,eY=eZ.isConfirmed,eQ=eZ.writeError;function e0(){return(e0=(0,x._)(function(e){var t,r,s;return(0,g.__generator)(this,function(a){switch(a.label){case 0:if(!(0,B.C)(W))return[2];if(!(ey&&ej))return k.oR.error("请先完成授权"),[2];if(t=(0,o.XS)(e.stakeToken),r=(0,o.XS)(e.parentToken),null===t||null===r)return k.oR.error("转换金额时出错，请检查输入格式"),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,eH(null==$?void 0:$.address,t,r,BigInt(e.releasePeriod),X)];case 2:return a.sent(),[3,4];case 3:return console.error("Stake failed",s=a.sent()),e1(s,"stake"),[3,4];case 4:return[2]}})})).apply(this,arguments)}(0,l.useEffect)(()=>{eY&&((null==$?void 0:$.initialStakeRound)&&$.initialStakeRound>0?j():ei(!0))},[eY]),(0,l.useEffect)(()=>{eo&&!eu&&(ed||Z(),j())},[eo,eu]),(0,l.useEffect)(()=>{$&&0==$.initialStakeRound&&ed&&ed>0&&q((0,b._)((0,v._)({},$),{initialStakeRound:Number(ed)}))},[$,ed]);var e1=(0,i.g)().handleContractError;(0,l.useEffect)(()=>{ee&&e1(ee,"token"),eA&&e1(eA,"stake"),eB&&e1(eB,"stake"),eQ&&e1(eQ,"stake"),em&&e1(em,"stake"),ev&&e1(ev,"stake")},[ee,eA,eB,eQ,em,ev]);var e2=eC||eI,e4=eT||eP,e3=e2||e4||ey&&ej;(0,l.useEffect)(()=>{!$||"true"!==K||eu||ed||H({name:"提示：",message:"新部署的代币，需先质押获取治理票，才能后续操作"})},[$,K,eu,ed]),(0,l.useEffect)(()=>{Q||et||e3||!$||!$.symbol||H({name:"余额不足",message:"您当前".concat($.symbol,"数量为0，请先获取").concat($.symbol)}),Q||er||e3||!$||!$.parentTokenSymbol||H({name:"余额不足",message:"您当前".concat($.parentTokenSymbol,"数量为0，请先获取").concat($.parentTokenSymbol)})},[et,er,$,Q]);var e6=(0,l.useRef)(null),e5=(0,l.useRef)(eC);(0,l.useEffect)(()=>{if(e5.current&&!eC){var e;null==(e=e6.current)||e.blur()}e5.current=eC},[eC]);var e7=(0,y._)((0,l.useState)(!1),2),e8=e7[0],e9=e7[1];return!$||eh||eu?(0,s.jsx)(p.A,{}):(0,s.jsx)("div",{className:"bg-white px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md sm:max-w-lg md:max-w-2xl lg:max-w-full mx-auto space-y-4",children:[(0,s.jsx)("div",{className:"w-full flex justify-between items-center",children:(0,s.jsx)(M.A,{title:"质押获取治理票："})}),(0,s.jsx)(E.lV,(0,b._)((0,v._)({},ep),{children:(0,s.jsxs)("form",{onSubmit:ep.handleSubmit(function(e){return e0.apply(this,arguments)}),className:"space-y-3",children:[(0,s.jsx)(O.Zp,{children:(0,s.jsx)(O.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"第1步: 填写质押数量"}),(0,s.jsx)(w(),{href:"/dex/swap",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline transition-colors",children:"获取代币"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsx)(E.zB,{control:ep.control,name:"parentToken",render:e=>{var t=e.field;return(0,s.jsxs)(E.eI,{children:[(0,s.jsx)(O.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,s.jsxs)(O.Wu,{className:"py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(P.p,(0,b._)((0,v._)({type:"number",placeholder:"0"},t),{disabled:e3,onChange:e=>{t.onChange(e),eM(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors ",children:(0,s.jsx)("span",{className:"font-medium text-gray-800",children:null==$?void 0:$.parentTokenSymbol})})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,s.jsxs)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var t=er*BigInt(e)/100n;ep.setValue("parentToken",(0,o.Js)(t)),eM(!0)},disabled:e3||er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,s.jsx)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ep.setValue("parentToken",(0,o.Js)(er||0n)),eM(!0)},disabled:er<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,o.NJ)(er)," ",null==$?void 0:$.parentTokenSymbol]})]})]})}),(0,s.jsx)(E.C5,{})]})}}),(0,s.jsx)(E.zB,{control:ep.control,name:"stakeToken",render:e=>{var t=e.field;return(0,s.jsxs)(E.eI,{children:[(0,s.jsx)(O.Zp,{className:"bg-[#f7f8f9] border-none",children:(0,s.jsxs)(O.Wu,{className:"py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(P.p,(0,b._)((0,v._)({type:"number",placeholder:"0"},t),{disabled:et<=0n,onChange:e=>{t.onChange(e),eX(!0)},className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"})),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors",children:(0,s.jsx)("span",{className:"font-medium text-gray-800",children:null==$?void 0:$.symbol})})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[[25,50,75].map(e=>(0,s.jsxs)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{var t=et*BigInt(e)/100n;ep.setValue("stakeToken",(0,o.Js)(t)),eX(!0)},disabled:et<=0n,className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)),(0,s.jsx)(R.$,{variant:"outline",size:"sm",type:"button",onClick:()=>{ep.setValue("stakeToken",(0,o.Js)(et||0n)),eX(!0)},disabled:et<=0n,className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,o.NJ)(et)," ",null==$?void 0:$.symbol]})]})]})}),(0,s.jsx)(E.C5,{})]})}})]}),en&&(0,s.jsxs)("div",{className:"space-y-1 text-sm mt-2",children:[(0,s.jsxs)("div",{className:"text-gray-600 flex items-center gap-1",children:[(0,s.jsx)(S.A,{className:"w-4 h-4"}),"质押比例按当前价格计算："]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-gray-600",children:e8?(0,s.jsxs)(s.Fragment,{children:["1 ",null==$?void 0:$.symbol," ="," ",(0,o.NJ)(BigInt(Y.pairReserveParentToken)*BigInt(1e18)/BigInt(Y.pairReserveToken))," ",null==$?void 0:$.parentTokenSymbol]}):(0,s.jsxs)(s.Fragment,{children:["1 ",null==$?void 0:$.parentTokenSymbol," ="," ",(0,o.NJ)(BigInt(Y.pairReserveToken)*BigInt(1e18)/BigInt(Y.pairReserveParentToken))," ",null==$?void 0:$.symbol]})}),(0,s.jsx)(R.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>e9(!e8),className:"h-6 w-6 p-0 hover:bg-gray-100 transition-colors",title:"切换比例显示",children:(0,s.jsx)(A,{className:"h-3 w-3 text-gray-500"})})]})]})]})})}),(0,s.jsx)(O.Zp,{children:(0,s.jsx)(O.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第2步: 选择解锁期"})}),(0,s.jsx)(E.zB,{control:ep.control,name:"releasePeriod",render:e=>{var t=e.field;return(0,s.jsxs)(E.eI,{children:[(0,s.jsx)(E.MJ,{children:(0,s.jsxs)(I.l6,{onValueChange:e=>t.onChange(e),value:t.value,children:[(0,s.jsx)(I.bq,{className:"w-full !ring-secondary-foreground",children:(0,s.jsx)(I.yv,{placeholder:"选择解锁期"})}),(0,s.jsx)(I.gC,{children:Array.from({length:2},(e,t)=>t+1).filter(e=>e>=ex).map(e=>(0,s.jsx)(I.eb,{value:String(e),children:(0,D.u$)(e)},e))})]})}),(0,s.jsx)(E.Rr,{children:'"解锁期" 是指，取消质押后多久才能取回代币 (注意：是从取消质押的阶段结束时开始计算)'}),(0,s.jsx)(E.C5,{})]})}})]})})}),(0,s.jsx)(O.Zp,{children:(0,s.jsx)(O.Wu,{className:"p-3 md:p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"第3步: 授权并存入"})}),(0,s.jsxs)("div",{className:"flex justify-center lg:justify-start space-x-2",children:[(0,s.jsx)(R.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",ref:e6,disabled:eC||eT||ey,onClick:ep.handleSubmit(function(e){return eD.apply(this,arguments)}),children:eC?"1.提交中...":eT?"1.确认中...":ey?"1.".concat(null==$?void 0:$.symbol,"已授权"):"1.授权".concat(null==$?void 0:$.symbol)}),(0,s.jsx)(R.$,{type:"button",className:"flex-1 lg:w-auto lg:px-4",disabled:!ey||eI||eP||ej,onClick:ep.handleSubmit(function(e){return eF.apply(this,arguments)}),children:eI?"2.提交中...":eP?"2.确认中...":ej?"2.".concat(null==$?void 0:$.parentTokenSymbol,"已授权"):"2.授权".concat(null==$?void 0:$.parentTokenSymbol)}),(0,s.jsx)(R.$,{type:"submit",className:"flex-1 lg:w-auto lg:px-4",disabled:!ey||!ej||eK||eG||eY,children:eK?"3.提交中...":eG?"3.确认中...":eY?"3.已提交":"3.提交"})]})]})})})]})})),(0,s.jsx)(J.A,{isLoading:e2||e4||eK||eG||eu&&eo,text:e2||eK?"提交交易...":"确认交易..."})]})})},X=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.A,{title:"质押LP"}),(0,s.jsxs)("main",{className:"flex-grow",children:[(0,s.jsx)(f,{}),(0,s.jsx)(V,{}),(0,s.jsx)("div",{className:"flex flex-col w-full p-4",children:(0,s.jsxs)("div",{className:"bg-blue-50/30 border-l-4 border-l-blue-50 rounded-r-lg p-4 mb-8 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-base font-bold text-blue-800 pb-2",children:[(0,s.jsx)(S.A,{className:"w-4 h-4"}),"提示"]}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"SL代币："}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"代币对儿由质押合约注入 Uniswap V2 流动性池，并铸造SL代币作为流动性质押凭证"}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理票："}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"所得治理票数 = SL代币数量 * 解锁期阶段数"}),(0,s.jsx)("div",{className:"text-base font-bold text-blue-700 pt-2 pb-1",children:"治理激励："}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"1、当轮所得治理激励 = 验证激励 + 加速激励"}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"2、单个地址的验证激励：当轮治理总激励 * 50% * 该地址行使验证权的治理票数 / 行使验权的治理票总数"}),(0,s.jsx)("div",{className:"text-sm text-blue-700 pb-1",children:"3、单个地址的加速激励：当轮治理总激励 * 50% * 该地址质押代币数量 / 质押代币总数量"}),(0,s.jsx)("div",{className:"text-sm text-blue-700",children:"4、溢出：单个地址的加速激励 超过验证激励 2 倍以上的部分，为溢出激励，自动销毁，归入未来总激励"})]})})]})]})},92659:(e,t,r)=>{"use strict";r.d(t,{lV:()=>h,MJ:()=>w,Rr:()=>k,zB:()=>b,eI:()=>N,lR:()=>j,C5:()=>_});var s=r(81110),a=r(40120),n=r(3576),l=r(62701),o=r(65699),i=r(37876),c=r(14232),d=r(39358),u=r(88992),m=r(30684),p=r(49794),f=(0,r(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]);return(0,i.jsx)(p.b,(0,n._)({ref:t,className:(0,m.cn)(f(),r)},s))});x.displayName=p.b.displayName;var h=u.Op,v=c.createContext({}),b=e=>{var t=(0,s._)({},(0,a._)(e));return(0,i.jsx)(v.Provider,{value:{name:t.name},children:(0,i.jsx)(u.xI,(0,n._)({},t))})},y=()=>{var e=c.useContext(v),t=c.useContext(g),r=(0,u.xW)(),s=r.getFieldState,a=r.formState,l=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");var o=t.id;return(0,n._)({id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message")},l)},g=c.createContext({}),N=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=c.useId();return(0,i.jsx)(g.Provider,{value:{id:a},children:(0,i.jsx)("div",(0,n._)({ref:t,className:(0,m.cn)("space-y-2",r)},s))})});N.displayName="FormItem";var j=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=y(),l=a.error,c=a.formItemId;return(0,i.jsx)(x,(0,n._)({ref:t,className:(0,m.cn)(l&&"text-destructive",r),htmlFor:c},s))});j.displayName="FormLabel";var w=c.forwardRef((e,t)=>{var r=(0,s._)({},(0,a._)(e)),l=y(),o=l.error,c=l.formItemId,u=l.formDescriptionId,m=l.formMessageId;return(0,i.jsx)(d.DX,(0,n._)({ref:t,id:c,"aria-describedby":o?"".concat(u," ").concat(m):"".concat(u),"aria-invalid":!!o},r))});w.displayName="FormControl";var k=c.forwardRef((e,t)=>{var r=e.className,s=(0,o._)(e,["className"]),a=y().formDescriptionId;return(0,i.jsx)("p",(0,n._)({ref:t,id:a,className:(0,m.cn)("text-sm text-muted-foreground",r)},s))});k.displayName="FormDescription";var _=c.forwardRef((e,t)=>{var r=e.className,s=e.children,a=(0,o._)(e,["className","children"]),c=y(),d=c.error,u=c.formMessageId,p=d?String(null==d?void 0:d.message):s;return p?(0,i.jsx)("p",(0,l._)((0,n._)({ref:t,id:u,className:(0,m.cn)("text-sm font-medium text-destructive",r)},a),{children:p})):null});_.displayName="FormMessage"},95167:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var s=(0,r(11713).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},99574:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876);r(14232);var a=r(7446);let n=e=>{var t=e.isLoading,r=e.text;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===r?"Loading":r})]})}):null}},99680:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],s=0;s<e.rangeCount;s++)r.push(e.getRangeAt(s));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}}},e=>{var t=t=>e(e.s=t);e.O(0,[6869,4571,3921,2569,5139,5284,636,6593,8792],()=>t(2316)),_N_E=e.O()}]);