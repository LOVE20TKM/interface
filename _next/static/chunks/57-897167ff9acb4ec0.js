try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="30fa6eb7-d5f2-43e0-9dc5-4e9c970c32e6",e._sentryDebugIdIdentifier="sentry-dbid-30fa6eb7-d5f2-43e0-9dc5-4e9c970c32e6")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(e,s,t){var n=t(11010),r=t(91309),i=t(97582),a=t(85893),c=t(27245),l=t(86501),d=t(42130),o=t(67294),u=t(41664),m=t.n(u),x=t(74598),f=t(26858),h=t(99958),b=t(73591),y=t(92180),v=t(7080),g=t(77156),j=t(7224),p=t(85794),k=t(53696),N=t(42083),w=t(44576);s.Z=function(e){var s,t,u,C,B=e.token,I=e.enableWithdraw,E=void 0!==I&&I,T=e.onStakeStatusChange,A=(0,d.m)().address,_=(0,v.Bk)(),F=_.currentRound,D=_.isPending,Z=_.error,z=(0,y.L)(null==B?void 0:B.address,A),S=z.slAmount,P=z.stAmount,L=z.promisedWaitingPhases,J=z.requestedUnstakeRound,W=z.govVotes,G=z.isPending,H=z.error,K=function(){return!(!S||S<=BigInt(0))||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)},q=(0,p.yG)(null==B?void 0:B.slTokenAddress,A,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),R=q.allowance,V=q.isPending,Q=q.error,U=(0,p.yG)(null==B?void 0:B.stTokenAddress,A,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),M=U.allowance,O=U.isPending,X=U.error,Y=(0,y.Ty)((null==B?void 0:B.address)||"",A||""),$=Y.validGovVotes,ee=Y.isPending;Y.error;var es=(0,r._)((0,o.useState)(!1),2),et=es[0],en=es[1],er=(0,r._)((0,o.useState)(!1),2),ei=er[0],ea=er[1],ec=(0,g.yA)(null==B?void 0:B.stTokenAddress),el=ec.isPending,ed=ec.isConfirming,eo=ec.isConfirmed,eu=ec.writeError,em=ec.approve,ex=(0,j.yA)(null==B?void 0:B.slTokenAddress),ef=ex.isPending,eh=ex.isConfirming,eb=ex.isConfirmed,ey=ex.writeError,ev=ex.approve,eg=(s=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(S&&S>BigInt(0)&&!et))return[3,3];return[4,ev("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",S)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),ej=(t=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(P&&P>BigInt(0)&&!ei))return[3,3];return[4,em("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",P)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return console.error(e.sent()),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){eb?en(!0):S&&S>BigInt(0)&&R&&R>=S?en(!0):en(!1)},[S,R,V,eb]),(0,o.useEffect)(function(){eo?ea(!0):!P||P<=BigInt(0)?ea(!0):M&&M>=P?ea(!0):ea(!1)},[P,M,O,eo]);var ep=(0,y.vc)(),ek=ep.isWriting,eN=ep.isConfirming,ew=ep.isConfirmed,eC=ep.writeError,eB=ep.unstake,eI=(u=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eB(null==B?void 0:B.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){ew&&(l.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[ew]);var eE=(0,y.Qc)(),eT=eE.isWriting,eA=eE.isConfirming,e_=eE.isConfirmed,eF=eE.writeError,eD=eE.withdraw,eZ=(C=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eD(null==B?void 0:B.address)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})}),function(){return C.apply(this,arguments)});(0,o.useEffect)(function(){e_&&(l.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[e_]),(0,o.useEffect)(function(){T&&!G&&T(!!(S&&S>BigInt(0)))},[S,G,T]);var ez=(0,b.S)().handleContractError;if((0,o.useEffect)(function(){H&&ez(H,"stake"),eu&&ez(eu,"stToken"),ey&&ez(ey,"slToken"),eC&&ez(eC,"stake"),eF&&ez(eF,"stake"),Z&&ez(Z,"stake"),Q&&ez(Q,"slToken"),X&&ez(X,"stToken")},[H,eu,ey,eC,eF,Z,Q,X]),!A)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!B||E&&D||G)return(0,a.jsx)(N.Z,{});if(!G&&!S)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eS=ef||eh,eP=el||ed,eL=et&&ei,eJ=J&&F>J+(L||BigInt(0));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,a.jsx)("div",{className:"stat-value text-xl text-secondary",children:G?(0,a.jsx)(N.Z,{}):(0,f.LH)(W||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:J&&J>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,a.jsxs)("div",{className:"stat-value text-lg",children:[(0,a.jsx)("span",{className:"text-secondary",children:G?(0,a.jsx)(N.Z,{}):"".concat(L||BigInt(0)," ")}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,h.Cn)(Number(L||BigInt(0)),!0))})]})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,a.jsx)(k.Z,{tokenAddress:B.slTokenAddress,tokenSymbol:"sl"+B.symbol,tokenDecimals:B.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:G?(0,a.jsx)(N.Z,{}):(0,a.jsxs)(m(),{href:"/my/liquid?symbol=".concat(B.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,a.jsx)("span",{className:"cursor-pointer",children:(0,f.LH)(S||BigInt(0))}),(0,a.jsx)(x.Z,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/stake/stakelp/?symbol=".concat(B.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,a.jsx)(k.Z,{tokenAddress:B.stTokenAddress,tokenSymbol:"st"+B.symbol,tokenDecimals:B.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:G?(0,a.jsx)(N.Z,{}):(0,f.LH)(P||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/stake/staketoken?symbol=".concat(B.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),!ee&&!G&&void 0!==$&&void 0!==W&&$<=BigInt(0)&&W>BigInt(0)&&(0,a.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,a.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),E&&(0,a.jsxs)(a.Fragment,{children:[!J&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,a.jsx)(c.z,{className:"w-1/3",onClick:eg,disabled:eS||et,children:eS?"1.提交中...":eh?"1.确认中...":et?"1.sl".concat(null==B?void 0:B.symbol," 已授权"):"1.授权 sl".concat(null==B?void 0:B.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:ej,disabled:!et||eP||ei,children:eP?"2.提交中...":ed?"2.确认中...":ei?"2.st".concat(null==B?void 0:B.symbol," 已授权"):"2.授权 st".concat(null==B?void 0:B.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:eI,disabled:!eL||ek||eN||ew,children:ek?"3.提交中":eN?"3.确认中":ew?"3.已取消质押":"3.取消质押"})]}),(0,a.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,a.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,a.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,f.cK)(F,B)+(L||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),J&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,a.jsx)(c.z,{className:"w-1/2",onClick:eZ,disabled:!eJ||eT||eA||e_,children:eJ?eT?"提交中":eA?"确认中":e_?"已取回":"取回质押代币":"已取消,第"+((0,f.cK)(J,B)+(L||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!E&&(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/my/govrewards?symbol=".concat(B.symbol),children:"铸造 治理激励 >>"})}),J&&(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 ".concat(eJ?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eJ,asChild:!0,children:(0,a.jsx)(m(),{href:"/stake/unstake/?symbol=".concat(B.symbol),children:eJ?"取回质押代币":"已取消, 第"+((0,f.cK)(J,B)+(L||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,a.jsx)(w.Z,{isLoading:eS||eP||eT||ek||eA||eN,text:ef||el||eT||ek?"提交交易...":"确认交易..."})]})}}}]);