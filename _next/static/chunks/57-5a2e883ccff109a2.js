try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="255d46fc-91b5-41cc-8ce2-a1b00bf3c43f",e._sentryDebugIdIdentifier="sentry-dbid-255d46fc-91b5-41cc-8ce2-a1b00bf3c43f")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(e,s,t){var n=t(11010),r=t(91309),i=t(97582),a=t(85893),c=t(27245),l=t(86501),d=t(42130),o=t(67294),u=t(41664),m=t.n(u),x=t(74598),f=t(26858),h=t(99958),b=t(73591),y=t(92180),v=t(7080),g=t(77156),j=t(7224),p=t(85794),N=t(53696),k=t(27460),w=t(42083),C=t(44576);s.Z=function(e){var s,t,u,B,I=e.token,A=e.enableWithdraw,E=void 0!==A&&A,T=e.onStakeStatusChange,_=(0,d.m)().address,F=(0,v.Bk)(),Z=F.currentRound,D=F.isPending,z=F.error,S=(0,y.L)(null==I?void 0:I.address,_),P=S.slAmount,L=S.stAmount,J=S.promisedWaitingPhases,W=S.requestedUnstakeRound,G=S.govVotes,H=S.isPending,K=S.error,q=function(){return!(!P||P<=BigInt(0))||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)},R=(0,p.yG)(null==I?void 0:I.slTokenAddress,_,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),V=R.allowance,Q=R.isPending,U=R.error,M=(0,p.yG)(null==I?void 0:I.stTokenAddress,_,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),O=M.allowance,X=M.isPending,Y=M.error,$=(0,y.Ty)((null==I?void 0:I.address)||"",_||""),ee=$.validGovVotes,es=$.isPending;$.error;var et=(0,r._)((0,o.useState)(!1),2),en=et[0],er=et[1],ei=(0,r._)((0,o.useState)(!1),2),ea=ei[0],ec=ei[1],el=(0,g.yA)(null==I?void 0:I.stTokenAddress),ed=el.isPending,eo=el.isConfirming,eu=el.isConfirmed,em=el.writeError,ex=el.approve,ef=(0,j.yA)(null==I?void 0:I.slTokenAddress),eh=ef.isPending,eb=ef.isConfirming,ey=ef.isConfirmed,ev=ef.writeError,eg=ef.approve,ej=(s=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!q())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(P&&P>BigInt(0)&&!en))return[3,3];return[4,eg("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",P)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),ep=(t=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!q())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(L&&L>BigInt(0)&&!ea))return[3,3];return[4,ex("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",L)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){ey?er(!0):P&&P>BigInt(0)&&V&&V>=P?er(!0):er(!1)},[P,V,Q,ey]),(0,o.useEffect)(function(){eu?ec(!0):!L||L<=BigInt(0)?ec(!0):O&&O>=L?ec(!0):ec(!1)},[L,O,X,eu]);var eN=(0,y.vc)(),ek=eN.isWriting,ew=eN.isConfirming,eC=eN.isConfirmed,eB=eN.writeError,eI=eN.unstake,eA=(u=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eI(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){eC&&(l.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[eC]);var eE=(0,y.Qc)(),eT=eE.isWriting,e_=eE.isConfirming,eF=eE.isConfirmed,eZ=eE.writeError,eD=eE.withdraw,ez=(B=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eD(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return B.apply(this,arguments)});(0,o.useEffect)(function(){eF&&(l.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[eF]),(0,o.useEffect)(function(){T&&!H&&T(!!(P&&P>BigInt(0)))},[P,H,T]);var eS=(0,b.S)().handleContractError;if((0,o.useEffect)(function(){K&&eS(K,"stake"),em&&eS(em,"stToken"),ev&&eS(ev,"slToken"),eB&&eS(eB,"stake"),eZ&&eS(eZ,"stake"),z&&eS(z,"stake"),U&&eS(U,"slToken"),Y&&eS(Y,"stToken")},[K,em,ev,eB,eZ,z,U,Y]),!_)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!I||E&&D||H)return(0,a.jsx)(w.Z,{});if(!H&&!P)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eP=eh||eb,eL=ed||eo,eJ=en&&ea,eW=W&&Z>W+(J||BigInt(0));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,a.jsx)("div",{className:"stat-value text-xl text-secondary",children:H?(0,a.jsx)(w.Z,{}):(0,f.LH)(G||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:W&&W>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,a.jsxs)("div",{className:"stat-value text-lg",children:[(0,a.jsx)("span",{className:"text-secondary",children:H?(0,a.jsx)(w.Z,{}):"".concat(J||BigInt(0)," ")}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,h.Cn)(Number(J||BigInt(0)),!0))})]})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,a.jsx)(k.Z,{address:I.slTokenAddress,showAddress:!1}),(0,a.jsx)(N.Z,{tokenAddress:I.slTokenAddress,tokenSymbol:"sl"+I.symbol,tokenDecimals:I.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:H?(0,a.jsx)(w.Z,{}):(0,a.jsxs)(m(),{href:"/my/liquid?symbol=".concat(I.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,a.jsx)("span",{className:"cursor-pointer",children:(0,f.LH)(P||BigInt(0))}),(0,a.jsx)(x.Z,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/gov/stakelp/?symbol=".concat(I.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,a.jsx)(k.Z,{address:I.stTokenAddress,showAddress:!1}),(0,a.jsx)(N.Z,{tokenAddress:I.stTokenAddress,tokenSymbol:"st"+I.symbol,tokenDecimals:I.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:H?(0,a.jsx)(w.Z,{}):(0,f.LH)(L||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/gov/staketoken?symbol=".concat(I.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),!es&&!H&&void 0!==ee&&void 0!==G&&ee<=BigInt(0)&&G>BigInt(0)&&(0,a.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,a.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),E&&(0,a.jsxs)(a.Fragment,{children:[!W&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,a.jsx)(c.z,{className:"w-1/3",onClick:ej,disabled:eP||en,children:eP?"1.提交中...":eb?"1.确认中...":en?"1.sl".concat(null==I?void 0:I.symbol," 已授权"):"1.授权 sl".concat(null==I?void 0:I.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:ep,disabled:!en||eL||ea,children:eL?"2.提交中...":eo?"2.确认中...":ea?"2.st".concat(null==I?void 0:I.symbol," 已授权"):"2.授权 st".concat(null==I?void 0:I.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:eA,disabled:!eJ||ek||ew||eC,children:ek?"3.提交中":ew?"3.确认中":eC?"3.已取消质押":"3.取消质押"})]}),(0,a.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,a.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,a.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,f.cK)(Z,I)+(J||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),W&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,a.jsx)(c.z,{className:"w-1/2",onClick:ez,disabled:!eW||eT||e_||eF,children:eW?eT?"提交中":e_?"确认中":eF?"已取回":"取回质押代币":"已取消,第"+((0,f.cK)(W,I)+(J||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!E&&(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(m(),{href:"/my/govrewards?symbol=".concat(I.symbol),children:"铸造 治理激励 >>"})}),W&&(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 ".concat(eW?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eW,asChild:!0,children:(0,a.jsx)(m(),{href:"/gov/unstake/?symbol=".concat(I.symbol),children:eW?"取回质押代币":"已取消, 第"+((0,f.cK)(W,I)+(J||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,a.jsx)(C.Z,{isLoading:eP||eL||eT||ek||e_||ew,text:eh||ed||eT||ek?"提交交易...":"确认交易..."})]})}}}]);