try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3f23312c-c6f2-490e-947f-bc6424db2156",e._sentryDebugIdIdentifier="sentry-dbid-3f23312c-c6f2-490e-947f-bc6424db2156")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2112],{92112:function(e,n,t){t.d(n,{kz:function(){return p},YS:function(){return y}});var o=t(91309),r=t(67294),a=t(67516),s=t(58494),i=[{type:"function",name:"CENTER_ADDRESS",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"exists",inputs:[{name:"extension",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"extensionCreator",inputs:[{name:"extension",type:"address",internalType:"address"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"extensions",inputs:[],outputs:[{name:"",type:"address[]",internalType:"address[]"}],stateMutability:"view"},{type:"function",name:"extensionsAtIndex",inputs:[{name:"index",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"extensionsCount",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"event",name:"CreateExtension",inputs:[{name:"extension",type:"address",indexed:!0,internalType:"address"},{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"}],anonymous:!1}],d=t(18456),u=t(37541),l=t(92261);function c(e,n){return"".concat("love20:extension:contract:").concat(e.toLowerCase(),":").concat(n.toString())}function f(e,n,t,o,r,a,s,i,d){try{var u=c(e,n);localStorage.setItem(u,JSON.stringify({data:{extensionAddress:t,factoryAddress:o,factoryName:r,factoryType:a,joinedAmountTokenAddress:s,joinedAmountTokenIsLP:i,joinedAmountTokenSymbol:d}}))}catch(e){console.error("保存扩展合约信息缓存失败:",e)}}function v(e,n){try{var t=c(e,n);localStorage.removeItem(t),console.log("\uD83D\uDDD1️ 清除合约信息缓存: ActionId ".concat(n))}catch(e){console.error("清除扩展合约信息缓存失败:",e)}}var y=function(e){var n=e.tokenAddress,t=e.actionInfos,y=(0,o._)((0,r.useState)(0),2),p=y[0],m=y[1],h=(0,r.useMemo)(function(){if(!n||0===t.length)return{cachedData:new Map,uncachedActionInfos:[]};var e=new Map,o=[],r=!0,a=!1,s=void 0;try{for(var i,d=t[Symbol.iterator]();!(r=(i=d.next()).done);r=!0){var u=i.value,f=u.head.id,y=function(e,n){try{var t=c(e,n),o=localStorage.getItem(t);if(!o)return null;return JSON.parse(o)}catch(e){return console.error("读取扩展合约信息缓存失败:",e),null}}(n,f);if(y){var p="0x0000000000000000000000000000000000000000"===y.data.extensionAddress;if(!p&&!y.data.factoryAddress){console.log("⚠️ ActionId ".concat(f," 合约信息缓存不完整（缺少factory），清除缓存重新查询")),v(n,f),o.push(u);continue}if(!p&&void 0===y.data.joinedAmountTokenAddress){console.log("⚠️ ActionId ".concat(f," 合约信息缓存缺少 joinedAmountTokenAddress，清除缓存重新查询")),v(n,f),o.push(u);continue}if(!p&&void 0===y.data.joinedAmountTokenSymbol){console.log("⚠️ ActionId ".concat(f," 合约信息缓存缺少 joinedAmountTokenSymbol，清除缓存重新查询")),v(n,f),o.push(u);continue}e.set(f,{actionId:f,isExtension:!p,factory:p?void 0:{type:y.data.factoryType||l.nw.LP,name:y.data.factoryName||"未知类型",address:y.data.factoryAddress},extension:p?void 0:y.data.extensionAddress,joinedAmountTokenAddress:!p&&y.data.joinedAmountTokenAddress?y.data.joinedAmountTokenAddress:void 0,joinedAmountTokenIsLP:p?void 0:y.data.joinedAmountTokenIsLP,joinedAmountTokenSymbol:p?void 0:y.data.joinedAmountTokenSymbol})}else o.push(u)}}catch(e){a=!0,s=e}finally{try{r||null==d.return||d.return()}finally{if(a)throw s}}return{cachedData:e,uncachedActionInfos:o}},[n,t,p]),g=h.cachedData,b=h.uncachedActionInfos,x=(0,r.useMemo)(function(){if(!n||0===b.length)return{validWhitelistInfos:[],factoryContracts:[]};var e=[],t=[],o=!0,r=!1,a=void 0;try{for(var i,d=b[Symbol.iterator]();!(o=(i=d.next()).done);o=!0){var u=i.value,l=u.body.whiteListAddress;l&&"0x0000000000000000000000000000000000000000"!==l&&(e.push({actionInfo:u,whitelistAddress:l}),t.push({address:l,abi:s.U,functionName:"FACTORY_ADDRESS",args:[]}))}}catch(e){r=!0,a=e}finally{try{o||null==d.return||d.return()}finally{if(r)throw a}}return{validWhitelistInfos:e,factoryContracts:t}},[n,b]),A=x.validWhitelistInfos,k=x.factoryContracts,I=(0,a.N)({contracts:k,query:{enabled:!!n&&k.length>0}}),w=I.data,T=I.isPending,M=I.error,N=(0,r.useMemo)(function(){if(!w||0===w.length)return[];for(var e=new Set((0,l.kR)().map(function(e){return e.factoryAddress.toLowerCase()})),n=[],t=0;t<w.length;t++){var o,r=null===(o=w[t])||void 0===o?void 0:o.result,a=A[t];r&&e.has(r.toLowerCase())&&n.push({address:r,abi:i,functionName:"exists",args:[a.whitelistAddress]})}return n},[w,A]),S=(0,a.N)({contracts:N,query:{enabled:N.length>0}}),C=S.data,j=S.isPending,L=S.error,D=(0,r.useMemo)(function(){if(!C||0===C.length||!w)return[];for(var e=new Set((0,l.kR)().map(function(e){return e.factoryAddress.toLowerCase()})),n=[],t=0,o=0;o<w.length;o++){var r,a,i=null===(r=w[o])||void 0===r?void 0:r.result,d=A[o];if(i&&e.has(i.toLowerCase())){var u=null===(a=C[t])||void 0===a?void 0:a.result;t++,!0===u&&d.whitelistAddress&&n.push({address:d.whitelistAddress,abi:s.U,functionName:"joinedAmountTokenAddress",args:[]})}}return n},[C,w,A]),P=(0,a.N)({contracts:D,query:{enabled:D.length>0}}),E=P.data,_=P.isPending,O=P.error,q=(0,r.useMemo)(function(){if(!E||0===E.length)return[];for(var e=[],n=0;n<E.length;n++){var t,o=null===(t=E[n])||void 0===t?void 0:t.result;o&&"0x0000000000000000000000000000000000000000"!==o&&e.push({address:o,abi:d.y,functionName:"factory",args:[]})}return e},[E]),R=(0,a.N)({contracts:q,query:{enabled:q.length>0}}),W=R.data,U=R.isPending,Z=R.error,K=(0,r.useMemo)(function(){var e=new Map,n=new Map;if(!E||!W)return{joinedTokenNonZeroIndexMap:e,lpTokenIndexMap:n};var t="0x0ce7aa2069d92de630aff1b6b512f5e47af6ffc8";if(!t)return{joinedTokenNonZeroIndexMap:e,lpTokenIndexMap:n};var o=0,r=0;return E.forEach(function(a,s){var i=null==a?void 0:a.result;if(i&&"0x0000000000000000000000000000000000000000"!==i){e.set(s,o);var d=null==W?void 0:W[o];(null==d?void 0:d.status)==="success"&&d.result&&d.result.toLowerCase()===t&&(n.set(s,r),r++),o++}}),{joinedTokenNonZeroIndexMap:e,lpTokenIndexMap:n}},[E,W]),z=(K.joinedTokenNonZeroIndexMap,K.lpTokenIndexMap),J=(0,r.useMemo)(function(){if(!E||0===z.size)return[];var e=[];return E.forEach(function(n,t){if(void 0!==z.get(t)){var o=null==n?void 0:n.result;o&&"0x0000000000000000000000000000000000000000"!==o&&(e.push({address:o,abi:d.y,functionName:"token0",args:[]}),e.push({address:o,abi:d.y,functionName:"token1",args:[]}))}}),e},[E,z]),Y=(0,a.N)({contracts:J,query:{enabled:J.length>0}}),F=Y.data,B=Y.isPending,G=Y.error,H=(0,r.useMemo)(function(){if(!E)return{tokenSymbolContracts:[],lpSymbolIndexMap:new Map,nonLpSymbolIndexMap:new Map};var e=[],n=new Map,t=new Map,o=0;return E.forEach(function(r,a){var s=null==r?void 0:r.result;if(s&&"0x0000000000000000000000000000000000000000"!==s){var i=z.get(a);if(void 0!==i){var d=null==F?void 0:F[2*i],l=null==F?void 0:F[2*i+1],c=(null==d?void 0:d.status)==="success"?d.result:void 0,f=(null==l?void 0:l.status)==="success"?l.result:void 0,v={};c&&(e.push({address:c,abi:u.O,functionName:"symbol",args:[]}),v.token0=o,o++),f&&(e.push({address:f,abi:u.O,functionName:"symbol",args:[]}),v.token1=o,o++),(void 0!==v.token0||void 0!==v.token1)&&n.set(a,v)}else e.push({address:s,abi:u.O,functionName:"symbol",args:[]}),t.set(a,o),o++}}),{tokenSymbolContracts:e,lpSymbolIndexMap:n,nonLpSymbolIndexMap:t}},[E,z,F]),Q=H.tokenSymbolContracts,V=H.lpSymbolIndexMap,X=H.nonLpSymbolIndexMap,$=(0,a.N)({contracts:Q,query:{enabled:Q.length>0}}),ee=$.data,en=$.isPending,et=$.error;return(0,r.useEffect)(function(){if(n&&0!==b.length&&(!(k.length>0)||!T)&&(!(N.length>0)||!j)&&(!(D.length>0)||!_)&&(!(q.length>0)||!U)&&(!(J.length>0)||!B)&&(!(Q.length>0)||!en)){var e=new Set((0,l.kR)().map(function(e){return e.factoryAddress.toLowerCase()})),t="0x0ce7aa2069d92de630aff1b6b512f5e47af6ffc8",o=0,r=0,a=0,s=0,i=0,d=!0,u=!1,c=void 0;try{for(var v,y=b[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var p,h,g=v.value,x=g.head.id,A=g.body.whiteListAddress;if(!A||"0x0000000000000000000000000000000000000000"===A){f(n,x,"0x0000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000","","",void 0,void 0,void 0),o++;continue}var I=null==w?void 0:null===(p=w[r])||void 0===p?void 0:p.result;if(r++,!I||!e.has(I.toLowerCase())){f(n,x,"0x0000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000","","",void 0,void 0,void 0),o++;continue}var M=null==C?void 0:null===(h=C[a])||void 0===h?void 0:h.result;if(a++,!0!==M){f(n,x,"0x0000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000","","",void 0,void 0,void 0),o++;continue}var S=(0,l.qD)(I),L=(null==S?void 0:S.name)||"未知类型",P=(null==S?void 0:S.type)||l.nw.LP,O=null==E?void 0:E[s];if(!O||"success"!==O.status){console.warn("⚠️ ActionId ".concat(x," 的 joinedAmountTokenAddress 查询失败，跳过缓存")),s++;continue}var R=O.result;s++;var Z=!1;if(R&&"0x0000000000000000000000000000000000000000"!==R&&t){var K=null==W?void 0:W[i];K&&"success"===K.status&&K.result&&K.result.toLowerCase()===t&&(Z=!0),i++}var z="UNKNOWN";if(R&&"0x0000000000000000000000000000000000000000"!==R){if(Z){var Y=V.get(s-1);if(Y){var F=void 0!==Y.token0?null==ee?void 0:ee[Y.token0]:void 0,G=void 0!==Y.token1?null==ee?void 0:ee[Y.token1]:void 0,H=(null==F?void 0:F.status)==="success"&&F.result?F.result:"UNKNOWN",$=(null==G?void 0:G.status)==="success"&&G.result?G.result:"UNKNOWN";z="LP(".concat(H,",").concat($,")")}}else{var et=X.get(s-1);if(void 0!==et){var eo=null==ee?void 0:ee[et];(null==eo?void 0:eo.status)==="success"&&eo.result&&(z=eo.result)}}}f(n,x,A,I,L,P,R,Z,z),o++}}catch(e){u=!0,c=e}finally{try{d||null==y.return||y.return()}finally{if(u)throw c}}o>0&&(console.log("✅ 成功缓存 ".concat(o," 个扩展合约信息（含 joinedAmountTokenSymbol）")),m(function(e){return e+1}))}},[n,b,k,N,D,q,J,Q,w,C,E,W,F,ee,V,X,T,j,_,U,B,en]),{contractInfos:(0,r.useMemo)(function(){var e=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var i=a.value.head.id,d=g.get(i);if(d){e.push(d);continue}e.push({actionId:i,isExtension:!1})}}catch(e){o=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}return e},[t,g]),isPending:b.length>0&&(k.length>0&&T||N.length>0&&j||D.length>0&&_||q.length>0&&U||J.length>0&&B||Q.length>0&&en),error:M||L||O||Z||G||et}},p=function(e){var n=e.tokenAddress,t=e.actionInfo,o=y({tokenAddress:n,actionInfos:(0,r.useMemo)(function(){return void 0!==t?[t]:[]},[t])}),a=o.contractInfos,s=o.isPending,i=o.error;return{contractInfo:(0,r.useMemo)(function(){if(void 0!==t)return a.find(function(e){return e.actionId===t.head.id})},[a,t]),isPending:s,error:i}}}}]);