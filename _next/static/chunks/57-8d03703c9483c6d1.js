"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{44576:function(e,t,n){var s=n(85893);n(67294);var a=n(23432);t.Z=e=>{let{isLoading:t,text:n="Loading"}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:n})]})}):null}},40057:function(e,t,n){var s=n(85893),a=n(27245),i=n(86501),r=n(92321),l=n(67294),d=n(41664),o=n.n(d),c=n(48105),u=n(91529),m=n(99958),y=n(67068),p=n(92180),x=n(77156),b=n(7224),f=n(19638),v=n(34426),h=n(27460),T=n(42083),j=n(44576);t.Z=e=>{let{token:t,enableWithdraw:n=!1}=e,{address:d,chain:N}=(0,r.m)(),{currentRound:g,isPending:A,error:w}=(0,p.Bk)(n),{slAmount:k,stAmount:C,promisedWaitingPhases:B,requestedUnstakeRound:M,govVotes:S,isPending:E,error:I}=(0,p.L)(null==t?void 0:t.address,d),L=()=>!!(0,c.S)(N)&&(!!k&&!(k<=0n)||(i.Am.error("流动性质押数量为0，不用取消质押"),!1)),{allowance:_,isPending:Z,error:F}=(0,f.yG)(null==t?void 0:t.slTokenAddress,d,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",n),{allowance:P,isPending:z,error:K}=(0,f.yG)(null==t?void 0:t.stTokenAddress,d,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",n),{validGovVotes:O,isPending:H,error:G}=(0,p.Ty)((null==t?void 0:t.address)||"",d||""),[D,U]=(0,l.useState)(!1),[V,W]=(0,l.useState)(!1),{isPending:X,isConfirming:$,isConfirmed:Q,error:R,approve:q}=(0,x.yA)(null==t?void 0:t.stTokenAddress),{isPending:J,isConfirming:Y,isConfirmed:ee,error:et,approve:en}=(0,b.yA)(null==t?void 0:t.slTokenAddress),es=async()=>{if(L())try{k&&k>0n&&!D&&await en("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",k)}catch(e){console.error(e)}},ea=async()=>{if(L())try{C&&C>0n&&!V&&await q("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",C)}catch(e){console.error(e)}};(0,l.useEffect)(()=>{ee?U(!0):k&&k>0n&&_&&_>=k?U(!0):U(!1)},[k,_,Z,ee]),(0,l.useEffect)(()=>{Q?W(!0):!C||C<=0n?W(!0):P&&P>=C?W(!0):W(!1)},[C,P,z,Q]);let{isWriting:ei,isConfirming:er,isConfirmed:el,writeError:ed,unstake:eo}=(0,p.vc)(),ec=async()=>{try{await eo(null==t?void 0:t.address)}catch(e){console.error(e)}};(0,l.useEffect)(()=>{el&&(i.Am.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==t?void 0:t.symbol)},2e3))},[el]);let{isWriting:eu,isConfirming:em,isConfirmed:ey,writeError:ep,withdraw:ex}=(0,p.Qc)(),eb=async()=>{try{await ex(null==t?void 0:t.address)}catch(e){console.error(e)}};(0,l.useEffect)(()=>{ey&&(i.Am.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==t?void 0:t.symbol)},2e3))},[ey]);let{handleContractError:ef}=(0,y.S)();if((0,l.useEffect)(()=>{I&&ef(I,"stake"),R&&ef(R,"stToken"),et&&ef(et,"slToken"),ed&&ef(ed,"stake"),ep&&ef(ep,"stake"),w&&ef(w,"stake"),F&&ef(F,"slToken"),K&&ef(K,"stToken")},[I,R,et,ed,ep,w,F,K]),!d)return(0,s.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!t||n&&A||E)return(0,s.jsx)(T.Z,{});if(!E&&!k)return(0,s.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});let ev=J||Y,eh=X||$,eT=D&&V,ej=n&&M&&g>M+(B||BigInt(0));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,s.jsx)("div",{className:"stat-value text-xl",children:E?(0,s.jsx)(T.Z,{}):(0,u.LH)(S||0n,2)}),(0,s.jsx)("div",{className:"stat-desc text-xs my-2",children:"注意：解锁期内治理票数为0"})]}),(0,s.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,s.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,s.jsxs)("div",{className:"stat-value text-lg",children:[E?(0,s.jsx)(T.Z,{}):"".concat(B||0n," "),(0,s.jsx)("span",{className:"text-sm",children:" 阶段"})]}),(0,s.jsx)("div",{className:"stat-desc text-xs my-2",children:"".concat((0,m.Cn)(Number(B||0n),!0))})]})]}),(0,s.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,s.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,s.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押sl",t.symbol,(0,s.jsx)(h.Z,{address:t.slTokenAddress,showAddress:!1}),(0,s.jsx)(v.Z,{tokenAddress:t.slTokenAddress,tokenSymbol:"sl"+t.symbol,tokenDecimals:t.decimals})]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:E?(0,s.jsx)(T.Z,{}):(0,u.LH)(k||0n,2)}),(0,s.jsx)("div",{className:"stat-desc text-xs",children:(0,s.jsx)(a.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,s.jsx)(o(),{href:"/gov/stakelp/?symbol=".concat(t.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,s.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,s.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["质押代币st",t.symbol,(0,s.jsx)(h.Z,{address:t.stTokenAddress,showAddress:!1}),(0,s.jsx)(v.Z,{tokenAddress:t.stTokenAddress,tokenSymbol:"st"+t.symbol,tokenDecimals:t.decimals})]}),(0,s.jsx)("div",{className:"stat-value text-xl",children:E?(0,s.jsx)(T.Z,{}):(0,u.LH)(C||0n,2)}),(0,s.jsx)("div",{className:"stat-desc text-xs",children:(0,s.jsx)(a.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,s.jsx)(o(),{href:"/gov/staketoken?symbol=".concat(t.symbol),children:"质押 增加收益\xa0>>"})})})]})]}),(0,s.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:O<=0n&&S&&S>0n&&(0,s.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),n&&(0,s.jsxs)(s.Fragment,{children:[!M&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,s.jsx)(a.z,{className:"w-1/3",onClick:es,disabled:ev||D,children:ev?"1.提交中...":Y?"1.确认中...":D?"1.sl".concat(null==t?void 0:t.symbol," 已授权"):"1.授权 sl".concat(null==t?void 0:t.symbol)}),(0,s.jsx)(a.z,{className:"w-1/3",onClick:ea,disabled:!D||eh||V,children:eh?"2.提交中...":$?"2.确认中...":V?"2.st".concat(null==t?void 0:t.symbol," 已授权"):"2.授权 st".concat(null==t?void 0:t.symbol)}),(0,s.jsx)(a.z,{className:"w-1/3",onClick:ec,disabled:!eT||ei||er||el,children:ei?"3.提交中":er?"3.确认中":el?"3.已取消质押":"3.取消质押"})]}),(0,s.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,s.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,s.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,u.cK)(g,t)+(B||0n)+1n," ")}),"轮才能取回代币）"]})]}),M&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,s.jsx)(a.z,{className:"w-1/2",onClick:eb,disabled:!ej||eu||em||ey,children:ej?eu?"提交中":em?"确认中":ey?"已取回":"取回质押代币":"已取消,第"+((0,u.cK)(M,t)+(B||0n)+1n)+"轮才可取回"})})})]}),!n&&(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,s.jsx)(a.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(o(),{href:"/my/govrewards?symbol=".concat(t.symbol),children:"查看奖励"})}),M&&(0,s.jsx)(a.z,{variant:"outline",className:"w-1/2 ".concat(ej?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!ej,asChild:!0,children:(0,s.jsx)(o(),{href:"/gov/unstake/?symbol=".concat(t.symbol),children:ej?"取回质押代币":"已取消, 第"+((0,u.cK)(M,t)+(B||0n)+1n)+"轮可取回"})}),!M&&(0,s.jsx)(a.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(o(),{href:"/gov/?symbol=".concat(t.symbol),children:"社区治理"})})]}),(0,s.jsx)(j.Z,{isLoading:ev||eh||eu||ei||em||er,text:J||X||eu||ei?"提交交易...":"确认交易..."})]})}},77156:function(e,t,n){n.d(t,{yA:function(){return d},hS:function(){return l}});var s=n(89810),a=n(71366),i=n(83540);let r=[{type:"constructor",inputs:[{name:"minter_",type:"address",internalType:"address"},{name:"tokenAddress_",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"allowance",inputs:[{name:"owner",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"balanceOf",inputs:[{name:"account",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"burn",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"decimals",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"decreaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"subtractedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"increaseAllowance",inputs:[{name:"spender",type:"address",internalType:"address"},{name:"addedValue",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"mint",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"minter",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"reserve",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"tokenAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"totalSupply",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transfer",inputs:[{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"transferFrom",inputs:[{name:"from",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"event",name:"Approval",inputs:[{name:"owner",type:"address",indexed:!0,internalType:"address"},{name:"spender",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenBurn",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenMint",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Transfer",inputs:[{name:"from",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AmountIsGreaterThanReserve",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"NotEligibleToMint",inputs:[]}],l=(e,t)=>{let{data:n,isPending:a,error:i}=(0,s.u)({address:e,abi:r,functionName:"balanceOf",args:[t]});return{balance:n,isPending:a,error:i}},d=e=>{let{writeContract:t,data:n,isPending:s,error:l}=(0,a.S)(),d=async(n,s)=>{try{await t({address:e,abi:r,functionName:"approve",args:[n,s]})}catch(e){console.error("Approve failed:",e)}},{isLoading:o,isSuccess:c}=(0,i.A)({hash:n});return{approve:d,writeData:n,isPending:s,error:l,isConfirming:o,isConfirmed:c}}},99958:function(e,t,n){n.d(t,{Cn:function(){return i},IS:function(){return s},Tn:function(){return a}});let s=(e,t,n)=>{if(!e||!t)return"0%";let s=31536e5/Number("255"),a=BigInt("33784");if(0===s||0n===a)return console.error("配置错误: NEXT_PUBLIC_BLOCK_TIME 或 NEXT_PUBLIC_PHASE_BLOCKS 未设置"),"0%";let i=e?99n*e*99n/2000000n:BigInt(0),r=(2n*t||BigInt(0))+(n||BigInt(0));if(r===BigInt(0))return"0%";let l=Number(i)/Number(r)/(Number(a)/s)*100;return"".concat(l.toFixed(2).replace(/\.?0+$/,""),"%")},a=(e,t)=>{if(!e||!t||0n===t)return"0%";let n=31536e5/Number("255"),s=BigInt("33784");if(0===n||0n===s)return console.error("配置错误: BLOCK_TIME 或 PHASE_BLOCKS 未设置或为0"),"0%";let a=Number(e)/Number(t)/(Number(s)/n)*100;return"".concat(a.toFixed(2).replace(/\.?0+$/,""),"%")},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Number("33784")||0,s=Number("255")||0,a=e*n,i="".concat(a.toLocaleString(),"区块，约").concat(Math.ceil(Math.ceil(a*s/100)/86400),"天");return t||(i="".concat(e,"个阶段（").concat(i,")")),i}},48105:function(e,t,n){n.d(t,{S:function(){return a}});var s=n(86501);let a=e=>!!e||(s.Am.error("请先将钱包链接 ".concat("thinkium801")),!1)}}]);