try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="d38834a4-2f0a-406e-b3b0-2055faa31bf3",e._sentryDebugIdIdentifier="sentry-dbid-d38834a4-2f0a-406e-b3b0-2055faa31bf3")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(e,s,t){var n=t(11010),r=t(91309),a=t(97582),i=t(85893),c=t(27245),l=t(86501),d=t(42130),o=t(67294),u=t(41664),x=t.n(u),m=t(91529),f=t(99958),h=t(73591),b=t(92180),v=t(7080),y=t(77156),g=t(7224),j=t(85794),p=t(34426),k=t(27460),N=t(42083),w=t(44576);s.Z=function(e){var s,t,u,C,B=e.token,I=e.enableWithdraw,A=void 0!==I&&I,E=e.onStakeStatusChange,T=(0,d.m)().address,_=(0,v.Bk)(),F=_.currentRound,Z=_.isPending,D=_.error,S=(0,b.L)(null==B?void 0:B.address,T),z=S.slAmount,P=S.stAmount,L=S.promisedWaitingPhases,J=S.requestedUnstakeRound,W=S.govVotes,G=S.isPending,H=S.error,K=function(){return!(!z||z<=BigInt(0))||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)},R=(0,j.yG)(null==B?void 0:B.slTokenAddress,T,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",A),V=R.allowance,q=R.isPending,Q=R.error,U=(0,j.yG)(null==B?void 0:B.stTokenAddress,T,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",A),M=U.allowance,O=U.isPending,X=U.error,Y=(0,b.Ty)((null==B?void 0:B.address)||"",T||""),$=Y.validGovVotes;Y.isPending,Y.error;var ee=(0,r._)((0,o.useState)(!1),2),es=ee[0],et=ee[1],en=(0,r._)((0,o.useState)(!1),2),er=en[0],ea=en[1],ei=(0,y.yA)(null==B?void 0:B.stTokenAddress),ec=ei.isPending,el=ei.isConfirming,ed=ei.isConfirmed,eo=ei.writeError,eu=ei.approve,ex=(0,g.yA)(null==B?void 0:B.slTokenAddress),em=ex.isPending,ef=ex.isConfirming,eh=ex.isConfirmed,eb=ex.writeError,ev=ex.approve,ey=(s=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(z&&z>BigInt(0)&&!es))return[3,3];return[4,ev("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",z)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),eg=(t=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(P&&P>BigInt(0)&&!er))return[3,3];return[4,eu("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",P)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){eh?et(!0):z&&z>BigInt(0)&&V&&V>=z?et(!0):et(!1)},[z,V,q,eh]),(0,o.useEffect)(function(){ed?ea(!0):!P||P<=BigInt(0)?ea(!0):M&&M>=P?ea(!0):ea(!1)},[P,M,O,ed]);var ej=(0,b.vc)(),ep=ej.isWriting,ek=ej.isConfirming,eN=ej.isConfirmed,ew=ej.writeError,eC=ej.unstake,eB=(u=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eC(null==B?void 0:B.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){eN&&(l.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[eN]);var eI=(0,b.Qc)(),eA=eI.isWriting,eE=eI.isConfirming,eT=eI.isConfirmed,e_=eI.writeError,eF=eI.withdraw,eZ=(C=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eF(null==B?void 0:B.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return C.apply(this,arguments)});(0,o.useEffect)(function(){eT&&(l.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[eT]),(0,o.useEffect)(function(){E&&!G&&E(!!(z&&z>BigInt(0)))},[z,G,E]);var eD=(0,h.S)().handleContractError;if((0,o.useEffect)(function(){H&&eD(H,"stake"),eo&&eD(eo,"stToken"),eb&&eD(eb,"slToken"),ew&&eD(ew,"stake"),e_&&eD(e_,"stake"),D&&eD(D,"stake"),Q&&eD(Q,"slToken"),X&&eD(X,"stToken")},[H,eo,eb,ew,e_,D,Q,X]),!T)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!B||A&&Z||G)return(0,i.jsx)(N.Z,{});if(!G&&!z)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eS=em||ef,ez=ec||el,eP=es&&er,eL=J&&F>J+(L||BigInt(0));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,i.jsx)("div",{className:"stat-value text-xl text-secondary",children:G?(0,i.jsx)(N.Z,{}):(0,m.LH)(W||BigInt(0))}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:J&&J>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,i.jsxs)("div",{className:"stat-value text-lg",children:[(0,i.jsx)("span",{className:"text-secondary",children:G?(0,i.jsx)(N.Z,{}):"".concat(L||BigInt(0)," ")}),(0,i.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,f.Cn)(Number(L||BigInt(0)),!0))})]})]}),(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,i.jsx)(k.Z,{address:B.slTokenAddress,showAddress:!1}),(0,i.jsx)(p.Z,{tokenAddress:B.slTokenAddress,tokenSymbol:"sl"+B.symbol,tokenDecimals:B.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl text-gray-600",children:G?(0,i.jsx)(N.Z,{}):(0,m.LH)(z||BigInt(0))}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(x(),{href:"/gov/stakelp/?symbol=".concat(B.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,i.jsx)(k.Z,{address:B.stTokenAddress,showAddress:!1}),(0,i.jsx)(p.Z,{tokenAddress:B.stTokenAddress,tokenSymbol:"st"+B.symbol,tokenDecimals:B.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl text-gray-600",children:G?(0,i.jsx)(N.Z,{}):(0,m.LH)(P||BigInt(0))}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(x(),{href:"/gov/staketoken?symbol=".concat(B.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),$<=BigInt(0)&&W&&W>BigInt(0)&&(0,i.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,i.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),A&&(0,i.jsxs)(i.Fragment,{children:[!J&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,i.jsx)(c.z,{className:"w-1/3",onClick:ey,disabled:eS||es,children:eS?"1.提交中...":ef?"1.确认中...":es?"1.sl".concat(null==B?void 0:B.symbol," 已授权"):"1.授权 sl".concat(null==B?void 0:B.symbol)}),(0,i.jsx)(c.z,{className:"w-1/3",onClick:eg,disabled:!es||ez||er,children:ez?"2.提交中...":el?"2.确认中...":er?"2.st".concat(null==B?void 0:B.symbol," 已授权"):"2.授权 st".concat(null==B?void 0:B.symbol)}),(0,i.jsx)(c.z,{className:"w-1/3",onClick:eB,disabled:!eP||ep||ek||eN,children:ep?"3.提交中":ek?"3.确认中":eN?"3.已取消质押":"3.取消质押"})]}),(0,i.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,i.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,i.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(F,B)+(L||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),J&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,i.jsx)(c.z,{className:"w-1/2",onClick:eZ,disabled:!eL||eA||eE||eT,children:eL?eA?"提交中":eE?"确认中":eT?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(J,B)+(L||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!A&&(0,i.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,i.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(x(),{href:"/my/govrewards?symbol=".concat(B.symbol),children:"铸造 治理激励 >>"})}),J&&(0,i.jsx)(c.z,{variant:"outline",className:"w-1/2 ".concat(eL?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eL,asChild:!0,children:(0,i.jsx)(x(),{href:"/gov/unstake/?symbol=".concat(B.symbol),children:eL?"取回质押代币":"已取消, 第"+((0,m.cK)(J,B)+(L||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,i.jsx)(w.Z,{isLoading:eS||ez||eA||ep||eE||ek,text:em||ec||eA||ep?"提交交易...":"确认交易..."})]})}}}]);