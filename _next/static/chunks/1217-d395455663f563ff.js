"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1217],{22605:(e,s,t)=>{t.d(s,{A:()=>w});var n=t(16927),a=t(4902),i=t(37876),l=t(14232),r=t(8047),c=t(97685),d=t(6960),o=t(48230),x=t.n(o),m=t(89099),u=t(17660),h=t(52372),v=t(64115),j=t(20451),f=t(42038),N=t(83416),b=t(20442),y=t(12293),p=t(99574),g=t(43885);let w=e=>{var s=e.actionId,t=e.onRoundChange,o=e.actionInfo,w=e.onStakedAmountChange,A=e.showJoinButton,C=(0,r.F)(),k=C.address,I=C.chain,E=((0,l.useContext)(N.N)||{}).token,R=(0,m.useRouter)(),S=(0,u.vC)(),_=S.currentRound,B=S.error;(0,l.useEffect)(()=>{t&&"function"==typeof t&&t(_)},[_,t]);var P=(0,v.F6)((null==E?void 0:E.address)||"",_,s),F=P.isSubmitted,L=P.error,$=P.isPending,H=(0,u.vx)((null==E?void 0:E.address)||"",s,k||""),J=H.joinedAmountByActionIdByAccount,K=H.isPending,D=H.error,V=(0,u.p9)((null==E?void 0:E.address)||"",s),z=V.joinedAmountByActionId,G=V.isPending,M=V.error,T=J&&J>0&&z&&z>0,W=T?Number(J)/Number(z)*100:0,Y=(0,b.Ee)(W),q=T?(0,b.Ee)(Math.min(W*Number(null==o?void 0:o.body.maxRandomAccounts),100)):"0%",O=(0,h.IJ)((null==E?void 0:E.address)||"",s,k||""),Q=O.verificationKeys,U=O.verificationInfos,X=O.isPending,Z=O.error,ee=(0,u.S1)(),es=ee.withdraw,et=ee.isPending,en=ee.isConfirming,ea=ee.isConfirmed,ei=ee.error,el=function(){var e=(0,n._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:if(!(0,f.C)(I))return[2];if(void 0!=J&&J<=2n)return c.oR.error("你还没有参与，无需取回"),[2];return[4,es((null==E?void 0:E.address)||"",s)];case 1:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}();(0,l.useEffect)(()=>{ea&&(c.oR.success("取回成功"),R.push("/my"))},[ea,R]),(0,l.useEffect)(()=>{K||null==w||w(J||BigInt(0))},[J,K]);var er=(0,j.g)().handleContractError;return((0,l.useEffect)(()=>{D&&er(D,"join"),M&&er(M,"join"),Z&&er(Z,"join"),B&&er(B,"join"),ei&&er(ei,"join"),L&&er(L,"submit")},[D,M,Z,B,ei,L]),K||G||$)?"":(0,i.jsxs)("div",{className:"flex flex-col items-center px-4 pt-1",children:[T&&(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,i.jsxs)("div",{className:"stat place-items-center",children:[(0,i.jsx)("div",{className:"stat-title",children:"我的参与"}),(0,i.jsx)("div",{className:"stat-value text-2xl text-secondary",children:G?(0,i.jsx)(y.A,{}):(0,b.NJ)(J||BigInt(0),0)}),(0,i.jsx)("div",{className:"stat-desc text-sm mt-2",children:"参与本行动的代币"})]}),(0,i.jsxs)("div",{className:"stat place-items-center",children:[(0,i.jsx)("div",{className:"stat-title",children:"我的占比"}),(0,i.jsx)("div",{className:"stat-value text-2xl text-secondary",children:Y}),(0,i.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["被抽中验证概率 ",q]})]})]}),(void 0===A||A)&&(0,i.jsx)(i.Fragment,{children:T?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-center space-x-4 mt-2 w-full",children:[void 0!=J&&J<=2n?(0,i.jsx)(d.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",disabled:!0,children:"取回"}):(0,i.jsx)(d.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",onClick:el,disabled:et||en||ea,children:et?"提交中":en?"确认中":ea?"已取回":"取回代币"}),(0,i.jsx)(d.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(x(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==E?void 0:E.symbol),children:"增加参与代币"})})]}),(0,i.jsx)("div",{className:"flex flex-col items-center mt-2 mb-4",children:(0,i.jsxs)("div",{className:"text-sm text-greyscale-600",children:[X&&"加载中...",void 0!=J&&J>2n&&Q&&Q.length>0&&(0,i.jsx)("div",{children:Q.map((e,s)=>(0,i.jsxs)("div",{children:[e,": ",(0,i.jsx)(g.H,{text:U[s]})]},s))})]})})]}):F&&(0,i.jsx)(d.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(x(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==E?void 0:E.symbol),children:"参与行动"})})}),(0,i.jsx)(p.A,{isLoading:et||en,text:et?"提交交易...":"确认交易..."})]})}},42038:(e,s,t)=>{t.d(s,{C:()=>a});var n=t(97685),a=e=>!!e||(n.oR.error("请先将钱包链接 ".concat("thinkium801")),!1)},43885:(e,s,t)=>{t.d(s,{H:()=>l});var n=t(37876);t(14232);var a=t(54680),i=e=>{if(!e)return e;var s=/(https?:\/\/[^\s]+)/g;if(!s.test(e))return e;var t=e.split(s),i=e.match(s)||[];return(0,n.jsx)(n.Fragment,{children:t.map((e,s)=>{if(s%2==0)return e;var t=i[(s-1)/2];return(0,n.jsx)("a",{href:t,onClick:e=>{e.preventDefault(),a.a.handleExternalLink(t)},className:"text-blue-500 underline hover:text-blue-700",children:t},s)})})},l=e=>{var s=e.text;return(0,n.jsx)(n.Fragment,{children:i(s)})}},87577:(e,s,t)=>{t.d(s,{A:()=>x});var n=t(40854),a=t(37876),i=t(14232),l=t(48447),r=t(33276),c=t(70801),d=t(97685),o=t(20442);let x=e=>{var s=e.address,t=e.word,x=e.showCopyButton,m=e.showAddress,u=void 0===m||m,h=e.colorClassName,v=void 0===h?"":h,j=e.colorClassName2,f=void 0===j?"":j,N=(0,n._)((0,i.useState)(!1),2),b=N[0],y=N[1];return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[t&&(0,a.jsx)("span",{className:"text-xs",children:t}),u&&!f&&(0,a.jsx)("span",{className:"text-xs ".concat(null!=v?v:"text-greyscale-500"),children:(0,o.W_)(s)}),u&&f&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"text-xs ".concat(null!=v?v:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,a.jsx)("span",{className:"text-xs ".concat(f),children:"".concat(s.substring(s.length-4))})]}),(void 0===x||x)&&(0,a.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?y(!0):d.Ay.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:b?(0,a.jsx)(r.A,{className:"h-4 w-4 ".concat(null!=v?v:"text-greyscale-500")}):(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=v?v:"text-greyscale-500")})})})]})}},92101:(e,s,t)=>{t.d(s,{A:()=>j});var n=t(37876),a=t(14232),i=t(6960),l=t(48230),r=t.n(l),c=t(64115),d=t(20451),o=t(83416),x=t(20442),m=t(43885),u=t(87577),h=t(12293),v=t(1709);let j=e=>{var s,t=e.actionId,l=e.round,j=e.showSubmitter,f=e.showVerifyHistory,N=e.onActionInfo,b=((0,a.useContext)(o.N)||{}).token,y=(0,c.Y4)(null==b?void 0:b.address,t),p=y.actionInfo,g=y.isPending,w=y.error;(0,a.useEffect)(()=>{N&&p&&N(p)},[p]);var A=(0,c.VD)(null==b?void 0:b.address,j?l:0n),C=A.actionSubmits,k=A.isPending,I=A.error,E=(null==C||null==(s=C.find(e=>e.actionId==Number(t)))?void 0:s.submitter)||"N/A",R=(0,d.g)().handleContractError;return((0,a.useEffect)(()=>{w&&R(w,"submit"),I&&R(I,"submit")},[w,I]),g)?(0,n.jsx)(h.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mx-auto p-4 pb-2 border-t border-greyscale-100",children:(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)(v.A,{title:"行动详情"}),(void 0===f||f)&&(0,n.jsx)(i.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(r(),{href:"/my/actrewards/?id=".concat(t,"&symbol=").concat(null==b?void 0:b.symbol),children:"查看铸造激励 >>"})})]})}),(0,n.jsxs)("div",{className:"mx-auto p-4 pb-2 ",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==p?void 0:p.head.id.toString()]}),(0,n.jsx)("span",{className:"text-xl font-bold text-black",children:null==p?void 0:p.body.action})]}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("span",{className:"text-greyscale-600",children:null==p?void 0:p.body.consensus})}),(0,n.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,n.jsx)(u.A,{address:null==p?void 0:p.head.author})]}),j&&(0,n.jsxs)("div",{className:"flex items-center",children:["推举人"," ",k?(0,n.jsx)(h.A,{}):(0,n.jsx)(u.A,{address:E})]})]})]}),(0,n.jsx)("div",{className:"mx-auto p-4 pb-2",children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最小参与代币数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(0,x.NJ)((null==p?void 0:p.body.minStake)||BigInt(0))})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"最大抽取验证地址数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==p?void 0:p.body.maxRandomAccounts.toString())||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,n.jsx)("p",{className:"text-greyscale-500 whitespace-pre-wrap",children:(0,n.jsx)(m.H,{text:null==p?void 0:p.body.verificationRule})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"报名参加行动时，行动者要提供的信息"}),(null==p?void 0:p.body.verificationKeys)&&(null==p?void 0:p.body.verificationKeys.length)>0?(0,n.jsx)("ul",{className:"list-disc pl-5",children:p.body.verificationKeys.map((e,s)=>(0,n.jsxs)("li",{className:"text-greyscale-500",children:[e," : ",p.body.verificationInfoGuides[s]]},s))}):(0,n.jsx)("span",{className:"text-greyscale-500",children:"无"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,n.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==p?void 0:p.body.whiteList.length)?p.body.whiteList.map((e,s)=>(0,n.jsx)("span",{className:"flex items-center mr-2",children:(0,n.jsx)(u.A,{address:e})},s)):"无限制"})]})]})})]})}},99574:(e,s,t)=>{t.d(s,{A:()=>i});var n=t(37876);t(14232);var a=t(7446);let i=e=>{var s=e.isLoading,t=e.text;return s?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(a.A,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:void 0===t?"Loading":t})]})}):null}}}]);