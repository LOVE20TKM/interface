"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(s,e,t){var l=t(85893),n=t(27245),a=t(86501),c=t(92321),r=t(67294),i=t(41664),d=t.n(i),o=t(48105),m=t(91529),x=t(99958),h=t(10403),j=t(92180),v=t(77156),b=t(7224),y=t(19638),u=t(34426),f=t(27460),N=t(42083),k=t(44576);e.Z=s=>{let{token:e,enableWithdraw:t=!1}=s,{address:i,chain:A}=(0,c.m)(),{currentRound:g,isPending:w,error:p}=(0,j.Bk)(t),{slAmount:C,stAmount:T,promisedWaitingPhases:Z,requestedUnstakeRound:B,govVotes:z,isPending:E,error:F}=(0,j.L)(null==e?void 0:e.address,i),S=()=>!!(0,o.S)(A)&&(!!C&&!(C<=0n)||(a.Am.error("流动性质押数量为0，不用取消质押"),!1)),{allowance:P,isPending:L,error:_}=(0,y.yG)(null==e?void 0:e.slTokenAddress,i,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t),{allowance:H,isPending:K,error:D}=(0,y.yG)(null==e?void 0:e.stTokenAddress,i,"0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",t),{validGovVotes:G,isPending:W,error:I}=(0,j.Ty)((null==e?void 0:e.address)||"",i||""),[Q,q]=(0,r.useState)(!1),[J,M]=(0,r.useState)(!1),{isPending:O,isConfirming:R,isConfirmed:U,error:V,approve:X}=(0,v.yA)(null==e?void 0:e.stTokenAddress),{isPending:Y,isConfirming:$,isConfirmed:ss,error:se,approve:st}=(0,b.yA)(null==e?void 0:e.slTokenAddress),sl=async()=>{if(S())try{C&&C>0n&&!Q&&await st("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",C)}catch(s){console.error(s)}},sn=async()=>{if(S())try{T&&T>0n&&!J&&await X("0x11bBb48bAA8765b0394A13F6Aa406B13e940836A",T)}catch(s){console.error(s)}};(0,r.useEffect)(()=>{ss?q(!0):C&&C>0n&&P&&P>=C?q(!0):q(!1)},[C,P,L,ss]),(0,r.useEffect)(()=>{U?M(!0):!T||T<=0n?M(!0):H&&H>=T?M(!0):M(!1)},[T,H,K,U]);let{isWriting:sa,isConfirming:sc,isConfirmed:sr,writeError:si,unstake:sd}=(0,j.vc)(),so=async()=>{try{await sd(null==e?void 0:e.address)}catch(s){console.error(s)}};(0,r.useEffect)(()=>{sr&&(a.Am.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==e?void 0:e.symbol)},2e3))},[sr]);let{isWriting:sm,isConfirming:sx,isConfirmed:sh,writeError:sj,withdraw:sv}=(0,j.Qc)(),sb=async()=>{try{await sv(null==e?void 0:e.address)}catch(s){console.error(s)}};(0,r.useEffect)(()=>{sh&&(a.Am.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/interface","/my?symbol=").concat(null==e?void 0:e.symbol)},2e3))},[sh]);let{handleContractError:sy}=(0,h.S)();if((0,r.useEffect)(()=>{F&&sy(F,"stake"),V&&sy(V,"stToken"),se&&sy(se,"slToken"),si&&sy(si,"stake"),sj&&sy(sj,"stake"),p&&sy(p,"stake"),_&&sy(_,"slToken"),D&&sy(D,"stToken")},[F,V,se,si,sj,p,_,D]),!i)return(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!e||t&&w||E)return(0,l.jsx)(N.Z,{});if(!E&&!C)return(0,l.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});let su=Y||$,sf=O||R,sN=Q&&J,sk=t&&B&&g>B+(Z||BigInt(0));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,l.jsx)("div",{className:"stat-value text-xl",children:E?(0,l.jsx)(N.Z,{}):(0,m.LH)(z||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:B&&B>0n&&"注意：解锁期内治理票数为0"})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,l.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,l.jsxs)("div",{className:"stat-value text-lg",children:[E?(0,l.jsx)(N.Z,{}):"".concat(Z||0n," "),(0,l.jsx)("span",{className:"text-sm",children:" 阶段"})]}),(0,l.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,x.Cn)(Number(Z||0n),!0))})]})]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,l.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,l.jsx)(f.Z,{address:e.slTokenAddress,showAddress:!1}),(0,l.jsx)(u.Z,{tokenAddress:e.slTokenAddress,tokenSymbol:"sl"+e.symbol,tokenDecimals:e.decimals})]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:E?(0,l.jsx)(N.Z,{}):(0,m.LH)(C||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(n.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,l.jsx)(d(),{href:"/gov/stakelp/?symbol=".concat(e.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,l.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,l.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,l.jsx)(f.Z,{address:e.stTokenAddress,showAddress:!1}),(0,l.jsx)(u.Z,{tokenAddress:e.stTokenAddress,tokenSymbol:"st"+e.symbol,tokenDecimals:e.decimals})]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:E?(0,l.jsx)(N.Z,{}):(0,m.LH)(T||0n,2)}),(0,l.jsx)("div",{className:"stat-desc text-xs",children:(0,l.jsx)(n.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,l.jsx)(d(),{href:"/gov/staketoken?symbol=".concat(e.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),(0,l.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:G<=0n&&z&&z>0n&&(0,l.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),t&&(0,l.jsxs)(l.Fragment,{children:[!B&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,l.jsx)(n.z,{className:"w-1/3",onClick:sl,disabled:su||Q,children:su?"1.提交中...":$?"1.确认中...":Q?"1.sl".concat(null==e?void 0:e.symbol," 已授权"):"1.授权 sl".concat(null==e?void 0:e.symbol)}),(0,l.jsx)(n.z,{className:"w-1/3",onClick:sn,disabled:!Q||sf||J,children:sf?"2.提交中...":R?"2.确认中...":J?"2.st".concat(null==e?void 0:e.symbol," 已授权"):"2.授权 st".concat(null==e?void 0:e.symbol)}),(0,l.jsx)(n.z,{className:"w-1/3",onClick:so,disabled:!sN||sa||sc||sr,children:sa?"3.提交中":sc?"3.确认中":sr?"3.已取消质押":"3.取消质押"})]}),(0,l.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,l.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,l.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(g,e)+(Z||0n)+1n," ")}),"轮才能取回代币）"]})]}),B&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,l.jsx)(n.z,{className:"w-1/2",onClick:sb,disabled:!sk||sm||sx||sh,children:sk?sm?"提交中":sx?"确认中":sh?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(B,e)+(Z||0n)+1n)+"轮才可取回"})})})]}),!t&&(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,l.jsx)(n.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(d(),{href:"/my/govrewards?symbol=".concat(e.symbol),children:"查看奖励"})}),B&&(0,l.jsx)(n.z,{variant:"outline",className:"w-1/2 ".concat(sk?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!sk,asChild:!0,children:(0,l.jsx)(d(),{href:"/gov/unstake/?symbol=".concat(e.symbol),children:sk?"取回质押代币":"已取消, 第"+((0,m.cK)(B,e)+(Z||0n)+1n)+"轮可取回"})}),!B&&(0,l.jsx)(n.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(d(),{href:"/gov/?symbol=".concat(e.symbol),children:"社区治理"})})]}),(0,l.jsx)(k.Z,{isLoading:su||sf||sm||sa||sx||sc,text:Y||O||sm||sa?"提交交易...":"确认交易..."})]})}}}]);