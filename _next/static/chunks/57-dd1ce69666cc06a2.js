try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="6f247e57-86e7-44ee-85e3-1a22ca0a50cc",e._sentryDebugIdIdentifier="sentry-dbid-6f247e57-86e7-44ee-85e3-1a22ca0a50cc")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{40057:function(e,s,t){var n=t(11010),r=t(91309),a=t(97582),i=t(85893),c=t(27245),l=t(86501),d=t(42130),o=t(67294),u=t(41664),m=t.n(u),x=t(74598),h=t(91529),f=t(99958),b=t(73591),y=t(92180),v=t(7080),g=t(77156),j=t(7224),p=t(85794),N=t(53696),k=t(27460),w=t(42083),C=t(44576);s.Z=function(e){var s,t,u,B,I=e.token,A=e.enableWithdraw,E=void 0!==A&&A,T=e.onStakeStatusChange,_=(0,d.m)().address,F=(0,v.Bk)(),Z=F.currentRound,D=F.isPending,z=F.error,S=(0,y.L)(null==I?void 0:I.address,_),P=S.slAmount,L=S.stAmount,J=S.promisedWaitingPhases,W=S.requestedUnstakeRound,G=S.govVotes,H=S.isPending,K=S.error,q=function(){return!(!P||P<=BigInt(0))||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)},R=(0,p.yG)(null==I?void 0:I.slTokenAddress,_,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),V=R.allowance,Q=R.isPending,U=R.error,M=(0,p.yG)(null==I?void 0:I.stTokenAddress,_,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",E),O=M.allowance,X=M.isPending,Y=M.error,$=(0,y.Ty)((null==I?void 0:I.address)||"",_||""),ee=$.validGovVotes;$.isPending,$.error;var es=(0,r._)((0,o.useState)(!1),2),et=es[0],en=es[1],er=(0,r._)((0,o.useState)(!1),2),ea=er[0],ei=er[1],ec=(0,g.yA)(null==I?void 0:I.stTokenAddress),el=ec.isPending,ed=ec.isConfirming,eo=ec.isConfirmed,eu=ec.writeError,em=ec.approve,ex=(0,j.yA)(null==I?void 0:I.slTokenAddress),eh=ex.isPending,ef=ex.isConfirming,eb=ex.isConfirmed,ey=ex.writeError,ev=ex.approve,eg=(s=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:if(!q())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(P&&P>BigInt(0)&&!et))return[3,3];return[4,ev("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",P)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),ej=(t=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:if(!q())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(L&&L>BigInt(0)&&!ea))return[3,3];return[4,em("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",L)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){eb?en(!0):P&&P>BigInt(0)&&V&&V>=P?en(!0):en(!1)},[P,V,Q,eb]),(0,o.useEffect)(function(){eo?ei(!0):!L||L<=BigInt(0)?ei(!0):O&&O>=L?ei(!0):ei(!1)},[L,O,X,eo]);var ep=(0,y.vc)(),eN=ep.isWriting,ek=ep.isConfirming,ew=ep.isConfirmed,eC=ep.writeError,eB=ep.unstake,eI=(u=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eB(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){ew&&(l.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[ew]);var eA=(0,y.Qc)(),eE=eA.isWriting,eT=eA.isConfirming,e_=eA.isConfirmed,eF=eA.writeError,eZ=eA.withdraw,eD=(B=(0,n._)(function(){return(0,a.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eZ(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return B.apply(this,arguments)});(0,o.useEffect)(function(){e_&&(l.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[e_]),(0,o.useEffect)(function(){T&&!H&&T(!!(P&&P>BigInt(0)))},[P,H,T]);var ez=(0,b.S)().handleContractError;if((0,o.useEffect)(function(){K&&ez(K,"stake"),eu&&ez(eu,"stToken"),ey&&ez(ey,"slToken"),eC&&ez(eC,"stake"),eF&&ez(eF,"stake"),z&&ez(z,"stake"),U&&ez(U,"slToken"),Y&&ez(Y,"stToken")},[K,eu,ey,eC,eF,z,U,Y]),!_)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!I||E&&D||H)return(0,i.jsx)(w.Z,{});if(!H&&!P)return(0,i.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eS=eh||ef,eP=el||ed,eL=et&&ea,eJ=W&&Z>W+(J||BigInt(0));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,i.jsx)("div",{className:"stat-value text-xl text-secondary",children:H?(0,i.jsx)(w.Z,{}):(0,h.LH)(G||BigInt(0))}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:W&&W>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,i.jsxs)("div",{className:"stat-value text-lg",children:[(0,i.jsx)("span",{className:"text-secondary",children:H?(0,i.jsx)(w.Z,{}):"".concat(J||BigInt(0)," ")}),(0,i.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,i.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,f.Cn)(Number(J||BigInt(0)),!0))})]})]}),(0,i.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,i.jsx)(k.Z,{address:I.slTokenAddress,showAddress:!1}),(0,i.jsx)(N.Z,{tokenAddress:I.slTokenAddress,tokenSymbol:"sl"+I.symbol,tokenDecimals:I.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl text-gray-600",children:H?(0,i.jsx)(w.Z,{}):(0,i.jsxs)(m(),{href:"/my/liquid?symbol=".concat(I.symbol),className:"flex items-center hover:text-secondary-focus",children:[(0,i.jsx)("span",{className:"cursor-pointer",children:(0,h.LH)(P||BigInt(0))}),(0,i.jsx)(x.Z,{size:16,className:"ml-1 text-secondary cursor-pointer"})]})}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(m(),{href:"/gov/stakelp/?symbol=".concat(I.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,i.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,i.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,i.jsx)(k.Z,{address:I.stTokenAddress,showAddress:!1}),(0,i.jsx)(N.Z,{tokenAddress:I.stTokenAddress,tokenSymbol:"st"+I.symbol,tokenDecimals:I.decimals})]}),(0,i.jsx)("div",{className:"stat-value text-xl text-gray-600",children:H?(0,i.jsx)(w.Z,{}):(0,h.LH)(L||BigInt(0))}),(0,i.jsx)("div",{className:"stat-desc text-xs",children:(0,i.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,i.jsx)(m(),{href:"/gov/staketoken?symbol=".concat(I.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),ee<=BigInt(0)&&G&&G>BigInt(0)&&(0,i.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,i.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),E&&(0,i.jsxs)(i.Fragment,{children:[!W&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,i.jsx)(c.z,{className:"w-1/3",onClick:eg,disabled:eS||et,children:eS?"1.提交中...":ef?"1.确认中...":et?"1.sl".concat(null==I?void 0:I.symbol," 已授权"):"1.授权 sl".concat(null==I?void 0:I.symbol)}),(0,i.jsx)(c.z,{className:"w-1/3",onClick:ej,disabled:!et||eP||ea,children:eP?"2.提交中...":ed?"2.确认中...":ea?"2.st".concat(null==I?void 0:I.symbol," 已授权"):"2.授权 st".concat(null==I?void 0:I.symbol)}),(0,i.jsx)(c.z,{className:"w-1/3",onClick:eI,disabled:!eL||eN||ek||ew,children:eN?"3.提交中":ek?"3.确认中":ew?"3.已取消质押":"3.取消质押"})]}),(0,i.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,i.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,i.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,h.cK)(Z,I)+(J||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),W&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,i.jsx)(c.z,{className:"w-1/2",onClick:eD,disabled:!eJ||eE||eT||e_,children:eJ?eE?"提交中":eT?"确认中":e_?"已取回":"取回质押代币":"已取消,第"+((0,h.cK)(W,I)+(J||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!E&&(0,i.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,i.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(m(),{href:"/my/govrewards?symbol=".concat(I.symbol),children:"铸造 治理激励 >>"})}),W&&(0,i.jsx)(c.z,{variant:"outline",className:"w-1/2 ".concat(eJ?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eJ,asChild:!0,children:(0,i.jsx)(m(),{href:"/gov/unstake/?symbol=".concat(I.symbol),children:eJ?"取回质押代币":"已取消, 第"+((0,h.cK)(W,I)+(J||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,i.jsx)(C.Z,{isLoading:eS||eP||eE||eN||eT||ek,text:eh||el||eE||eN?"提交交易...":"确认交易..."})]})}}}]);