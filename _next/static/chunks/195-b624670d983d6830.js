try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="355445d2-ca35-4404-9eaa-5347a9b87e0c",e._sentryDebugIdIdentifier="sentry-dbid-355445d2-ca35-4404-9eaa-5347a9b87e0c")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[195],{67997:function(e,n,t){t.d(n,{Z:function(){return s}});var s=(0,t(31134).Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},89126:function(e,n,t){t.d(n,{Z:function(){return ee}});var s=t(72253),r=t(91309),a=t(85893),o=t(67294),i=t(43032),d=t(64777),u=t(42083),l=t(44576),c=t(14932),m=t(11163),f=t(87536),p=t(56312),y=t(86501),h=(0,t(31134).Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),T=t(27245),v=t(74193),g=t(26858),x=t(63448),b=function(e){var n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=[];t.push({symbol:"TKM",address:"NATIVE",decimals:18,isNative:!0});var s="TKM20",r="0xc3Da46ED14dBd79922027031BB5D688A81139e01";s&&r&&t.push({symbol:s,address:r,decimals:18,isNative:!1,isWETH:!0});var a="TUSDT",o="0x47Ba4471046fC0442078CF1519924cb205F02c7a";return a&&o&&o.length>0&&t.push({symbol:a,address:o,decimals:18,isNative:!1}),e&&n&&e.symbol&&e.address&&!t.find(function(n){return n.address===e.address})&&t.push({symbol:e.symbol,address:e.address,decimals:18,isNative:!1}),e&&e.parentTokenSymbol&&e.parentTokenAddress&&!t.find(function(n){return n.address===e.parentTokenAddress})&&t.push({symbol:e.parentTokenSymbol,address:e.parentTokenAddress,decimals:18,isNative:!1,isWETH:"0xc3Da46ED14dBd79922027031BB5D688A81139e01"===e.parentTokenAddress}),t},k=function(){return{wethAddress:"0xc3Da46ED14dBd79922027031BB5D688A81139e01",routerAddress:"0xBE7A91095198ddc6356CD7751c3dECa98321FE37",usdtAddress:"0x47Ba4471046fC0442078CF1519924cb205F02c7a"}},w=function(e){if(0===e.length)return{fromToken:null,toToken:null};var n,t=e[0],s="LOVE20";if(s&&(n=e.find(function(e){return e.symbol===s&&e.address!==(null==t?void 0:t.address)})),!n){for(var r=1;r<e.length;r++)if(e[r].address!==(null==t?void 0:t.address)){n=e[r];break}}return{fromToken:t,toToken:n||e[1]||e[0]}},A=function(){var e=k(),n=e.wethAddress,t=e.routerAddress;return n&&t?{isValid:!0}:{isValid:!1,error:"系统配置错误，请联系管理员"}},N=function(e,n,t,s){var r=k().wethAddress;if("UniswapV2_ETH_TO_TOKEN"===n){if(e.length<2||e.length>3)return{isValid:!1,error:"交换路径配置错误"};if(e[0]!==r)return{isValid:!1,error:"TKM20/WETH 地址配置错误"}}if("UniswapV2_TOKEN_TO_ETH"===n){if(e.length<2||e.length>3)return{isValid:!1,error:"交换路径配置错误"};if(e[e.length-1]!==r)return{isValid:!1,error:"TKM20/WETH 地址配置错误"}}return{isValid:!0}},E=t(88659),j=function(e){var n=e.selectedToken,t=e.supportedTokens,s=e.onTokenSelect,r=e.disabled;return(0,a.jsxs)(E.Ph,{value:n.address,onValueChange:s,disabled:r,children:[(0,a.jsx)(E.i4,{className:"w-auto border-none bg-white hover:bg-gray-50 px-3 py-1.5 rounded-full transition-colors border border-gray-200 font-mono",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"font-medium text-gray-800 font-mono",children:n.symbol})})}),(0,a.jsx)(E.Bw,{children:t.map(function(e){return(0,a.jsx)(E.Ql,{value:e.address,className:"font-mono",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"font-mono",children:e.symbol})})},e.address)})})]})},C=t(21774),B=t(34680),_=function(e){var n=e.value,t=e.onChange,s=e.token,r=e.balance,o=e.disabled,i=e.readOnly,d=e.onSetPercentage,u=e.onSetMax,l=e.maxNativeInputLimit,c=e.showPercentageButtons,m=e.tokenSelector;return(0,a.jsx)(B.Zb,{className:"bg-[#f7f8f9] border-none",children:(0,a.jsxs)(B.aY,{className:"py-4 px-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(C.I,{type:"number",placeholder:"0",value:n,onChange:function(e){return t(e.target.value)},disabled:o,readOnly:i,className:"text-xl border-none p-0 h-auto bg-transparent focus:ring-0 focus:outline-none mr-2"}),m]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(void 0===c||c)&&d&&u?(0,a.jsxs)("div",{className:"flex space-x-1",children:[[25,50,75].map(function(e){return(0,a.jsxs)(T.z,{variant:"outline",size:"sm",type:"button",onClick:function(){return d(e)},disabled:o||(r||BigInt(0))<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:[e,"%"]},e)}),(0,a.jsx)(T.z,{variant:"outline",size:"sm",type:"button",onClick:u,disabled:o||(r||BigInt(0))<=BigInt(0),className:"text-xs h-7 px-2 rounded-lg",children:"最高"})]}):(0,a.jsx)("div",{}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,g.LH)(r||BigInt(0))," ",s.symbol]})]}),l&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["测试环境限制：",s.isWETH?"最多可使用 1 ":"最多可使用 ".concat("0.1"," "),s.symbol]})]})})},S=function(e){var n=e.needsApproval,t=e.isApproved,s=e.isApproving,r=e.isSwapping,o=e.isSwapConfirmed,i=e.onApprove,d=e.onSwap,u=e.disabled;return(0,a.jsxs)("div",{className:"flex flex-row space-x-2",children:[n&&(0,a.jsx)(T.z,{className:"w-1/2",onClick:i,disabled:s||t||u,children:s?"1.授权中...":t?"1.已授权":"1.授权"}),(0,a.jsx)(T.z,{className:n?"w-1/2":"w-full",onClick:d,disabled:!t||s||r||o||u,children:r?n?"2.兑换中...":"兑换中...":o?n?"2.已兑换":"已兑换":n?"2.兑换":"兑换"})]})},I=function(e){var n,t=e.fromToken,r=e.toToken,i=e.supportedTokens,d=e.onFromTokenChange,u=e.onToTokenChange,l=e.onFromAmountChange,b=e.onFromAmountStringChange,k=e.onSwapTokens,w=(e.fromAmount,e.toAmount),A=e.fromBalance,N=e.toBalance,E=e.maxNativeInputLimit,C=e.isPendingFromBalance,B=e.isPendingToBalance,I=e.needsApproval,M=e.isApproved,V=e.isApproving,O=e.isSwapping,H=e.isSwapConfirmed,P=e.setMaxAmount,F=e.handleApprove,D=e.executeSwap;(0,m.useRouter)();var W=C||B,U=(0,f.cI)({resolver:(0,p.F)((n=A||BigInt(0),x.Ry({fromTokenAmount:x.Z_().nonempty("请输入兑换数量").refine(function(e){if(e.endsWith(".")||"0"===e)return!0;try{var t=(0,g.vz)(e);return t>BigInt(0)&&t<=n}catch(e){return!1}},{message:"输入数量必须大于0且不超过您的可用余额"}),fromTokenAddress:x.Z_(),toTokenAddress:x.Z_()}))),defaultValues:{fromTokenAmount:"",fromTokenAddress:t.address,toTokenAddress:r.address},mode:"onChange"});(0,o.useEffect)(function(){U.setValue("fromTokenAddress",t.address),U.setValue("toTokenAddress",r.address)},[t.address,r.address,U]);var L=U.watch("fromTokenAmount");(0,o.useEffect)(function(){b(L||"0");try{var e=(0,g.vz)(L||"0"),n=e;if(E&&e>E){n=E;var s=(0,g.bM)(n);L&&L!==s&&(U.setValue("fromTokenAmount",s),(0,y.Am)("测试环境限制：最多可使用 "+s+" "+t.symbol))}l(n)}catch(e){l(BigInt(0))}},[L,E,U,t.symbol,l,b]);var K=function(e){var n=i.find(function(n){return n.address===e});n&&(n.address===r.address?(d(n),u(t),U.setValue("fromTokenAddress",n.address),U.setValue("toTokenAddress",t.address),U.setValue("fromTokenAmount","")):(d(n),U.setValue("fromTokenAddress",e)))},Z=function(e){var n=i.find(function(n){return n.address===e});n&&(n.address===t.address?(d(r),u(n),U.setValue("fromTokenAddress",r.address),U.setValue("toTokenAddress",n.address),U.setValue("fromTokenAmount","")):(u(n),U.setValue("toTokenAddress",e)))},R=function(e){var n=(null!=A?A:BigInt(0))*BigInt(e)/BigInt(100),t=E&&n>E?E:n;U.setValue("fromTokenAmount",(0,g.bM)(t))},z=function(){var e=P();U.setValue("fromTokenAmount",e)};return(0,a.jsx)(v.l0,(0,c._)((0,s._)({},U),{children:(0,a.jsxs)("form",{children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(v.Wi,{control:U.control,name:"fromTokenAmount",render:function(e){var n=e.field;return(0,a.jsxs)(v.xJ,{children:[(0,a.jsx)(_,{value:n.value,onChange:n.onChange,token:t,balance:A,disabled:W,onSetPercentage:R,onSetMax:z,maxNativeInputLimit:E,tokenSelector:(0,a.jsx)(v.Wi,{control:U.control,name:"fromTokenAddress",render:function(e){return e.field,(0,a.jsx)(v.xJ,{children:(0,a.jsx)(v.NI,{children:(0,a.jsx)(j,{selectedToken:t,supportedTokens:i,onTokenSelect:K,disabled:W})})})}})}),(0,a.jsx)(v.zG,{})]})}})}),(0,a.jsx)("div",{className:"flex justify-center mb-1",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(T.z,{variant:"ghost",type:"button",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:k,disabled:W,children:(0,a.jsx)(h,{className:"w-5 h-5 text-gray-600"})})})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(_,{value:(0,g.bM)(w),onChange:function(){},token:r,balance:N,disabled:!0,readOnly:!0,showPercentageButtons:!1,tokenSelector:(0,a.jsx)(v.Wi,{control:U.control,name:"toTokenAddress",render:function(){return(0,a.jsx)(v.xJ,{children:(0,a.jsx)(v.NI,{children:(0,a.jsx)(j,{selectedToken:r,supportedTokens:i,onTokenSelect:Z,disabled:W})})})}})})}),(0,a.jsx)(S,{needsApproval:I,isApproved:M,isApproving:V,isSwapping:O,isSwapConfirmed:H,onApprove:U.handleSubmit(F),onSwap:U.handleSubmit(D),disabled:W})]})}))},M=function(e){var n=e.fromToken,t=e.toToken,s=e.fromAmount,r=e.toAmount,i=e.watchFromAmount,d=e.swapMethod,u=e.amountsOutError,l=(0,o.useMemo)(function(){if(s>BigInt(0)&&r>BigInt(0))try{var e=(0,g.bM)(s),n=(0,g.bM)(r),t=parseFloat(e),a=parseFloat(n);if(t>0)return(0,g.eb)((a/t).toString(),2,4)}catch(e){console.warn("转换率计算出错:",e)}return"0"},[s,r]),c=(0,o.useMemo)(function(){if("WETH9"===d)return{feePercentage:0,feeAmount:"0"};var e=.3*parseFloat(i||"0")/100;return{feePercentage:.3,feeAmount:e<parseFloat("0.1")?e.toExponential(2):e.toFixed(6)}},[d,i]);return s<=BigInt(0)?null:(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:["WETH9"===d&&(0,a.jsx)("div",{className:"text-sm text-green-600 mb-2",children:"\uD83D\uDCA1 这是 1:1 包装转换，无手续费，无滑点"}),u&&"WETH9"!==d&&(0,a.jsx)("div",{className:"text-sm text-amber-600 mb-2 bg-amber-50 p-2 rounded border-l-4 border-amber-400",children:"⚠️ 价格信息更新中，请稍后重试。这通常是因为链上交易活跃导致的临时状态。"}),!u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-greyscale-400",children:"兑换率: "}),(0,a.jsxs)("span",{children:["1 ",n.symbol," = ",l," ",t.symbol]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-greyscale-400",children:["手续费 (",c.feePercentage,"%)："]}),(0,a.jsxs)("span",{children:[c.feeAmount," ",n.symbol]})]}),"WETH9"!==d&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-greyscale-400",children:"滑点上限 (自动)："}),(0,a.jsx)("span",{children:"0.5%"})]})]}),u&&r===BigInt(0)&&"WETH9"!==d&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"\uD83D\uDCA1 提示：同时进行相同交易可能会因MEV保护机制而失败，这是为了保护您的资金安全。"})]})},V=function(e,n){var t=(0,m.useRouter)(),a=w(e),i=(0,r._)((0,o.useState)(a.fromToken||{symbol:"TKM",address:"NATIVE",decimals:18,isNative:!0}),2),d=i[0],u=i[1],l=(0,r._)((0,o.useState)(a.toToken||{symbol:"LOVE20",address:"0x6458E25680765Add4e2ca8d5a31fA08f5e1b6e4a",decimals:18,isNative:!1,isWETH:!1}),2),c=l[0],f=l[1];return(0,o.useEffect)(function(){if(n&&0!==e.length){var r=t.query,a=r.from,o=r.to,i=void 0,d=void 0,l=!1;!a||"string"!=typeof a||(i=e.find(function(e){return e.symbol&&e.symbol.toLowerCase()===a.toLowerCase()}))||(y.Am.error("找不到代币 ".concat(a)),l=!0),!o||"string"!=typeof o||(d=e.find(function(e){return e.symbol&&e.symbol.toLowerCase()===o.toLowerCase()}))||(y.Am.error("找不到代币 ".concat(o)),l=!0),i&&d&&i.address===d.address&&(y.Am.error("不能选择相同的代币进行兑换"),l=!0,i=void 0,d=void 0),i?u(i):e[0]&&u(e[0]);var c=i||e[0];if(d&&d.address!==(null==c?void 0:c.address))f(d);else{var m=w(e).toToken;m&&m.address!==(null==c?void 0:c.address)&&f(m)}if(l){y.Am.error("已切换为默认代币对儿");var p=(0,s._)({},t.query);delete p.from,delete p.to,t.replace({pathname:t.pathname,query:p},void 0,{shallow:!0})}}},[e,t,n]),{fromToken:d,toToken:c,setFromToken:u,setToToken:f,handleSwapTokens:function(){var e=(0,s._)({},d);u((0,s._)({},c)),f(e)}}},O=t(11010),H=t(97582),P=t(42130),F=t(73591),D=t(62776),W=t(85794),U=function(e,n){var t=(0,D.K)({address:n,query:{enabled:!!n&&e.isNative}}),s=t.data,r=t.isLoading,a=(0,W.hS)(e.isNative?"0x0000000000000000000000000000000000000000":e.address,n),o=a.balance,i=a.isPending;return{balance:e.isNative?null==s?void 0:s.value:o,isPending:e.isNative?r:i}},L=t(301),K=t(92180),Z=t(4586),R=function(e,n){return e.isNative&&n.isWETH||e.isWETH&&n.isNative?"WETH9":!e.isNative||n.isNative||n.isWETH?e.isNative||e.isWETH||!n.isNative?"UniswapV2_TOKEN_TO_TOKEN":"UniswapV2_TOKEN_TO_ETH":"UniswapV2_ETH_TO_TOKEN"},z=function(e,n,t){var s="0xc3Da46ED14dBd79922027031BB5D688A81139e01",r="0x47Ba4471046fC0442078CF1519924cb205F02c7a",a=null==t?void 0:t.address,o=(0,Z._)(s&&a?[{token1:s,token2:a}]:[]).concat((0,Z._)(r&&a?[{token1:r,token2:a}]:[]),(0,Z._)((null==t?void 0:t.parentTokenAddress)&&a?[{token1:t.parentTokenAddress,token2:a}]:[])),i=e.isNative?"NATIVE":e.address,d=n.isNative?"NATIVE":n.address;return!e.isNative||n.isNative||n.isWETH?e.isNative||e.isWETH||!n.isNative?o.some(function(e){return e.token1===i&&e.token2===d||e.token1===d&&e.token2===i})?J(e,n,s):q(e,n,t,o,s,a):G(e,s,a,r,o):Q(n,s,a,r,o)},J=function(e,n,t){if(e.isNative||n.isNative)throw Error("buildDirectPath should not handle native tokens");return[e.address,n.address]},q=function(e,n,t,s,r,a){if(e.isNative||n.isNative)throw Error("buildRoutedPath should not handle native tokens");var o=e.address,i=n.address;if(a&&o!==a&&i!==a){var d=s.some(function(e){return e.token1===o&&e.token2===a||e.token1===a&&e.token2===o}),u=s.some(function(e){return e.token1===a&&e.token2===i||e.token1===i&&e.token2===a});if(d&&u)return[e.address,a,n.address]}var l=s.some(function(e){return e.token1===o&&e.token2===r||e.token1===r&&e.token2===o}),c=s.some(function(e){return e.token1===r&&e.token2===i||e.token1===i&&e.token2===r});if(l&&c)return[e.address,r,n.address];throw Error("No valid routing path found for ".concat(e.symbol," -> ").concat(n.symbol))},Q=function(e,n,t,s,r){if(e.address===t)return[n,t];if(e.address===s){var a=r.some(function(e){return e.token1===n&&e.token2===t||e.token1===t&&e.token2===n}),o=r.some(function(e){return e.token1===t&&e.token2===s||e.token1===s&&e.token2===t});if(a&&o)return[n,t,s]}return[n,e.address]},G=function(e,n,t,s,r){if(e.address===t)return[t,n];if(e.address===s){var a=r.some(function(e){return e.token1===s&&e.token2===t||e.token1===t&&e.token2===s}),o=r.some(function(e){return e.token1===t&&e.token2===n||e.token1===n&&e.token2===t});if(a&&o)return[s,t,n]}return[e.address,n]},Y=function(e,n,t){var s=(0,i.Z)().token,r=(0,o.useMemo)(function(){return R(e,n)},[e,n]),a=(0,o.useMemo)(function(){return"WETH9"===r?[]:"WETH9"===R(e,n)?[]:z(e,n,s)},[e,n,r,s]),d=(0,K.VL)(null==s?void 0:s.address),u=d.initialStakeRound,l=d.isPending,c=d.error,m=!(e.symbol===(null==s?void 0:s.symbol)||n.symbol===(null==s?void 0:s.symbol))||!!u,f=(0,L.op)(t,a,m&&"WETH9"!==r&&t>BigInt(0)&&a.length>=2);return{swapMethod:r,swapPath:a,amountsOut:f.data,amountsOutError:f.error,isAmountsOutLoading:f.isLoading,canSwap:m,initialStakeRound:u,isPendingInitialStakeRound:l,errInitialStakeRound:c}},X=t(33838),$=function(e,n){var t,s,a=(0,P.m)().address,i=(0,F.S)().handleContractError,d=(0,r._)((0,o.useState)(BigInt(0)),2),u=d[0],l=d[1],c=(0,r._)((0,o.useState)(BigInt(0)),2),m=c[0],f=c[1],p=U(e,a),h=p.balance,T=p.isPending,v=U(n,a),x=v.balance,b=v.isPending,k=Y(e,n,u),w=k.swapMethod,E=k.swapPath,j=k.amountsOut,C=k.amountsOutError,B=k.canSwap,_=k.errInitialStakeRound,S=(0,o.useMemo)(function(){},[e.isNative,n.isWETH]),I=!e.isNative&&"WETH9"!==w,M="WETH9"===w?"0xc3Da46ED14dBd79922027031BB5D688A81139e01":"0xBE7A91095198ddc6356CD7751c3dECa98321FE37",V=(0,W.yA)(e.address),D=V.approve,K=V.isPending,Z=V.isConfirming,R=V.isConfirmed,z=V.writeError,J=(0,X.Qo)(),q=J.deposit,Q=J.isPending,G=J.writeError,$=J.isConfirming,ee=J.isConfirmed,en=(0,X.Qc)(),et=en.withdraw,es=en.isPending,er=en.writeError,ea=en.isConfirming,eo=en.isConfirmed,ei=(0,L.oN)(),ed=ei.swap,eu=ei.isWriting,el=ei.isConfirming,ec=ei.isConfirmed,em=ei.writeError,ef=(0,L.Ae)(),ep=ef.swap,ey=ef.isWriting,eh=ef.isConfirming,eT=ef.isConfirmed,ev=ef.writeError,eg=(0,L.HL)(),ex=eg.swap,eb=eg.isWriting,ek=eg.isConfirming,ew=eg.isConfirmed,eA=eg.writeError,eN=R||!I,eE=ee||eo||ec||eT||ew;(0,o.useEffect)(function(){"WETH9"===w?f(u):j&&j.length>1?f(BigInt(j[j.length-1])):f(BigInt(0))},[w,u,j]),(0,o.useEffect)(function(){C&&i(C,"uniswapV2Router")},[C,i]),(0,o.useEffect)(function(){[_,z,G,er,em,ev,eA].forEach(function(e){e&&i(e,"uniswapV2Router")})},[_,z,G,er,em,ev,eA,i]),(0,o.useEffect)(function(){R&&y.Am.success("授权".concat(e.symbol,"成功"))},[R,e.symbol]),(0,o.useEffect)(function(){eE&&(y.Am.success("兑换成功"),setTimeout(function(){var t=new URL(window.location.href);t.searchParams.set("from",e.symbol),t.searchParams.set("to",n.symbol),window.location.href=t.toString()},2e3))},[eE,e.symbol,n.symbol]);var ej=(t=(0,O._)(function(){return(0,H.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,D(M,u)];case 1:return e.sent(),[3,3];case 2:return console.error(e.sent()),[3,3];case 3:return[2]}})}),function(){return t.apply(this,arguments)}),eC=(s=(0,O._)(function(){var t,s,r,o,d,l,c,f,p,h,T;return(0,H.Jh)(this,function(v){switch(v.label){case 0:if(!B)return y.Am.error("流动池为空，无法兑换，请稍后重试"),[2];if(!(t=A()).isValid)return y.Am.error(t.error),[2];if(S&&u>S)return s=(0,g.bM)(S),y.Am.error("输入超出测试环境上限，已调整为 ".concat(s," ").concat(e.symbol)),[2];if(!(r=N(E,w,e,n)).isValid)return y.Am.error(r.error),[2];if(!(o=m<=BigInt(0)?{isValid:!1,error:"无法获取兑换价格，流动池可能不足"}:{isValid:!0}).isValid)return y.Am.error(o.error),[2];v.label=1;case 1:switch(v.trys.push([1,14,,15]),d=BigInt(Math.floor(Date.now()/1e3)+1200),l=m*BigInt(995)/BigInt(1e3),w){case"WETH9":return[3,2];case"UniswapV2_ETH_TO_TOKEN":return[3,7];case"UniswapV2_TOKEN_TO_ETH":return[3,9];case"UniswapV2_TOKEN_TO_TOKEN":return[3,11]}return[3,13];case 2:if(!e.isNative)return[3,4];return[4,q(u)];case 3:return v.sent(),[3,6];case 4:return[4,et(u)];case 5:v.sent(),v.label=6;case 6:return[3,13];case 7:return[4,ep(l,E,a,d,u)];case 8:case 10:case 12:return v.sent(),[3,13];case 9:return[4,ex(u,l,E,a,d)];case 11:return[4,ed(u,l,E,a,d)];case 13:return[3,15];case 14:if((null===(f=(c=v.sent()).message)||void 0===f?void 0:f.includes("INSUFFICIENT_OUTPUT_AMOUNT"))||(null===(h=c.cause)||void 0===h?void 0:null===(p=h.message)||void 0===p?void 0:p.includes("INSUFFICIENT_OUTPUT_AMOUNT"))||(null===(T=c.details)||void 0===T?void 0:T.includes("INSUFFICIENT_OUTPUT_AMOUNT")))return y.Am.error("价格变动过快超过滑点保护，交易被保护性取消，请重试"),[2];return i(c,"uniswapV2Router"),[3,15];case 15:return[2]}})}),function(){return s.apply(this,arguments)});return{fromAmount:u,toAmount:m,setFromAmount:l,fromBalance:h,toBalance:x,isPendingFromBalance:T,isPendingToBalance:b,swapMethod:w,swapPath:E,amountsOut:j,amountsOutError:C,canSwap:B,maxNativeInputLimit:S,needsApproval:I,isApproved:eN,isApproving:K||Z,isSwapping:Q||$||es||ea||eu||el||ey||eh||eb||ek,isSwapConfirmed:eE,setMaxAmount:function(){var e=h||BigInt(0);return(0,g.bM)(S&&e>S?S:e)},handleApprove:ej,executeSwap:eC}},ee=function(e){var n=e.showCurrentToken,t=void 0===n||n,c=(0,i.Z)().token,m=(0,r._)((0,o.useState)(""),2),f=m[0],p=m[1],y=(0,o.useMemo)(function(){return b(c,t)},[c,t]),h=V(y,c),T=h.fromToken,v=h.toToken,g=h.setFromToken,x=h.setToToken,k=h.handleSwapTokens,w=$(T,v);if(!c)return(0,a.jsx)(u.Z,{});if(0===y.length)return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(d.Z,{title:"兑换"}),(0,a.jsx)("div",{className:"text-center text-greyscale-500 mt-4",children:"正在加载代币信息..."})]});var A=w.isApproving||w.isSwapping;return(0,a.jsxs)("div",{className:"py-6 px-2",children:[(0,a.jsx)(d.Z,{title:"兑换代币"}),(0,a.jsxs)("div",{className:"w-full max-w-md mt-4 md:max-w-2xl lg:max-w-4xl mx-auto",children:[(0,a.jsx)(I,(0,s._)({fromToken:T,toToken:v,supportedTokens:y,onFromTokenChange:g,onToTokenChange:x,onFromAmountChange:w.setFromAmount,onFromAmountStringChange:p,onSwapTokens:k},w)),(0,a.jsx)(M,{fromToken:T,toToken:v,fromAmount:w.fromAmount,toAmount:w.toAmount,watchFromAmount:f,swapMethod:w.swapMethod,amountsOutError:w.amountsOutError})]}),(0,a.jsx)(l.Z,{isLoading:A,text:w.isApproving?"授权中...":"兑换中..."})]})}},33838:function(e,n,t){t.d(n,{hS:function(){return m},Qo:function(){return f},Qc:function(){return p}});var s=t(11010),r=t(97582),a=t(67294),o=t(71104),i=[{type:"fallback",stateMutability:"payable"},{type:"function",name:"allowance",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"guy",type:"address",internalType:"address"},{name:"wad",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"balanceOf",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"decimals",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"deposit",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string",internalType:"string"}],stateMutability:"view"},{type:"function",name:"totalSupply",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transfer",inputs:[{name:"dst",type:"address",internalType:"address"},{name:"wad",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"transferFrom",inputs:[{name:"src",type:"address",internalType:"address"},{name:"dst",type:"address",internalType:"address"},{name:"wad",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"withdraw",inputs:[{name:"wad",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"Approval",inputs:[{name:"src",type:"address",indexed:!0,internalType:"address"},{name:"guy",type:"address",indexed:!0,internalType:"address"},{name:"wad",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Deposit",inputs:[{name:"dst",type:"address",indexed:!0,internalType:"address"},{name:"wad",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Transfer",inputs:[{name:"src",type:"address",indexed:!0,internalType:"address"},{name:"dst",type:"address",indexed:!0,internalType:"address"},{name:"wad",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Withdrawal",inputs:[{name:"src",type:"address",indexed:!0,internalType:"address"},{name:"wad",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],d=t(37742),u=t(37474),l=t(84689),c="0xc3Da46ED14dBd79922027031BB5D688A81139e01",m=function(e,n){var t=(0,o.u)({address:e,abi:i,functionName:"balanceOf",args:[n],query:{enabled:!!e&&!!n}}),s=t.data,r=t.isPending,a=t.error;return{balance:s?(0,d.Zu)(s):void 0,isPending:r,error:a}},f=function(){var e,n=(0,u.e9)(i,c,"deposit"),t=n.execute,o=n.isPending,d=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,h=(e=(0,s._)(function(e){return(0,r.Jh)(this,function(n){switch(n.label){case 0:return console.log("提交deposit交易:",{ethAmount:e,isTukeMode:y}),[4,t([],e)];case 1:return[2,n.sent()]}})}),function(n){return e.apply(this,arguments)});return(0,a.useEffect)(function(){p&&console.log("deposit tx hash:",p),f&&(console.log("提交deposit交易错误:"),(0,l.Vh)(f),(0,l.H)(f))},[p,f]),{deposit:h,isPending:o,isConfirming:d,writeError:f,isConfirmed:m,hash:p,isTukeMode:y}},p=function(){var e,n=(0,u.e9)(i,c,"withdraw"),t=n.execute,o=n.isPending,d=n.isConfirming,m=n.isConfirmed,f=n.error,p=n.hash,y=n.isTukeMode,h=(e=(0,s._)(function(e){return(0,r.Jh)(this,function(n){switch(n.label){case 0:return console.log("提交withdraw交易:",{wethAmount:e,isTukeMode:y}),[4,t([e])];case 1:return[2,n.sent()]}})}),function(n){return e.apply(this,arguments)});return(0,a.useEffect)(function(){p&&console.log("withdraw tx hash:",p),f&&(console.log("提交withdraw交易错误:"),(0,l.Vh)(f),(0,l.H)(f))},[p,f]),{withdraw:h,isPending:o,isConfirming:d,writeError:f,isConfirmed:m,hash:p,isTukeMode:y}}}}]);