try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="792dfef8-ad82-4043-a7e0-c2c2d047c38d",e._sentryDebugIdIdentifier="sentry-dbid-792dfef8-ad82-4043-a7e0-c2c2d047c38d")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2313],{82313:function(e,s,t){var n=t(11010),r=t(91309),i=t(97582),a=t(85893),l=t(1504),c=t(86501),d=t(20975),o=t(67294),u=t(41664),x=t.n(u),m=t(99019),h=t(56566),f=t(99522),b=t(30449),v=t(46273),y=t(94283),g=t(97613),j=t(907),p=t(43447),N=t(25223),k=t(761),w=t(26749),C=t(34155);s.Z=function(e){var s,t,u,B,I=e.token,A=e.enableWithdraw,T=void 0!==A&&A,E=(0,d.m)().address,_=(0,v.Bk)(),F=_.currentRound,P=_.isPending,Z=_.error,D=(0,b.L)(null==I?void 0:I.address,E),S=D.slAmount,z=D.stAmount,L=D.promisedWaitingPhases,H=D.requestedUnstakeRound,J=D.govVotes,W=D.isPending,G=D.error,K=function(){return!(!S||S<=BigInt(0))||(c.Am.error("流动性质押数量为0，不用取消质押"),!1)},U=(0,j.yG)(null==I?void 0:I.slTokenAddress,E,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",T),R=U.allowance,V=U.isPending,X=U.error,q=(0,j.yG)(null==I?void 0:I.stTokenAddress,E,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",T),Q=q.allowance,M=q.isPending,O=q.error,Y=(0,b.Ty)((null==I?void 0:I.address)||"",E||""),$=Y.validGovVotes;Y.isPending,Y.error;var ee=(0,r._)((0,o.useState)(!1),2),es=ee[0],et=ee[1],en=(0,r._)((0,o.useState)(!1),2),er=en[0],ei=en[1],ea=(0,y.yA)(null==I?void 0:I.stTokenAddress),el=ea.isPending,ec=ea.isConfirming,ed=ea.isConfirmed,eo=ea.writeError,eu=ea.approve,ex=(0,g.yA)(null==I?void 0:I.slTokenAddress),em=ex.isPending,eh=ex.isConfirming,ef=ex.isConfirmed,eb=ex.writeError,ev=ex.approve,ey=(s=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(S&&S>BigInt(0)&&!es))return[3,3];return[4,ev("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",S)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),eg=(t=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!K())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(z&&z>BigInt(0)&&!er))return[3,3];return[4,eu("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",z)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){ef?et(!0):S&&S>BigInt(0)&&R&&R>=S?et(!0):et(!1)},[S,R,V,ef]),(0,o.useEffect)(function(){ed?ei(!0):!z||z<=BigInt(0)?ei(!0):Q&&Q>=z?ei(!0):ei(!1)},[z,Q,M,ed]);var ej=(0,b.vc)(),ep=ej.isWriting,eN=ej.isConfirming,ek=ej.isConfirmed,ew=ej.writeError,eC=ej.unstake,eB=(u=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eC(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){ek&&(c.Am.success("取消质押成功"),setTimeout(function(){var e;window.location.href="".concat(null!==(e=C.env.NEXT_PUBLIC_BASE_PATH)&&void 0!==e?e:"","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[ek]);var eI=(0,b.Qc)(),eA=eI.isWriting,eT=eI.isConfirming,eE=eI.isConfirmed,e_=eI.writeError,eF=eI.withdraw,eP=(B=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,eF(null==I?void 0:I.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return B.apply(this,arguments)});(0,o.useEffect)(function(){eE&&(c.Am.success("取回代币成功"),setTimeout(function(){var e;window.location.href="".concat(null!==(e=C.env.NEXT_PUBLIC_BASE_PATH)&&void 0!==e?e:"","/my?symbol=").concat(null==I?void 0:I.symbol)},2e3))},[eE]);var eZ=(0,f.S)().handleContractError;if((0,o.useEffect)(function(){G&&eZ(G,"stake"),eo&&eZ(eo,"stToken"),eb&&eZ(eb,"slToken"),ew&&eZ(ew,"stake"),e_&&eZ(e_,"stake"),Z&&eZ(Z,"stake"),X&&eZ(X,"slToken"),O&&eZ(O,"stToken")},[G,eo,eb,ew,e_,Z,X,O]),!E)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!I||T&&P||W)return(0,a.jsx)(k.Z,{});if(!W&&!S)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eD=em||eh,eS=el||ec,ez=es&&er,eL=H&&F>H+(L||BigInt(0));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,a.jsx)("div",{className:"stat-value text-xl text-secondary",children:W?(0,a.jsx)(k.Z,{}):(0,m.LH)(J||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:H&&H>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,a.jsxs)("div",{className:"stat-value text-lg",children:[(0,a.jsx)("span",{className:"text-secondary",children:W?(0,a.jsx)(k.Z,{}):"".concat(L||BigInt(0)," ")}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,h.Cn)(Number(L||BigInt(0)),!0))})]})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,a.jsx)(N.Z,{address:I.slTokenAddress,showAddress:!1}),(0,a.jsx)(p.Z,{tokenAddress:I.slTokenAddress,tokenSymbol:"sl"+I.symbol,tokenDecimals:I.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:W?(0,a.jsx)(k.Z,{}):(0,m.LH)(S||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/stakelp/?symbol=".concat(I.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,a.jsx)(N.Z,{address:I.stTokenAddress,showAddress:!1}),(0,a.jsx)(p.Z,{tokenAddress:I.stTokenAddress,tokenSymbol:"st"+I.symbol,tokenDecimals:I.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:W?(0,a.jsx)(k.Z,{}):(0,m.LH)(z||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/staketoken?symbol=".concat(I.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),$<=BigInt(0)&&J&&J>BigInt(0)&&(0,a.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,a.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),T&&(0,a.jsxs)(a.Fragment,{children:[!H&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,a.jsx)(l.z,{className:"w-1/3",onClick:ey,disabled:eD||es,children:eD?"1.提交中...":eh?"1.确认中...":es?"1.sl".concat(null==I?void 0:I.symbol," 已授权"):"1.授权 sl".concat(null==I?void 0:I.symbol)}),(0,a.jsx)(l.z,{className:"w-1/3",onClick:eg,disabled:!es||eS||er,children:eS?"2.提交中...":ec?"2.确认中...":er?"2.st".concat(null==I?void 0:I.symbol," 已授权"):"2.授权 st".concat(null==I?void 0:I.symbol)}),(0,a.jsx)(l.z,{className:"w-1/3",onClick:eB,disabled:!ez||ep||eN||ek,children:ep?"3.提交中":eN?"3.确认中":ek?"3.已取消质押":"3.取消质押"})]}),(0,a.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,a.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,a.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(F,I)+(L||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),H&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,a.jsx)(l.z,{className:"w-1/2",onClick:eP,disabled:!eL||eA||eT||eE,children:eL?eA?"提交中":eT?"确认中":eE?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(H,I)+(L||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!T&&(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(l.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/my/govrewards?symbol=".concat(I.symbol),children:"铸造 治理激励 >>"})}),H&&(0,a.jsx)(l.z,{variant:"outline",className:"w-1/2 ".concat(eL?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eL,asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/unstake/?symbol=".concat(I.symbol),children:eL?"取回质押代币":"已取消, 第"+((0,m.cK)(H,I)+(L||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,a.jsx)(w.Z,{isLoading:eD||eS||eA||ep||eT||eN,text:em||el||eA||ep?"提交交易...":"确认交易..."})]})}}}]);